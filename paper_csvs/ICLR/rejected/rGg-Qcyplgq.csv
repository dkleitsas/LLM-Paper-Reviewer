Section,Section Appearance Order,Paragraph
ABSTRACT,0.0,ABSTRACT
ABSTRACT,0.0031746031746031746,"Distributional reinforcement learning aims to learn distribution of return under
stochastic environments. Since the learned distribution of return contains rich in-
formation about the stochasticity of the environment, previous studies have relied
on descriptive statistics, such as standard deviation, for optimism in the face of
uncertainty. However, using the uncertainty from an empirical distribution can
hinder convergence and performance when exploring with the certain criterion
that has an one-sided tendency on risk in these methods. In this paper, we pro-
pose a novel distributional reinforcement learning that explores by randomizing
risk criterion to reach a risk-neutral optimal policy. First, we provide a perturbed
distributional Bellman optimality operator by distorting the risk measure in ac-
tion selection. Second, we prove the convergence and optimality of the proposed
method by using the weaker contraction property. Our theoretical results support
that the proposed method does not fall into biased exploration and is guaranteed
to converge to an optimal return distribution. Finally, we empirically show that
our method outperforms other existing distribution-based algorithms in various
environments including Atari games."
INTRODUCTION,0.006349206349206349,"1
INTRODUCTION"
INTRODUCTION,0.009523809523809525,"Distributional reinforcement learning (DRL) learns the stochasticity of returns in the reinforcement
learning environments and has shown remarkable performance in several benchmark tasks. Its model
generates the approximated distribution of returns, where the mean value implies the traditional Q-
value (Bellemare et al., 2017; Dabney et al., 2018b; Choi et al., 2019). Learning procedure with
stochasticity through return distribution is represented by parametric (epistemic) uncertainty, which
is due to insufficient or inaccurate data, and intrinsic (aleatoric) uncertainty, which is inherently
possessed randomness in the environment. (Chow et al., 2015; Dabney et al., 2018a) The learned
stochasticity gives rise to the notion of risk-sensitivity, and some distributional reinforcement learn-
ing algorithms distort the learned distribution to create a risk-averse or risk-seeking policy."
INTRODUCTION,0.012698412698412698,"Another way to employ the uncertainty is to design an efficient exploration method which is essential
to find an optimal behavior with a few number of trials. Optimism in the face of uncertainty (OFU)
is one of the fundamental exploration principles that employs parametric uncertainty to promote
exploring less understood behaviors and to construct confidence set. Most OFU algorithms select an
action with the highest upper-confidence bound (UCB) of uncertainty which can be considered as the
optimistic decision at the moment (Chen et al., 2017; Ciosek et al., 2019). In deep RL, several OFU
studies often model the uncertainty explicitly through the Bayesian posterior, which is estimated by
using neural networks. However, learning the representation of high-dimensional state-action space
and Bellman update simultaneously leads to unstable propagation(Yang et al., 2021)."
INTRODUCTION,0.015873015873015872,"On the other hand, DRL can provide more statistical information during control such as mode, me-
dian, or variance by addressing full characteristics of the return distribution. Despite the richness
of information for return distribution, only a few DRL methods have tried to employ the benefits
of distributional perspective for exploration (Tang & Agrawal, 2018; Mavrin et al., 2019; Clements
et al., 2019). To estimate the uncertainty from distributional outputs, descriptive statistics that is
composed of a mixture of intrinsic and parametric uncertainty can be utilized. Unfortunately, sepa-"
INTRODUCTION,0.01904761904761905,Under review as a conference paper at ICLR 2022
INTRODUCTION,0.022222222222222223,"rating these two types of uncertainty during learning is not a trivial task. Mavrin et al. (2019) propose
a distribution-based OFU exploration that schedules a decaying bonus rate to suppress the effect of
intrinsic uncertainty, which unintentionally induces a risk-seeking policy. Although OFU based ap-
proaches try to reduce parametric uncertainty by revisiting the state with high uncertainty, there
exists the side effect that the criteria unfortunately forces the agent to chase the intrinsic uncertainty
(risk) simultaneously during updates. Relying on a specific criteria causes an one-sided tendency on
risk and makes an agent consistently select certain actions during exploration as degrading perfor-
mance. We call this phenomenon as stuckness."
INTRODUCTION,0.025396825396825397,"In this paper, we introduce perturbed quantile regression (PQR) which perturbs the criterion on un-
certainty by randomizing the risk criterion in action selection. First, the distributional perturbation on
return distribution is to re-evaluate the estimate of return by distorting the learned distribution with
perturbation weight. Unlike the typical worst-case approach in risk-sensitive settings or OFU based
approaches, we instead randomly sample a risk measure from an ambiguity set, which represents
that the risk setting is ambiguous when the characteristics of a given environment are unknown. We
empirically demonstrate on the stochastic variant of N-Chain environment (Osband et al., 2016) that
a randomized scheme is more effective than OFU to alleviate the sub-optimality problem of tendency
to obtain risk-seeking policies. Second, any risk-measure with some time-varying perturbation con-
straint allows us to average over all possible risk-sensitive behaviors to achieve the optimal policy.
We provide a sufficient condition for the convergence of return distribution in the weaker contrac-
tion property. Our method covers the full elements of the reinforcement learning with distributional
perspective from the novel exploration method with distributional perturbation to the theoretically
guaranteed convergence of return distribution, which has the same fixed-point with the standard
Bellman optimality operator. The proposed algorithm is based on QR-DQN, which is a baseline of
DRL architecture to learn a return distribution, and we show that PQR outperforms QR-DQN and
other DRL baselines in several benchmark environments, LunarLander-v2 and Atari games."
BACKGROUNDS & RELATED WORKS,0.02857142857142857,"2
BACKGROUNDS & RELATED WORKS"
DISTRIBUTIONAL REINFORCEMENT LEARNING,0.031746031746031744,"2.1
DISTRIBUTIONAL REINFORCEMENT LEARNING"
DISTRIBUTIONAL REINFORCEMENT LEARNING,0.03492063492063492,"We consider a Markov decision process (MDP) which is defined as a tuple (S, A, P, R, Œ≥) where S
is a finite state space, A is a finite action space, P : S√óA√óS ‚Üí[0, 1] is the transition probability, R
is the random variable of rewards in [‚àíRmax, Rmax], and Œ≥ ‚àà[0, 1) is the discount factor. We define a
stochastic policy œÄ(¬∑|s) which is a conditional distribution over A given state s. For a fixed policy œÄ,
we denote ZœÄ(s, a) as a random variable of return distribution of state-action pair (s, a) following
the policy œÄ. We attain ZœÄ(s, a) = P‚àû
t=0 Œ≥tR(St, At), where St+1 ‚àºP(¬∑|St, At), At ‚àºœÄ(¬∑|St)
and S0 = s, A0 = a. Then, we define an action-value function as QœÄ(s, a) = E[ZœÄ(s, a)] in
[‚àíVmax, Vmax] where Vmax = Rmax/(1‚àíŒ≥). For regularity, we further notice that the space of action-
value distributions Z has the first moment bounded by Vmax:"
DISTRIBUTIONAL REINFORCEMENT LEARNING,0.0380952380952381,"Z =

Z : S √ó A ‚ÜíP(R)
 E[|Z(s, a)|] ‚â§Vmax, ‚àÄ(s, a)
	
."
DISTRIBUTIONAL REINFORCEMENT LEARNING,0.04126984126984127,"In distributional RL, the return distribution for the fixed œÄ can be computed via dynamic program-
ming with the distributional Bellman operator defined as (Bellemare et al., 2017),"
DISTRIBUTIONAL REINFORCEMENT LEARNING,0.044444444444444446,"œÑ œÄZ(s, a)
D= R(s, a) + Œ≥Z(S‚Ä≤, A‚Ä≤),
S‚Ä≤ ‚àºP(¬∑|s, a), A‚Ä≤ ‚àºœÄ(¬∑|S‚Ä≤)"
DISTRIBUTIONAL REINFORCEMENT LEARNING,0.047619047619047616,"where
D= denotes that both random variables share the same probability distribution. We can compute
the optimal return distribution by using the distributional Bellman optimality operator defined as,"
DISTRIBUTIONAL REINFORCEMENT LEARNING,0.050793650793650794,"œÑ Z(s, a)
D= R(s, a) + Œ≥Z(S‚Ä≤, a‚àó),
S‚Ä≤ ‚àºP(¬∑|s, a), a‚àó= arg max
a‚Ä≤
EZ[Z(S‚Ä≤, a‚Ä≤)]."
DISTRIBUTIONAL REINFORCEMENT LEARNING,0.05396825396825397,"Bellemare et al. (2017) have shown that œÑ œÄ is a contraction in a maximal form of the Wasserstein
metric but œÑ is not a contraction in any metric. Combining with the expectation operator, EœÑ is a
contraction so that we can guarantee that the expectation of Z converges to the optimal state-action
value, while the convergence of a return distribution itself is not guaranteed."
DISTRIBUTIONAL REINFORCEMENT LEARNING,0.05714285714285714,Under review as a conference paper at ICLR 2022
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.06031746031746032,"2.2
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING"
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.06349206349206349,"In this section, we will briefly describe the main practical algorithm for DRL with a deep neural
network, and explain the derived exploration method. To combine with deep RL, a parametric dis-
tribution ZŒ∏ is used to learn a return distribution by usingœÑ . Dabney et al. (2018b) have employed a
quantile regression to approximate the full distribution by letting ZŒ∏(s, a) = 1"
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.06666666666666667,"N
PN
i=1 Œ¥Œ∏i(s,a) where
the parameter Œ∏ represents the locations of a mixture of N Dirac delta functions. Each Œ∏i represents
the value where the cumulative probability is œÑi =
i
N . Then, by using the quantile representation
with the distributional Bellman optimality operator, the problem can be formulated as a minimiza-
tion problem as,"
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.06984126984126984,"Œ∏ = arg min
Œ∏‚Ä≤ D (ZŒ∏‚Ä≤(st, at),œÑ ZŒ∏‚àí(st, at)) := N
X i=1 N
X j=1"
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.07301587301587302,"1
N [œÅŒ∫
ÀÜœÑi(rt + Œ≥Œ∏‚àí
j (st+1, a‚Ä≤) ‚àíŒ∏‚Ä≤
i(st, at))]"
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.0761904761904762,"where (st, at, rt, st+1) is a given transition pair, ÀÜœÑi = œÑi‚àí1+œÑi"
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.07936507936507936,"2
, a‚Ä≤ := arg maxa‚Ä≤ EZ[ZŒ∏(st+1, a‚Ä≤)],
œÅŒ∫
ÀÜœÑi(x) := |ÀÜœÑi‚àíŒ¥{x<0}|LŒ∫(x), and LŒ∫(x) := x2/2 for |x| ‚â§Œ∫ and LŒ∫(x) := Œ∫(|x|‚àí1"
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.08253968253968254,"2Œ∫), otherwise.
Based on the quantile regression, Dabney et al. (2018b) have proposed a quantile regression deep Q
network (QR-DQN) that shows better empirical performance than the categorical approach (Belle-
mare et al., 2017) since the quantile regression does not restrict the bounds for return. As deep RL
typically did, QR-DQN adjusts œµ-greedy schedule, which selects the greedy action with probability
1 ‚àíœµ and otherwise selects random available actions uniformly. The majority of QR-DQN variants
(Dabney et al., 2018a; Yang et al., 2019) rely on the same exploration method. However, such ap-
proaches do not put aside inferior actions from the selection list and thus suffers from a loss (Osband
et al., 2019). Hence, selecting a statistically plausible action is crucial for efficient exploration."
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.08571428571428572,"In recent studies, Mavrin et al. (2019) modifies the criterion of selecting an action for efficient
exploration in the face of uncertainty. Using left truncated variance as a bonus term to estimate
optimistic way and decaying ratio ct to suppress the intrinsic uncertainty, DLTV was proposed as an
uncertainty-based exploration in DRL without using œµ-greedy exploration. At timestep t, the action
selection of DLTV can be described as:"
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.08888888888888889,"a‚àó= arg max
a‚Ä≤"
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.09206349206349207,"
EP [Z(s‚Ä≤, a‚Ä≤)] + ct
q"
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.09523809523809523,"œÉ2
+(s‚Ä≤, a‚Ä≤)

, ct = c r log t"
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.09841269841269841,"t
, œÉ2
+ =
1
2N N
X i= N 2 (Œ∏ N"
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.10158730158730159,"2 ‚àíŒ∏i)2,"
EXPLORATION ON DISTRIBUTIONAL REINFORCEMENT LEARNING,0.10476190476190476,"where Œ∏i‚Äôs are the values of quantile level œÑi. DLTV shows that a constant schedule degrades the
performance significantly compared to a decaying schedule."
RISK IN DISTRIBUTIONAL REINFORCEMENT LEARNING,0.10793650793650794,"2.3
RISK IN DISTRIBUTIONAL REINFORCEMENT LEARNING"
RISK IN DISTRIBUTIONAL REINFORCEMENT LEARNING,0.1111111111111111,"Instead of an expected value, risk-sensitive RL tries to maximize a risk measure such as Mean-
Variance (Zhang et al., 2020), Value-at-Risk (VaR) (Chow et al., 2017), or Conditional Value-at-Risk
(CVaR) (Rockafellar et al., 2000; Rigter et al., 2021), which result in different classes of optimal
policy. Especially, Dabney et al. (2018a) interprets risk measures as the expected utility function of
the return, i.e., EZ[U(Z(s, a))]. Under this interpretation, risk-sensitive RL can be formulated as
the maximization problem with various types of utility functions. If the utility function U is linear,
the policy obtained under such risk measure is called risk-neutral. If U is concave or convex, the
resulting policy is termed as risk-averse or risk-seeking, respectively. In general, a distortion risk
measure is a generalized expression of risk measure generated from the distortion function.
Definition 1. Let h : [0, 1] ‚Üí[0, 1] be a distortion function such that h(0) = 0, h(1) = 1 and non-
decreasing. Given a probability space (‚Ñ¶, F, P) and a random variable Z : ‚Ñ¶‚ÜíR, a distortion
risk measure œÅh corresponding to a distortion function h is defined by:"
RISK IN DISTRIBUTIONAL REINFORCEMENT LEARNING,0.11428571428571428,"œÅh(Z) := Eh(P)[Z] =
Z ‚àû"
RISK IN DISTRIBUTIONAL REINFORCEMENT LEARNING,0.11746031746031746,"‚àí‚àû
z ‚àÇ"
RISK IN DISTRIBUTIONAL REINFORCEMENT LEARNING,0.12063492063492064,"‚àÇz (h ‚ó¶FZ)(z)dz,"
RISK IN DISTRIBUTIONAL REINFORCEMENT LEARNING,0.12380952380952381,where FZ is the cumulative distribution function of Z.
RISK IN DISTRIBUTIONAL REINFORCEMENT LEARNING,0.12698412698412698,"In fact, non-decreasing property of h makes it possible to distort the distribution of Z while satisfying
the fundamental property of CDF. Note that the concavity and the convexity of distortion function"
RISK IN DISTRIBUTIONAL REINFORCEMENT LEARNING,0.13015873015873017,Under review as a conference paper at ICLR 2022
RISK IN DISTRIBUTIONAL REINFORCEMENT LEARNING,0.13333333333333333,"Figure 1: Illustration of the N-Chain environment starting from state s2. To emphasize the stochas-
ticity, the reward of state s4 was set as a mixture model composed of two Gaussian distributions.
Blue arrows indicate the risk-neutral optimal policy in this MDPs."
RISK IN DISTRIBUTIONAL REINFORCEMENT LEARNING,0.1365079365079365,"also imply risk-averse or risk-seeking behavior, respectively. Dhaene et al. (2012) showed that any
distorted expectation can be expressed as weighted averages of quantiles. In other words, generating
a distortion risk measure is equivalent to choosing a reweighting distribution."
RISK IN DISTRIBUTIONAL REINFORCEMENT LEARNING,0.13968253968253969,"Fortunately, distributional RL has a suitable configuration to apply those uncertainty-based ap-
proaches that could naturally expand the class of policies. Chow et al. (2015) and Stanko & Macek
(2019) considered risk-sensitive RL with a CVaR objective, where risk is related to robust decision
making. Dabney et al. (2018a) expanded the class of policies on arbitrary distortion risk measures
and investigated the effects of a distinct distortion risk measures by changing the sampling distri-
bution for quantile targets œÑ. Unlike the usual risk-sensitive RL, DLTV applied the risk measure
only on action selection, while it keeps the standard objective to obtain a risk-neutral optimal policy.
Our analysis shows that risk-based exploration can utilize risk measures in two different ways: (1)
selecting action and (2) evaluating the value function by using distorted (perturbed) expectation."
PERTURBATION IN DISTRIBUTIONAL REINFORCEMENT LEARNING,0.14285714285714285,"3
PERTURBATION IN DISTRIBUTIONAL REINFORCEMENT LEARNING"
MOTIVATION,0.14603174603174604,"3.1
MOTIVATION"
MOTIVATION,0.1492063492063492,"Distribution-based OFU exploration (Moerland et al., 2018; Keramati et al., 2020) was proposed
to give a bonus for the uncertainty that can be extracted from the distribution. However, we found
that keeping optimism on uncertainty tends to select sub-optimal behaviors over a long exploration.
For example, suppose we choose a criterion based on mean-standard deviation with coefficient ct.
Consider two actions a1, a2 with mean ¬µ1, ¬µ2 and variance œÉ1, œÉ2 respectively, under the following
conditions: ¬µ1 ‚â•¬µ2, œÉ1 ‚â§œÉ2, and ¬µ1 + ctœÉ1 ‚â§¬µ2 + ctœÉ2. Then, the agent prefers to select a2
based on OFU. To change the decision towards the true optimal action a1, the following steps need
to be spent:"
MOTIVATION,0.1523809523809524,"Œ∑ = min

t‚Ä≤ > t : ct‚Ä≤ ‚â§¬µ1 ‚àí¬µ2"
MOTIVATION,0.15555555555555556,"œÉ2 ‚àíœÉ1 
‚àít."
MOTIVATION,0.15873015873015872,"Hence, if there is a bias in the criterion itself, such stuckness often occurs and degrades the perfor-
mance since the agent does not have experience with the optimal policy during that period."
MOTIVATION,0.1619047619047619,"To demonstrate such shortcomings of OFU exploration in distributional RL framework, we build
a representative environment that is easy to interpret intuitively among the cases in which intrinsic
uncertainty exists. We experiment on the stochastic variant of N-Chain environment used in Osband
et al. (2016) as a toy experiment. A schematic diagram of the N-Chain environment is shown in
Figure 1. The reward is only given in the leftmost and rightmost states and the game terminates when
one of the reward states is reached. We set the leftmost reward as N(10, 0.12) and the rightmost
reward as 1"
MOTIVATION,0.16507936507936508,"2N(5, 0.12) + 1"
MOTIVATION,0.16825396825396827,"2N(13, 0.12) which has a lower mean as 9 but higher variance. The agent
always starts from the middle state s2 and should move toward the leftmost state s0 to achieve the
greatest expected return. For each state, the agent can take one of six available actions: left, right,
and 4 no-op actions. The optimal policy with respect to mean is to move left twice from the start.
Despite the simple configuration, the possibility to obtain a higher reward in the suboptimal state
than the optimal state makes the agent difficult which policy is optimal until it experiences enough
to detect the characteristics of each distribution. Thus, the goal of our toy experiment is to evaluate
how quickly each algorithm could find a risk-neutral optimal policy."
MOTIVATION,0.17142857142857143,Under review as a conference paper at ICLR 2022 (a)
MOTIVATION,0.1746031746031746,"0
5000
10000
15000
20000
Steps 0 2500 5000 7500 10000 12500 15000 17500 20000"
MOTIVATION,0.17777777777777778,Total Count
MOTIVATION,0.18095238095238095,"QRDQN
DLTV
p-DLTV
PQR (b)"
MOTIVATION,0.18412698412698414,"Figure 2: (a) Empirical return distribution of DLTV during training in N-Chain environment. The
dashed lines denote the exact mean, and the dots on the x-axis denote the perturbed mean of each
action. No-op actions are not shown for visibility. (b) Total count of performing true optimal action.
The oracle (dashed line) is to perform the true optimal action from start to end."
MOTIVATION,0.1873015873015873,"Rather than applying a decaying schedule to suppress intrinsic uncertainty, we naively modify the
optimism into a randomized risk criterion and named the perturbed variant as p-DLTV. We compare
QR-DQN and DLTV with our randomized variants of two algorithms PQR and p-DLTV to examine
the effect of randomized risk criteria. In short, p-DLTV is a straightforward modification of DLTV
where randomness is given to the coefficient ct through normal distribution. We will describe our
main algorithm, PQR, in detail in Section 3.4."
MOTIVATION,0.19047619047619047,"In Figure 2(a), DLTV fails to estimate the true optimal return distribution of action a1. Due to the
erroneous estimation, the agent takes longer to recognize its error. Hence, the deterministic selection
based on a fixed criteria could mislead toward exploitation rather than exploration. This indicates that
DLTV may not gather experiences well in a complex environment that requires deep exploration. In
Figure 2(b), we plot the point when the optimal policy was actually performed for each algorithm
to show stuckness. Since the optimal policy consists of only the same index a1, we plot the total
count of performing the optimal action with 10 different seeds. The slope indicates the ratio of
performing the optimal policy on average. Hence, the interval with a slope of 1 implies that the
optimal policy was performed every time. From the slope of each line, it is observed that DLTV
selects the suboptimal action even if the optimal policy was initially performed. Although the mean
return of a1 (move left) is estimated to be superior, the agent only selects a2 (move right) during
training due to its consistent optimism on uncertainty. Even if DLTV has spent enough number of
time steps to choose the true optimal policy, the remaining procedure is already close to greedy
selection as it starts from a decreased coefficient."
MOTIVATION,0.19365079365079366,"Surprisingly, p-DLTV alleviates the stuckness early by randomly choosing a plausible action. We
also propose a theoretically guaranteed algorithm to be converged, PQR which shows a much steeper
line by quickly obtaining the optimal policy. In Section 3.2, we derive the first theoretical sufficient
condition for the convergence of exploration method for DRL, which implies that PQR has the same
unique fixed point as the standard distributional Bellman equation."
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.19682539682539682,"3.2
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR"
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.2,"To choose statistically plausible actions which may be maximal for certain criteria, we are interested
in generating a distortion risk measure involved in a pre-defined constraint set called an ambiguity
set. The ambiguity set, originated from distributionally robust optimization (DRO) literature, is a
family of distribution characterized by a certain statistical distance such as œï-divergence or Wasser-
stein distance (Esfahani & Kuhn, 2018; Shapiro et al., 2021). In this paper, we will examine the
ambiguity set defined by the discrepancy between distortion risk measure and expectation. We say
the sampled reweighting distribution Œæ as (distributional) perturbation and define it as follows:"
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.20317460317460317,"Definition 2. (Perturbation, Perturbation Gap, and Ambiguity Set) Given a probability space
(‚Ñ¶, F, P), let X : ‚Ñ¶‚ÜíR be a random variable and Œû =

Œæ : Œæ(w) ‚â•0,
R"
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.20634920634920634,w‚àà‚Ñ¶Œæ(w)P(w)dw = 1
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.20952380952380953,Under review as a conference paper at ICLR 2022
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.2126984126984127,"be a set of probability density functions. For a given constraint set U ‚äÇŒû, we say Œæ ‚ààU as a
(distributional) perturbation from U and denote the Œæ‚àíweighted expectation of X as follows:"
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.21587301587301588,"EŒæ[X] :=
Z"
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.21904761904761905,"w‚àà‚Ñ¶
X(w)Œæ(w)P(w)dw,"
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.2222222222222222,"which can be interpreted as the expectation of X under perturbed probability distribution ŒæP. We
further define d(X; Œæ) = |E[X] ‚àíEŒæ[X]| as perturbation gap of X with respect to Œæ. Then, for a
given constant ‚àÜ‚â•0, we define the ambiguity set with the bound ‚àÜas"
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.2253968253968254,"U‚àÜ(X) =
n
Œæ ‚ààŒû : d(X; Œæ) ‚â§‚àÜ
o
."
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.22857142857142856,"For brevity, we omit the input w from a random variable unless confusing. Since Œæ is a probability
density function, EŒæ[X] is an induced risk measure with respect to a reference measure P. Intuitively,
Œæ(w) can be viewed as a distortion to generate a different probability measure and allow to vary the
risk tendency. The aspect of using distortion risk measures looks similar to IQN (Dabney et al.,
2018a). However, instead of changing the sampling distribution of quantile level œÑ implicitly, we
reweight each quantile from the ambiguity set. This allows us to control the maximum allowable
distortion with bound ‚àÜ, whereas in IQN the risk measure does not change throughout learning. In
Section 3.4, we will suggest a practical method to construct the ambiguity set."
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.23174603174603176,"Now, we characterize perturbed distributional Bellman optimality operatorœÑ Œæ for a fixed perturba-
tion Œæ ‚ààU‚àÜ(Z) written as below:"
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.23492063492063492,"œÑ ŒæZ(s, a)
D= R(s, a) + Œ≥Z(S‚Ä≤, a‚àó(Œæ)),
S‚Ä≤ ‚àºP (¬∑|s, a) , a‚àó(Œæ) = arg max
a‚Ä≤
EŒæ,P [Z(s‚Ä≤, a‚Ä≤)]."
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.23809523809523808,"Notice that Œæ ‚â°1 corresponds to a base expectation, i.e., EŒæ,P = EP , which recovers the standard
distributional Bellman optimality operatorœÑ . To understand the progress of PDBOO intuitively, we
add the pipeline figure in Appendix A.4."
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.24126984126984127,"Specifically, updating via œÑ Œæ can be described in two steps. 1) Select the superior action in terms
of an arbitrary distortion risk measure instead of mean. We specify the distortion risk measure by
sampling the perturbation Œæ from the ambiguity set. 2) Compute the return distribution through
dynamic programming which follows the standard Bellman optimality equation. In risk-sensitive
DRL or distributionally robust RL, the Bellman optimality equation is reformulated for a pre-defined
risk measure (Chow et al., 2015; Smirnova et al., 2019; Yang, 2020). In this sense, PDBOO has
a significant distinction in that it performs dynamic programming that adheres to the risk-neutral
optimal policy while randomizing the risk criterion at every step."
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.24444444444444444,"If we consider the time-varying bound of ambiguity set, scheduling ‚àÜt is a key ingredient to deter-
mine whether PDBOO will efficiently explore or converge. The following lemma plays an important
role to guarantee the convergence of PDBOO.
Lemma 3. If Œæt converges to 1 uniformly on ‚Ñ¶, then EœÑ Œæt also converges to EœÑ uniformly on Z
for all s ‚ààS and a ‚ààA."
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.24761904761904763,"Intuitively, if an agent continues to sample the distortion risk measure from a fixed ambiguity set
with a constant ‚àÜ, there is a possibility of selecting sub-optimal actions after sufficient exploration,
which may not guarantee eventual convergence. Hence, it will be crucial to schedule a constraint of
ambiguity set properly at each action selection to guarantee convergence."
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.2507936507936508,"Based on the quantile model ZŒ∏, our algorithm can be summarized into two parts. First, we aim
to minimize the expected discrepancy between ZŒ∏ and œÑ ŒæZŒ∏‚àíwhere Œæ is sampled from ambiguity
set U‚àÜ. To clarify notation, we write EŒæ[¬∑] as a Œæ‚àíweighted expectation and EŒæ‚àºP(U‚àÜ)[¬∑] as an
expectation with respect to Œæ which is sampled from U‚àÜ. Then, our goal is to minimize the perturbed
distributional Bellman objective with sampling procedure P:"
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.25396825396825395,"min
Œ∏‚Ä≤ EŒæt‚àºP(U‚àÜt)[D(ZŒ∏‚Ä≤(s, a),œÑ ŒætZŒ∏‚àí(s, a))]
(1)"
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.2571428571428571,"where we use the Huber quantile loss as a discrepancy on ZŒ∏‚Ä≤ andœÑ ŒæZŒ∏‚àíat timestep t. It is different
from DRO which performs the worst-case optimization by using a minimax objective. By using
expectation instead of max operator, we investigate risk-neutral exploration that can avoid overly"
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.26031746031746034,Under review as a conference paper at ICLR 2022
PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY OPERATOR,0.2634920634920635,"pessimistic policies. Second, considering a sequence Œæt which converges uniformly to 1 so that œÑ Œæt
converges uniformly to original œÑ , we derive a sufficient condition of ‚àÜt that the expectation of
iterated operator EœÑ Œæn:1 = EœÑ ŒænœÑ Œæn‚àí1 ¬∑ ¬∑ ¬∑œÑ Œæ1 has a unique fixed point with the same solution as
the standard solution."
"CONVERGENCE OF THE PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY
OPERATOR",0.26666666666666666,"3.3
CONVERGENCE OF THE PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY
OPERATOR"
"CONVERGENCE OF THE PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY
OPERATOR",0.2698412698412698,"In this section, we will provide the theoretical result of PDBOO about its convergence through
E[Z(n)] where the iteration procedure is denoted as Z(n+1) := œÑ Œæn+1Z(n) and Z(0) = Z for each
timestep n > 0.
Theorem 4. For a sequence of bound ‚àÜn, let ¬ØU‚àÜn(Z(n‚àí1)) := T
s,a U‚àÜn
 
Z(n‚àí1)(s, a)

. If we
sample Œæn from ¬ØU‚àÜn(Z(n‚àí1)) for every iteration and P‚àû
n=1 ‚àÜn < ‚àûholds, then, the expectation
of iterated operator œÑ Œæn:1 has a fixed point E[Z‚àó]. Moreover, the following bound holds,"
"CONVERGENCE OF THE PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY
OPERATOR",0.273015873015873,"sup
s,a"
"CONVERGENCE OF THE PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY
OPERATOR",0.2761904761904762,"E[Z(n)(s, a)] ‚àíE[Z‚àó(s, a)]
 ‚â§ ‚àû
X k=n "
"CONVERGENCE OF THE PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY
OPERATOR",0.27936507936507937,"2Œ≥k‚àí1Vmax + 2 k
X"
"CONVERGENCE OF THE PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY
OPERATOR",0.28253968253968254,"i=1
Œ≥i(‚àÜk+2‚àíi + ‚àÜk+1‚àíi) ! ."
"CONVERGENCE OF THE PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY
OPERATOR",0.2857142857142857,"Theorem 4 states thatœÑ Œæn:1 converges while it does not satisfy the Œ≥-contraction property. Note that
the fixed point E[Z‚àó] is not yet guaranteed to be unique for any Z ‚ààZ. Fortunately, we could show
that E[Z‚àó] is, in fact, the solution of the standard Bellman optimality equation which is already well
known to have a unique solution.
Theorem 5. If {‚àÜn} follows the assumption in Theorem 4, then E[Z‚àó] is the unique solution of
Bellman optimality equation."
"CONVERGENCE OF THE PERTURBED DISTRIBUTIONAL BELLMAN OPTIMALITY
OPERATOR",0.28888888888888886,"From two theoretical results, PDBOO is guaranteed to have the same unique fixed point as the
standard Bellman operator under weaker contraction property. Unlike other distribution-based or
risk-sensitive approaches, PDBOO is a novel operator having compatibility for obtaining a risk-
neutral optimal policy. Also, it is also observed that this randomized method is more efficient than
the OFU-based exploration by quickly alleviating from sub-optimal policies."
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.2920634920634921,"3.4
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.29523809523809524,"We propose a perturbed quantile regression (PQR) that is a practical algorithm for distributional
reinforcement learning. We model a return distribution using quantile regression and update the
quantile model by minimizing the objective function (1) induced by PDBOO. To compute the target
distribution of (1), we propose a sampling method of Œæ from ambiguity set U‚àÜ. Since we employ
a quantile model, sampling a reweight function Œæ can be reduced into sampling an N-dimensional
weight vector Œæ := [Œæ1, ¬∑ ¬∑ ¬∑ , ŒæN] where PN
i=1 Œæi = N and Œæi ‚â•0 for all i ‚àà{1, ¬∑ ¬∑ ¬∑ , N}. Based on
the QR-DQN setup, note that the condition
R"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.2984126984126984,"w‚àà‚Ñ¶Œæ(w)P(w)dw = 1 turns into PN
i=1
1
N Œæi = 1 since
the quantile level is set as œÑi =
i
N ."
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.30158730158730157,"A key issue is how to construct an ambiguity set with bound ‚àÜt and then sample Œæ. A natural class
of distribution for practical use is the symmetric Dirichlet distribution with concentration Œ≤, which"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.3047619047619048,"Algorithm 1: Perturbed QR-DQN (PQR)
Input: transition (s, a, r, s‚Ä≤), discount Œ≥ ‚àà[0, 1), timestep t > 0, epsilon œµ > 0, concentration Œ≤
Initialize ‚àÜ0 > 0
‚àÜt ‚Üê‚àÜ0t‚àí(1+œµ)"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.30793650793650795,"Œæ ‚Üêmax

1N + ‚àÜt(Nx ‚àí1N), 0

where x ‚àºDir(Œ≤)
# Sample Œæ ‚àº¬ØU‚àÜt(Z(t))"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.3111111111111111,"Œæ ‚ÜêNŒæ/P Œæi
a‚àó‚Üêarg maxa‚Ä≤ EŒæ[Z(s‚Ä≤, a‚Ä≤)]
# Select greedy action with distorted expectation
œÑ Œ∏j ‚Üêr + Œ≥Œ∏j(s‚Ä≤, a‚àó),
‚àÄj
t ‚Üêt + 1
Output: PN
i=1 Ej[œÅŒ∫
ÀÜœÑi(œÑ Œ∏j ‚àíŒ∏i(s, a))]"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.3142857142857143,Under review as a conference paper at ICLR 2022
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.31746031746031744,"‚àÜ¬µ
(ÀÜ¬µ ‚àí¬µ)
‚àÜœÉ
(ÀÜœÉ ‚àíœÉ)"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.32063492063492066,"QR-DQN
1.23
0.01"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.3238095238095238,"DLTV
-1.02
1.01"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.326984126984127,"p-DLTV
0.02
0.38"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.33015873015873015,"PQR(ours)
-0.03
-0.01"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.3333333333333333,"Figure 3: (Left) Empirical return distribution plot in N-Chain environment. Since QR-DQN does
not depend on other criterion, the dots are omitted. (Right) Mean and standard-deviation difference
between each algorithm and ground truth distribution."
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.33650793650793653,"represents distribution over distributions. (i.e. x ‚àºDir(Œ≤).) If Œ≤ is small, then, most of the mass is
concentrated on a few elements. Otherwise, all elements are similar to each other and produce evenly
distributed weight. By using the Dirichlet distribution, we sample a random vector, x ‚àºDir(Œ≤), and
define the reweight distribution as Œæ := 1N + Œ±(Nx ‚àí1N). From the construction of Œæ, we have
1 ‚àíŒ± ‚â§Œæi ‚â§1 + Œ±(N ‚àí1) for all i and it follows that |1 ‚àíŒæi| ‚â§Œ±(N ‚àí1) for all i. By controlling
Œ±, we can bound the deviation of Œæi from 1 and bound the perturbation gap as"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.3396825396825397,"sup
s,a |E[Z(s, a)] ‚àíEŒæ[Z(s, a)]| = sup
s,a  Z"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.34285714285714286,"w‚àà‚Ñ¶
Z(w; s, a)(1 ‚àíŒæ(w))P(w)dw"
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.346031746031746,"‚â§sup
w‚àà‚Ñ¶
|1 ‚àíŒæ(w)| sup
s,a E[|Z(s, a)|] ‚â§sup
w‚àà‚Ñ¶
|1 ‚àíŒæ(w)|Vmax ‚â§Œ±(N ‚àí1)Vmax."
PERTURBED QUANTILE REGRESSION FOR DEEP Q-NETWORK,0.3492063492063492,"Hence, letting Œ± ‚â§
‚àÜ
(N‚àí1)Vmax is sufficient to obtain d(Z; Œæ) ‚â§‚àÜin the quantile setting. We set
Œ≤ = 0.05 ¬∑ 1N to generate a constructive perturbation Œæn which gap is close to the bound ‚àÜn. To
satisfy the condition stated in Theorem 4, we set ‚àÜt = ‚àÜ0t‚àí(1+œµ) where ‚àÜ0 is a hyperparameter.
The detailed procedure of the proposed method is summarized in Algorithm 1."
EXPERIMENTAL RESULTS AND DETAILS,0.3523809523809524,"4
EXPERIMENTAL RESULTS AND DETAILS"
EXPERIMENTAL RESULTS AND DETAILS,0.35555555555555557,"In this section, we evaluate the performance on N-Chain, LunarLander and Atari games to demon-
strate the efficiency of randomized criteria, comparing with QR-DQN (œµ-greedy) and DLTV (OFU)."
EXPERIMENTAL RESULTS AND DETAILS,0.35873015873015873,"N-Chain.
As the mean of each return is designed to be similar, it is useful to examine the learning
behavior of the empirical return distribution for each algorithm. Figure 3 shows the empirical PDF
of return distribution by using Gaussian kernel density estimation. PQR estimates the ground truth
much better than other baselines with much closer mean and standard-deviation. Although the op-
timal policy was performed, QR-DQN overestimates the optimal Q-value of (s2, a1) as ÀÜ¬µ = 9.33
while the ground truth is computed as ¬µ = 10Œ≥2 = 8.1. PQR estimated the target relatively better
compared to QR-DQN as the agent often chooses an alternative action from a risk-neutral per-
spective. Only by chainging from optimism to a randomized scheme, p-DLTV made a much better
estimate than DLTV."
EXPERIMENTAL RESULTS AND DETAILS,0.3619047619047619,"LunarLander-v2.
Next, we evaluate the performance on LunarLander-v2 environment where its
input is given by 8-dimensional coordinates with 4 different discrete actions. The goal of the agent
is to reach the landing pad with a given threshold of 200 points without crashing. Without obtaining
the extra point of +100, the agent cannot reach the threshold."
EXPERIMENTAL RESULTS AND DETAILS,0.36507936507936506,"Figure 4(a) shows that p-DLTV and PQR have reached the threshold 200 points faster than the
other two algorithms. Significantly, p-DLTV successfully reached the goal just by randomizing the
criterion from OFU while DLTV did not learn to obtain the extra point. The result shows that one-
sided tendency on risk leads to learning failure of an agent. We note that the randomized risk criterion
could alleviate the stuckness within an affordable time budget."
EXPERIMENTAL RESULTS AND DETAILS,0.3682539682539683,Under review as a conference paper at ICLR 2022
EXPERIMENTAL RESULTS AND DETAILS,0.37142857142857144,"0.05
0.10
0.15
0.20
0.25
0.30
Steps (Million) 200 100 0 100 200 300 Score"
EXPERIMENTAL RESULTS AND DETAILS,0.3746031746031746,LunarLander-v2
EXPERIMENTAL RESULTS AND DETAILS,0.37777777777777777,"QRDQN
DLTV
p-DLTV
PQR (a)"
EXPERIMENTAL RESULTS AND DETAILS,0.38095238095238093,Hitting Time (M)
EXPERIMENTAL RESULTS AND DETAILS,0.38412698412698415,"QR-DQN
0.23"
EXPERIMENTAL RESULTS AND DETAILS,0.3873015873015873,"DLTV
N.A"
EXPERIMENTAL RESULTS AND DETAILS,0.3904761904761905,"p-DLTV
0.18"
EXPERIMENTAL RESULTS AND DETAILS,0.39365079365079364,"PQR(ours)
0.16 (b)"
EXPERIMENTAL RESULTS AND DETAILS,0.3968253968253968,"Figure 4: (a) Evaluation curves on LunarLander-v2. All curves are the average of three random seeds
and the shaded area represents the standard deviation. We smoothed the curve over 5 consecutive
steps. (b) Hitting time to reach a given threshold."
EXPERIMENTAL RESULTS AND DETAILS,0.4,"Atari Games.
Lastly, we evaluate the performance in Atari games, including multiple environ-
ments, each of which contained intrinsic uncertainty in different ways."
EXPERIMENTAL RESULTS AND DETAILS,0.4031746031746032,"0
50
100
150
200
Training Frames (Million) 200 400 600 800 1000"
EXPERIMENTAL RESULTS AND DETAILS,0.40634920634920635,Average Score
EXPERIMENTAL RESULTS AND DETAILS,0.4095238095238095,Gravitar-v4
EXPERIMENTAL RESULTS AND DETAILS,0.4126984126984127,"QRDQN
DLTV
p-DLTV
PQR"
EXPERIMENTAL RESULTS AND DETAILS,0.4158730158730159,"0
50
100
150
200
Training Frames (Million) 0 2500 5000 7500 10000 12500 15000"
EXPERIMENTAL RESULTS AND DETAILS,0.41904761904761906,Average Score
EXPERIMENTAL RESULTS AND DETAILS,0.4222222222222222,Kangaroo-v4
EXPERIMENTAL RESULTS AND DETAILS,0.4253968253968254,"0
10
20
30
40
Training Frames (Million) 0 5 10 15 20"
EXPERIMENTAL RESULTS AND DETAILS,0.42857142857142855,Average Score
EXPERIMENTAL RESULTS AND DETAILS,0.43174603174603177,Pong-v4
EXPERIMENTAL RESULTS AND DETAILS,0.43492063492063493,"0
50
100
150
200
Training Frames (Million) 0 10000 20000 30000 40000"
EXPERIMENTAL RESULTS AND DETAILS,0.4380952380952381,Average Score
EXPERIMENTAL RESULTS AND DETAILS,0.44126984126984126,Seaquest-v4
EXPERIMENTAL RESULTS AND DETAILS,0.4444444444444444,"Figure 5: Evaluation curves on Atari games. We smoothed all curves over 10 consecutive steps with
three random seeds. In case of Pong-v4, we resize the x-axis, since it can easily obtain the optimal
policy with few interactions due to its environmental simplicity."
EXPERIMENTAL RESULTS AND DETAILS,0.44761904761904764,"We plot the average performance of each algorithm in the evaluation step on 200M frames with 3
random seeds. In Figure 5, PQR achieves the shortest time to hit the asymptotic highest performance
in various Atari games. Moreover, our proposed method is stable with relatively low variance in all
four environments. As the bound of perturbation gap converges to 0, the plausible action is chosen
from the shrinking ambiguity set, and thus the agent gradually performs only the optimal policy.
Further experimental details are in Appendix D"
EXPERIMENTAL RESULTS AND DETAILS,0.4507936507936508,"In all experiments, just adding randomness to the coefficient ct shows the significant improvement
supporting that the randomized risk criterion was superior to OFU in distributional RL. In the ma-
jority of environments where intrinsic uncertainties exist, OFU has difficulty in making a decision
that matches risk-neutral purpose, because two uncertainties are intertwined during learning. We
observe that PQR outperforms the baseline by showing faster convergence without degrading the
performance. All experimental results support that the randomizing scheme is more effective than
OFU in distributional RL."
CONCLUSIONS,0.45396825396825397,"5
CONCLUSIONS"
CONCLUSIONS,0.45714285714285713,"In this paper, we proposed a general framework of risk-based exploration which captures the char-
acteristics of a return distribution. Without resorting to a pre-defined risk criterion, we revealed and
resolved the stuckness where one-sided tendency on risk can lead to biased action selection. To
our best knowledge, this paper is the first attempt in DRL to integrate risk-sensitivity and explo-
ration by using time-varying Bellman objective with theoretical analysis. We prove that PDBOO is
theoretically guaranteed for convergence, and has a unique fixed point in a weaker condition than
contraction. By obtaining the same fixed point as the standard Bellman optimality operator, we can
obtain a risk-neutral optimal policy even if the agent explored with distortion risk measure. Our
method shows better empirical results compared to recent exploration methods for distributional RL
with various environments."
CONCLUSIONS,0.4603174603174603,Under review as a conference paper at ICLR 2022
REFERENCES,0.4634920634920635,REFERENCES
REFERENCES,0.4666666666666667,"Marc G Bellemare, Will Dabney, and R¬¥emi Munos. A distributional perspective on reinforcement
learning. In International Conference on Machine Learning, pp. 449‚Äì458. PMLR, 2017."
REFERENCES,0.46984126984126984,"Pablo Samuel Castro, Subhodeep Moitra, Carles Gelada, Saurabh Kumar, and Marc G. Bellemare.
Dopamine: A Research Framework for Deep Reinforcement Learning. 2018. URL http://
arxiv.org/abs/1812.06110."
REFERENCES,0.473015873015873,"Richard Y Chen, Szymon Sidor, Pieter Abbeel, and John Schulman.
Ucb exploration via q-
ensembles. arXiv preprint arXiv:1706.01502, 2017."
REFERENCES,0.47619047619047616,"Yunho Choi, Kyungjae Lee, and Songhwai Oh. Distributional deep reinforcement learning with a
mixture of gaussians. In 2019 International Conference on Robotics and Automation (ICRA), pp.
9791‚Äì9797. IEEE, 2019."
REFERENCES,0.4793650793650794,"Yinlam Chow, Aviv Tamar, Shie Mannor, and Marco Pavone. Risk-sensitive and robust decision-
making: a cvar optimization approach. arXiv preprint arXiv:1506.02188, 2015."
REFERENCES,0.48253968253968255,"Yinlam Chow, Mohammad Ghavamzadeh, Lucas Janson, and Marco Pavone. Risk-constrained re-
inforcement learning with percentile risk criteria. The Journal of Machine Learning Research, 18
(1):6070‚Äì6120, 2017."
REFERENCES,0.4857142857142857,"Kamil Ciosek, Quan Vuong, Robert Loftin, and Katja Hofmann. Better exploration with optimistic
actor-critic. arXiv preprint arXiv:1910.12807, 2019."
REFERENCES,0.4888888888888889,"William R Clements, Bastien Van Delft, BenoÀÜƒ±t-Marie Robaglia, Reda Bahi Slaoui, and S¬¥ebastien
Toth.
Estimating risk and uncertainty in deep reinforcement learning.
arXiv preprint
arXiv:1905.09638, 2019."
REFERENCES,0.49206349206349204,"Will Dabney, Georg Ostrovski, David Silver, and R¬¥emi Munos. Implicit quantile networks for distri-
butional reinforcement learning. In International conference on machine learning, pp. 1096‚Äì1105.
PMLR, 2018a."
REFERENCES,0.49523809523809526,"Will Dabney, Mark Rowland, Marc Bellemare, and R¬¥emi Munos. Distributional reinforcement learn-
ing with quantile regression. In Proceedings of the AAAI Conference on Artificial Intelligence,
2018b."
REFERENCES,0.4984126984126984,"Jan Dhaene, Alexander Kukush, Dani¬®el Linders, and Qihe Tang. Remarks on quantiles and distortion
risk measures. European Actuarial Journal, 2(2):319‚Äì328, 2012."
REFERENCES,0.5015873015873016,"Peyman Mohajerin Esfahani and Daniel Kuhn.
Data-driven distributionally robust optimization
using the wasserstein metric: Performance guarantees and tractable reformulations. Mathematical
Programming, 171(1):115‚Äì166, 2018."
REFERENCES,0.5047619047619047,"Matteo Hessel, Joseph Modayil, Hado Van Hasselt, Tom Schaul, Georg Ostrovski, Will Dabney, Dan
Horgan, Bilal Piot, Mohammad Azar, and David Silver. Rainbow: Combining improvements in
deep reinforcement learning. In Thirty-second AAAI conference on artificial intelligence, 2018."
REFERENCES,0.5079365079365079,"Ramtin Keramati, Christoph Dann, Alex Tamkin, and Emma Brunskill.
Being optimistic to be
conservative: Quickly learning a cvar policy. In Proceedings of the AAAI Conference on Artificial
Intelligence, volume 34, pp. 4436‚Äì4443, 2020."
REFERENCES,0.5111111111111111,"Marlos C Machado, Marc G Bellemare, Erik Talvitie, Joel Veness, Matthew Hausknecht, and
Michael Bowling. Revisiting the arcade learning environment: Evaluation protocols and open
problems for general agents. Journal of Artificial Intelligence Research, 61:523‚Äì562, 2018."
REFERENCES,0.5142857142857142,"Borislav Mavrin, Hengshuai Yao, Linglong Kong, Kaiwen Wu, and Yaoliang Yu. Distributional
reinforcement learning for efficient exploration. In International conference on machine learning,
pp. 4424‚Äì4434. PMLR, 2019."
REFERENCES,0.5174603174603175,"Thomas M Moerland, Joost Broekens, and Catholijn M Jonker. The potential of the return distribu-
tion for exploration in rl. arXiv preprint arXiv:1806.04242, 2018."
REFERENCES,0.5206349206349207,Under review as a conference paper at ICLR 2022
REFERENCES,0.5238095238095238,"Ian Osband, Charles Blundell, Alexander Pritzel, and Benjamin Van Roy. Deep exploration via
bootstrapped dqn. Advances in neural information processing systems, 29:4026‚Äì4034, 2016."
REFERENCES,0.526984126984127,"Ian Osband, Benjamin Van Roy, Daniel J Russo, Zheng Wen, et al. Deep exploration via randomized
value functions. J. Mach. Learn. Res., 20(124):1‚Äì62, 2019."
REFERENCES,0.5301587301587302,"John Quan and Georg Ostrovski. DQN Zoo: Reference implementations of DQN-based agents,
2020. URL http://github.com/deepmind/dqn_zoo."
REFERENCES,0.5333333333333333,"Antonin Raffin, Ashley Hill, Maximilian Ernestus, Adam Gleave, Anssi Kanervisto, and Noah Dor-
mann. Stable baselines3. https://github.com/DLR-RM/stable-baselines3, 2019."
REFERENCES,0.5365079365079365,"Marc Rigter, Bruno Lacerda, and Nick Hawes. Risk-averse bayes-adaptive reinforcement learning."
REFERENCES,0.5396825396825397,"arXiv preprint arXiv:2102.05762, 2021."
REFERENCES,0.5428571428571428,"R Tyrrell Rockafellar, Stanislav Uryasev, et al. Optimization of conditional value-at-risk. Journal of"
REFERENCES,0.546031746031746,"risk, 2:21‚Äì42, 2000."
REFERENCES,0.5492063492063493,"Alexander Shapiro, Darinka Dentcheva, and Andrzej Ruszczynski.
Lectures on stochastic
programming: modeling and theory. SIAM, 2021."
REFERENCES,0.5523809523809524,"Elena Smirnova, Elvis Dohmatob, and J¬¥er¬¥emie Mary. Distributionally robust reinforcement learning."
REFERENCES,0.5555555555555556,"arXiv preprint arXiv:1902.08708, 2019."
REFERENCES,0.5587301587301587,"Silvestr Stanko and Karel Macek. Risk-averse distributional reinforcement learning: A cvar opti-
mization approach. In IJCCI, pp. 412‚Äì423, 2019."
REFERENCES,0.5619047619047619,Yunhao Tang and Shipra Agrawal. Exploration by distributional reinforcement learning. arXiv
REFERENCES,0.5650793650793651,"preprint arXiv:1805.01907, 2018."
REFERENCES,0.5682539682539682,"Derek Yang, Li Zhao, Zichuan Lin, Tao Qin, Jiang Bian, and Tie-Yan Liu. Fully parameterized quan-
tile function for distributional reinforcement learning. Advances in neural information processing
systems, 32:6193‚Äì6202, 2019."
REFERENCES,0.5714285714285714,Insoon Yang. Wasserstein distributionally robust stochastic control: A data-driven approach. IEEE
REFERENCES,0.5746031746031746,"Transactions on Automatic Control, 2020."
REFERENCES,0.5777777777777777,"Tianpei Yang, Hongyao Tang, Chenjia Bai, Jinyi Liu, Jianye Hao, Zhaopeng Meng, and Peng
Liu.
Exploration in deep reinforcement learning: A comprehensive survey.
arXiv preprint
arXiv:2109.06668, 2021."
REFERENCES,0.580952380952381,"Shangtong Zhang, Bo Liu, and Shimon Whiteson. Mean-variance policy iteration for risk-averse
reinforcement learning. arXiv preprint arXiv:2004.10888, 2020."
REFERENCES,0.5841269841269842,Under review as a conference paper at ICLR 2022
REFERENCES,0.5873015873015873,"A
PROOF"
REFERENCES,0.5904761904761905,"A.1
TECHNICAL LEMMA"
REFERENCES,0.5936507936507937,"Before proving our theoretical results, we present two inequalities for supremum to clear the de-
scription."
SUP,0.5968253968253968,"1. sup
x‚ààX
|f(x) + g(x)| ‚â§sup
x‚ààX
|f(x)| + sup
x‚ààX
|g(x)| 2."
SUP,0.6,"sup
x‚ààX
f(x) ‚àísup
x‚Ä≤‚ààX
g(x‚Ä≤)
 ‚â§
sup
x,x‚Ä≤‚ààX
|f(x) ‚àíg(x‚Ä≤)|"
SUP,0.6031746031746031,"Proof of 1. Since |f(x) + g(x)| ‚â§|f(x)| + |g(x)| holds for all x ‚ààX,"
SUP,0.6063492063492063,"sup
x‚ààX
|f(x) + g(x)| ‚â§sup
x‚ààX
(|f(x)| + |g(x)|) ‚â§sup
x‚ààX
|f(x)| + sup
x‚ààX
|g(x)| ‚ñ†"
SUP,0.6095238095238096,"Proof of 2. Since
‚à•a‚à•‚àí‚à•b‚à•
 ‚â§‚à•a ‚àíb‚à•for any norm ‚à•¬∑ ‚à•and for a large enough M,"
SUP,0.6126984126984127,"sup
x,x‚Ä≤‚ààX
|f(x) ‚àíg(x‚Ä≤)| ‚â•sup
x‚ààX
|f(x) ‚àíg(x)|= sup
x‚ààX
|(f(x) + M) ‚àí(g(x) + M)|"
SUP,0.6158730158730159,"‚â•
 sup
x‚ààX
(f(x) + M) ‚àísup
x‚ààX
(g(x) + M)"
SUP,0.6190476190476191,"=
 sup
x‚ààX
f(x) ‚àísup
x‚Ä≤‚ààX
g(x‚Ä≤) ‚ñ†"
SUP,0.6222222222222222,"A.2
PROOF OF THEOREM 3"
SUP,0.6253968253968254,"Theorem 3. If Œæt converges to 1 uniformly on ‚Ñ¶, then EœÑ Œæt also converges to EœÑ uniformly on Z
for all s ‚ààS and a ‚ààA."
SUP,0.6285714285714286,"Proof. Recall that Z =
n
Z : S √ó A ‚ÜíP(R)
 E[|Z(s, a)|] ‚â§Vmax, ‚àÄ(s, a)
o
. Then for any Z ‚ààZ
and Œæ ‚ààŒû,"
SUP,0.6317460317460317,E[|œÑ ŒæZ|] ‚â§Rmax + Œ≥ Rmax
SUP,0.6349206349206349,1 ‚àíŒ≥ = Rmax
SUP,0.638095238095238,1 ‚àíŒ≥ = Vmax.
SUP,0.6412698412698413,"which implies PDBOO is closed in Z, i.e. œÑ ŒæZ ‚ààZ for all Œæ ‚ààŒû. Hence, for any sequence Œæt,
Z(n) = œÑ Œæn:1Z ‚ààZ for any n ‚â•0."
SUP,0.6444444444444445,"Since Œæt converges to 1 uniformly on ‚Ñ¶, there exists T such that for any t > T,"
SUP,0.6476190476190476,"sup
w‚àà‚Ñ¶
|Œæt(w) ‚àí1| ‚â§œµ."
SUP,0.6507936507936508,"For any Z ‚ààZ, s ‚ààS, a ‚ààA, and t > T, by using H¬®older‚Äôs inequality,"
SUP,0.653968253968254,"sup
Z‚ààZ
sup
s,a |EŒæt[Z(s, a)] ‚àíE[Z(s, a)]| = sup
Z‚ààZ
sup
s,a  Z"
SUP,0.6571428571428571,"w‚àà‚Ñ¶
(1 ‚àíŒæt(w))Z(s, a, w)P(w)dw"
SUP,0.6603174603174603,"‚â§sup
w‚àà‚Ñ¶
|Œæt(w) ‚àí1| sup
Z‚ààZ
sup
s,a  Z"
SUP,0.6634920634920635,"w‚àà‚Ñ¶
|Z(s, a, w)|P(w)dw"
SUP,0.6666666666666666,‚â§œµVmax
SUP,0.6698412698412698,"which implies that EŒæt converges to E uniformly on Z for all s, a."
SUP,0.6730158730158731,Under review as a conference paper at ICLR 2022
SUP,0.6761904761904762,"By using A.1, we can get the desired result."
SUP,0.6793650793650794,"sup
Z‚ààZ
sup
s,a |E[œÑ ŒætZ(s, a)] ‚àíE[œÑ Z(s, a)]|"
SUP,0.6825396825396826,"‚â§sup
Z‚ààZ
sup
s,a |E[œÑ ŒætZ(s, a)] ‚àíEŒæt[œÑ ŒætZ(s, a)]| + sup
Z‚ààZ
sup
s,a |EŒæt[œÑ ŒætZ(s, a)] ‚àíE[œÑ Z(s, a)]|"
SUP,0.6857142857142857,"‚â§œµVmax + Œ≥ sup
Z‚ààZ
sup
s,a Es‚Ä≤
sup
a‚Ä≤ EŒæt[Z(s‚Ä≤, a‚Ä≤)] ‚àísup
a‚Ä≤‚Ä≤ E[Z(s‚Ä≤, a‚Ä≤‚Ä≤)] "
SUP,0.6888888888888889,"‚â§œµVmax + Œ≥ sup
Z‚ààZ
sup
s‚Ä≤,a‚Ä≤ |EŒæt[Z(s‚Ä≤, a‚Ä≤)] ‚àíE[Z(s‚Ä≤, a‚Ä≤)]|"
SUP,0.692063492063492,"‚â§œµVmax + Œ≥œµVmax
= (1 + Œ≥)œµVmax. ‚ñ†"
SUP,0.6952380952380952,"A.3
PROOF OF THEOREM 4"
SUP,0.6984126984126984,"Theorem 4. For a sequence of bound ‚àÜn, let ¬ØU‚àÜn(Z(n‚àí1)) := T"
SUP,0.7015873015873015,"s,a U‚àÜn
 
Z(n‚àí1)(s, a)

. If we
sample Œæn from ¬ØU‚àÜn(Z(n‚àí1)) for every iteration and P‚àû
n=1 ‚àÜn < ‚àûholds, then, the expectation
of iterated operator œÑ Œæn:1 has a fixed point E[Z‚àó]. Moreover, the following bound holds,"
SUP,0.7047619047619048,"sup
s,a"
SUP,0.707936507936508,"E[Z(n)(s, a)] ‚àíE[Z‚àó(s, a)]
 ‚â§ ‚àû
X k=n "
SUP,0.7111111111111111,"2Œ≥k‚àí1Vmax + 2 k
X"
SUP,0.7142857142857143,"i=1
Œ≥i(‚àÜk+2‚àíi + ‚àÜk+1‚àíi) ! ."
SUP,0.7174603174603175,"Proof. We denote a‚àó
i (Œæn) = arg max
a‚Ä≤
EŒæn[Z(n‚àí1)
i
(s‚Ä≤, a‚Ä≤)] as the greedy action of Z(n‚àí1)
i
under"
SUP,0.7206349206349206,"perturbation Œæn. Also, we denote sup
s,a | ¬∑ | which is the supremum norm over s and a as ‚à•¬∑ ‚à•sa."
SUP,0.7238095238095238,"Before we start from the term
E[Z(k+1)] ‚àíE[Z(k)]

sa, for a given (s, a),
E[Z(k+1)(s, a)] ‚àíE[Z(k)(s, a)]"
SUP,0.726984126984127,"‚â§Œ≥ sup
s‚Ä≤"
SUP,0.7301587301587301,"E[Z(k)(s‚Ä≤, a‚àó(Œæk+1))] ‚àíE[Z(k‚àí1)(s‚Ä≤, a‚àó(Œæk))]"
SUP,0.7333333333333333,"‚â§Œ≥ sup
s‚Ä≤"
SUP,0.7365079365079366," E[Z(k)(s‚Ä≤, a‚àó(Œæk+1)] ‚àímax
a‚Ä≤ E[Z(k)(s‚Ä≤, a‚Ä≤)]
 +
 max
a‚Ä≤ E[Z(k)(s‚Ä≤, a‚Ä≤)]"
SUP,0.7396825396825397,"‚àímax
a‚Ä≤ E[Z(k‚àí1)(s‚Ä≤, a‚Ä≤)]
 +
max
a‚Ä≤ E[Z(k‚àí1)(s‚Ä≤, a‚Ä≤)] ‚àíE[Z(k‚àí1)(s‚Ä≤, a‚àó(Œæk))]

"
SUP,0.7428571428571429,"‚â§Œ≥sup
s‚Ä≤,a‚Ä≤"
SUP,0.746031746031746,"E[Z(k)(s‚Ä≤, a‚Ä≤)] ‚àíE[Z(k‚àí1)(s‚Ä≤, a‚Ä≤)]
 + Œ≥ k
X"
SUP,0.7492063492063492,"i=k‚àí1
sup
s‚Ä≤"
SUP,0.7523809523809524,"E[Z(i)(s‚Ä≤, a‚àó(Œæi+1))]"
SUP,0.7555555555555555,"‚àímax
a‚Ä≤ E[Z(i)(s‚Ä≤, a‚Ä≤)]

"
SUP,0.7587301587301587,"‚â§Œ≥
E[Z(k)] ‚àíE[Z(k‚àí1)]

sa + Œ≥ k
X"
SUP,0.7619047619047619,"i=k‚àí1
sup
s‚Ä≤"
SUP,0.765079365079365,"E[Z(i)(s‚Ä≤, a‚àó(Œæi+1))]"
SUP,0.7682539682539683,"‚àíEŒæi+1[Z(i)(s‚Ä≤, a‚àó(Œæi+1))]
 +
max
a‚Ä≤ EŒæi+1[Z(i)(s‚Ä≤, a‚Ä≤)] ‚àímax
a‚Ä≤‚Ä≤ E[Z(i)(s‚Ä≤, a‚Ä≤‚Ä≤))]

"
SUP,0.7714285714285715,"‚â§Œ≥
E[Z(k)] ‚àíE[Z(k‚àí1)]

sa + 2Œ≥ k
X"
SUP,0.7746031746031746,"i=k‚àí1
sup
s‚Ä≤,a‚Ä≤"
SUP,0.7777777777777778,"E[Z(i)(s‚Ä≤, a‚Ä≤)] ‚àíEŒæi+1[Z(i)(s‚Ä≤, a‚Ä≤)]

"
SUP,0.780952380952381,"‚â§Œ≥
E[Z(k)] ‚àíE[Z(k‚àí1)]

sa + 2Œ≥ k
X"
SUP,0.7841269841269841,"i=k‚àí1
‚àÜi+1"
SUP,0.7873015873015873,where we use A.1.1 in third and fifth line and A.1.2 in sixth line.
SUP,0.7904761904761904,Under review as a conference paper at ICLR 2022
SUP,0.7936507936507936,"Taking a supremum over s and a, then for all k > 0,
E[Z(k+1)] ‚àíE[Z(k)]

sa ‚â§Œ≥
E[Z(k)] ‚àíE[Z(k‚àí1)]

sa + 2 k
X"
SUP,0.7968253968253968,"i=k‚àí1
Œ≥‚àÜi+1"
SUP,0.8,"‚â§Œ≥2 E[Z(k‚àí1)] ‚àíE[Z(k‚àí2)]

sa + 2 k‚àí1
X"
SUP,0.8031746031746032,"i=k‚àí2
Œ≥2‚àÜi+1 + 2 k
X"
SUP,0.8063492063492064,"i=k‚àí1
Œ≥‚àÜi+1 ..."
SUP,0.8095238095238095,"‚â§Œ≥k E[Z(1)] ‚àíE[Z]

sa + 2 k
X"
SUP,0.8126984126984127,"i=1
Œ≥i(‚àÜk+2‚àíi + ‚àÜk+1‚àíi)"
SUP,0.8158730158730159,"‚â§2Œ≥kVmax + 2 k
X"
SUP,0.819047619047619,"i=1
Œ≥i(‚àÜk+2‚àíi + ‚àÜk+1‚àíi)"
SUP,0.8222222222222222,"Since P‚àû
i=1 Œ≥i =
Œ≥
1‚àíŒ≥ < ‚àûand P‚àû
i=1 ‚àÜi < ‚àûby assumption, we have k
X"
SUP,0.8253968253968254,"i=1
Œ≥i‚àÜk+1‚àíi ‚Üí0"
SUP,0.8285714285714286,"which is resulted from the convergence of Cauchy product of two sequences {Œ≥i} and {‚àÜi}. Hence,
{E[Z(k)]} is a Cauchy sequence and therefore converges for every Z ‚ààZ."
SUP,0.8317460317460318,"Let E[Z‚àó] be the limit point of the sequence {E[Z(n)]}. Then,
E[Z‚àó] ‚àíE[Z(n)]

sa = lim
l‚Üí‚àû"
SUP,0.834920634920635,"E[Z(n+l)] ‚àíE[Z(n)]

sa ‚â§ ‚àû
X k=n"
SUP,0.8380952380952381,"E[Z(k+1)] ‚àíE[Z(k)]

sa = ‚àû
X k=n"
SUP,0.8412698412698413,"
2Œ≥kVmax + 2 k
X"
SUP,0.8444444444444444,"i=1
Œ≥i(‚àÜk+2‚àíi + ‚àÜk+1‚àíi)

. ‚ñ†"
SUP,0.8476190476190476,"A.4
PROOF OF THEOREM 5"
SUP,0.8507936507936508,"Theorem 5. If {‚àÜn} follows the assumption in Theorem 4, then E[Z‚àó] is the unique solution of
Bellman optimality equation."
SUP,0.8539682539682539,"Proof. The proof follows by linearity of expectation. Denote the Q-value based operator as ¬ØœÑ . Note
that ‚àÜn converges to 0 with regularity of Z implies that Œæn converges to 1 uniformly on ‚Ñ¶. By
Theorem 3, for a given œµ > 0, there exists a constant K = max(K1, K2) such that for every
k ‚â•K1,"
SUP,0.8571428571428571,"sup
Z‚ààZ
‚à•¬ØœÑ ŒækE[Z] ‚àí¬ØœÑ E[Z]‚à•sa ‚â§œµ 2."
SUP,0.8603174603174604,"Since ¬ØœÑ is continuous, for every k ‚â•K2,"
SUP,0.8634920634920635,‚à•¬ØœÑ E[Z(k)] ‚àí¬ØœÑ E[Z‚àó]‚à•sa ‚â§œµ 2.
SUP,0.8666666666666667,"Thus, it holds that
‚à•¬ØœÑ Œæk+1E[Z(k)] ‚àí¬ØœÑ E[Z‚àó]‚à•sa ‚â§‚à•¬ØœÑ Œæk+1E[Z(k)] ‚àí¬ØœÑ E[Z(k)]‚à•sa + ‚à•¬ØœÑ E[Z(k)] ‚àí¬ØœÑ E[Z‚àó]‚à•sa"
SUP,0.8698412698412699,"‚â§sup
Z‚ààZ
‚à•¬ØœÑ Œæk+1E[Z] ‚àí¬ØœÑ E[Z]‚à•sa + ‚à•¬ØœÑ E[Z(k)] ‚àí¬ØœÑ E[Z‚àó]‚à•sa ‚â§œµ 2 + œµ"
SUP,0.873015873015873,"2
= œµ."
SUP,0.8761904761904762,Under review as a conference paper at ICLR 2022
SUP,0.8793650793650793,"Therefore, we have
E[Z‚àó] = lim
k‚Üí‚àûE[Z(k)] = lim
k‚Üí‚àûE[Z(k+1)] = lim
k‚Üí‚àûE[œÑ Œæk+1Z(k)] = lim
k‚Üí‚àû
¬ØœÑ Œæk+1E[Z(k)] = ¬ØœÑ E[Z‚àó]"
SUP,0.8825396825396825,"Since the standard Bellman optimality operator has a unique solution, we derived the desired result.
‚ñ†"
SUP,0.8857142857142857,"B
ALGORITHM PIPELINE"
SUP,0.8888888888888888,Figure 6: Pipeline of PDBOO.
SUP,0.8920634920634921,"Figure 6 shows the pipeline of our algorithm. With the schedule of perturbation bound {‚àÜn}, the
ambiguity set U‚àÜn(Zn‚àí1) can be defined by previous Zn‚àí1. For each step, (distributional) perturba-
tion Œæn is sampled from U‚àÜn(Zn‚àí1) by the symmetric Dirichlet distribution and then PDBOO œÑ Œæn
can be performed."
SUP,0.8952380952380953,"C
IMPLEMENTATION DETAILS"
SUP,0.8984126984126984,"Except for each own hyperparameter, our algorithms and DLTV shares the same hyperparameter and
network architecture with QR-DQN. Also, we set up p-DLTV by only multiplying a gaussian noise
N(0, 1) to the coefficient of DLTV. We do not combine any additional improvements such as double
Q-learning, dueling network, prioritized replay, and n-step update. Experiments on LunarLander-v2
and Atari games were performed with 3 random seeds."
SUP,0.9015873015873016,"C.1
N-CHAIN"
SUP,0.9047619047619048,"For hyperparameter settings, we initialize all agents with a random policy for 500 steps and then
train by 20K steps with 10 random seeds. œµ‚àígreedy policy which is only executed on QR-DQN
annealed linearly from 1 to 0.01 over the first 2500 steps. The batch size was 64 and the discount
factor was Œ≥ = 0.9. We update the network every 1 step and the number of steps to update targets
was 25 steps."
SUP,0.9079365079365079,"C.2
LUNARLANDER-V2"
SUP,0.9111111111111111,"The hyperparameters of QR-DQN were followed by the settings reported in Raffin et al. (2019)
for a fair comparison. Our experiments used 2 layers of MLP with 256 hidden units. We used the
experience replay with batch size 128 and the buffer size 1 √ó 105. The number of quantiles N
was 170 and Œ≥ = 0.995. As a stochastic gradient optimizer, we adopt Adam with a learning rate
1.5 √ó 10‚àí3 with a linear decaying schedule. œµ-greedy schedule was only performed on QR-DQN.
For the rest, we used ct = 0.05, and ‚àÜ= 5 √ó 104. We evaluated each algorithm for every 10K
training steps by averaging 5 episodes."
SUP,0.9142857142857143,"C.3
ATARI GAMES"
SUP,0.9174603174603174,"For a fair comparison, our hyperparameter setting is aligned with Dabney et al. (2018b). The number
of quantile fraction N is 200. We set Œ≥ = 0.99 and ct = 50 which refers to Mavrin et al. (2019) and
‚àÜ= 1 √ó 106. We use œµ-greedy with threshold œµ = 0.01 at training stage and œµ = 0.001 at test stage."
SUP,0.9206349206349206,Under review as a conference paper at ICLR 2022
SUP,0.9238095238095239,"C.4
PSEUODOCODE OF P-DLTV"
SUP,0.926984126984127,"Algorithm 2: Perturbed DLTV (p-DLTV)
Input: (s, a, r, s‚Ä≤), Œ≥ ‚àà[0, 1)
Q(s‚Ä≤, a‚Ä≤) = 1 N
P"
SUP,0.9301587301587302,"j Œ∏j(s‚Ä≤, a‚Ä≤)
ct ‚àºc N(0, ln t"
SUP,0.9333333333333333,"t )
# Randomize the coefficient"
SUP,0.9365079365079365,"a‚àó‚Üêarg maxa‚Ä≤(Q(s‚Ä≤, a‚Ä≤) + ct
q"
SUP,0.9396825396825397,"œÉ2
+(s‚Ä≤, a‚Ä≤))
œÑ Œ∏j ‚Üêr + Œ≥Œ∏j(s‚Ä≤, a‚àó),
‚àÄj
Output: PN
i=1 Ej[œÅŒ∫
ÀÜœÑi(œÑ Œ∏j ‚àíŒ∏i(s, a))]"
SUP,0.9428571428571428,"D
FURTHER EXPERIMENTAL RESULTS OF ATARI GAMES"
SUP,0.946031746031746,"We test our algorithm under 30 no-op settings to align with previous works. We compare our baseline
results with results from the DQN Zoo framework (Quan & Ostrovski, 2020), which provides the
full benchmark results on 57 Atari games at 50M and 200M frames. We report the average of the best
scores over 5 seeds for each baseline algorithms up to 50M frames. However, recent studies tried to
follow the setting proposed by Machado et al. (2018) for reproducibility, where they recommended
using sticky actions. Hence, we provide all human normalized scores results across 55 Atari games
including previous report of Yang et al. (2019), Dopamine and DQN Zoo framework to help the
follow-up researchers as a reference. We exclude Defender and Surround which is not reported on
Yang et al. (2019) because of relialbility issues in the Dopamine framework."
SUP,0.9492063492063492,"Mean
Median"
SUP,0.9523809523809523,"DQN-dopamine(50M)
401%
51%
DQN-zoo(50M)
507%
69%
DQN-zoo(200M)
804%
84%
DQN(200M)
221%
79%"
SUP,0.9555555555555556,"QR-DQN-dopamine(50M)
562%
93%
QR-DQN-zoo(50M)
707%
119%
QR-DQN-zoo(200M)
1714%
174%
QR-DQN(200M)
902%
193%"
SUP,0.9587301587301588,"IQN-dopamine(50M)
940%
124%
IQN-zoo(50M)
1057%
143%
IQN-zoo(200M)
2070%
229%
IQN(200M)
1112%
218%"
SUP,0.9619047619047619,"RAINBOW-dopamine(50M)
965%
123%
RAINBOW-zoo(50M)
1366%
154%
RAINBOW-zoo(200M)
2115%
246%
RAINBOW(200M)
1213%
230%
PQR(50M)
1121%
124%"
SUP,0.9650793650793651,"Table 1: Mean and median of best scores across 55 Atari games on 50M frames, measured as per-
centages of human baseline (Castro et al., 2018; Yang et al., 2019; Quan & Ostrovski, 2020)"
SUP,0.9682539682539683,"Table 1 provides the mean and median human normalized scores across 55 Atari games. Due to
the high computational cost, our algorithm was evaluated on 50M frames to provide results over as
many environments as possible. It is observed that PQR shows better performance in terms of both
mean and median metrics than QR-DQN. Since our method is based on QR-DQN, we would expect
that PDBOO can be combined with IQN (Dabney et al., 2018a) or techniques in Rainbow (Hessel
et al., 2018) as an efficient exploration method, and the performance can be further improved. Since
ourmethod is based on QR-DQN, PDBOO can be combined with IQN (Dabney et al., 2018a) or
the techniques in Rainbow (Hessel et al., 2018), such as double q-learning, n-step updates, dueling
networks and prioritized experience replay. We would expect that PQR for efficient exploration
would benefit from the additional improvement of performance as IQN and Rainbow outperform
QR-DQN."
SUP,0.9714285714285714,Under review as a conference paper at ICLR 2022
SUP,0.9746031746031746,"GAMES
RANDOM
HUMAN
DQN(50M)
QR-DQN(50M)
IQN(50M)
RAINBOW(50M)
PQR(50M)
Alien
227.8
7127.7
1633.9
1891.7
1991.0
4507.8
2455.8
Amidar
5.8
1719.5
344.6
761.2
853.6
2649.4
938.4
Assault
222.4
742.0
3744.7
13951.4
18910.2
11921.0
10759.2
Asterix
210.0
8503.3
5994.6
21225.7
33625.8
35954.1
10490.5
Asteroids
719.1
47388.7
1590.9
2113.3
2305.9
1917.8
1662.0
Atlantis
12850.0
29028.1
383243.6
962130.0
907430.0
954790.0
897640.0
BankHeist
14.2
753.1
477.1
1267.9
1298.1
1089.8
1038.8
BattleZone
2360.0
37187.5
22167.1
31242.0
33382.4
36797.6
28470.5
BeamRider
363.9
16926.5
8276.5
14710.0
23600.8
17280.9
10224.9
Berzerk
123.7
2630.4
644.5
936.0
960.9
2191.4
137873.1
Bowling
23.1
160.7
49.2
58.5
63.3
64.9
86.9
Boxing
0.1
12.1
90.2
99.7
99.6
99.9
97.1
Breakout
1.7
30.5
350.0
478.6
556.8
349.4
380.3
Centipede
2090.9
12017.0
6912.0
9334.4
8124.0
6055.8
7291.2
ChopperCommand
811.0
7387.8
1081.7
1453.6
2054.5
6277.6
1300.0
CrazyClimber
10780.5
35829.4
109112.5
111783.3
134466.5
168808.9
84390.9
DemonAttack
152.1
1971.0
9695.5
116973.3
115749.8
98203.8
73794.0
DoubleDunk
-18.6
-16.4
-14.9
-7.0
-7.6
0.2
-7.5
Enduro
0.0
860.5
850.5
2238.6
2345.7
2350.7
2341.2
FishingDerby
-91.7
-38.7
15.2
33.4
27.0
38.5
31.7
Freeway
0.0
29.6
24.6
33.5
33.8
34.0
34.0
Frostbite
65.2
4334.7
614.8
4346.2
6187.6
9902.2
4148.2
Gopher
257.6
2412.5
4289.8
7425.6
34520.2
37955.5
47054.5
Gravitar
173.0
3351.4
271.2
617.6
535.9
2253.4
635.8
Hero
1027.0
30826.4
10821.5
11823.4
13628.9
38189.0
12579.2
IceHockey
-11.2
0.9
-4.1
-1.0
-2.6
2.5
-1.4
Jamesbond
29.0
302.8
524.3
1411.5
1336.8
15191.8
2121.8
Kangaroo
52.0
3035.0
8146.9
14885.9
14504.8
14670.3
14617.1
Krull
1598.0
2665.5
10626.8
11004.2
10028.9
9055.3
9746.1
KungFuMaster
258.5
22736.3
25251.6
37140.8
44248.7
32520.8
43258.6
MontezumaRevenge
0.0
4753.3
0.4
0.0
0.2
80.3
0.0
MsPacman
307.3
6951.6
2427.6
3385.0
3075.4
3894.8
2928.9
NameThisGame
2292.3
8049.0
7260.8
12595.6
12538.4
11609.4
10298.2
Phoenix
761.4
7242.6
12646.5
37830.1
37153.7
61410.6
20453.8
Pitfall
-229.4
6463.7
0.0
0.0
0.0
0.0
0.0
Pong
-20.7
14.6
19.2
21.0
21.0
21.0
21.0
PrivateEye
24.9
69571.3
542.7
100.0
100.0
160.0
372.4
Qbert
163.9
13455.0
6541.3
14885.8
15681.3
26067.9
15267.4
Riverraid
1338.5
17118.0
7467.2
10019.4
14311.3
17785.7
11175.3
RoadRunner
11.5
7845.0
32714.0
55506.2
55873.9
54265.5
50854.7
Robotank
2.2
11.9
35.7
56.6
55.5
67.6
60.3
Seaquest
68.4
42054.7
3239.3
8990.9
18943.3
3057.5
19652.5
Skiing
-17098.1
-4336.9
-13445.9
-9198.1
-9310.5
-14901.8
-9299.3
Solaris
1236.3
12326.7
3388.0
2523.6
3612.9
3714.6
2640.0
SpaceInvaders
148.0
1668.7
1314.2
1960.3
3058.2
2746.3
1749.4
StarGunner
664.0
10250.0
30631.9
63950.3
81730.5
111760.9
62920.6
Tennis
-23.8
-8.3
0.0
0.0
0.0
0.0
-1.0
TimePilot
3568.0
5229.2
3439.9
7835.8
6971.4
12731.9
6506.4
Tutankham
11.4
167.6
192.8
229.2
209.0
199.9
231.3
UpNDown
533.4
11693.2
11192.4
45653.5
65773.2
77524.5
36008.1
Venture
0.0
1187.5
154.2
17.5
54.1
1.1
993.3
VideoPinball
16256.9
17667.9
258626.0
182452.1
416941.4
589122.4
465578.3
WizardOfWor
563.5
4756.5
4914.8
19040.8
15892.2
13362.6
6132.8
YarsRevenge
3092.9
54576.9
18540.6
23385.8
23115.6
69092.9
27674.4
Zaxxon
32.5
9173.3
4890.3
9632.6
8686.6
23620.4
10806.6"
SUP,0.9777777777777777,"Table 2: Raw scores for a single seed across all 55 games, starting with 30 no-op actions. We report
the best scores for DQN, QR-DQN, IQN and Rainbow on 50M frames, averaged by 5 seeds. Refer-
ence values were provided by DQN Zoo framework (Quan & Ostrovski, 2020)"
SUP,0.9809523809523809,Under review as a conference paper at ICLR 2022
SUP,0.9841269841269841,"GAMES
RANDOM
HUMAN
DQN(50M)
QR-DQN(50M)
IQN(50M)
RAINBOW(50M)
PQR(50M)
Alien
227.8
7127.7
1688.1
2754.2
4016.3
2076.2
2455.8
Amidar
5.8
1719.5
888.2
841.6
1642.8
1669.6
938.4
Assault
222.4
742
1615.9
2233.1
4305.6
2535.9
10759.2
Asterix
210
8503.3
3326.1
3540.1
7038.4
5862.3
10490.5
Asteroids
719.1
47388.7
828.2
1333.4
1336.3
1345.1
1662.0
Atlantis
12850.0
29028.1
388466.7
879022.0
897558.0
870896.0
897640.0
BankHeist
14.2
753.1
720.2
964.1
1082.8
1104.9
1038.8
BattleZone
2360.0
37187.5
15110.3
25845.6
29959.7
32862.1
28470.5
BeamRider
343.9
16926.5
4771.3
7143.0
7113.7
6331.9
10224.9
Berzerk
123.7
2630.4
529.2
603.2
627.3
697.8
137873.1
Bowling
23.1
160.7
38.5
55.3
33.6
55.0
86.9
Boxing
0.1
12.1
80.0
96.6
97.8
96.3
97.1
Breakout
1.7
30.5
113.5
40.7
164.4
69.8
380.3
Centipede
2090.9
12017.0
3403.7
3562.5
3746.1
5087.6
7291.2
ChopperCommand
811
7387.8
1615.3
1600.3
6654.1
5982.0
1044.0
CrazyClimber
10780.5
35829.4
111493.8
108493.9
131645.8
135786.1
84390.9
DemonAttack
152.1
1971.0
4396.7
3182.6
7715.5
6346.4
73794.0
DoubleDunk
-18.6
-16.4
-16.7
7.4
20.2
17.4
-7.5
Enduro
0
860.5
799.5
2062.5
2268.1
2255.6
2341.2
FishingDerby
-91.7
-38.7
12.3
48.4
41.9
37.6
31.7
Freeway
0
29.6
25.8
33.5
33.5
33.2
34.0
Frostbite
65.2
4334.7
760.2
8022.8
7824.9
5697.2
4148.2
Gopher
257.6
2412.5
3495.8
3917.1
11192.6
7102.1
47054.5
Gravitar
173.0
3351.4
250.7
821.3
1083.5
926.2
635.8
Hero
1027
30826.4
12316.4
14980.0
18754.0
31254.8
12579.2
IceHockey
-11.2
0.9
-6.7
-4.5
0.0
2.3
-1.4
Jamesbond
29.0
302.8
500.0
802.3
1118.8
656.7
2121.8
Kangaroo
52.0
3035.0
6768.2
4727.3
11385.4
13133.1
14617.1
Krull
1598
2665.5
6181.1
8073.9
8661.7
6292.5
9746.1
KungFuMaster
258.5
22736.3
20418.8
20988.3
33099.9
26707.0
43258.6
MontezumaRevenge
0.0
4753.3
2.6
300.5
0.7
501.2
0.0
MsPacman
307.3
6951.6
2727.2
3313.9
4714.4
3406.4
2928.9
NameThisGame
2292.3
8049.0
5697.3
7307.9
9432.8
9389.5
10298.2
Phoenix
761.4
7245.6
5833.7
4641.1
5147.2
8272.9
20453.8
Pitfall
-229.4
6463.7
-16.8
-3.4
-0.4
0
0.0
Pong
-20.7
14.6
13.2
19.2
19.9
19.4
21.0
PrivateEye
24.9
69571.3
1884.6
680.7
1287.3
4298.8
372.4
Qbert
163.9
13455.0
8216.2
17228.0
15045.5
17121.4
15267.4
Riverraid
1338.5
17118.0
9077.8
13389.4
14868.6
15748.9
11175.3
RoadRunner
11.5
7845.0
39703.1
44619.2
50534.1
51442.4
50854.7
Robotank
2.2
11.9
25.8
53.6
65.9
63.6
60.3
Seaquest
68.4
42054.7
1585.9
4667.9
20081.3
3916.2
19652.5
Skiing
-17098.1
-4336.9
-17038.2
-14401.6
-13755.6
-17960.1
-9299.3
Solaris
1236.3
12326.7
2029.5
2361.7
2234.5
2922.2
2640.0
SpaceInvaders
148.0
1668.7
1361.1
940.2
3115.0
1908.0
1749.4
StarGunner
664.0
10250.0
1676.5
23593.3
60090.0
39456.3
62920.6
Tennis
-23.8
-9.3
-0.1
19.2
3.5
0.0
-1.0
TimePilot
3568.0
5229.2
3200.9
6622.8
9820.6
9324.4
6506.4
Tutankham
11.4
167.6
138.8
209.9
250.4
252.2
231.3
UpNDown
533.4
11693.2
10405.6
29890.1
44327.6
18790.7
36008.1
Venture
0
1187.5
50.8
1099.6
1134.5
1488.9
993.3
VideoPinball
16256.9
17667.9
216042.7
250650.0
486111.5
536364.4
465578.3
WizardOfWor
563.5
4756.5
2664.9
2841.8
6791.4
7562.7
6132.8
YarsRevenge
3092.9
54576.9
20375.7
66055.9
57960.3
31864.4
27674.4
Zaxxon
32.5
9173.3
1928.6
8177.2
12048.6
14117.5
10806.6"
SUP,0.9873015873015873,"Table 3: Raw scores for a single seed across all 55 games. We report the best scores for DQN, QR-
DQN, IQN, and Rainbow on 50M frames, averaged by 5 seeds. Reference values were provided by
Dopamine framework (Castro et al., 2018)."
SUP,0.9904761904761905,Under review as a conference paper at ICLR 2022
SUP,0.9936507936507937,"GAMES
RANDOM
HUMAN
DQN(200M)
QR-DQN(200M)
IQN(200M)
PQR(50M)
Alien
227.8
7127.7
1620.0
4871.0
7022.0
2455.8
Amidar
5.8
1719.5
978.0
1641.0
2946.0
938.4
Assault
222.4
742.0
4280.4
22012.0
29091.0
10759.2
Asterix
210.0
8503.3
4359.0
261025.0
342016.0
10490.5
Asteroids
719.1
47388.7
1364.5
4226.0
2898.0
1662.0
Atlantis
12850.0
29028.1
279987.0
971850.0
978200.0
897640.0
BankHeist
14.2
753.1
455.0
1249.0
1416.0
1038.8
BattleZone
2360.0
37187.5
29900.0
39268.0
42244.0
28470.5
BeamRider
363.9
16926.5
8627.5
34821.0
42776.0
10224.9
Berzerk
123.7
2630.4
585.6
3117.0
1053.0
137873.1
Bowling
23.1
160.7
50.4
77.2
86.5
86.9
Boxing
0.1
12.1
88.0
99.9
99.8
97.1
Breakout
1.7
30.5
385.5
742.0
734.0
380.3
Centipede
2090.9
12017.0
4657.7
12447.0
11561.0
7291.2
ChopperCommand
811.0
7387.8
6126.0
14667.0
16836.0
1044.0
CrazyClimber
10780.5
35829.4
110763.0
161196.0
179082.0
84390.9
DemonAttack
152.1
1971.0
12149.4
121551.0
128580.0
73794.0
DoubleDunk
-18.6
-16.4
-6.6
21.9
5.6
-7.5
Enduro
0.0
860.5
729.0
2355.0
2359.0
2341.2
FishingDerby
-91.7
-38.7
-4.9
39.0
33.8
31.7
Freeway
0.0
29.6
30.8
34.0
34.0
34.0
Frostbite
65.2
4334.7
797.4
4384.0
4324.0
4148.2
Gopher
257.6
2412.5
8777.4
113585.0
118365.0
47054.5
Gravitar
173.0
3351.4
473.0
995.0
911.0
635.8
Hero
1027.0
30826.4
20437.8
21395.0
28386.0
12579.2
IceHockey
-11.2
0.9
-1.9
-1.7
0.2
-1.4
Jamesbond
29.0
302.8
768.5
4703.0
35108.0
2121.8
Kangaroo
52.0
3035.0
7259.0
15356.0
15487.0
14617.1
Krull
1598.0
2665.5
8422.3
11447.0
10707.0
9746.1
KungFuMaster
258.5
22736.3
26059.0
76642.0
73512.0
43258.6
MontezumaRevenge
0.0
4753.3
0.0
0.0
0.0
0.0
MsPacman
307.3
6951.6
3085.6
5821.0
6349.0
2928.9
NameThisGame
2292.3
8049.0
8207.8
21890.0
22682.0
10298.2
Phoenix
761.4
7242.6
8485.2
16585.0
56599.0
20453.8
Pitfall
-229.4
6463.7
-286.1
0.0
0.0
0.0
Pong
-20.7
14.6
19.5
21.0
21.0
21.0
PrivateEye
24.9
69571.3
146.7
350.0
200.0
372.4
Qbert
163.9
13455.0
13117.3
572510.0
25750.0
15267.4
Riverraid
1338.5
17118.0
7377.6
17571.0
17765.0
11175.3
RoadRunner
11.5
7845.0
39544.0
64262.0
57900.0
50854.7
Robotank
2.2
11.9
63.9
59.4
62.5
60.3
Seaquest
68.4
42054.7
5860.6
8268.0
30140.0
19652.5
Skiing
-17098.1
-4336.9
-13062.3
-9324.0
-9289.0
-9299.3
Solaris
1236.3
12326.7
3482.8
6740.0
8007.0
2640.0
SpaceInvaders
148.0
1668.7
1692.3
20972.0
28888.0
1749.4
StarGunner
664.0
10250.0
54282.0
77495.0
74677.0
60920.6
Tennis
-23.8
-9.3
12.2
23.6
23.6
-1.0
TimePilot
3568.0
5229.2
4870.0
10345.0
12236.0
6506.4
Tutankham
11.4
167.6
68.1
297.0
293.0
231.3
UpNDown
533.4
11693.2
9989.9
71260.0
88148.0
36008.1
Venture
0.0
1187.5
163.0
43.9
1318.0
993.3
VideoPinball
16256.9
17667.9
196760.4
705662.0
698045.0
465578.3
WizardOfWor
563.5
4756.5
2704.0
25061.0
31190.0
6132.8
YarsRevenge
3092.9
54576.9
18098.9
26447.0
28379.0
2764.4
Zaxxon
32.5
9173.3
5363.0
13113.0
21772.0
10806.6"
SUP,0.9968253968253968,"Table 4: Raw scores for a single seed across all 55 games, starting with 30 no-op actions. Note that
PQR was evaluated on 50M frames. We report the published scores for DQN, QR-DQN, and IQN
on 200M frames. Reference values from Yang et al. (2019)."
