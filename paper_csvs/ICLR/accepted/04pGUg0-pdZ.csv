Section,Section Appearance Order,Paragraph
ABSTRACT,0.0,ABSTRACT
ABSTRACT,0.0016207455429497568,"In this paper, we establish the ﬁrst ﬁnite-time convergence result of the actor-critic
algorithm for fully decentralized multi-agent reinforcement learning (MARL)
problems with average reward. In this problem, a set of N agents work coop-
eratively to maximize the global average reward through interacting with their
neighbors over a communication network. We consider a practical MARL set-
ting, where the rewards and actions of each agent are only known to itself, and the
knowledge of joint actions of the agents is not assumed. Toward this end, we pro-
pose a mini-batch Markovian sampled fully decentralized actor-critic algorithm
and analyze its ﬁnite-time convergence and sample complexity. We show that the
sample complexity of this algorithm is O(N 2/ǫ2 log(N/ǫ)). Interestingly, this
sample complexity bound matches that of the state-of-the-art single-agent actor-
critic algorithms for reinforcement learning."
INTRODUCTION,0.0032414910858995136,"1
INTRODUCTION"
INTRODUCTION,0.004862236628849271,"1) Background and Motivations: In recent years, multi-agent reinforcement learning (MARL)
has found a wide range of applications in networked large-scale systems, such as power grid sys-
tems (Riedmiller et al., 2000), autonomous driving (Yu et al., 2019; Shalev-Shwartz et al., 2016)
and strategic games (Silver et al., 2018; Foerster et al., 2018), to name just a few. Although em-
pirical successes of MARL applications have been widely observed, the fundamental theoretical
understanding of how to develop fast-converging and low sample-complexity MARL algorithms,
two of the most important performance metrics for MARL, remains in its infancy so far (see, e.g.,
(Zhang et al., 2021a) for an excellent survey). In particular, two important aspects of cooperative
MARL algorithm designs deserve special attention:
• First, in the multi-agent collaborative setting, the information structure (i.e., the assumptions of
who have the knowledge of what) is far more complex than its single-agent counterpart and care
must be taken in MARL problem formulations. In the cooperative MARL literature so far, many
existing works assume full knowledge of joint states and joint actions, which often do not hold
true in practice. For example, in autonomous driving (Yu et al., 2019), each vehicle can only
observe/detect the actions of the surrounding vehicles that are within its communication range.
As another example, in power grid networks (Riedmiller et al., 2000), each power distributor
generally does not know the resistor values set by other distributors.
• Second, most MARL theoretical studies in the MARL literature are focused on the discounted
total reward setting, where a hyperparameter γ ∈(0, 1) is introduced as the discount factor in the
objective function. Although the discounted total reward setting captures the important aspect of
diminishing return in the future, it may not be appropriate for many other applications where the
long-term average reward is of interest. For example, in the optimization of distributed communi-
cation networks with MARL, the typical and natural performance metrics are long-term average
throughput or latency in the steady-state.
The lack of a fundamental understanding on how to develop efﬁcient cooperative MARL algorithms
that consider the above two aspects in terms of information structure, scalability, and communication"
INTRODUCTION,0.006482982171799027,Published as a conference paper at ICLR 2022
INTRODUCTION,0.008103727714748784,"and sample complexities motivates us to ﬁll this gap by developing a fully decentralized cooperative
MARL algorithm in the average reward setting, without assuming joint action knowledge."
INTRODUCTION,0.009724473257698542,"2) Technical Challenges: Developing a fully decentralized cooperative MARL algorithm for the
average reward setting without full joint action knowledge is highly non-trivial and several major
technical challenges naturally arise. First, it is well-known that, even in the single-agent reinforce-
ment learning (RL) setting, the average reward setting is more challenging to analyze compared to
the discounted reward setting, which necessitates different proof techniques (Tsitsiklis & Van Roy,
1999). In MARL, the decentralized nature and the lack of joint action-state information further
complicate the algorithm design and analysis in the average reward setting. Second, due to the lack
of joint action knowledge, the communication costs among agents in MARL will be signiﬁcantly
increased to achieve a satisfying performance, which implies that low sample and communication
complexities are even more challenging and critical for MARL without joint action information."
INTRODUCTION,0.011345218800648298,"3) Main Results and Contributions: The main contribution of this paper is that we overcome the
aforementioned challenges and develop a consensus-based Markovian sampled decentralized actor-
critic algorithm for MARL. Our key results in this paper are summarized as follows:"
INTRODUCTION,0.012965964343598054,"• We propose a batch-sampled actor-critic algorithm that uses consensus updates in TD-sharing
among agents. This batch sampling approach enables more efﬁcient communication compared
to the classical fully decentralized MARL. Speciﬁcally, in order to converge to an ǫ neighbor-
hood of the stationary, we require O(ǫ−1 log(ǫ−1)) rounds of communication while only needing
O(ǫ−2 log(ǫ−1)) samples. By contrast, the state-of-the-art MARL requires a communication
round per sampling. Also, our algorithm allows the use of constant step-sizes in both the actor
and the critic steps."
INTRODUCTION,0.014586709886547812,"• We provide the ﬁrst-ever sample complexity analysis in the MARL average reward problem set-
ting without joint action information. Our obtained complexity is O(ǫ−2 log(ǫ−1)), where ǫ is the
closeness to the neighborhood of stationary point (treating network size N as a ﬁxed constant).
It is worth noting that the order-wise sample complexity of our algorithm matches that of the
state-of-the-art single-agent RL algorithms."
RELATED WORK,0.01620745542949757,"2
RELATED WORK"
RELATED WORK,0.017828200972447326,"In this section, we provide a quick overview on the closely related work on MARL algorithms and
their theoretical results, along with several notable related counterparts in single-agent RL."
RELATED WORK,0.019448946515397084,"1) MARL Theoretical Analysis and Algorithm Design: For recent advances in MARL algorithms
and their theoretical results, Zhang et al. (2021a) provided a comprehensive survey. Also, Lee et al.
(2020) highlighted the evolution from single-agent to multi-agent RL from a distributed optimization
perspective. In the broader area of MARL, a line of research has been focused on the MARL policy
evaluation problem. These works analyzed the convergence Doan et al. (2019) and proposed vari-
ous variance reduction of policy evaluation in decentralized MARL algorithms Zhang et al. (2021b).
Doan et al. (2019) used i.i.d. sampling and has shown the sample complexity of ˜O(ǫ−1) for their
TD(0) learning algorithm to reach a mean-square error convergence. However, these algorithms do
not involve policy improvement and solely focus on the performance evaluation of given policies. In
the areas of joint policy evaluation and improvement, Foerster et al. (2018) considered multi-agent
actor-critic algorithm that has a centralized critic and decentralized actors, which is different from
our fully decentralized actor-critic algorithm. In contrast, Zhang et al. (2018) established asymp-
totic convergence results for fully decentralized MARL actor-critic algorithms. Concurrent with
our work, Chen et al. (2021) has recently studied the mini-batch Markovian sampling actor-critic
algorithm for a class of discounted reward MARL problems, where the ﬁnite-time convergence re-
sult is obtained. They have applied batch sampling for both actor and critic steps and achieved a
sample complexity of O(ǫ−2 log(ǫ−1)), which is the same as ours. We note that, together with our
work, these are the ﬁrst ﬁnite-time convergence results for MARL. However, there are several key
differences between our work and (Chen et al., 2021). First, we focus on the average reward prob-
lem, while Chen et al. (2021) studied the discounted reward setting. Second, in (Chen et al., 2021),
agents share a noisy version of the rewards with the neighbors, which requires a re-sampling process
from every sampled reward instance. In contrast, we allow agents to share local TD-errors with their
neighbors and no re-sampling is required."
RELATED WORK,0.02106969205834684,Published as a conference paper at ICLR 2022
RELATED WORK,0.022690437601296597,"Table 1: Comparison of sample complexity of single-agent (SA) and multi-agent (MA) AC algo-
rithms and TD(0) algorithms at Average Reward (AR) and Discounted Reward (DR) settings."
RELATED WORK,0.024311183144246355,"Paper
Problem
Sampling
Sample Complexity
actor step
critic step
Qiu et al. (2021)
SAAR
i.i.d.
Markovian
O(ǫ−3 log2(ǫ−1))
Xu et al. (2020)
SADR
Markovian
Markovian
O(ǫ−2 log(ǫ−1))
Zhang et al. (2018)
MAAR
Markovian
Markovian
Asymptotic
Doan et al. (2019)
MADR
N/A
i.i.d
˜O(ǫ−1)
Chen et al. (2021)
MADR
Markovian
Markovian
O(ǫ−2 log(ǫ−1))
This paper
MAAR
Markovian
Markovian
O(N 2/ǫ2 log(N/ǫ))"
RELATED WORK,0.02593192868719611,"2) Related Literature in Single-Agent RL: We note that single-agent RL can be viewed as a
centralized approach, where a central controller collects joint actions, rewards and even designs
policies for agents. For the single-agent average reward setting, Tsitsiklis & Van Roy (1999) ﬁrst
analyzed the asymptotic convergence of TD(λ) algorithm with function approximations in the policy
evaluation problem. Also, Tsitsiklis & Van Roy (2002) provided insights in terms of differences and
connections between average reward and discounted reward of TD-based learning algorithms with
function approximations. Recently, Qiu et al. (2021) analyzed the sample complexity for an actor-
critic algorithm for the average reward problem. In their actor-critic algorithm, they used batch
sampling for the critic learning and i.i.d. sampling for the actor step, with sample complexity being
O(ǫ−3 log2(ǫ−1)). By applying mini-batch sampling update, we are able to improve the sample
complexity by a factor of O(ǫ−1). Another closely related work on single-agent RL is (Xu et al.,
2020), where the authors studied the discounted reward problem. They used batch sampling for both
actor and critic steps in their actor-critic algorithm and developed a new technique to handle bias
error in the critic step, which we also adopted for the average approximation parameter analysis in
our critic step. This achieved the state-of-the-art sample complexity of O(ǫ−2 log(ǫ−1)) for single-
agent RL. In addition, the global convergence of actor-critic algorithm to the optimal policy has
been studied in the case of discounted setting with single time scale in (Fu et al., 2020) and linear
quadratic regulator in (Yang et al., 2019). However, we note that these settings are fundamentally
different from the average reward setting and it will be an interesting future direction to consider
global convergence possibility in the average reward setting."
RELATED WORK,0.027552674230145867,"To conclude this section, we summarize the aforementioned related actor-critic and TD algorithms
and their sample complexity results in Table 1."
MULTI-AGENT REINFORCEMENT LEARNING WITH AVERAGE REWARD,0.029173419773095625,"3
MULTI-AGENT REINFORCEMENT LEARNING WITH AVERAGE REWARD"
SYSTEM MODEL,0.03079416531604538,"3.1
SYSTEM MODEL"
SYSTEM MODEL,0.03241491085899514,"Consider a multi-agent system with N agents, denoted by N = {1, · · · , N}, operating in a net-
worked environment. Let E be the edge set for a given network G = (N, E). To formulate our
MARL problem and facilitate our subsequent discussions, we ﬁrst deﬁne the notion of networked
multi-agent MDP as follows.
Deﬁnition 1 (Networked Multi-Agent MDP). Let G
=
(N, E) be a communication net-
work that connects N agents.
A networked multi-agent MDP is deﬁned by following tuple
(S, {Ai}i∈N , P, {Ri}i∈N , G), where S is the global state space observed by all agents, Ai is the
action set for agent i, and P : S ×A×S →[0, 1] is a global state transition function, and Ri : S ×A
is the local reward function for agent i. Let A = Q"
SYSTEM MODEL,0.03403565640194489,i∈N Ai be the joint action set of all agents.
SYSTEM MODEL,0.03565640194489465,"In this paper, we assume that the global state space S and action space for agent Ai are ﬁnite. As
a result, the joint action space A is also ﬁnite for ﬁnite N. We also note that at time t ≥0, all
agents can observe the current global state st. However, agent i can only observe its own action
ai
t ∈Ai, which is the key difference between our model and that in (Zhang et al., 2018), where it is
assumed that the joint actions are observable to all agents. Moreover, each agent can only observe
its own reward ri
t, i.e., agents do not observe or share rewards with other agents at time t. The"
SYSTEM MODEL,0.03727714748784441,Published as a conference paper at ICLR 2022
SYSTEM MODEL,0.03889789303079417,"reward function Ri(s, a) is an expectation given s and a, and the instantaneous reward is denoted
by ri(s, a), i.e., Ri(s, a) = E[ri(s, a)]."
SYSTEM MODEL,0.04051863857374392,"We consider policies that are stationary. In our MARL system, each agent chooses its action follow-
ing its local policy πi that is conditioned on the current global state s, i.e., πi(ai|s) is the probability
for agent i to choose an action ai ∈Ai. Then, the joint policy π : S × A →[0, 1] can be written as
π(a|s) = Q
i∈N πi(ai|s)."
SYSTEM MODEL,0.04213938411669368,"Moreover, the policies at the agents are parameterized. Speciﬁcally, each agent i’s local policy can
be written as πi
θi, where θi ∈Rmi denotes the parameter. We let θ ≜[(θ1)T , · · · , (θN)T ]T ∈
R
PN
i=1 mi. Then, we can write the joint policy as follows: πθ(a|s) = Q
i∈N πθi(ai|s)."
TECHNICAL ASSUMPTIONS,0.04376012965964344,"3.2
TECHNICAL ASSUMPTIONS"
TECHNICAL ASSUMPTIONS,0.04538087520259319,"We now state the following assumptions on the positivity and continuity of πi
θi(ai|s), which guar-
antee the stationary distribution of {st} under any given policy.
Assumption 1. For any i ∈N, s ∈S, ai ∈Ai and θi ∈Rmi, the policy function πi
θi(ai|s) ≥0.
Also, πi
θi(s, a) is a continuously differentiable with respect to the parameter θi. In addition, for
any θ, we assume the induced Markov chain {st}t≥0 is irreducible and aperiodic, and its transition
matrix P θ is P θ(s′|s) = P
a∈A πθ(a|s) · P(s′|s, a),
∀s, s′ ∈S."
TECHNICAL ASSUMPTIONS,0.04700162074554295,"Assumption 1 guarantees that the states have a stationary distribution dθ(s) over S given any policy
πθ. As a result, the Markov chain of state action pair {(st, at)} also has a stationary distribution
dθ(s) · πθ(a|s).
Assumption 2. The instantaneous reward ri
t is uniformly bounded by a constant rmax > 0 for any
i ∈N and t ≥0."
TECHNICAL ASSUMPTIONS,0.04862236628849271,"Assumption 2 is common in the literature (see, e.g., (Zhang et al., 2018; Xu et al., 2020; Doan et al.,
2019)) and easy to be satisﬁed in many practical MDP models with ﬁnite state and action spaces.
Assumption 3. Let A be a consensus weight matrix for a given communication network G. There
exists a positive constant η > 0 such that A ∈RN×N is doubly stochastic and Aii ≥η, ∀i ∈N.
Moreover, Aij ≥η if i, j are connected, otherwise Aij = 0 for all i, j."
TECHNICAL ASSUMPTIONS,0.050243111831442464,"Assumption 3 is standard in the distributed multi-agent optimization literature Nedic & Ozdaglar
(2009).
We remark that for a practical choice of A, one can use the following form A =
1
deg(G)(deg(G) · I −L), where deg(G) is the degree of the graph G (i.e. the maximal vertex de-
gree), I is the identity matrix of conforming dimensionality, and L is the Laplacian matrix of the
graph. It is easy to verify that this matrix is symmetric, doubly stochastic and η ≥
1
deg(G) ≥1 N ."
TECHNICAL ASSUMPTIONS,0.05186385737439222,"Assumption 4. Each agent i’s value function is parameterized by the class of linear functions, i.e.,
Vθ(s; w) = φ(s)T w where φ(s) ≜[φ1(s), · · · , φK(s)]T ∈RK is the feature associated with the
state s ∈S and K < |S|. The feature vectors φ(s) are uniformly bounded for any s ∈S. Without
loss of generality, we assume that ∥φ(s)∥≤1. Furthermore, the feature matrix Φ ∈R|S|×K has
full column rank. Also, for any u ∈RK, Φu ̸= 1, where 1 is an all-one vector."
TECHNICAL ASSUMPTIONS,0.05348460291734198,"This assumption on features is standard and has been widely adopted in the literature, e.g.,
(Tsitsiklis & Van Roy, 1999; Zhang et al., 2018; Qiu et al., 2021). This assumption implies the fol-
lowing property: for any policy πθ, the inequality wT Aπθw < 0 holds for any w ̸= 0, where Aπθ is
deﬁned as"
TECHNICAL ASSUMPTIONS,0.055105348460291734,"Aπθ := Es∼dθ(s),s′∼P (·|s)[(φ(s′) −φ(s))φT (s)].
(1)"
TECHNICAL ASSUMPTIONS,0.05672609400324149,"This property further implies that for all θ, Aπθ is invertible and λmax(Aπθ + AT
πθ) < 0 (Qiu et al.,
2021), where λmax(·) is the largest eigenvalues of the matrix.
Assumption 5. There exists a constant λA > 0 such that λmax(Aπθ + AT
πθ) ≤−λA holds for all
θ ∈R
P"
TECHNICAL ASSUMPTIONS,0.05834683954619125,i∈N mi.
TECHNICAL ASSUMPTIONS,0.059967585089141004,"Assumption 5 ensures the optimal approximation w∗
θ for any given policy πθ is uniformly bounded
(see discussion before Theorem 2 and Lemma 4)."
TECHNICAL ASSUMPTIONS,0.06158833063209076,Published as a conference paper at ICLR 2022
TECHNICAL ASSUMPTIONS,0.06320907617504051,"Assumption 6. Let ψθ(s, a) = ∇θ log πθ(a|s) be the score function for any state-action pair (s, a).
For any two policy parameters θ, θ′ ∈R
P
i∈N mi, and any state-action pair (s, a) ∈S×A, there exist
positive constants such that the following hold: 1): ∥ψθ(s, a)∥≤Cψ; 2): ∥∇θJ(θ) −∇θJ(θ′)∥≤
LJ∥θ −θ′∥; where J(θ) is deﬁned in (2) and ∥· ∥denotes the ℓ2-norm."
TECHNICAL ASSUMPTIONS,0.06482982171799027,"Assumption 6 says that the score function is uniformly bounded for any policy and the gradient of
the objective function has a Lipschitz property with respect to the policy parameter. This assumption
has also been adopted in the analysis of the single-agent actor-critic algorithm in (Qiu et al., 2021).
We note that for the discounted reward problem, this gradient Lipschitz property can be guaranteed
through (Xu et al., 2020, Assumption 2). We note that Assumption 6 can be satisﬁed by the class of
soft-max policy under the Assumption 1, as in (Guo et al., 2021)."
THE OBJECTIVE FUNCTION,0.06645056726094004,"3.3
THE OBJECTIVE FUNCTION"
THE OBJECTIVE FUNCTION,0.06807131280388978,"The goal of the agents is to ﬁnd a joint policy πθ to maximize the global average long-term reward.
Mathematically, this can be written as:"
THE OBJECTIVE FUNCTION,0.06969205834683954,"maximizeθ
J(θ) = lim
T →∞
1
T E"
THE OBJECTIVE FUNCTION,0.0713128038897893,"T −1
X t=0"
N,0.07293354943273905,"1
N X"
N,0.07455429497568881,"i∈N
ri
t+1 ! =
X"
N,0.07617504051863858,"s∈S
dθ(s)
X"
N,0.07779578606158834,"a∈A
πθ(a|s) · ¯R(s, a),
(2)"
N,0.07941653160453808,"where ¯R(s, a) =
1
N
P"
N,0.08103727714748785,"i∈N Ri(s, a) is the global average reward function. Let ¯rt =
1
N
P"
N,0.08265802269043761,"i∈N ri
t,
then we have ¯R(s, a) = E[¯rt+1|st = s, at = a].
Next, we deﬁne the state-action value
function: Qθ(s, a) = E[P∞
t=0 ¯rt+1 −J(θ)|s0 = s, a0 = a, πθ], and the state value function
Vθ(s) = P"
N,0.08427876823338736,"a∈A Qθ(s, a) · πθ(a|s). The advantage function is deﬁned as follows:"
N,0.08589951377633712,"Advθ(s, a) = Qθ(s, a) −Vθ(s).
(3)"
POLICY GRADIENT THEOREM,0.08752025931928688,"3.4
POLICY GRADIENT THEOREM"
POLICY GRADIENT THEOREM,0.08914100486223663,"The gradient of a policy πθ for decentralized policy gradient is stated in the following theorem.
Theorem 1 (Policy Gradient Theorem for MARL (Zhang et al., 2018)). For any θ, let πθ : S ×A →
[0, 1] be a policy and let J(θ) be the global average long-term average return deﬁned in (2). Then,
the gradient of J(θ) with respect to parameter θi can be computed as:"
POLICY GRADIENT THEOREM,0.09076175040518639,"∇θiJ(θ) = Es∼dθ,a∼πθ[∇θi log πi
θi(ai|s) · Advθ(s, a)].
(4)"
A CONSENSUS-BASED ACTOR-CRITIC ALGORITHM,0.09238249594813615,"4
A CONSENSUS-BASED ACTOR-CRITIC ALGORITHM"
A CONSENSUS-BASED ACTOR-CRITIC ALGORITHM,0.0940032414910859,"In this section, we propose a consensus-based actor-critic algorithm that includes two key steps:
actor and critic. In the critic step, the algorithm evaluates the value functions for the policy πθt at
time t. After the critic step, the algorithm enters the actor step, which improves the policy parameter
θt according to the direction from policy gradient as shown in Theorem 1. In both steps, we use
constant step-sizes and adopt batch sampling."
A CONSENSUS-BASED ACTOR-CRITIC ALGORITHM,0.09562398703403566,"In this paper, we use linear function approximations for the value functions. Speciﬁcally, each agent
i has a parameter wi ∈RK to approximate the global value functions Vθ(s; wi) for each state s ∈S.
For linear approximation, we have Vθ(s; wi) = φ(s)T wi, where φ(s) ∈RK denotes the feature for
state s. As a result, the gradient of value function at state s with respect to approximation parameter
wi is φ(s), i.e. ∇wVθ(s; wi) = φ(s)."
A CONSENSUS-BASED ACTOR-CRITIC ALGORITHM,0.09724473257698542,"1) The Critic Step: The critic step is achieved through its own oracle, which is summarized in
Algorithm 1. In the critic step, we allow the agents to communicate the approximation parameters
w(s) with their neighbors via the communication network with consensus weight matrix A. For
agent i ∈N, the parameter is locally updated by following rules:"
A CONSENSUS-BASED ACTOR-CRITIC ALGORITHM,0.09886547811993517,"µi
k,τ+1 = (1 −β)µi
k,τ + βri
k,τ+1
(5)"
A CONSENSUS-BASED ACTOR-CRITIC ALGORITHM,0.10048622366288493,"δi
k,τ = ri
k,τ+1 −µi
k,τ + φT (sk,τ+1)wi
k −φT (sk,τ)wi
k
(6)"
A CONSENSUS-BASED ACTOR-CRITIC ALGORITHM,0.10210696920583469,Published as a conference paper at ICLR 2022
A CONSENSUS-BASED ACTOR-CRITIC ALGORITHM,0.10372771474878444,"Algorithm 1:
Mini-batch TD learning for Critic
Input : s0, πθt, φ, step-size β, critic step iteration number K, critic batch size M, the
communication network A"
A CONSENSUS-BASED ACTOR-CRITIC ALGORITHM,0.1053484602917342,"1 for k = 0, · · · , Kc −1 do"
A CONSENSUS-BASED ACTOR-CRITIC ALGORITHM,0.10696920583468396,"2
sk,0 = sk−1,M ( when k = 0, sk,0 = s0);"
A CONSENSUS-BASED ACTOR-CRITIC ALGORITHM,0.1085899513776337,"3
for all i ∈N do"
A CONSENSUS-BASED ACTOR-CRITIC ALGORITHM,0.11021069692058347,"4
for τ = 0, · · · , M −1 do"
EXECUTE ACTION AI,0.11183144246353323,"5
Execute action ai
k,τ ∼πi
θi
t(·|sk,τ);"
EXECUTE ACTION AI,0.11345218800648298,"6
Observe the state sk,τ+1 and reward ri
k,τ+1;"
EXECUTE ACTION AI,0.11507293354943274,"7
Update µi
k,τ+1 ←(1 −β) · µi
k,τ + β · ri
k,τ+1;"
EXECUTE ACTION AI,0.1166936790923825,"8
Update δi
k,τ ←ri
k,τ+1 −µi
k,τ + φT (sk,τ+1)wi
k −φT (sk,τ)wi
k;"
END,0.11831442463533225,"9
end"
END,0.11993517017828201,"10
Critic Step: ˜wi
k ←wi
k + β"
END,0.12155591572123177,"M
PM−1
τ=0 δi
k,τ · φ(sk,τ);"
CONSENSUS UPDATE WI,0.12317666126418152,"11
Consensus Update wi
k+1 ←P"
CONSENSUS UPDATE WI,0.12479740680713128,"j∈Ni A(i, j) · ˜wj
k;"
END,0.12641815235008103,"12
end"
END,0.1280388978930308,"13 end
Output: sKc−1,M,
wKc"
END,0.12965964343598055,"˜wi
k = wi
k + β M M−1
X"
END,0.1312803889789303,"τ=0
δi
k,τ · φ(sk,τ),
(7)"
END,0.13290113452188007,"where β > 0 is the step-size of the critic step, µi
k,τ is the estimate of the long-term return of
agent i, and δi
k,τ is the local TD-error for agent i at iteration k using sample τ. Here, in each
iteration k in the critic step, the approximation parameter is locally updated through a batch of
sampling as in (7), where the batch size is M. Then, agent i will further update the approximation
parameter wi through a weighted average of its local and neighboring agents’ parameters as follows:
wi
k+1 = P
j∈Ni A(i, j) ˜wi
k. This batched sampling update continues for Kc iterations for each given
policy πθt."
END,0.13452188006482982,"2) The Actor Step: As shown in Theorem 1, the advantage function needs to be known to compute
the gradient. However, from the deﬁnition in (3), the joint action a also has to be known to compute
the advantage function, whereas in our model, each agent can only observe its own action. As a
result, an estimation of the advantage function is required. Here, we show that the global TD-error
is an unbiased estimate of the advantage function."
END,0.13614262560777957,"At time t, suppose we have samples st, at, st+1 and the rewards {ri
t+1}i∈N then the advantage
function is as follows: Advθ(st, at) = E[¯rt+1 −J(θ) + Vθ(St+1) −Vθ(st)|st, at], and the global
TD-error can be computed as follows: δt = ¯rt+1 −µt + Vθ(st+1) −Vθ(st), where µt+1 = (1 −
α) · µt + α · ¯rt+1 is the estimate for the average long term return, and α is the step-size for the actor
step. Hence, we have that the expected global TD-error is the advantage function, i.e., E[δt|st, at] =
Aθ(st, at). Thus, we can use this global TD-error as an unbiased estimate of the advantage function.
For agent i, the local TD-error can be computed as δi
t = ri
t+1 −µi
t + Vθ(st+1) −Vθ(st), where
µi
t+1 = (1 −α)µi
t + αri
t+1. We also note that µt = 1 N
P"
END,0.13776337115072934,"i∈N µi
t ."
END,0.1393841166936791,"Thus, once each agent knows the global TD-error, the policy parameter can be updated according to
the policy gradient rule in (4). However, without any communication, each agent only has the knowl-
edge of its own local TD-error. Moreover, we will show that the networked TD-error is actually the
average of the local TD-errors. Speciﬁcally,"
END,0.14100486223662884,δt = ¯rt+1 −µt + Vθ(st+1) −Vθ(st) = 1 N X
END,0.1426256077795786,"i∈N
ri
t+1 −1 N X"
END,0.14424635332252836,"i∈N
µi
t + Vθ(st+1) −Vθ(st) = 1 N X"
END,0.1458670988654781,"i∈N
[ri
t+1 −µi
t + Vθ(st+1) −Vθ(st)] = 1 N X"
END,0.14748784440842788,"i∈N
δi
t."
END,0.14910858995137763,Published as a conference paper at ICLR 2022
END,0.1507293354943274,"Algorithm 2:
Minibatch-TD sharing for Actor Critic Algorithm
Input : state feature matrix Φ, actor step-size α, Initial parameters θi for all i ∈N"
END,0.15235008103727715,"1 for t = 0, · · · , T −1 do"
END,0.1539708265802269,"2
critic update: wt, st,0 = Minibatch-TD-critic in Algorithm 1;"
END,0.15559157212317667,"3
for l = 0, · · · , B −1 do"
END,0.15721231766612642,"4
for all i ∈N do"
EXECUTE ACTION AI,0.15883306320907617,"5
Execute action ai
t,l ∼πi
θi
t(·|st,l);"
EXECUTE ACTION AI,0.16045380875202594,"6
Observe the state st,l+1 and reward ri
t,l+1;"
EXECUTE ACTION AI,0.1620745542949757,"7
Update µi
t,l+1 ←(1 −α) · µi
t,l + α · ri
t,l+1;"
EXECUTE ACTION AI,0.16369529983792544,"8
Update δi
t,l ←ri
t,l+1 −µi
t,l + φT (st,l+1)wi
t −φT (st,l)wi
t;"
EXECUTE ACTION AI,0.16531604538087522,"9
Update ψi
t,l ←∇θi log πi
θi
t(st,l, ai
t,l);"
END,0.16693679092382496,"10
end"
END,0.1685575364667747,"11
end"
END,0.17017828200972449,"12
Let ∆0 =  "
END,0.17179902755267423,"δ1
t,0
· · ·
δN
t,0
...
...
...
δ1
t,B−1
· · ·
δN
t,B−1  ;"
END,0.17341977309562398,"13
for i ∈N do"
END,0.17504051863857376,"14
for k = 0 : tgossip −1 do"
END,0.1766612641815235,"15
∆k+1(:, i) ←P"
END,0.17828200972447325,"j∈Ni A(i, j) · ∆k(:, j);"
END,0.17990275526742303,"16
end"
END,0.18152350081037277,"17
end"
END,0.18314424635332252,"18
for all i ∈N do"
END,0.1847649918962723,"19
Let ˜δi
t,1:B−1 = ∆tgossip(:, i) ;"
END,0.18638573743922204,"20
Actor Step: θi
t+1 ←θi
t + α"
END,0.1880064829821718,"B
PB−1
l=0 ˜δi
t,l · ψi
t,l;"
END,0.18962722852512157,"21
end"
END,0.1912479740680713,"22 end
Output: θ ˆT with ˆT chosen uniformly from {1, · · · , T}"
END,0.19286871961102106,"For any time t, the average of the local TD-errors is an unbiased estimate of the advantage function.
Therefore, we just need to let each agent communicate with its neighbors so that an average of all
local TD-errors can be reached or estimated for all agents."
END,0.19448946515397084,"From the results in (Nedic & Ozdaglar, 2009),
we have limτ→∞Aτ(x1, · · · , xN)T
=
1
N
P
i∈N xi1. However, this convergence is asymptotic, meaning that the exact estimation can
only be achieved with inﬁnite iterations (i.e., τ →∞). In practice, since one can only apply ﬁ-
nite iterations, we use ˜δi
t to denote the estimate of the global TD-error maintained by agent i after
tgossip iterations of updates at time t, i.e., ˜δi
t = [Atgossip]i∆0
t, where ∆0
t = (δ1
t , · · · , δN
t )T is the N-
dimension vector of local TD-errors at time t. We note that agents do not need to know the weight
information of other agents. Rather, each agent just needs to exchange updated estimate of the lo-
cal TD-errors with its neighbors for tgossip rounds as shown in Lines 11-16 of Algorithm 2. This
communication among agents is also done in a batch fashion, with batch size being B. This implies
that for each outer iteration t ∈{0 · · · , T −1}, only tgossip rounds of communication for every B
samples are needed."
END,0.19611021069692058,"Combined with a B-batched Markovian sampling, the parameter θi update for agent i ∈N can be
written as follows: θi
t+1 = θi
t + α"
END,0.19773095623987033,"B
PB−1
l=0 ˜δi
t,l · ψi
t,l where α is the step-size for the actor step and
ψi
t,l = ∇θi log πi
θi
t(st,l, ai
t,l) is the local score function for agent i using l-th sample at time t. The
actor step of our algorithm is illustrated in Algorithm 2."
END,0.1993517017828201,Published as a conference paper at ICLR 2022
THEORETICAL CONVERGENCE ANALYSIS,0.20097244732576985,"5
THEORETICAL CONVERGENCE ANALYSIS"
THEORETICAL CONVERGENCE ANALYSIS,0.2025931928687196,"In this section, we present the convergence results for both the critic and actor steps in Theorems 2
and 3, respectively. Due to space limitation, we relegate the proofs to the supplementary material."
THEORETICAL CONVERGENCE ANALYSIS,0.20421393841166938,"5.1
CONVERGENCE ANALYSIS FOR CRITIC (ALGORITHM 1)"
THEORETICAL CONVERGENCE ANALYSIS,0.20583468395461912,"For a given policy πθ, we deﬁne bπθ = Es∼dθ,a∼πθ[φ(s)(¯r(s, a) −J(θ))], where ¯r(s, a) =
1
N
P"
THEORETICAL CONVERGENCE ANALYSIS,0.20745542949756887,"i∈N ri(s, a) and J(θ) are as deﬁned in (2). For all agents, the optimal solution (Wu et al.,
2020), (Qiu et al., 2021) of this critic learning is w∗
θ = −A−1
πθ bπθ , where Aπθ is deﬁned as in (1).
The invertiblity of Aπθ is due to the Assumptions 1 and 4 (see more details in (Qiu et al., 2021;
Tsitsiklis & Van Roy, 1999)). Then, the convergence of the critic step is summarized as follows:
Theorem 2 (Convergence and Sample Complexity of the Critic). Suppose that Assumptions 1-5
hold. For any given policy πθ, consider the iteration generated by Algorithm 1. Recall the deﬁnition
of λA in the Assumption 5 and let β < min{
ηN−1"
THEORETICAL CONVERGENCE ANALYSIS,0.20907617504051865,"2(1−ηN−1), λA"
THEORETICAL CONVERGENCE ANALYSIS,0.2106969205834684,"128,
4
λA }. It then follows that: E[ N
X"
THEORETICAL CONVERGENCE ANALYSIS,0.21231766612641814,"i=1
||wi
Kc −w∗
θ||2] ≤κ′
1N 4γ2Kc + κ′′
2N 6β2 + κ3N 5γKcβ"
THEORETICAL CONVERGENCE ANALYSIS,0.21393841166936792,+ 2N(1 −λA
THEORETICAL CONVERGENCE ANALYSIS,0.21555915721231766,"8 β)Kc|| ¯w0 −w∗
θ||2
2 + κ4"
THEORETICAL CONVERGENCE ANALYSIS,0.2171799027552674,"M N,
(8)"
THEORETICAL CONVERGENCE ANALYSIS,0.2188006482982172,"where γ := (1−ηN−1)·(1+2β) < 1 and κ′
1, κ′′
2, κ3, κ4 are positive constants. If we further let Kc ≥"
THEORETICAL CONVERGENCE ANALYSIS,0.22042139384116693,"1
2 max{logγ−1 6κ′
1N 4"
THEORETICAL CONVERGENCE ANALYSIS,0.22204213938411668,"ǫ
, log(1−λA"
THEORETICAL CONVERGENCE ANALYSIS,0.22366288492706646,"8 β)−1
12N|| ¯
w0−w∗
θ||2
2
ǫ
}, β
≤min{ 1 N 3
q"
THEORETICAL CONVERGENCE ANALYSIS,0.2252836304700162,"ǫ
6κ′′
2 ,
ηN−1"
THEORETICAL CONVERGENCE ANALYSIS,0.22690437601296595,"2(1−ηN−1), λA"
THEORETICAL CONVERGENCE ANALYSIS,0.22852512155591573,"128,
4
λA }"
THEORETICAL CONVERGENCE ANALYSIS,0.23014586709886548,"and M ≥
6κ4N"
THEORETICAL CONVERGENCE ANALYSIS,0.23176661264181522,"ǫ
, then we have E[PN
i=1 ||wi
Kc −w∗
θ||2] ≤ǫ for all i ∈N with total sample
complexity given by KcM = O( N"
THEORETICAL CONVERGENCE ANALYSIS,0.233387358184765,ǫ log( N ǫ )).
THEORETICAL CONVERGENCE ANALYSIS,0.23500810372771475,"Theorem 2 establishes a convergence result for the policy evaluation of a given policy πθ. We can
see that our constant step-size batch-sampled critic process can achieve the same complexity of
˜O(ǫ−1) order-wise as the TD(0) learning in Doan et al. (2019), where diminishing step-sizes were
used. On the other hand, in the single agent average reward setting of Qiu et al. (2021), there exists
a non-vanishing error term in their critic convergence. In contrast, with proper choices of iteration
number Kc and batch size M, our mean-square error can be arbitrarily small."
THEORETICAL CONVERGENCE ANALYSIS,0.2366288492706645,"5.2
CONVERGENCE ANALYSIS FOR ACTOR-CRITIC ALGORITHM (ALGORITHM 2)"
THEORETICAL CONVERGENCE ANALYSIS,0.23824959481361427,"Deﬁne the approximation error introduced by using linear approximation in the critic step, ξcritic
approx =
maxθ∈R
P
i∈N mi Es∼dθ[|Vπθ(s) −Vw∗
πθ (s)|2]. For a given policy πθ, this error represents the gap
between ground truth value function under such policy and the value function obtained by the best
possible linear approximation. Such an error term is standard in the literature where linear approx-
imations are adopted (Qiu et al., 2021; Xu et al., 2020). Let Rw, deﬁned in Lemma 4, be an upper
bound on ||wθ|| for all policy parameter θ.
Theorem 3 (Overall Convergence Rate and Sample Complexity). Suppose that Assumption 1-6
hold. Consider the actor-critic algorithm in Algorithm 2. Let step-size α =
1
4LJ . It then holds that:"
THEORETICAL CONVERGENCE ANALYSIS,0.23987034035656402,E[||∇θJ(θ ˜T )||2] ≤16LJrmax
THEORETICAL CONVERGENCE ANALYSIS,0.24149108589951376,"T
+ 72N"
THEORETICAL CONVERGENCE ANALYSIS,0.24311183144246354,"PT
t=1
PN
i=1 ||wi
t −w∗
θt||2"
THEORETICAL CONVERGENCE ANALYSIS,0.24473257698541329,"T
+ 18κ3N 3(1 −ηN−1)2tgossip"
THEORETICAL CONVERGENCE ANALYSIS,0.24635332252836303,"+ 72ξcritic
approx + 288(rmax + Rw)2[1 + (2κ −1)ρ]"
THEORETICAL CONVERGENCE ANALYSIS,0.2479740680713128,"B(1 −ρ)
N,
(9)"
THEORETICAL CONVERGENCE ANALYSIS,0.24959481361426256,"where κ3 is a positive constant. Furthermore, let T ≥64LJrmax"
THEORETICAL CONVERGENCE ANALYSIS,0.25121555915721233,"ǫ
, B ≥576 (rmax+2Rw)2[1+(2κ−1)ρ]"
THEORETICAL CONVERGENCE ANALYSIS,0.25283630470016205,"(1−ρ)
N"
THEORETICAL CONVERGENCE ANALYSIS,0.2544570502431118,"ǫ
and the communication round among the agents tgossip ≥1"
THEORETICAL CONVERGENCE ANALYSIS,0.2560777957860616,2 log(1−ηN−1)−1 64κ3N 3
THEORETICAL CONVERGENCE ANALYSIS,0.2576985413290113,"ǫ
. Suppose for the"
THEORETICAL CONVERGENCE ANALYSIS,0.2593192868719611,"same setting as in Theorem 1 holds so that E[PN
i=1 ||wi
Kc −w∗
θ||2] ≤
ǫ
288N for all 0 ≤t ≤
T, then we have E[||∇θJ(θt)||2] ≤ǫ + O(ξcritic
approx), with a total complexity of (B + MKc)T ="
THEORETICAL CONVERGENCE ANALYSIS,0.26094003241491087,O( N 2
THEORETICAL CONVERGENCE ANALYSIS,0.2625607779578606,ǫ2 log( N
THEORETICAL CONVERGENCE ANALYSIS,0.26418152350081037,ǫ )). And the communication complexity is (Kc + tgossip)T = O( 1
THEORETICAL CONVERGENCE ANALYSIS,0.26580226904376014,ǫ log( N ǫ )).
THEORETICAL CONVERGENCE ANALYSIS,0.26742301458670986,Published as a conference paper at ICLR 2022
THEORETICAL CONVERGENCE ANALYSIS,0.26904376012965964,"(a) System size N = 6.
(b) System size N = 10.
(c) System size N = 15."
THEORETICAL CONVERGENCE ANALYSIS,0.2706645056726094,Figure 1: Our TD-sharing algorithm vs classical MARL algorithm.
THEORETICAL CONVERGENCE ANALYSIS,0.27228525121555913,"Theorem 3 concludes the overall sample complexity of our proposed actor-critic algorithm. The
sample complexity of O(ǫ−2 log(ǫ−1)) matches the state-of-the-art single-agent actor-critic RL by
Xu et al. (2020) and the discounted MARL by Chen et al. (2021)."
THEORETICAL CONVERGENCE ANALYSIS,0.2739059967585089,"We note that the overall communication complexity also matches that of (Chen et al., 2021) in the
discounted reward setting. However, our work is still an improvement compared to the classical
MARL in Zhang et al. (2018) for the average reward setting. Speciﬁcally, Zhang et al. (2018) needed
a communication round after each sampling. By contrast, in this paper, we only need a communica-
tion round per O(ǫ−1) sampling. This is thanks to the use of batch sampling in the actor step. Also
because of the batch sampling, we are able to use a constant step-size for both actor and critic steps.
Here, the overall communication cost is measured by the number of communication rounds rather
than the size of bits transmitted over the network. We follow the standard deﬁnition of communi-
cation complexity in the literature, which is widely adopted in the literature, see (Chen et al., 2018)
(Zhang et al., 2019). However, we note that tgossip, actor step batch size B and critic iteration rounds
Kc, scale with O(log 1/ǫ), O(1/ǫ) and O(log 1/ǫ) respectively as indicated in the Theorem 3 and
2. The amount of information (in terms of bits) is (KcNK + BNtgossip)T = O( N"
THEORETICAL CONVERGENCE ANALYSIS,0.2755267423014587,ǫ2 log N ǫ ).
EXPERIMENTAL RESULTS,0.2771474878444084,"6
EXPERIMENTAL RESULTS"
EXPERIMENTAL RESULTS,0.2787682333873582,"In this section, we conduct experiments to compare our proposed consensus-based TD-sharing
MARL algorithm with the most related MARL algorithm 1 in Zhang et al. (2018) that also stud-
ied average reward. To our knowledge, this is the only work that is directly comparable to ours. The
key difference is that the knowledge of joint action is assumed in Zhang et al. (2018), but not in our
work. We vary the system size from N = 6, 10 to 15. The blue curve is our TD-sharing algorithm
and the red curve is classical MARL algorithm in Zhang et al. (2018). The curves represent the
average results of 10 trials and the 95% conﬁdence intervals are also plotted. For the details, see A.1
in Appendix. The results in Figure 1 show that for different system sizes, both algorithms converge
to a reasonable objective value. Note that if we use uniformly random policy as the baseline policy,
then the objective values will be around 2 due to the setting of our experiments. All simulation
results are above this threshold and our TD-sharing algorithm converge to a better objective value.
See Section A.2 for addition experiment results."
CONCLUSION AND DISCUSSION,0.28038897893030795,"7
CONCLUSION AND DISCUSSION"
CONCLUSION AND DISCUSSION,0.2820097244732577,"In this paper, we studied fully decentralized MARL in average reward setting and proposed a
batch-sampled actor-critic algorithm. Our main contribution is to establish the ﬁrst ﬁnite time con-
vergence result for fully decentralized MARL in average reward setting, where the complexity is
O(ǫ−2 log(ǫ−1)), which matches that of the state-of-the-art single agent RL. The algorithm reaches
such convergence with a better communication efﬁciency. However, it is still in the preliminary
stage of the convergence analysis of the MARL since we only used the vanilla average. The future
direction will be how to design a more scalable algorithm in terms of system size."
CONCLUSION AND DISCUSSION,0.28363047001620745,Published as a conference paper at ICLR 2022
CONCLUSION AND DISCUSSION,0.2852512155591572,ACKNOWLEDGMENTS
CONCLUSION AND DISCUSSION,0.28687196110210694,"Hairi and Jia Liu’s work has been supported in part by NSF grants CAREER CNS-2110259, CNS-
2112471, CNS-2102233, CCF-2110252, and a Google Faculty Research Award."
REFERENCES,0.2884927066450567,REFERENCES
REFERENCES,0.2901134521880065,"Rajendra Bhatia. Matrix analysis, volume 169 of. Graduate texts in mathematics, 1997."
REFERENCES,0.2917341977309562,"Tianyi Chen, Georgios B Giannakis, Tao Sun, and Wotao Yin. Lag: Lazily aggregated gradient for
communication-efﬁcient distributed learning. arXiv preprint arXiv:1805.09965, 2018."
REFERENCES,0.293354943273906,"Ziyi Chen, Yi Zhou, Rongrong Chen, and Shaofeng Zou. Sample and communication-efﬁcient
decentralized actor-critic algorithms with ﬁnite-time analysis. arXiv preprint arXiv:2109.03699,
2021."
REFERENCES,0.29497568881685576,"Thinh Doan, Siva Maguluri, and Justin Romberg. Finite-time analysis of distributed td (0) with linear
function approximation on multi-agent reinforcement learning. In International Conference on
Machine Learning, pp. 1626–1635. PMLR, 2019."
REFERENCES,0.2965964343598055,"Jakob Foerster, Gregory Farquhar, Triantafyllos Afouras, Nantas Nardelli, and Shimon Whiteson.
Counterfactual multi-agent policy gradients. In Proceedings of the AAAI Conference on Artiﬁcial
Intelligence, volume 32, 2018."
REFERENCES,0.29821717990275526,"Zuyue Fu, Zhuoran Yang, and Zhaoran Wang. Single-timescale actor-critic provably ﬁnds globally
optimal policy. arXiv preprint arXiv:2008.00483, 2020."
REFERENCES,0.29983792544570503,"Xin Guo, Anran Hu, and Junzi Zhang. Theoretical guarantees of ﬁctitious discount algorithms
for episodic reinforcement learning and global convergence of policy gradient methods. arXiv
preprint arXiv:2109.06362, 2021."
REFERENCES,0.3014586709886548,"Sham Machandranath Kakade. On the sample complexity of reinforcement learning. University of
London, University College London (United Kingdom), 2003."
REFERENCES,0.30307941653160453,"Donghwan Lee, Niao He, Parameswaran Kamalaruban, and Volkan Cevher. Optimization for rein-
forcement learning: From a single agent to cooperative agents. IEEE Signal Processing Magazine,
37(3):123–135, 2020."
REFERENCES,0.3047001620745543,"David A Levin and Yuval Peres. Markov chains and mixing times, volume 107. American Mathe-
matical Soc., 2017."
REFERENCES,0.3063209076175041,"Angelia Nedic and Asuman Ozdaglar. Distributed subgradient methods for multi-agent optimiza-
tion. IEEE Transactions on Automatic Control, 54(1):48–61, 2009."
REFERENCES,0.3079416531604538,"Shuang Qiu, Zhuoran Yang, Jieping Ye, and Zhaoran Wang. On ﬁnite-time convergence of actor-
critic algorithm. IEEE Journal on Selected Areas in Information Theory, 2(2):652–664, 2021."
REFERENCES,0.3095623987034036,"Martin Riedmiller, Andrew Moore, and Jeff Schneider. Reinforcement learning for cooperating and
communicating reactive agents in electrical power grids. In Workshop on Balancing Reactivity
and Social Deliberation in Multi-Agent Systems, pp. 137–149. Springer, 2000."
REFERENCES,0.31118314424635335,"Shai Shalev-Shwartz, Shaked Shammah, and Amnon Shashua. Safe, multi-agent, reinforcement
learning for autonomous driving. arXiv preprint arXiv:1610.03295, 2016."
REFERENCES,0.31280388978930307,"David Silver, Thomas Hubert, Julian Schrittwieser, Ioannis Antonoglou, Matthew Lai, Arthur Guez,
Marc Lanctot, Laurent Sifre, Dharshan Kumaran, Thore Graepel, et al. A general reinforcement
learning algorithm that masters chess, shogi, and go through self-play. Science, 362(6419):1140–
1144, 2018."
REFERENCES,0.31442463533225284,"John N Tsitsiklis and Benjamin Van Roy. Average cost temporal-difference learning. Automatica,
35(11):1799–1808, 1999."
REFERENCES,0.3160453808752026,"John N Tsitsiklis and Benjamin Van Roy. On average versus discounted reward temporal-difference
learning. Machine Learning, 49(2):179–191, 2002."
REFERENCES,0.31766612641815234,Published as a conference paper at ICLR 2022
REFERENCES,0.3192868719611021,"Yue Wu, Weitong Zhang, Pan Xu, and Quanquan Gu. A ﬁnite time analysis of two time-scale actor
critic methods. arXiv preprint arXiv:2005.01350, 2020."
REFERENCES,0.3209076175040519,"Tengyu Xu, Zhe Wang, and Yingbin Liang. Improving sample complexity bounds for (natural)
actor-critic algorithms. arXiv preprint arXiv:2004.12956, 2020."
REFERENCES,0.3225283630470016,"Zhuoran Yang, Yongxin Chen, Mingyi Hong, and Zhaoran Wang.
On the global conver-
gence of actor-critic: A case for linear quadratic regulator with ergodic cost.
arXiv preprint
arXiv:1907.06246, 2019."
REFERENCES,0.3241491085899514,"Chao Yu, Xin Wang, Xin Xu, Minjie Zhang, Hongwei Ge, Jiankang Ren, Liang Sun, Bingcai Chen,
and Guozhen Tan. Distributed multiagent coordinated learning for autonomous driving in high-
ways based on dynamic coordination graphs. IEEE Transactions on Intelligent Transportation
Systems, 21(2):735–748, 2019."
REFERENCES,0.32576985413290116,"Kaiqing Zhang, Zhuoran Yang, Han Liu, Tong Zhang, and Tamer Basar. Fully decentralized multi-
agent reinforcement learning with networked agents. In International Conference on Machine
Learning, pp. 5872–5881. PMLR, 2018."
REFERENCES,0.3273905996758509,"Kaiqing Zhang, Zhuoran Yang, and Tamer Bas¸ar. Multi-agent reinforcement learning: A selective
overview of theories and algorithms. Handbook of Reinforcement Learning and Control, pp.
321–384, 2021a."
REFERENCES,0.32901134521880065,"Xin Zhang, Jia Liu, Zhengyuan Zhu, and Elizabeth S Bentley. Compressed distributed gradient
descent: Communication-efﬁcient consensus over networks. In IEEE INFOCOM 2019-IEEE
Conference on Computer Communications, pp. 2431–2439. IEEE, 2019."
REFERENCES,0.33063209076175043,"Xin Zhang, Zhuqing Liu, Jia Liu, Zhengyuan Zhu, and Songtao Lu. Taming communication and
sample complexities in decentralized policy evaluation for cooperative multi-agent reinforcement
learning. In Advances Neural Information Processing Systems (NeurIPS), Virtual Event, Decem-
ber 2021b."
REFERENCES,0.33225283630470015,"A
APPENDIX"
REFERENCES,0.3338735818476499,"In this section, we provide lemmas that lead to the proof of both Theorem 2 and Theorem 3."
REFERENCES,0.3354943273905997,"In this paper, we use || · || for 2-norm and || · ||T V for total variance norm. ⟨·, ·⟩denotes the inner
product. Superscript i in quantity x, i.e. xi, denotes the x quantity correspond to agent i ∈N.
λ(·) and σ(·) denote the eigenvalues and singular values of the corresponding matrix respectively.
All vectors are assumed to be column vector, unless speciﬁed. (·)T is the transpose of an matrix or
vector. We use 1 to denote all-1 vector with a proper dimension. For a matrix A, [A]i represents
the i-th row of matrix A. Let ⃗δ = [δ1, · · · , δN]T , i.e. the column vector for local TD-errors. In
comparison, δ denotes the scalar global TD-error, i.e. δ = 1 N
P"
REFERENCES,0.3371150729335494,i∈N δi.
REFERENCES,0.3387358184764992,"First, we explain the detail of our experiment setup."
REFERENCES,0.34035656401944897,"A.1
EXPERIMENT SETUP"
REFERENCES,0.3419773095623987,"We considered the same setting as in the Section 6.1 of Zhang et al. (2018). There are N agents,
each has a binary-valued action space, i.e. Ai = {0, 1}, for all i ∈N. In addition, in all the results
shown here, we set |S| = 5 states. The elements in the transition matrix are uniformly sampled from
the interval [0, 1] and normalized to be stochastic. We also added 10−5 onto each element to ensure
ergodicity of the MDP such that the Assumption 1 is satisﬁed. For each agent i and state action pair
(s, a), the mean reward Ri(s, a) is sampled uniformly from [0, 4]. The instantaneous rewards ri
t are
sampled from the uniform distribution [Ri(s, a) −0.5, Ri(s, a) + 0.5]. The policy is parameterized
following the Bolzmann policies, i.e.,"
REFERENCES,0.34359805510534847,"πi
θi(s, ai) =
exp(qT
s,aiθi)
P"
REFERENCES,0.34521880064829824,"bi∈Ai exp(qT
s,biθi)"
REFERENCES,0.34683954619124796,Published as a conference paper at ICLR 2022
REFERENCES,0.34846029173419774,"where qT
s,bi is the feature vector with the same dimension as θi, for all s ∈S and i ∈N. Here,
we set m1 = · · · = mN = 5. The elements of qs,bi are uniformly sampled from [0, 1e3]. We set
the dimension for state features K = 3. The feature matrix Φ are insured to have full column. The
stepsizes for classical MARL are set as βw,t =
1
t0.51 and βθ,t =
1
t0.52 . The network matrix as chosen
as a ring network with diagonal elements being 0.4 and off diagonal elements 0.3 ."
REFERENCES,0.3500810372771475,"For our algorithm, we used step-sizes α = 1 and β = 0.1. The batch sizes are B = 10, M = 10
and the critic iterations are 10 and actor iterations are T = 100."
REFERENCES,0.35170178282009723,"A.2
ADDITIONAL EXPERIMENT RESULTS"
REFERENCES,0.353322528363047,"We have modiﬁed classical MARL into i)constant stepsize MARL, ii)batch MARL and iii)batch
constant stepsize MARL. For classical MARL and batch MARL, we chose the stepsizes as βw =
1
t0.65 and βθ =
1
t0.85 as in the paper (Zhang et al., 2018), and for the constant steptize MARL and
batch constant stepsize MARL, we chose stepsizes to be βw = 0.9 and βθ = 0.01. For batch MARL
and batch constant stepsize MARL, we used batch size as 10. Other parameters are the same as in
the A.1. We vary the system sizes from N = 5 to N = 15 and the empirical comparison results are
in Figure 2 (a)-(c). In addition, we provide the comparison between average reward setting with the
discounted counterpart of our algorithms for discounting factors ranging from γ = 0.1 to γ = 0.999.
As we can see from Figure 2 (a)-(c), our TD-sharing algorithm performs well compared to the base-
line algorithms. Among the modiﬁed algorithms, batch constant stepsize MARL shows improve-
ment compared to the classical MARL in all three cases. Moreover in (b) and (c), when system size
is larger, speciﬁcally N = 10 and N = 15, either batch modiﬁcation or constant stepsize modiﬁ-
cation seem to improve the classical MARL. Yet in (a), for smaller system size, i.e. N = 5, only
modifying to the batch size or constant stepsizes don’t seem to improve the performance.
In addition, in (d), for discounted setting, as γ increases and gets closer to 1, the objective value
is closer to the average reward setting. It is because as the discounting factor approaches 1, the
effective horizon, which scales with O( log ǫ−1"
REFERENCES,0.3549432739059968,"1−γ ) (Kakade, 2003), to an ǫ close stationary point gets
larger and larger. As a result, it will get closer to the average reward setting. However, we can see
average setting value converges to a signiﬁcantly higher value. More importantly, one advantage
of the average reward setting is that with more samples, the policies can potentially keep updating
and so is the objective value. From Figure 2(d), we can see that as the number of sample increases,
the average reward setting objective value still evolves, which means the policies are keep updating.
However, for the discounted reward case, the extra sample doesn’t affect the objective value."
REFERENCES,0.3565640194489465,"In Figure 3, we have shown the results of different network structures on the performance when
system size is 10. We compared the ring network, small world network and 2-regular network. The
small world network is generated with mean node degrees being 4 and rewiring probability being
0.2. The entries of matrix A, for both small world network and regular network, are set as the way
discussed after Assumption 3. Different network structures exhibit different performances, but all
are better than baseline value 2. Among these three structures, within given sample numbers, ring
network yields the best result."
REFERENCES,0.3581847649918963,"A.3
SUPPORTING LEMMAS FOR THEOREM 2"
REFERENCES,0.35980551053484605,"Because of the Assumption 1, by (Levin & Peres, 2017, Theorem 4.9), for aperiodic and irreducible
Makrov chains, we can guarantee the following lemma holds:"
REFERENCES,0.36142625607779577,"Lemma 1. For any policy parameter θ ∈R
P
i∈N mi, consider the MDP with policy πθ and transi-
tion kernel P(·|s, a). Let dθ be the stationary distribution of the MDP. There exist constants κ > 0
and ρ ∈(0, 1) such that sups∈S ||P(st|s0 = s) −dθ||T V ≤κρt,
∀t ≥0."
REFERENCES,0.36304700162074555,"This lemma has been adopted directly as an assumption in many related works in theoretical analysis
of RL (Xu et al., 2020; Chen et al., 2021; Qiu et al., 2021)."
REFERENCES,0.3646677471636953,"As a result of the Lemma 1, the Markov chain of state-action pair {st, at}t≥0 for policy πθ also has
the property of ergodicity. We state this result as the following lemma."
REFERENCES,0.36628849270664504,Published as a conference paper at ICLR 2022
REFERENCES,0.3679092382495948,"(a) N = 5
(b) N = 10"
REFERENCES,0.3695299837925446,(c) N = 15
REFERENCES,0.3711507293354943,"0
1
2
3
4
5
6
Sample Number
105 0 0.5 1 1.5 2 2.5 J( )"
REFERENCES,0.3727714748784441,"TD-sharing MARL
Discounted Counterpart with 
=0.1
Discounted Counterpart with 
=0.5
Discounted Counterpart with 
=0.9
Discounted Counterpart with 
=0.99
Discounted Counterpart with 
=0.999"
REFERENCES,0.37439222042139386,(d) average vs discounted
REFERENCES,0.3760129659643436,Figure 2: The empirical comparisons of algorithms
REFERENCES,0.37763371150729336,"0
1
2
3
4
5
6
Sample Number
105 1.9 1.95 2 2.05 2.1 2.15 2.2 2.25 J( )"
REFERENCES,0.37925445705024313,"Ring Network
Small World Network
Regular Network"
REFERENCES,0.38087520259319285,Figure 3: Different Network Structures on Performance When N = 10
REFERENCES,0.3824959481361426,Published as a conference paper at ICLR 2022
REFERENCES,0.3841166936790924,"Lemma 2. Suppose the Assumption 1 hold, let νθ be the stationary distribution of the state-action
pair MDP. Then, we have"
REFERENCES,0.3857374392220421,"sup
s∈S
||P(st, at|s0 = s) −νθ||T V ≤κρt,
∀t ≥0.
(10)"
REFERENCES,0.3873581847649919,"Proof. For any given s0 ∈S, by deﬁnition, we have"
REFERENCES,0.3889789303079417,"||P(st, at|s0) −νθ||T V = 1 2 X"
REFERENCES,0.3905996758508914,"(s,a)∈S×A
|P(st = s, at = a|s0) −νθ(s, a)| = 1 2 X"
REFERENCES,0.39222042139384117,"(s,a)∈S×A
|P(st = s|s0)πθ(at = a|st = s) −νs
θ(s)πθ(a|s)| = 1 2 X"
REFERENCES,0.39384116693679094,"(s,a)∈S×A
|(P(st = s|s0) −νs
θ(s))πθ(a|s)| = 1 2 X"
REFERENCES,0.39546191247974066,"(s,a)∈S×A
πθ(a|s)|P(st = s|s0) −νs
θ(s)| = 1 2 X"
REFERENCES,0.39708265802269044,"s∈S
|P(st = s|s0) −νs
θ(s)|"
REFERENCES,0.3987034035656402,"= ||P(st|s0) −νs
θ||T V ≤κρt."
REFERENCES,0.40032414910858993,"Since it holds for all s0 ∈S, equation 10 holds."
REFERENCES,0.4019448946515397,"As a result of Assumption 5, we have the following lemmas."
REFERENCES,0.4035656401944895,"Lemma 3. For all policy πθ, we have"
REFERENCES,0.4051863857374392,"⟨w, Aπθw⟩≤−λA"
REFERENCES,0.406807131280389,"2 ||w||2
(11)"
REFERENCES,0.40842787682333875,where λA is deﬁned in Assumption 5.
REFERENCES,0.4100486223662885,"Proof. Because of the fact wT Aπθw = wT AT
πθw, we have"
REFERENCES,0.41166936790923825,wT Aπθw = 1
REFERENCES,0.413290113452188,"2(wT Aπθw + wT AT
πθw) = 1"
REFERENCES,0.41491085899513774,"2wT (Aπθ + AT
πθ)w ≤−λA"
REFERENCES,0.4165316045380875,2 wT w = −λA
REFERENCES,0.4181523500810373,"2 ||w||2.
(12)"
REFERENCES,0.419773095623987,"In fact, interestingly enough, the Assumption 5 and Lemma 3 are equivalent in a sense that if the
statement in the Lemma 3 is taken as the assumption, the statement in the Assumption 5 can be
obtained as a result. And the paper (Xu et al., 2020) used the statement in the Lemma 3 as an
assumption, whereas in ours and (Qiu et al., 2021), we assumed Assumption 5."
REFERENCES,0.4213938411669368,"Lemma 4. For any given policy πθ, the corresponding optimal value function approximation pa-
rameter w∗
θ is uniformly bounded, speciﬁcally, there exists Rw := 4rmax"
REFERENCES,0.42301458670988656,"λA
> 0 such that"
REFERENCES,0.4246353322528363,"||w∗
θ|| ≤Rw.
(13)"
REFERENCES,0.42625607779578606,"Proof. It’s easy to see that J(θ) ≤rmax from equation 2 and ¯r(s, a) ≤rmax for any (s, a) pair.
Then, we have"
REFERENCES,0.42787682333873583,"||w∗
θ|| = || −A−1
πθ bπθ||"
REFERENCES,0.42949756888168555,Published as a conference paper at ICLR 2022
REFERENCES,0.43111831442463533,"= || −
 
Es∼dθ(s),s′∼P (·|s)[(φ(s′) −φ(s))φT (s)]
−1 · Es∼dθ,a∼πθ[φ(s)(¯r(s, a) −J(θ))]||"
REFERENCES,0.4327390599675851,"≤|| −
 
Es∼dθ(s),s′∼P (·|s)[(φ(s′) −φ(s))φT (s)]
−1 || · ||Es∼dθ,a∼πθ[φ(s)(¯r(s, a) −J(θ))]||"
REFERENCES,0.4343598055105348,"=
1
σmin
 
−Es∼dθ(s),s′∼P (·|s)[(φ(s′) −φ(s))φT (s)]
 · ||Es∼dθ,a∼πθ[φ(s)(¯r(s, a) −J(θ))]||"
REFERENCES,0.4359805510534846,"≤2||Es∼dθ,a∼πθ[φ(s)(¯r(s, a) −J(θ))]||"
REFERENCES,0.4376012965964344,λmin(−Aπθ −ATπθ)
REFERENCES,0.4392220421393841,"≤2Es∼dθ,a∼πθ[||φ(s)|| · (|¯r(s, a)| + |J(θ)|)]"
REFERENCES,0.44084278768233387,"λ
= 4rmax λA"
REFERENCES,0.44246353322528365,"where the third equality used the fact ||A−1|| =
1
σmin(A) and the second from the last inequality is
from Bhatia (1997) (Proposition III 5.1) ."
REFERENCES,0.44408427876823336,"Note that, for agent i ∈N, the estimated long term average reward µi
k,τ at sample τ of iteration k
in equation 5 can be written as"
REFERENCES,0.44570502431118314,"µi
k,τ = β τ
X"
REFERENCES,0.4473257698541329,"l=1
(1 −β)τ−lri
k,l + (1 −β)τµi
0.
(14)"
REFERENCES,0.44894651539708263,"Lemma 5. For any i ∈N and t ≥0, step size 0 < β < 1, for the estimated long term average
reward for agent i, we have"
REFERENCES,0.4505672609400324,"µi
t+1 = (1 −β)µi
t + βri
t
(15)"
REFERENCES,0.4521880064829822,"is bounded by rmax, i.e. |µi
t+1| ≤rmax."
REFERENCES,0.4538087520259319,"Proof. WLOG, we suppose that 0 < µi
0 ≤rmax, we have"
REFERENCES,0.4554294975688817,"|µi
t+1| = |(1 −β)µi
t + βri
t|"
REFERENCES,0.45705024311183146,"≤(1 −β)|µi
t| + β|ri
t|.
(16)"
REFERENCES,0.4586709886547812,"By the supposition, we have |µi
0| ≤rmax. We assume |µi
t| ≤rmax holds for iteration t > 0, then
for t + 1, by equation 16"
REFERENCES,0.46029173419773095,"|µi
t+1| ≤(1 −β)|µi
t| + β|ri
t| ≤(1 −β)rmax + βrmax = rmax."
REFERENCES,0.4619124797406807,"Therefore, Lemma 5 holds by mathematical induction."
REFERENCES,0.46353322528363045,"For a given policy πθ, to establish a bound on the difference between the optimal approximation
parameter w∗
θ, we ﬁrst derive a bound the difference between parameter wi
k and the average among
all agents ¯wk at time k. Then, we derive a bound for the difference between average ¯wk and the
optimal w∗
θ."
REFERENCES,0.4651539708265802,"We have following notations for the analysis. Given an agent i ∈N, we consider the consensus
error at time k and we denote Qi
k = wi
k −¯wk, where ¯wk :=
1
N
P"
REFERENCES,0.46677471636953,"i∈N wi
k. Then, we denote the
matrix form as Qk = [Q1
k, · · · , QN
k ] ∈RK×N Then, we have the following lemma.
Lemma 6. Suppose the Assumption 2 and 3 hold. For the consensus error matrix, we have"
REFERENCES,0.4683954619124797,"||Qk+1|| ≤κ1N 2γk||Q0|| + κ′
2N 3β
(17)"
REFERENCES,0.4700162074554295,"where γ := (1 −ηN−1) · (1 + 2β) < 1, κ1 = 2(1 + 2β)(1 + η−(N−1)) and κ′
2 = 4(1+η−(N−1))rmax 1−γ
."
REFERENCES,0.47163695299837927,"Proof. By equation 7, the parameter update ˜wi
k for agent i at iteration k can be written as follows"
REFERENCES,0.473257698541329,"˜wi
k = wi
k + β M M
X"
REFERENCES,0.47487844408427876,"τ=0
δi
k,τ · φ(sk,τ)"
REFERENCES,0.47649918962722854,"= wi
k + β M M−1
X"
REFERENCES,0.47811993517017826,"τ=0
[ri
k,τ+1 −β τ
X"
REFERENCES,0.47974068071312803,"l=1
(1 −β)τ−lri
k,l −(1 −β)τµi
0"
REFERENCES,0.4813614262560778,Published as a conference paper at ICLR 2022
REFERENCES,0.4829821717990275,"+ φ(sk,τ+1)T wi
k −φ(sk,τ)T wi
k] · φ(sk,τ)"
REFERENCES,0.4846029173419773,"= wi
k + β M M−1
X"
REFERENCES,0.4862236628849271,"τ=0
φ(sk,τ)[φ(sk,τ+1) −φ(sk,τ)]T wi
k + β M M−1
X"
REFERENCES,0.4878444084278768,"τ=0
(ri
k,τ+1 −β τ
X"
REFERENCES,0.48946515397082657,"l=1
(1 −β)τ−lri
k,l −(1 −β)τµi
0)φ(sk,τ).
(18)"
REFERENCES,0.49108589951377635,"After a consensus step, the update will be"
REFERENCES,0.49270664505672607,"wi
k+1 =
X"
REFERENCES,0.49432739059967584,"j∈Ni
A(i, j) · ˜wj
k =
X"
REFERENCES,0.4959481361426256,"j∈Ni
A(i, j) · [wj
k + β M M−1
X"
REFERENCES,0.49756888168557534,"τ=0
φ(sk,τ)[φ(sk,τ+1) −φ(sk,τ)]T wj
k + β M M−1
X"
REFERENCES,0.4991896272285251,"τ=0
(rj
k,τ+1 −β τ
X"
REFERENCES,0.5008103727714749,"l=1
(1 −β)τ−lrj
k,l −(1 −β)τµj
0)φ(sk,τ)] =
X"
REFERENCES,0.5024311183144247,"j∈Ni
A(i, j) · wj
k + β M M−1
X"
REFERENCES,0.5040518638573744,"τ=0
φ(sk,τ)[φ(sk,τ+1) −φ(sk,τ)]T X"
REFERENCES,0.5056726094003241,"j∈Ni
A(i, j) · wj
k + β M M−1
X"
REFERENCES,0.5072933549432739,"τ=0
φ(sk,τ)
X"
REFERENCES,0.5089141004862237,"j∈Ni
A(i, j) · (rj
k,τ+1 −β τ
X"
REFERENCES,0.5105348460291734,"l=1
(1 −β)τ−lrj
k,l −(1 −β)τµj
0)"
REFERENCES,0.5121555915721232,"= wk · (Ai,:)T + β M M−1
X"
REFERENCES,0.513776337115073,"τ=0
φ(sk,τ)[φ(sk,τ+1) −φ(sk,τ)]T wk · (Ai,:)T + β M M−1
X"
REFERENCES,0.5153970826580226,"τ=0
φ(sk,τ)Ai,:(rk,τ+1 −β τ
X"
REFERENCES,0.5170178282009724,"l=1
(1 −β)τ−lrk,l −(1 −β)τµ0)
(19)"
REFERENCES,0.5186385737439222,"where wk = [w1
k, w2
k, · · · , wN
k ] ∈RK×N is the matrix form of all parameters at time k, Ai,: is
the i-th row of matrix A and rk,l = (r1
k,l, · · · , rN
k,l). Now we consider the average dynamics of the
algorithm. Recall ¯wk = 1 N
P"
REFERENCES,0.520259319286872,"i∈N wi
k, then using equation 19 we have"
REFERENCES,0.5218800648298217,¯wk+1 = 1 N X
REFERENCES,0.5235008103727715,"i∈N
wi
k+1 = 1 N X i∈N "
REFERENCES,0.5251215559157212,"wk · (Ai,:)T + β M M−1
X"
REFERENCES,0.526742301458671,"τ=0
φ(sk,τ)[φ(sk,τ+1) −φ(sk,τ)]T wk · (Ai,:)T + β M M−1
X"
REFERENCES,0.5283630470016207,"τ=0
φ(sk,τ)Ai,:(rk,τ+1 −β τ
X"
REFERENCES,0.5299837925445705,"l=1
(1 −β)τ−lrk,l −(1 −β)τµ0) ! = 1"
REFERENCES,0.5316045380875203,"N wk · 1 + β M M−1
X"
REFERENCES,0.5332252836304701,"τ=0
φ(sk,τ)[φ(sk,τ+1) −φ(sk,τ)]T 1"
REFERENCES,0.5348460291734197,"N wk · 1 + β M M−1
X"
REFERENCES,0.5364667747163695,"τ=0
φ(sk,τ) 1 N X"
REFERENCES,0.5380875202593193,"i∈N
Ai,:(rk,τ+1 −β τ
X"
REFERENCES,0.539708265802269,"l=1
(1 −β)τ−lrk,l −(1 −β)τµ0)"
REFERENCES,0.5413290113452188,"= ¯wk + β M M−1
X"
REFERENCES,0.5429497568881686,"τ=0
φ(sk,τ)[φ(sk,τ+1) −φ(sk,τ)]T ¯wk + β M M−1
X"
REFERENCES,0.5445705024311183,"τ=0
φ(sk,τ) 1"
REFERENCES,0.546191247974068,"N 1T (rk,τ+1 −β τ
X"
REFERENCES,0.5478119935170178,"l=1
(1 −β)τ−lrk,l −(1 −β)τµ0)"
REFERENCES,0.5494327390599676,Published as a conference paper at ICLR 2022
REFERENCES,0.5510534846029174,"= ¯wk + β M M−1
X"
REFERENCES,0.5526742301458671,"τ=0
φ(sk,τ)[φ(sk,τ+1) −φ(sk,τ)]T ¯wk + β M M−1
X"
REFERENCES,0.5542949756888168,"τ=0
φ(sk,τ)(¯rk,τ+1 −β τ
X"
REFERENCES,0.5559157212317666,"l=1
(1 −β)τ−l¯rk,l −(1 −β)τµ0)
(20)"
REFERENCES,0.5575364667747164,"where ¯rk,l = 1 N
P"
REFERENCES,0.5591572123176661,"i∈N ri
k,l."
REFERENCES,0.5607779578606159,"Given an agent i ∈N, we consider the consensus error at time k and recall Qi
k = wi
k −¯wk. Then,
we have"
REFERENCES,0.5623987034035657,"Qi
k+1 =wi
k+1 −¯wk+1"
REFERENCES,0.5640194489465153,"=wk · (Ai,:)T −¯wk + β M M−1
X"
REFERENCES,0.5656401944894651,"τ=0
φ(sk,τ)[φ(sk,τ+1) −φ(sk,τ)]T (wk · (Ai,:)T −¯wk) + β M M−1
X"
REFERENCES,0.5672609400324149,"τ=0
φ(sk,τ)(Ai,: −1"
REFERENCES,0.5688816855753647,"N 1T )(rk,τ+1 −β τ
X"
REFERENCES,0.5705024311183144,"l=1
(1 −β)τ−lrk,l −(1 −β)τµ0).
(21)"
REFERENCES,0.5721231766612642,"Then, for the matrix form Qk = [Q1
k, · · · , QN
k ] ∈RK×N, we have"
REFERENCES,0.5737439222042139,"Qk+1 =QkAT + β M M−1
X"
REFERENCES,0.5753646677471637,"τ=0
φ(sk,τ)[φ(sk,τ+1) −φ(sk,τ)]T QkAT + β M M−1
X"
REFERENCES,0.5769854132901134,"τ=0
φ(sk,τ)[(A −1"
REFERENCES,0.5786061588330632,"N 11T )(rk,τ+1 −β τ
X"
REFERENCES,0.580226904376013,"l=1
(1 −β)τ−lrk,l −(1 −β)τµ0)]T"
REFERENCES,0.5818476499189628,"=QkAT + β M M−1
X"
REFERENCES,0.5834683954619124,"τ=0
φ(sk,τ)[φ(sk,τ+1) −φ(sk,τ)]T QkAT + β M M−1
X"
REFERENCES,0.5850891410048622,"τ=0
φ(sk,τ)[rk,τ+1 −β τ
X"
REFERENCES,0.586709886547812,"l=1
(1 −β)τ−lrk,l −(1 −β)τµ0]T (A −1"
REFERENCES,0.5883306320907618,N 11T ) (22)
REFERENCES,0.5899513776337115,"where the ﬁrst equality is due to A being doubly stochastic.
For convenience, denote Bk =
1
M
PM−1
τ=0 φ(sk,τ)[φ(sk,τ+1) −φ(sk,τ)]T and Ck =
1
M
PM−1
τ=0 φ(sk,τ)[rk,τ+1 −β Pτ
l=1(1 −
β)τ−lrk,l −(1 −β)τµ0]T . Then, iteratively we have"
REFERENCES,0.5915721231766613,Qk+1 =(I + βBk)QkAT + βCk(A −1
REFERENCES,0.593192868719611,"N 11T ) = k
Y"
REFERENCES,0.5948136142625607,"t=0
(I + βBt)Q0(AT )k+1 + β k
X t=0 k
Y"
REFERENCES,0.5964343598055105,"˜t>t
(I + βB˜t)Ct(A −1"
REFERENCES,0.5980551053484603,"N 11T )Ak−t
(23)"
REFERENCES,0.5996758508914101,"Then, the norm of the consensus error is following"
REFERENCES,0.6012965964343598,"||Qk+1|| =|| k
Y"
REFERENCES,0.6029173419773096,"t=0
(I + βBt)Q0(AT )k+1 + β k
X t=0 k
Y"
REFERENCES,0.6045380875202593,"˜t>t
(I + βB˜t)Ct(A −1"
REFERENCES,0.6061588330632091,"N 11T )Ak−t|| ≤|| k
Y"
REFERENCES,0.6077795786061588,"t=0
(I + βBt)|| · ||Q0(AT )k+1|| + β k
X t=0 k
Y"
REFERENCES,0.6094003241491086,"˜t>t
||(I + βB˜t)|| · ||Ct|| · ||(A −1"
REFERENCES,0.6110210696920584,N 11T )Ak−t||. (24)
REFERENCES,0.6126418152350082,"Note that since A is doubly stochastic, so is AT . Let (AT )k+1
:,i
be the i-th column of matrix (AT )k+1.
From Nedic & Ozdaglar (2009), we know that"
REFERENCES,0.6142625607779578,"||Q0(AT )k+1
:,i || = ||Q0(AT )k+1
:,i
−Q0
1
N 1||"
REFERENCES,0.6158833063209076,Published as a conference paper at ICLR 2022
REFERENCES,0.6175040518638574,"= ||
X"
REFERENCES,0.6191247974068071,"j∈N
((AT )k+1
j,i
−1"
REFERENCES,0.6207455429497569,"N )Qj
0|| ≤
X"
REFERENCES,0.6223662884927067,"j∈N
|(AT )k+1
j,i
−1"
REFERENCES,0.6239870340356564,"N | · ||Qj
0||"
REFERENCES,0.6256077795786061,≤N · 21 + η−(N−1)
REFERENCES,0.6272285251215559,"1 −ηN−1 (1 −ηN−1)k+1 · max
j∈N ||Qj
0||"
REFERENCES,0.6288492706645057,"≤2N(1 + η−(N−1))(1 −ηN−1)k · ||Q0||.
(25)"
REFERENCES,0.6304700162074555,"Hence, ||Q0Ak+1|| ≤2N 2(1 + η−(N−1))(1 −ηN−1)k · ||Q0||. To bound the ﬁrst term in the RHS
of equation 24, we have || k
Y"
REFERENCES,0.6320907617504052,"t=0
(I + βBt)|| ≤ k
Y"
REFERENCES,0.6337115072933549,"t=0
||I + βBt|| ≤ k
Y"
REFERENCES,0.6353322528363047,"t=0
(||I|| + β||Bt||) ≤ k
Y"
REFERENCES,0.6369529983792545,"t=0
(1 + 2β) = (1 + 2β)k+1.
(26)"
REFERENCES,0.6385737439222042,"In order to make sure it converges to the neighborhood of a consensus in the limit, the step size has
to satisfy γ := (1 −ηN−1) · (1 + 2β) < 1, which results in β <
ηN−1"
REFERENCES,0.640194489465154,"2(1−ηN−1). Hence, for the ﬁrst
term in the RHS of equation 24, we have || k
Y"
REFERENCES,0.6418152350081038,"t=0
(I + βBt)|| · ||Q0Ak+1|| ≤κ1N 2γk||Q0||"
REFERENCES,0.6434359805510534,where κ1 = 2(1 + 2β)(1 + η−(N−1)).
REFERENCES,0.6450567260940032,"Furthermore, we have"
REFERENCES,0.646677471636953,||(A −1
REFERENCES,0.6482982171799028,N 11T )Ak−t|| = ||Ak−t+1 −1
REFERENCES,0.6499189627228525,"N 11T || ≤2N 2(1 + η−(N−1))(1 −ηN−1)k−t.
(27)"
REFERENCES,0.6515397082658023,"And ||Ct|| ≤2Nrmax, where rmax = supi,s,a ri(s, a). This is because"
REFERENCES,0.653160453808752,"||Ck|| = || 1 M M−1
X"
REFERENCES,0.6547811993517018,"τ=0
φ(sk,τ)[rk,τ+1 −β τ
X"
REFERENCES,0.6564019448946515,"l=1
(1 −β)τ−lrk,l −(1 −β)τµ0]T || ≤1 M M−1
X"
REFERENCES,0.6580226904376013,"τ=0
||φ(sk,τ)[rk,τ+1 −β τ
X"
REFERENCES,0.6596434359805511,"l=1
(1 −β)τ−lrk,l −(1 −β)τµ0]T || ≤1 M M−1
X"
REFERENCES,0.6612641815235009,"τ=0
||φ(sk,τ)|| · ||rk,τ+1 −β τ
X"
REFERENCES,0.6628849270664505,"l=1
(1 −β)τ−lrk,l −(1 −β)τµ0|| ≤1 M M−1
X"
REFERENCES,0.6645056726094003,"τ=0
[||rk,τ+1|| + β τ
X"
REFERENCES,0.6661264181523501,"l=1
(1 −β)τ−l||rk,l|| + (1 −β)τ||µ0||] ≤1 M M−1
X"
REFERENCES,0.6677471636952999,"τ=0
[Nrmax + β 1 −(1 −β)τ"
REFERENCES,0.6693679092382496,1 −(1 −β) Nrmax + (1 −β)τNrmax] = 2Nrmax.
REFERENCES,0.6709886547811994,"Then for the second term of equation 24, we have β k
X t=0 k
Y"
REFERENCES,0.6726094003241491,"˜t>t
||(I + βB˜t)|| · ||Ct|| · ||(A −1"
REFERENCES,0.6742301458670988,N 11T )Ak−t||
REFERENCES,0.6758508914100486,"Published as a conference paper at ICLR 2022 ≤β k
X"
REFERENCES,0.6774716369529984,"t=0
(1 + 2β)k−t · 2Nrmax · 2N 2(1 + η−(N−1))(1 −ηN−1)k−t =κ2β k
X"
REFERENCES,0.6790923824959482,"t=0
γk−t = κ2N 3β 1 −γk+1"
REFERENCES,0.6807131280388979,"1 −γ
(28)"
REFERENCES,0.6823338735818476,"where κ2 = 4(1 + η−(N−1))rmax. Further, for consensus error equation 24, we have"
REFERENCES,0.6839546191247974,||Qk+1|| ≤κ1N 2γk||Q0|| + κ2N 3β 1 −γk+1
REFERENCES,0.6855753646677472,"1 −γ
≤κ1N 2γk||Q0|| + κ′
2N 3β
(29)"
REFERENCES,0.6871961102106969,"where κ′
2 =
κ2
1−γ ."
REFERENCES,0.6888168557536467,"The corresponding average parameter under the policy πθ will converge to the solution to
the following equation w∗
θ
= A−1
θ bθ, where Aθ
= Es∼dθ(s)[φ(s)(φ(s′) −φ(s))T ], bθ
=
E(s,a)∼dθ(s,a)[(¯r(s, a) −J(θ))φ(s)] and ¯r(s, a) = 1"
REFERENCES,0.6904376012965965,"N
P
i∈N ri(s, a)."
REFERENCES,0.6920583468395461,"Now consider || ¯wk −w∗||. Recall the from the average parameter equation equation 20 and the
corresponding ODE is"
REFERENCES,0.6936790923824959,"˙wθ = Aθwθ + bθ.
(30)"
REFERENCES,0.6952998379254457,"For the difference between average dynamics and the optimal value, we have the following lemma."
REFERENCES,0.6969205834683955,Lemma 7. For β ≤min{ λA
REFERENCES,0.6985413290113452,"128,
4
λA } and M ≥( 1"
REFERENCES,0.700162074554295,λA + β) 6144[1+(κ−1)ρ]
REFERENCES,0.7017828200972447,"(1−ρ)λA
, we have"
REFERENCES,0.7034035656401945,"E[|| ¯wK −w∗
θ||2
2] ≤(1 −λA"
REFERENCES,0.7050243111831442,"8 β)K|| ¯w0 −w∗
θ||2
2 + ( 1"
REFERENCES,0.706645056726094,"λA
+ β)1536(4R2
w + r2
max)[1 + (κ −1)ρ]
(1 −ρ)λAM
. (31)"
REFERENCES,0.7082658022690438,"Proof. The proof follows from verifying the Assumption 3 of Xu et al. (2020), then we can apply
the results from Theorem 4 of Xu et al. (2020)."
REFERENCES,0.7098865478119936,"1. For item 1 in the assumption, it’s easy to check that ||Aθ|| ≤CA = 4 by Assumption 4 and
bθ ≤Cb = 2rmax."
REFERENCES,0.7115072933549432,"2. For item 2, it holds because of Lemma 3."
REFERENCES,0.713128038897893,"3. For item 3, it holds because of Lemma 1."
REFERENCES,0.7147487844408428,"And we recall that the bound on ||w∗
θ|| is Rw = 4rmax"
REFERENCES,0.7163695299837926,"λA . Hence, by Theorem 4 of Xu et al. (2020),"
REFERENCES,0.7179902755267423,β ≤min{ λA
REFERENCES,0.7196110210696921,"8C2
A ,
4
λA } and M ≥( 2"
REFERENCES,0.7212317666126418,"λA + 2β) 192C2
A[1+(κ−1)ρ]
(1−ρ)λA
, equation 31 holds."
REFERENCES,0.7228525121555915,"A.4
PROOF OF THEOREM 2"
REFERENCES,0.7244732576985413,"As a result from Lemma 4 and Lemma 7, we provide the following proof for Theorem 2."
REFERENCES,0.7260940032414911,"Proof. Therefore, by equation 17 and equation 31, we have E[ N
X"
REFERENCES,0.7277147487844409,"i=1
||wi
K −w∗
θ||2] ≤2E[ N
X"
REFERENCES,0.7293354943273906,"i=1
||wi
K −¯wK||2] + 2E[ N
X"
REFERENCES,0.7309562398703403,"i=1
|| ¯wK −w∗
θ||2]"
REFERENCES,0.7325769854132901,"≤2||QK||2 + 2NE[|| ¯wK −w∗
θ||2]"
REFERENCES,0.7341977309562399,"≤2(κ1N 2γK||Q0|| + κ′
2N 3β)2 + 2N(1 −λA"
REFERENCES,0.7358184764991896,"8 β)K|| ¯w0 −w∗
θ||2
2"
REFERENCES,0.7374392220421394,Published as a conference paper at ICLR 2022
REFERENCES,0.7390599675850892,+ 2N( 2
REFERENCES,0.7406807131280388,"λA
+ 2β)192(C2
AR2
w + C2
b )[1 + (κ −1)ρ]
(1 −ρ)λAM"
REFERENCES,0.7423014586709886,"≤κ′
1N 4γ2K + κ′′
2N 6β2 + κ3N 5γKβ + 2N(1 −λA"
REFERENCES,0.7439222042139384,"8 β)K|| ¯w0 −w∗
θ||2
2 + κ4 M N"
REFERENCES,0.7455429497568882,"where κ′
1
=
2κ2
1||Q0||2,
κ”2
=
2κ′2
2 ,
κ3
=
4κ1κ′
2||Q0|| and κ4
=
( 1 λA +"
REFERENCES,0.747163695299838,"β) 3072(4R2
w+r2
max)[1+(κ−1)ρ]
(1−ρ)λA
."
REFERENCES,0.7487844408427877,"A.5
PROOF OF THEOREM 3"
REFERENCES,0.7504051863857374,"We use w∗
t to denote the optimal value function parameter under policy θt at time t and
wt = [(w1
t )T , · · · , (wN
t )T ]T
∈RN×K, which is the aggregated function approximation pa-
rameters from Line 2 of Algorithm 2.
Recall the ˜δi
t,l generated by Line 18 of Algorithm 2,
which is the i-th agent’s estimate of the global TD-error from sample l at time t after con-
sensus.
Let vi
t(wt) =
1
B
PB−1
l=0 ˜δi
t,l(wt) · ψi
t,l and vt(wt) = [(v1
t (wt))T , · · · , (vN
t (wt))T ]T ,
hi
t(w∗
t ) =
1
B
PB−1
l=0 δt,l(w∗
t ) · ψi
t,l and ht(w∗
t ) = [(h1
t(w∗
t ))T , · · · , (hN
t (w∗
t ))T ]T , Advw(s, a) =
Es′∼P (·|s,a),r∼dr(s,a)[δw(s, a, s′)|s, a] and gi(w, θ) = E[Advw(s, a)ψθi(s, ai)], where dr(s, a) is
the reward distribution of state-action pair (s, a). By Taylor expansion and the Lipschitz property
from Assumption 6, we have"
REFERENCES,0.7520259319286872,"J(θt+1) ≥J(θt) + ⟨∇θJ(θt), θt+1 −θt⟩−LJ"
REFERENCES,0.7536466774716369,2 ||θt+1 −θt||2
REFERENCES,0.7552674230145867,"= J(θt) + α⟨∇θJ(θt), vt(wt) −∇θJ(θt) + ∇θJ(θt)⟩−LJα2"
REFERENCES,0.7568881685575365,"2
||vt(wt)||2"
REFERENCES,0.7585089141004863,"= J(θt) + α||∇θJ(θt)||2 + α⟨∇θJ(θt), vt(wt) −∇θJ(θt)⟩−LJα2"
REFERENCES,0.7601296596434359,"2
||vt(wt)"
REFERENCES,0.7617504051863857,−∇θJ(θt) + ∇θJ(θt)||2
REFERENCES,0.7633711507293355,≥J(θt) + (1
REFERENCES,0.7649918962722853,2α −LJα2)||∇θJ(θt)||2 −(1
REFERENCES,0.766612641815235,2α + LJα2)||vt(wt) −∇θJ(θt)||2
REFERENCES,0.7682333873581848,where the last inequality is because
REFERENCES,0.7698541329011345,"⟨∇θJ(θt), vt(wt) −∇θJ(θt)⟩≥−1"
REFERENCES,0.7714748784440842,2||∇θJ(θt)||2 −1
REFERENCES,0.773095623987034,"2||vt(wt) −∇θJ(θ)||2, and"
REFERENCES,0.7747163695299838,"||vt(wt) −∇θJ(θt) + ∇θJ(θt)||2 ≤2||vt(wt) −∇θJ(θt)||2 + 2||∇θJ(θt)||2.
(32)"
REFERENCES,0.7763371150729336,"Taking expectations on both sides conditioned on the ﬁltration Ft and rearranging the terms, we
have (1"
REFERENCES,0.7779578606158833,2α −LJα2)E[||∇θJ(θt)||2|Ft] ≤E[J(θt+1)|Ft] −J(θt) + (1
REFERENCES,0.779578606158833,"2α + LJα2)E[||vt(wt) −∇θJ(θt)||2|Ft].
(33)"
REFERENCES,0.7811993517017828,"Then, we establish upper bound on the third term of the RHS. By deﬁnition, we have"
REFERENCES,0.7828200972447326,||vt(wt) −∇θJ(θt)||2
REFERENCES,0.7844408427876823,"= ||vt(wt) −vt(w∗
t ) + vt(w∗
t ) −ht(w∗
t ) + ht(w∗
t ) −g(w∗
t , θt) + g(w∗
t , θt) −∇θJ(θt)||2"
REFERENCES,0.7860615883306321,"≤6||vt(wt) −vt(w∗
t )||2 + 6||vt(w∗
t ) −ht(w∗
t )||2 + 6||ht(w∗
t ) −g(w∗
t , θt)||2"
REFERENCES,0.7876823338735819,"+ 6||g(w∗
t , θt) −∇θJ(θt)||2.
(34)"
REFERENCES,0.7893030794165316,"We note that ||vt(wt) −vt(w∗
t )||2 = P
i∈N ||vi
t(wt) −vi
t(w∗
t )||2 and the other three terms in equa-
tion 34 can also be similarly decomposed. For the ﬁrst term in the RHS of equation 34, we have"
REFERENCES,0.7909238249594813,"||vi
t(wt) −vi
t(w∗
t )||2"
REFERENCES,0.7925445705024311,Published as a conference paper at ICLR 2022
REFERENCES,0.7941653160453809,"= || 1 B B−1
X"
REFERENCES,0.7957860615883307,"l=0
˜δi
t,l(wt) · ψi
t,l −1 B B−1
X"
REFERENCES,0.7974068071312804,"l=0
˜δi
t,l(w∗
t ) · ψi
t,l||2"
REFERENCES,0.7990275526742301,"= || 1 B B−1
X"
REFERENCES,0.8006482982171799,"l=0
[˜δi
t,l(wt) −˜δi
t,l(w∗
t )] · ψi
t,l||2"
REFERENCES,0.8022690437601296,"= || 1 B B−1
X"
REFERENCES,0.8038897893030794,"l=0
[Atgossip]i(wt −w∗
t 1T )T [φ(st,l+1) −φ(st,l)] · ψi
t,l||2"
REFERENCES,0.8055105348460292,"≤
max
l∈{0,··· ,B−1} ||[Atgossip]i(wt −w∗
t 1T )T [φ(st,l+1) −φ(st,l)] · ψi
t,l||2"
REFERENCES,0.807131280388979,"≤
max
l∈{0,··· ,B−1} ||[Atgossip]i||2||[φ(st,l+1) −φ(st,l)]||2||wt −w∗
t 1T ||2 · ||ψi
t,l||2"
REFERENCES,0.8087520259319287,"≤4 · ||wt −w∗
t ⊗1||2 = 4 N
X"
REFERENCES,0.8103727714748784,"i=1
||wi
t −w∗
t ||2
(35)"
REFERENCES,0.8119935170178282,where the third equality is from
REFERENCES,0.813614262560778,"˜δi
t,l(wt) −˜δi
t,l(w∗
t )"
REFERENCES,0.8152350081037277,"= [Atgossip]i⃗δt,l(wt) −[Atgossip]i⃗δt,l(w∗
t )"
REFERENCES,0.8168557536466775,"= [Atgossip]i[⃗δt,l(wt) −⃗δt,l(w∗
t )]"
REFERENCES,0.8184764991896273,"= [Atgossip]i  
"
REFERENCES,0.820097244732577,"φT (st,l+1)(w1
t −w∗
t ) −φT (st,l)(w1
t −w∗
t )
...
φT (st,l+1)(wN
t −w∗
t ) −φT (st,l)(wN
t −w∗
t )  
"
REFERENCES,0.8217179902755267,"= [Atgossip]i(wt −w∗
t 1T )T [φ(st,l+1) −φ(st,l)]."
REFERENCES,0.8233387358184765,"For the second term in the RHS of equation 34, we have"
REFERENCES,0.8249594813614263,"||vi
t(w∗
t ) −hi
t(w∗
t )||2"
REFERENCES,0.826580226904376,"= || 1 B B−1
X"
REFERENCES,0.8282009724473258,"l=0
˜δi
t,l(w∗
t ) · ψi
t,l −1 B B−1
X"
REFERENCES,0.8298217179902755,"l=0
δt,l(w∗
t ) · ψi
t,l||2"
REFERENCES,0.8314424635332253,"= || 1 B B−1
X"
REFERENCES,0.833063209076175,"l=0
[˜δi
t,l(w∗
t ) −δt,l(w∗
t )] · ψi
t,l||2"
REFERENCES,0.8346839546191248,"= || 1 B B−1
X l=0"
REFERENCES,0.8363047001620746,"
[Atgossip]i −1"
REFERENCES,0.8379254457050244,"N 1T

⃗δt,l(w∗
t ) · ψi
t,l||2"
REFERENCES,0.839546191247974,"≤
max
l∈{0,··· ,B−1} ||

[Atgossip]i −1"
REFERENCES,0.8411669367909238,"N 1T

⃗δt,l(w∗
t ) · ψi
t,l||2"
REFERENCES,0.8427876823338736,"≤
max
l∈{0,··· ,B−1} ||[Atgossip]i −1"
REFERENCES,0.8444084278768234,"N 1T ||2 · ||⃗δt,l(w∗
t )||2 · ||ψi
t,l||2"
REFERENCES,0.8460291734197731,"≤
max
l∈{0,··· ,B−1} N(21 + η−(N−1)"
REFERENCES,0.8476499189627229,"1 −ηN−1 (1 −ηN−1)tgossip+1)2 · ||⃗δt,l(w∗
t )||2"
REFERENCES,0.8492706645056726,"≤16N 2((1 + η−(N−1))(1 −ηN−1)tgossip)2(rmax + Rw)2 = κ3N 2(1 −ηN−1)2tgossip
(36)"
REFERENCES,0.8508914100486223,where κ3 = 16(1 + η−(N−1))2(rmax + Rw)2. We note that the second equality is because
REFERENCES,0.8525121555915721,"˜δi
t,l(w∗
t ) −δt,l(w∗
t )"
REFERENCES,0.8541329011345219,"= [Atgossip]i⃗δt,l(w∗
t ) −1"
REFERENCES,0.8557536466774717,"N 1T⃗δt,l(w∗
t )"
REFERENCES,0.8573743922204214,"=

[Atgossip]i −1"
REFERENCES,0.8589951377633711,"N 1T

⃗δt,l(w∗
t )."
REFERENCES,0.8606158833063209,Published as a conference paper at ICLR 2022
REFERENCES,0.8622366288492707,"For the last inequality, we note that δt,l(w∗) is bounded because rewards and feature vectors are
bounded, µi is bounded for constant step size and w∗
t is bounded from the critic step. That is, for
j ∈N entry in ⃗δt,l(w∗) by deﬁnition,"
REFERENCES,0.8638573743922204,"δj
t,l(w∗) = rj
t,l −µj
t,l + [φ(st,l+1) −φ(st,l)]T w∗
t ."
REFERENCES,0.8654781199351702,"Hence, its 2-norm bound is"
REFERENCES,0.86709886547812,"||δj
t,l(w∗)|| = ||rj
t,l −µj
t,l + [φ(st,l+1) −φ(st,l)]T w∗
t ||"
REFERENCES,0.8687196110210696,"≤||rj
t,l|| + ||µj
t,l|| + ||φ(st,l+1) −φ(st,l)|| · ||w∗
t ||"
REFERENCES,0.8703403565640194,"≤rmax + rmax + [||φ(st,l+1)|| + ||φ(st,l)||] · Rw ≤2rmax + 2Rw.
(37)"
REFERENCES,0.8719611021069692,"For the last term in equation 34, we have"
REFERENCES,0.873581847649919,"||g(w∗
t , θt) −∇θJ(θt)||2"
REFERENCES,0.8752025931928687,"= ||Edθt(s,a)[Advw∗
t (s, a)ψθt(s, a)] −Edθt(s,a)[Advθt(s, a)ψθt(s, a)]||2"
REFERENCES,0.8768233387358185,"= ||Edθt(s,a)[(Advw∗
t (s, a) −Advθt(s, a))ψθt(s, a)]||2"
REFERENCES,0.8784440842787682,"≤(Edθt(s,a)[||(Advw∗
t (s, a) −Advθt(s, a))ψθt(s, a)||])2"
REFERENCES,0.880064829821718,"≤(Edθt(s,a)[||Advw∗
t (s, a) −Advθt(s, a)|| · ||ψθt(s, a)||])2"
REFERENCES,0.8816855753646677,"≤(Edθt(s,a)[|Advw∗
t (s, a) −Advθt(s, a)|])2"
REFERENCES,0.8833063209076175,"= (Edθt(s,a)[|E[Vw∗
t (s′)|s, a] −Vw∗
t (s) −E[Vθ∗
t (s′)|s, a] + Vθ∗
t (s)|])2"
REFERENCES,0.8849270664505673,"≤(Edθt(s,a)[|E[Vw∗
t (s′) −Vθ∗
t (s′)|s, a]| + |Vw∗
t (s) −Vθ∗
t (s)|])2"
REFERENCES,0.8865478119935171,"≤(Edθt(s,a)[E[|Vw∗
t (s′) −Vθ∗
t (s′)||s, a] + |Vw∗
t (s) −Vθ∗
t (s)|])2"
REFERENCES,0.8881685575364667,"= (E[|Vw∗
t (s) −Vθ∗
t (s)|] + E[|Vw∗
t (s) −Vθ∗
t (s)|])2"
REFERENCES,0.8897893030794165,"≤4(E[|Vw∗
t (s) −Vθ∗
t (s)|])2 ≤4E[|Vw∗
t (s) −Vθ∗
t (s)|2] ≤4ξcritic
approx.
(38)"
REFERENCES,0.8914100486223663,"For each i ∈N, we have"
REFERENCES,0.893030794165316,"||hi
t(w∗
t ) −gi(w∗
t , θi
t)||2 = ⟨1 B B−1
X"
REFERENCES,0.8946515397082658,"l1=0
δt,l1(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)], 1 B B−1
X"
REFERENCES,0.8962722852512156,"l2=0
δt,l2(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]⟩ = 1 B2 B−1
X l1=0 B−1
X"
REFERENCES,0.8978930307941653,"l2=0
⟨δt,l1(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)], δt,l2(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]⟩ = 1 B2 B−1
X"
REFERENCES,0.899513776337115,"l=0
||δt,l(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]||2 + 1 B2
X"
REFERENCES,0.9011345218800648,"l1̸=l2
⟨δt,l1(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)], δt,l2(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
t,l2(s, ai)]⟩."
REFERENCES,0.9027552674230146,"Taking expectation over the ﬁltration Ft, we have"
REFERENCES,0.9043760129659644,"E[||hi
t(w∗
t ) −gi(w∗
t , θi
t)||2|Ft] = 1 B2 B−1
X"
REFERENCES,0.9059967585089141,"l=0
E
h
||δt,l(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]||2|Ft
i + 1 B2
X"
REFERENCES,0.9076175040518638,"l1̸=l2
E
h
⟨δt,l1(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)], δt,l2(w∗
t )ψθi
t −Es,a[Aw∗
t (s, a)ψi
θi
t(s, ai)]⟩|Ft
i ≤16"
REFERENCES,0.9092382495948136,"B (rmax + Rw)2 + 1 B2
X"
REFERENCES,0.9108589951377634,"l1̸=l2
E
h
⟨δt,l1(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)], δt,l2(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]⟩|Ft
i"
REFERENCES,0.9124797406807131,Published as a conference paper at ICLR 2022
REFERENCES,0.9141004862236629,"where the inequality follows from triangle inequality and the facts that |δt,l1(w∗
t )ψθi
t| ≤2rmax +
2Rw and |Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]| = |E[δt,l1(w∗
t )ψθi
t]| ≤2rmax + 2Rw. WLOG, for the
following term, we suppose l1 < l2. Then we have"
REFERENCES,0.9157212317666127,"E
h
⟨δt,l1(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)], δt,l2(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]⟩|Ft
i"
REFERENCES,0.9173419773095624,"=E
h
E
h
⟨δt,l1(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi(s, ai)], δt,l2(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]⟩|Ft,l1
i
|Ft
i"
REFERENCES,0.9189627228525121,"=E
h
⟨δt,l1(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi(s, ai)], E
h
δt,l2(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]|Ft,l1
i
⟩|Ft
i"
REFERENCES,0.9205834683954619,"=E
h
⟨δt,l1(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi(s, ai)], E[δt,l2(w∗
t )ψθi
t|Ft,l1] −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]⟩|Ft
i"
REFERENCES,0.9222042139384117,"=E
h
⟨δt,l1(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi(s, ai)], E[Advw∗
t (st,l2, at,l2)ψθi
t|Ft,l1] −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]⟩|Ft
i"
REFERENCES,0.9238249594813615,"≤E
h
||δt,l1(w∗
t )ψθi
t −Es,a[Advw∗
t (s, a)ψi
θi(s, ai)]|| · ||E[Advw∗
t (st,l2, at,l2)ψθi
t|Ft,l1] −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]|||Ft
i"
REFERENCES,0.9254457050243112,"≤2(2rmax + 2Rw)E
h
||E[Advw∗
t (st,l2, at,l2)ψθi
t|Ft,l1] −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]|||Ft
i"
REFERENCES,0.9270664505672609,≤16(rmax + Rw)2κρl2−l1
REFERENCES,0.9286871961102107,where the last inequality follows from
REFERENCES,0.9303079416531604,"||E[Advw∗
t (st,l2, at,l2)ψθi
t|Ft,l1] −Es,a[Advw∗
t (s, a)ψi
θi
t(s, ai)]|| =||
X"
REFERENCES,0.9319286871961102,"(st,l2,at,l2)
Advw∗
t (st,l2, at,l2)ψθi
t(st,l2, at,l2)P(st,l2, at,l2|Ft,l1) −
X"
REFERENCES,0.93354943273906,"(s,a)
Advw∗
t (s, a)ψθi
t(s, a)νθt(s, a)|| ≤
X"
REFERENCES,0.9351701782820098,"s,a
||Advw∗
t (s, a)ψi
θi
t(s, ai)|| · |P l2−l1(s, a|Ft,l2) −νθt(s, a)|"
REFERENCES,0.9367909238249594,"≤2(2rmax + 2Rw) · ||P l2−l1(s, a|Ft,l2) −ν(s, a)||T V
≤4(rmax + Rw)κρl2−l1."
REFERENCES,0.9384116693679092,"Then, we have"
REFERENCES,0.940032414910859,"E[||hi
t(w∗
t ) −gi(w∗
t , θi
t)||2|Ft] ≤1"
REFERENCES,0.9416531604538088,"B2 [16B(rmax + Rw)2 + 16(rmax + Rw)2κ
X"
REFERENCES,0.9432739059967585,"l2̸=l1
ρl2−l1] ≤1"
REFERENCES,0.9448946515397083,B2 [16B(rmax + Rw)2 + 32(rmax + Rw)2κρB
REFERENCES,0.946515397082658,"1 −ρ
]"
REFERENCES,0.9481361426256077,≤16(rmax + Rw)2[1 + (2κ −1)ρ]
REFERENCES,0.9497568881685575,"B(1 −ρ)
.
(39)"
REFERENCES,0.9513776337115073,"Then, we have"
REFERENCES,0.9529983792544571,"E[||vt(wt) −∇θJ(θt)||2] ≤24N N
X"
REFERENCES,0.9546191247974068,"i=1
||wi
t −w∗
t ||2 + 6κ3N 3(1 −ηN−1)2tgossip"
REFERENCES,0.9562398703403565,"+ 24ξcritic
approx + 96(rmax + Rw)2[1 + (2κ −1)ρ]"
REFERENCES,0.9578606158833063,"B(1 −ρ)
N
(40)"
REFERENCES,0.9594813614262561,"As a result, substituting equation equation 40 into equation 33 and taking expectation over Ft on
both sides, we have (1"
REFERENCES,0.9611021069692058,2α −LJα2)E[||∇θJ(θt)||2]
REFERENCES,0.9627228525121556,≤E[J(θt+1)] −E[J(θt)] + (1
REFERENCES,0.9643435980551054,2α + LJα2) 
N,0.965964343598055,"24N N
X"
N,0.9675850891410048,"i=1
||wi
t −w∗
t ||2"
N,0.9692058346839546,Published as a conference paper at ICLR 2022
N,0.9708265802269044,"+6κ3N 3(1 −ηN−1)2tgossip + 24ξcritic
approx + 96(rmax + Rw)2[1 + (2κ −1)ρ]"
N,0.9724473257698542,"B(1 −ρ)
N

.
(41)"
N,0.9740680713128039,"By considering step size α =
1
4LJ , and dividing both sides of previous equation by
1
16LJ , we have"
N,0.9756888168557536,"E[||∇θJ(θt)||2] ≤16LJ(E[J(θt+1)] −E[J(θt)]) + 72N N
X"
N,0.9773095623987034,"i=1
||wi
t −w∗
t ||2"
N,0.9789303079416531,"+ 18κ3N 3(1 −ηN−1)2tgossip + 72ξcritic
approx + 288N (rmax + Rw)2[1 + (2κ −1)ρ]"
N,0.9805510534846029,"B(1 −ρ)
. (42)"
N,0.9821717990275527,"Let ˆT be a random variable that takes value uniformly among {1, · · · , T}. Taking summation over
t = {1, · · · , T} and dividing by T, we have"
N,0.9837925445705025,"E[||∇θJ(θ ˆT )||2] = 1 T T
X"
N,0.9854132901134521,"t=1
E[||∇θJ(θt)||2]"
N,0.9870340356564019,≤16LJ(E[J(θT )] −E[J(θ0)])
N,0.9886547811993517,"T
+ 72N
PT
t=1
PN
i=1 ||wi
t −w∗
t ||2 T"
N,0.9902755267423015,"+ 18κ3N 3(1 −ηN−1)2tgossip + 72ξcritic
approx + 288(rmax + Rw)2[1 + (2κ −1)ρ]"
N,0.9918962722852512,"B(1 −ρ)
N"
N,0.993517017828201,≤16LJE[J(θT )]
N,0.9951377633711507,"T
+ 72N
PN
i=1 ||wi
t −w∗
t ||2 T"
N,0.9967585089141004,"+ 18κ3N 3(1 −ηN−1)2tgossip + 72ξcritic
approx + 288(rmax + Rw)2[1 + (2κ −1)ρ]"
N,0.9983792544570502,"B(1 −ρ)
N."
