Section,Section Appearance Order,Paragraph
ABSTRACT,0.0,Abstract
ABSTRACT,0.0021141649048625794,"Persistence diagrams are one of the most popular types of data summaries
1"
ABSTRACT,0.004228329809725159,"used in Topological Data Analysis. The prevailing statistical approach to
2"
ABSTRACT,0.006342494714587738,"analyzing persistence diagrams is concerned with filtering out topological
3"
ABSTRACT,0.008456659619450317,"noise. In this paper, we adopt a different viewpoint and aim at estimating
4"
ABSTRACT,0.010570824524312896,"the actual distribution of a random persistence diagram, which captures both
5"
ABSTRACT,0.012684989429175475,"topological signal and noise. To that effect, [CD19] has shown that, under
6"
ABSTRACT,0.014799154334038054,"general conditions, the expected value of a random persistence diagram is
7"
ABSTRACT,0.016913319238900635,"a measure admitting a Lebesgue density, called the persistence intensity
8"
ABSTRACT,0.019027484143763214,"function. In this paper, we are concerned with estimating the persistence
9"
ABSTRACT,0.021141649048625793,"intensity function and a novel, normalized version of it – called the persistence
10"
ABSTRACT,0.023255813953488372,"density function. We present a class of kernel-based estimators based on
11"
ABSTRACT,0.02536997885835095,"an i.i.d. sample of persistence diagrams and derive estimation rates in
12"
ABSTRACT,0.02748414376321353,"the supremum norm. As a direct corollary, we obtain uniform consistency
13"
ABSTRACT,0.02959830866807611,"rates for estimating linear representations of persistence diagrams, including
14"
ABSTRACT,0.03171247357293869,"Betti numbers and persistence images. Interestingly, the persistence density
15"
ABSTRACT,0.03382663847780127,"function delivers stronger statistical guarantees.
16"
INTRODUCTION,0.035940803382663845,"1
Introduction
17"
INTRODUCTION,0.03805496828752643,"Topological Data Analysis (TDA) is a field at the interface of computational geometry,
18"
INTRODUCTION,0.040169133192389,"algebraic topology and data science whose primary objective is to extract topological and
19"
INTRODUCTION,0.042283298097251586,"geometric features from possibly high-dimensional, noisy and/or incomplete data. The
20"
INTRODUCTION,0.04439746300211417,"literature on the statistical analysis of TDA summaries has mainly focused on distinguishing
21"
INTRODUCTION,0.046511627906976744,"topological signatures from the unavoidable topological noise resulting from the data sampling
22"
INTRODUCTION,0.048625792811839326,"process. Toward that goal, the primary objective in designing statistical inference methods
23"
INTRODUCTION,0.0507399577167019,"for TDA is to isolate points on the sample persistence diagrams that are sufficiently far
24"
INTRODUCTION,0.052854122621564484,"from the diagonal to be deemed statistically significant in the sense of expressing underlying
25"
INTRODUCTION,0.05496828752642706,"topological features instead of randomness. This paradigm is entirely natural when the
26"
INTRODUCTION,0.05708245243128964,"target of inference is the unobservable persistence diagram arising from a filtration of interest,
27"
INTRODUCTION,0.05919661733615222,"and the sample persistent diagrams are noisy and imprecise approximations to it. On
28"
INTRODUCTION,0.0613107822410148,"the other hand, empirical evidence has also demonstrated that topological noise is not
29"
INTRODUCTION,0.06342494714587738,"unstructured and, in fact, may also carry expressive and discriminative power that can be
30"
INTRODUCTION,0.06553911205073996,"leveraged for various machine-learning tasks. In some applications, the distribution of the
31"
INTRODUCTION,0.06765327695560254,"topological noise itself is of interest; in cosmology, see e.g., [WNv+21]. As a result, statistical
32"
INTRODUCTION,0.06976744186046512,"summaries able to express the properties of both topological signal and topological noise
33"
INTRODUCTION,0.07188160676532769,"in a unified manner have also been proposed and investigated: e.g., persistence images and
34"
INTRODUCTION,0.07399577167019028,"linear functional of the persistence diagrams. In a recent contribution, [CD19] has derived
35"
INTRODUCTION,0.07610993657505286,"sufficient conditions to ensure that the expected persistent measure – the expected value
36"
INTRODUCTION,0.07822410147991543,"of the random counting measure corresponding to a noisy persistent diagram – admits a
37"
INTRODUCTION,0.080338266384778,"Lebesgue density, hereafter called the persistence intensity function; see also [CWRW15].
38"
INTRODUCTION,0.0824524312896406,"The significance of this result is multifaceted. First, the persistent intensity function provides
39"
INTRODUCTION,0.08456659619450317,"an explicit and highly-interpretable representation of the entire distribution of the persistence
40"
INTRODUCTION,0.08668076109936575,"homology of random filtrations. Secondly, it allows for a straightforward calculation of the
41"
INTRODUCTION,0.08879492600422834,"expected linear representation of a persistent diagram as a Lebesgue integral. Finally, the
42"
INTRODUCTION,0.09090909090909091,"representation provided by the persistence intensity function is of functional, as opposed
43"
INTRODUCTION,0.09302325581395349,"to algebraic, nature and thus analytically simpler. It is amenable to statistical analysis via
44"
INTRODUCTION,0.09513742071881606,"well-established theories and methods from the non-parametric statistics literature.
45"
INTRODUCTION,0.09725158562367865,"In this paper we derive consistency rates of estimation of the persistence intensity function
46"
INTRODUCTION,0.09936575052854123,"and of a novel variant called persistence density function in the ℓ∞norm based on a sample of
47"
INTRODUCTION,0.1014799154334038,"i.i.d. persistent diagrams. As we argue below in Theorem 3.1, controlling the estimation error
48"
INTRODUCTION,0.10359408033826638,"for the persistence intensity function in the ℓ∞norm is stronger than controlling the optimal
49"
INTRODUCTION,0.10570824524312897,"transport measure OTq for any q > 0 and, under mild assumptions, immediately implies
50"
INTRODUCTION,0.10782241014799154,"uniform control and concentration of any bounded linear representation of the persistence
51"
INTRODUCTION,0.10993657505285412,"diagram including (persistent) Betti numbers and persistence surfaces.
52"
BACKGROUND AND DEFINITIONS,0.11205073995771671,"2
Background and definitions
53"
BACKGROUND AND DEFINITIONS,0.11416490486257928,"In this section we introduce fundamental concepts from TDA that we will use throughout
54"
BACKGROUND AND DEFINITIONS,0.11627906976744186,"the paper. We refer the reader to [CM21, CD19] for detailed background and extensive
55"
REFERENCES,0.11839323467230443,"references.
56"
REFERENCES,0.12050739957716702,"Persistence diagrams.
We define a persistence diagram to be a locally finite multiset of
57"
REFERENCES,0.1226215644820296,"points D = {ri = (bi, di) | 1 ≤i ≤N(D)} belonging to the set
58"
REFERENCES,0.12473572938689217,"Ω= Ω(L) = {(b, d) | 0 < b < d ≤L} ⊂R2,
(1)"
REFERENCES,0.12684989429175475,"consisting of all the points on the plane in the positive orthant above the identity line and of
59"
REFERENCES,0.12896405919661733,"coordinate values no larger than a fixed constant L > 0. The coordinates of each point of
60"
REFERENCES,0.13107822410147993,"D correspond to the birth and death times of a persistent homology feature, where time is
61"
REFERENCES,0.1331923890063425,"measured with respect to the totally ordered set indexing a filtration. The restriction that
62"
REFERENCES,0.13530655391120508,"the persistence diagrams be contained in a box of side length L is a mild assumption that is
63"
REFERENCES,0.13742071881606766,"widely used in the TDA literature; see [DL21] and the discussion therein. To simplify our
64"
REFERENCES,0.13953488372093023,"notation, we will omit the dependence on L, but we will keep track of this parameter in our
65"
REFERENCES,0.1416490486257928,"error bounds. Some related quantities used throughout are
66"
REFERENCES,0.14376321353065538,"∂Ω:= {(x, x) | 0 ≤x ≤L};
Ω:= Ω∪∂Ω;"
REFERENCES,0.14587737843551796,"Ωℓ:=

ω ∈∂Ω: min
x∈Ω∥ω −x∥2 ≤ℓ

,
ℓ∈(0, L/
√"
REFERENCES,0.14799154334038056,"2).
(2)"
REFERENCES,0.15010570824524314,"That is, ∂Ωis a segment on the diagonal in R2 and Ωℓconsists of all the points in Ωat a
67"
REFERENCES,0.1522198731501057,"Euclidean distance of ℓor smaller from it.
68"
REFERENCES,0.1543340380549683,"The expected persistent measure and its normalization.
A persistence diagram
69"
REFERENCES,0.15644820295983086,"D = {ri = (bi, di) ∈Ω| 1 ≤i ≤N(D)} can be equivalently represented as a counting
70"
REFERENCES,0.15856236786469344,"measure µ on Ωgiven by
71"
REFERENCES,0.160676532769556,A ∈B 7→µ(A) =
REFERENCES,0.16279069767441862,"N(D)
X"
REFERENCES,0.1649048625792812,"i=1
δri(A),"
REFERENCES,0.16701902748414377,"where B = B(Ω) is the class of all Borel subsets of Ωand δr denotes the Dirac point mass at
72"
REFERENCES,0.16913319238900634,"r ∈Ω. We will refer to µ as the persistence measure corresponding to D and, with a slight
73"
REFERENCES,0.17124735729386892,"abuse of notation, will treat persistence diagrams as counting measures. If D is a random
74"
REFERENCES,0.1733615221987315,"persistence diagram, then the associated persistence measure is also random. In addition
75"
REFERENCES,0.17547568710359407,"to the persistence measure µ associated to a persistence diagram D, we will also study its
76"
REFERENCES,0.17758985200845667,"normalized measure ˜µ, which is the persistence measure divided by the total number of points
77"
REFERENCES,0.17970401691331925,"N(D) in the persistence diagram. In detail, ˜µ is the (possibly random) probability measure
78"
REFERENCES,0.18181818181818182,"on Ωgiven by
79"
REFERENCES,0.1839323467230444,"A ∈B 7→˜µ(A) =
1
N(D)"
REFERENCES,0.18604651162790697,"N(D)
X"
REFERENCES,0.18816067653276955,"i=1
δri(A)."
REFERENCES,0.19027484143763213,"The normalized persistence measure may be desirable when the number of points N(D)
80"
REFERENCES,0.19238900634249473,"in the persistence diagram is not of direct interest but their spatial distribution is. This
81"
REFERENCES,0.1945031712473573,"is typically the case when the persistence diagrams at hand contain many points or are
82"
REFERENCES,0.19661733615221988,"obtained from large random filtrations (e.g. the Vietoris-Rips complex built on point clouds),
83"
REFERENCES,0.19873150105708245,"so that the value of N(D) will mostly accounts for noisy topological fluctuations due to
84"
REFERENCES,0.20084566596194503,"sampling.
85"
REFERENCES,0.2029598308668076,"We will consider the setting in which the observed persistence diagram D is a random draw
86"
REFERENCES,0.20507399577167018,"from an unknown distribution. Then, the (non-random) measures
87"
REFERENCES,0.20718816067653276,"A ∈B 7→E[µ](A) = E[µ(A)]
and
A ∈B 7→E[˜µ](A) = E[˜µ(A)]"
REFERENCES,0.20930232558139536,"are well defined. We will refer to E[µ] and E[˜µ] as the expected persistence measure and
88"
REFERENCES,0.21141649048625794,"the expected persistence probability, respectively. Notice that typically, neither is a dis-
89"
REFERENCES,0.2135306553911205,"crete measure, and that the expected persistence probability is a probability measure by
90"
REFERENCES,0.2156448202959831,"construction.
91"
REFERENCES,0.21775898520084566,"The interpretations of the measure E[µ] and the probability measure E[˜µ] is straightforward:
92"
REFERENCES,0.21987315010570824,"for any Borel set A ⊂Ω, E[µ](A) is the expected number of points from the random
93"
REFERENCES,0.2219873150105708,"persistence diagram falling in A, while E[˜µ](A) is the probability that a random persistence
94"
REFERENCES,0.22410147991543342,"diagram will intersect A. As a result, they are able to directly express the randomness of
95"
REFERENCES,0.226215644820296,"the distribution of persistence diagram including structural properties of the topological
96"
REFERENCES,0.22832980972515857,"noise. Despite their interpretability, the expected persistence measure and probability are
97"
REFERENCES,0.23044397463002114,"not yet standard concepts in the practice and theory of TDA. As a result, they have not
98"
REFERENCES,0.23255813953488372,"been thoroughly investigated.
99"
REFERENCES,0.2346723044397463,"The persistence intensity and density functions and linear representations.
In a
100"
REFERENCES,0.23678646934460887,"recent, important contribution, [CD19] derived conditions – applicable to a wide range to
101"
REFERENCES,0.23890063424947147,"problems – that ensure that the expected persistence measure E[µ] and its normalization E[˜µ]
102"
REFERENCES,0.24101479915433405,"both admit densities with respect to the Lebesgue measure on Ω. Specifically, under fairly
103"
REFERENCES,0.24312896405919662,"mild and general conditions detailed in [CD19] there exist measurable functions p : Ω→R≥0
104"
REFERENCES,0.2452431289640592,"and ˜p : Ω→R≥0, such that for any Borel set A ⊂Ω,
105"
REFERENCES,0.24735729386892177,"E[µ](A) =
Z"
REFERENCES,0.24947145877378435,"A
p(u)du,
and
E[˜µ](A) =
Z"
REFERENCES,0.25158562367864695,"A
˜p(u)du.
(3)"
REFERENCES,0.2536997885835095,"In fact, [CD19] provided explicit expressions for p and ˜p (see Section D.5). Notice that,
106"
REFERENCES,0.2558139534883721,"by construction, ˜p integrates to 1 over Ω. We will refer to the functions p and ˜p as the
107"
REFERENCES,0.25792811839323465,"persistence intensity and the persistence density functions, respectively. We remark that the
108"
REFERENCES,0.26004228329809725,"notion of a persistence intensity function was originally put forward by [CWRW15].
109"
REFERENCES,0.26215644820295986,"The persistence intensity and density functions “operationalize” the notions of expected
110"
REFERENCES,0.2642706131078224,"persistence measure and expected persistence probability introduced above, allowing to
111"
REFERENCES,0.266384778012685,"evaluate, for any Borel set A, E[µ](A) and E[˜µ](A) in a straightforward way as Lebesgue
112"
REFERENCES,0.26849894291754756,"integrals.
113"
REFERENCES,0.27061310782241016,"The main objective of the paper is to construct estimators bp and ˇp of the persistence intensity
114"
REFERENCES,0.2727272727272727,"p and persistence density ˜p, respectively, and to provide high probability error bounds
115"
REFERENCES,0.2748414376321353,"with respect to the L∞norm. As we show below in Theorem 3.1,L∞-consistency for the
116"
REFERENCES,0.2769556025369979,"persistence intensity function is a stronger guarantee than consistency in the OTp metric,
117"
REFERENCES,0.27906976744186046,"for any p < ∞. Interestingly, we find that estimation of the persistence probability density
118"
REFERENCES,0.28118393234672306,"function is statistically easier, in the sense that uniform estimation error bounds can be
119"
REFERENCES,0.2832980972515856,"obtained for all points in Ω. In contrast, estimating the persistence intensity function becomes
120"
REFERENCES,0.2854122621564482,"progressively more difficult for points near ∂Ω. See Theorem 3.6 below.
121"
REFERENCES,0.28752642706131076,"Linear representations of persistence diagrams.
As noted in [CD19], the persistence
122"
REFERENCES,0.28964059196617337,"intensity and density functions are naturally suited to compute the expected value of linear
123"
REFERENCES,0.2917547568710359,"representations of random persistence diagrams. A linear representation Ψ of the persistence
124"
REFERENCES,0.2938689217758985,"diagram D = {ri = (bi, di) ∈Ω| 1 ≤i ≤N(D)} with corresponding persistence measure µ
125"
REFERENCES,0.2959830866807611,"is a summary statistic of D of the form
126"
REFERENCES,0.29809725158562367,Ψ(D) =
REFERENCES,0.30021141649048627,"N(D)
X"
REFERENCES,0.3023255813953488,"i=1
f(ri) =
Z"
REFERENCES,0.3044397463002114,"Ω
f(u)dµ(u),
(4)"
REFERENCES,0.30655391120507397,"for a given measurable function f on Ω. (An analogous definition can be given for the
127"
REFERENCES,0.3086680761099366,"normalized persistence measure ˜µ instead). Then,
128"
REFERENCES,0.3107822410147992,"E[Ψ(D)] =
Z"
REFERENCES,0.3128964059196617,"Ω
f(u)dE[µ](u) =
Z"
REFERENCES,0.3150105708245243,"Ω
f(u)p(u)du,
(5)"
REFERENCES,0.3171247357293869,"where the second identity follows from (3). Linear representations include persistent Betti
129"
REFERENCES,0.3192389006342495,"numbers, persistence surfaces, persistence silhouettes and persistence weighted Gaussian
130"
REFERENCES,0.321353065539112,"kernels.
131"
REFERENCES,0.32346723044397463,"The persistence surface is an especially popular linear representation introduced by [AEK+17].
132"
REFERENCES,0.32558139534883723,"In detail, for a kernel function K(·) : R2 →R≥0 and any x ∈R2, let Kh(x) =
1
h2 K( x"
REFERENCES,0.3276955602536998,"h),
133"
REFERENCES,0.3298097251585624,"where h > 0 is the bandwidth parameter1. The persistence surface of a persistence measure
134"
REFERENCES,0.33192389006342493,"µ is defined as
135"
REFERENCES,0.33403805496828753,"ρh(u) =
Z"
REFERENCES,0.3361522198731501,"Ω
f(ω)Kh(u −ω)dµ(ω),
(6)"
REFERENCES,0.3382663847780127,"where f(ω): R2 →R is the user-defined weighting function, chosen to ensure stability of the
136"
REFERENCES,0.3403805496828753,"representation. Our analysis allows to immediately obtain consistency rates for the expected
137"
REFERENCES,0.34249471458773784,"persistence surface in L∞norm, which, for brevity, we present in the supplementary material
138"
REFERENCES,0.34460887949260044,"(see Theorem B.5). Instead we focus on the estimation error the expected Betti numbers.
139"
REFERENCES,0.346723044397463,"Betti and the persistent Betti numbers.
The Betti number at scale x ∈[0, L] is
140"
REFERENCES,0.3488372093023256,"the number of persistent homologies that are in existence at “time"" x. Furthermore, the
141"
REFERENCES,0.35095137420718814,"persistent Betti number at a certain point x = (x1, x2) ∈Ωmeasures the number of
142"
REFERENCES,0.35306553911205074,"persistent homologies that are born before x1 and die after x2. In our notation, given
143"
REFERENCES,0.35517970401691334,"a persistence diagram D and its associated persistence measure µ, for x ∈[0, L] and
144"
REFERENCES,0.3572938689217759,"x = (x1, x2) ∈Ω, the corresponding Betti number and persistent Betti number are given by
145"
REFERENCES,0.3594080338266385,"βx(D) = µ(Bx)
and
βx(D) = µ(Bx),"
REFERENCES,0.36152219873150104,"respectively, where Bx = [0, x) × (x, L] and Bx = [0, x1) × (x2, L]. Though Betti numbers
146"
REFERENCES,0.36363636363636365,"are among the most prominent and widely used TDA summaries, relatively little is known
147"
REFERENCES,0.3657505285412262,"about the statistical hardness of estimating their expected values when the sample size is
148"
REFERENCES,0.3678646934460888,"fixed and the number of persistence diagrams increases. Our results will yield error bounds
149"
REFERENCES,0.3699788583509514,"of this type. We will also consider normalized versions of the Betti numbers defined using
150"
REFERENCES,0.37209302325581395,"the persistence probability ˜µ of the persistence diagram:
151"
REFERENCES,0.37420718816067655,"˜βx(D) = ˜µ(Bx)
and
˜βx(D) = ˜µ(Bx)."
REFERENCES,0.3763213530655391,"Notice that, by definition, ˜βx(D) ≤1. While their interpretation is not as direct as the Betti
152"
REFERENCES,0.3784355179704017,"numbers computed using persistence diagrams, the expected normalized (persistence) Betti
153"
REFERENCES,0.38054968287526425,"numbers are informative topological summaries while showing favorable statistical properties
154"
REFERENCES,0.38266384778012685,"(see Theorem 3.12 below).
155"
MAIN RESULTS,0.38477801268498946,"3
Main results
156"
MAIN RESULTS,0.386892177589852,"3.1
The OT distance between measures and L∞distance between intensity
157"
MAIN RESULTS,0.3890063424947146,"functions
158"
MAIN RESULTS,0.39112050739957716,"A popular and, arguably, natural metric for persistence diagrams – and, more generally,
159"
MAIN RESULTS,0.39323467230443976,"locally finite Radon measures such as normalized persistence measures and probabilities – is
160"
MAIN RESULTS,0.3953488372093023,"1[AEK+17] showed empirically that the bandwidth does not have a major influence on the
efficiency of the persistence surface."
MAIN RESULTS,0.3974630021141649,"the optimal transport distance; see, e.g., [DL21]. In detail, for two Radon measures µ and ν
161"
MAIN RESULTS,0.39957716701902746,"supported on Ω, an admissible transport from µ to ν is defined as a function π : Ω× Ω→R,
162"
MAIN RESULTS,0.40169133192389006,"such that for any Borel sets A, B ⊂Ω,
163"
MAIN RESULTS,0.40380549682875266,"π(A × Ω) = µ(A),
and
π(Ω× B) = ν(B)."
MAIN RESULTS,0.4059196617336152,"Let adm(µ, ν) denote all the admissible transports from µ to ν. For any q ∈R+ ∪{∞}, the
164"
MAIN RESULTS,0.4080338266384778,"q-th order Optimal Transport (OT) distance between µ and ν is defined as
165"
MAIN RESULTS,0.41014799154334036,"OTq(µ, ν) =

inf
π∈adm(µ,ν) Z"
MAIN RESULTS,0.41226215644820297,"Ω×Ω
∥x −y∥q
2dπ(x, y)
 1 q
."
MAIN RESULTS,0.4143763213530655,"When µ and ν are persistent diagrams the choice of q = ∞corresponds to the widely-used
166"
MAIN RESULTS,0.4164904862579281,"bottleneck distance. The OT distance is widely used for good reasons: by transporting from
167"
MAIN RESULTS,0.4186046511627907,"and to the diagonal ∂Ω, it captures the distance between two measures that have potentially
168"
MAIN RESULTS,0.42071881606765327,"different total masses, taking advantage of the fact that points on the diagonal have arbitrary
169"
MAIN RESULTS,0.42283298097251587,"multiplicity in persistent diagrams. It also proves to be stable with respect to perturbations
170"
MAIN RESULTS,0.4249471458773784,"of the input to TDA algorithms. However, for expected persistent measures with intensity
171"
MAIN RESULTS,0.427061310782241,"functions with respect to the Lebesgue measure, we will show next that the L∞distance
172"
MAIN RESULTS,0.42917547568710357,"between intensity functions provides a tighter control on the difference between two persistent
173"
MAIN RESULTS,0.4312896405919662,"measures. Below, for a real-valued function on Ω, we let ∥f∥∞= supx∈Ω|f(x)| be its L∞
174"
MAIN RESULTS,0.4334038054968288,"norm.
175"
MAIN RESULTS,0.4355179704016913,"Theorem 3.1 Let µ, ν be two expected persistent measures on Ωwith intensity functions
176"
MAIN RESULTS,0.4376321353065539,"pµ and pν respectively. Then
177"
MAIN RESULTS,0.4397463002114165,"OTq
q(µ, ν) ≤
L 2"
MAIN RESULTS,0.4418604651162791,"q+2  2
√"
MAIN RESULTS,0.4439746300211416,"2
q + 1 −
2
q + 2"
MAIN RESULTS,0.44608879492600423,"
∥pµ −pν∥∞.
(7)"
MAIN RESULTS,0.44820295983086683,"Furthermore, there exists two sequences of expected persistence measures {µn}n∈N and
178"
MAIN RESULTS,0.4503171247357294,"{νn}n∈N with intensity functions {pµn}n∈N and {pνn}n∈N respectively such that, as n →∞,
179"
MAIN RESULTS,0.452431289640592,"OTq(µn, νn) →0,
while
∥pµn −pνn∥∞→∞."
MAIN RESULTS,0.45454545454545453,"The bottleneck distance
For the case q = ∞, which yields the bottleneck distance when
180"
MAIN RESULTS,0.45665961945031713,"applied to persistence diagrams, there can be no meaningful upper bound in the form of
181"
MAIN RESULTS,0.4587737843551797,"(7): we show in Section D.1 of the supplementary material that there exist two sequences
182"
MAIN RESULTS,0.4608879492600423,"of measures such that their bottleneck distance converges to a finite number while the L∞
183"
MAIN RESULTS,0.4630021141649049,"distance between their intensity functions vanishes. Existing contributions [Pey18, NGK21]
184"
MAIN RESULTS,0.46511627906976744,"also upper bound the optimal transport distance by a Sobolev-type distance between density
185"
MAIN RESULTS,0.46723044397463004,"functions. It is noteworthy that these bounds require, among other things, the measures
186"
MAIN RESULTS,0.4693446088794926,"to have common support and the same total mass, two conditions that are not assumed in
187"
MAIN RESULTS,0.4714587737843552,"Theorem 3.1.
188"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.47357293868921774,"3.2
Non-parametric estimation of the persistent intensity and density functions
189"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.47568710359408034,"In this section, we analyze the performance of kernel-based estimators of the persistent
190"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.47780126849894294,"intensity function p(·) and the persistent density function ˜p(·). We adopt the setting where
191"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.4799154334038055,"we observe n i.i.d. persistent measures µ1, µ2, . . . , µn. The procedures we proposed are
192"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.4820295983086681,"directly inspired by kernel density estimators for probability densities traditionally used
193"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.48414376321353064,"in the non-parametric statistics literature; see, e.g., [GN21]. Specifically, we consider the
194"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.48625792811839325,"following estimator for p(·) and ˜p(·), respectively:
195"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.4883720930232558,"ω ∈R2 7→ˆph(ω) := 1 n n
X i=1 Z"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.4904862579281184,"Ω
Kh(x −ω)dµi(x);
(8a)"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.492600422832981,"ω ∈R2 7→ˇph(ω) = 1 n n
X i=1 Z"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.49471458773784355,"Ω
Kh(x −ω)d˜µi(x),
(8b)"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.49682875264270615,"where K(·) is the kernel function, which we assume to satisfy a number of standard regularity
196"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.4989429175475687,"conditions used in non-parametric literature, discussed in detail in Section B.2 of the
197"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5010570824524313,"supplementary material.
198"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5031712473572939,"Assumptions.
We will impose a number of regularity conditions on the expected persistent
199"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5052854122621564,"measures, the persistence intensity and density functions and the kernel function. Of course,
200"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.507399577167019,"we will assume throughout that both p and ˜p (see (3)) are well-defined as densities with
201"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5095137420718816,"respect to the Lebesgue measure, though we point out that this is not strictly necessary for
202"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5116279069767442,"Theorems 3.6 and 3.9.
203"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5137420718816068,"Our first assumption of smoothness of both p and ˜p is needed to control the point-wise bias
204"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5158562367864693,"of our estimators and is a standard assumption in non-parametric density estimation.
205"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5179704016913319,"Assumption 3.2 (Smoothness) The persistence intensity function p and persistence prob-
206"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5200845665961945,"ability density function ˜p are Hölder smooth of the order of s > 0 with parameters Lp and
207"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5221987315010571,"L˜p respectively2.
208"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5243128964059197,"In our next assumption, we impose boundedness conditions on p and ˜p, which are needed in
209"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5264270613107822,"order to apply a key concentration inequality for empirical processes.
210"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5285412262156448,"Assumption 3.3 (Boundedness) For some q > 0, let ¯p(ω) := ∥ω −∂Ω∥q
2p(ω). Then,
211"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5306553911205074,"∥¯p∥∞= sup
ω∈Ω
∥ω −∂Ω∥q
2p(ω) < ∞
and
∥˜p∥∞= sup
ω∈Ω
˜p(ω) < ∞."
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.53276955602537,"Notice that instead of assuming a bound on the L∞norm of the intensity function p,
212"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5348837209302325,"we are only requiring the weaker condition that the weighted intensity function ¯p(ω) =
213"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5369978858350951,"∥ω −∂Ω∥q
2p(ω) has finite L∞norm, due to the fact that the total mass of the persistence
214"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5391120507399577,"measure may not be uniformly bounded in a number of common data-generating mechanisms.
215"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5412262156448203,"Indeed, it is not a priori clear that Assumption 3.3 itself is realistic; in the supplementary
216"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5433403805496829,"material we prove that this assumption holds for the Vietoris-Rips filtration built on i.i.d.
217"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5454545454545454,"samples. On the other hand, assuming that the persistence density is uniformly bounded
218"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.547568710359408,"poses no problems. See Theorems B.1 and B.2 in the supplementary material for formal
219"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5496828752642706,"arguments. This fact is the primary reason why the persistence probability density function
220"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5517970401691332,"– unlike the persistence intensity function – can be estimated uniformly well over the entire
221"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5539112050739958,"set Ω- see (3.6) below. We refer readers to Section B.1 of the supplementary materials for
222"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5560253699788583,"details and a discussion on this subtle but consequential point.
223"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5581395348837209,"In our last assumption, we require a uniform bound on the q-th order total persistence,
224"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5602536997885835,"though not on the total number of points in the persistence diagram. As elucidated in
225"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5623678646934461,"[CSEHM10] and discussed in [DP19] and [DL21], this is a relatively mild assumption, which
226"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5644820295983086,"should be expected to hold under a broad variety of data-generating mechanisms.
227"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5665961945031712,"Assumption 3.4 (Bounded total persistence) There exists a constant M > 0, such
228"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5687103594080338,"that, for the value of q as in Assumption 3.3, it holds that, almost surely,
229"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5708245243128964,"max
i=1,...,n Z"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.572938689217759,"Ω
∥ω −∂Ω∥q
2dµi(ω) < M."
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5750528541226215,"We will denote with Zq
L,M the set of persistent measures on ΩL satisfying Assumption 3.4.
230"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5771670190274841,"We are now ready to present our first result concerning the bias of the kernel estimators,
231"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5792811839323467,"whose proof is relatively standard.
232"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5813953488372093,"Theorem 3.5 Under Assumption 3.2, for any ω ∈Ω,
233"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5835095137420718,"|E[ˆph(ω)] −p(ω)| ≤Lphs
Z"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5856236786469344,"∥v∥2≤1
K(v)∥v∥s
2dv,
and"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.587737843551797,"|E[ˇph(ω)] −˜p(ω)| ≤L˜phs
Z"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5898520084566596,"∥v∥2≤1
K(v)∥v∥s
2dv."
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5919661733615222,"The next result provides high-probability uniform bounds on the fluctuations of the kernel
234"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5940803382663847,"estimators around their expected values.
235"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5961945031712473,2We refer readers to the supplementary material for definitions.
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.5983086680761099,"Theorem 3.6 Suppose that Assumptions 3.3 and 3.4 hold. Then,
236"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6004228329809725,"(a) there exists a positive constant C depending on M, ∥K∥∞, ∥K∥2, ∥¯p∥∞and q such
237"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6025369978858351,"that for any δ ∈(0, 1), it can be guaranteed with probability at least 1 −δ that
238"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6046511627906976,"sup
ω∈Ω2h
ℓq
ω|ˆph(ω) −Eˆph(ω)| ≤C max"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6067653276955602,"(
1
nh2 log
1
δh2 , r 1
nh2 r"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6088794926004228,"log
1
δh2 ) ,"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6109936575052854,"where ℓω := ∥ω −∂Ω∥2 −h;
239"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6131078224101479,"(b) there exists a positive constant Cdepending on M, ∥K∥∞, ∥K∥2, ∥˜p∥∞and q such
240"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6152219873150105,"that for any δ ∈(0, 1), it can be guaranteed with probability at least 1 −δ that
241"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6173361522198731,"sup
ω∈Ω
|ˇph(ω) −Eˇph(ω)| ≤C max"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6194503171247357,"(
1
nh2 log
1
δh2 , r 1
nh2 r"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6215644820295984,"log
1
δh2 ) ."
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6236786469344608,"Remark.
The dependence of the constants on problem related parameters is made explicit
242"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6257928118393234,"in the proofs; see the supplementary material.
243"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.627906976744186,"There is an important difference between the two bounds in Theorem 3.6: while the variation
244"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6300211416490487,"of ˇph(ω) is uniformly bounded everywhere on Ω, the variation of ˆph(ω) is uniformly bounded
245"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6321353065539113,"only when ω is at least 2h away from the diagonal ∂Ω, and may increase as ω approaches
246"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6342494714587738,"the diagonal. The difficulty in controlling the variation of ˆph near the diagonal comes from
247"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6363636363636364,"the fact that we only assume the total persistence of the persistent measures to be bounded;
248"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.638477801268499,"in other words, the number of points near the diagonal in the sample persistent diagrams
249"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6405919661733616,"can be prohibitively large, since their contribution to the total persistence is negligible. This
250"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.642706131078224,"is to be expected in noisy settings in which the sampling process will result in topological
251"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6448202959830867,"noise consisting of many points in the persistence diagram near the diagonal. The above
252"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6469344608879493,"result suggests that it is advantageous to rely on density-based, instead of intensity-based
253"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6490486257928119,"representations of the persistent measures.
254"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6511627906976745,"Bias-variance trade-off and minimax lower bound.
If follows from Theorems 3.5
255"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.653276955602537,"and 3.6 that the choice h ≍n−
1
2(s+1) for the bandwidth will optimize the bias-variance
256"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6553911205073996,"trade-off, yielding high-probability estimation errors
257"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6575052854122622,"sup
w∈Ω2h
ℓq
ω|ˆph(ω) −p(ω)| ≲O

n−
s
2(s+1)

,
and
sup
w∈Ω
|ˇph(ω) −˜p(ω)| ≲O

n−
s
2(s+1)

."
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6596194503171248,"The following theorem shows that the above rate is minimax optimal for the persistence
258"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6617336152219874,"density function. For brevity, we here omit a similar result for the persistence intensity
259"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6638477801268499,"function (see Theorem B.4 in the supplementary material).
260"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6659619450317125,"Theorem 3.7 Let F denote the set of functions on Ωwith Besov norm bounded by B > 0:
261"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6680761099365751,"F = {f : Ω→R, ∥f∥Bs∞,∞≤B}."
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6701902748414377,"Then,
262"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6723044397463002,"inf
ˇpn sup
P
E
µ1,...,µn
i.i.d.
∼P ∥ˇpn −˜p∥∞≥O(n−
s
2(s+1) ),"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6744186046511628,"where the infimum is taken over estimator ˇpn mapping µ1, . . . , µn to an intensity function
263"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.6765327695560254,"in F, the supremum is over the set of all probability distributions on Zq
L,M and ˜p is the
264"
NON-PARAMETRIC ESTIMATION OF THE PERSISTENT INTENSITY AND DENSITY FUNCTIONS,0.678646934460888,"intensity function of EP [˜µ].
265"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.6807610993657506,"3.3
Kernel-based estimators for linear functionals of the persistent measure
266"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.6828752642706131,"The kernel estimators (8) can serve as a basis for estimating bounded linear representations
267"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.6849894291754757,"of the expected persistence measure E[µ] and its normalized counterpart E[˜µ]. Specifically,
268"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.6871035940803383,"for R > 0, let F2h,R and f
FR denote the set of linear representations of the form
269"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.6892177589852009,"F2h,R =

Ψ =
Z"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.6913319238900634,"Ω2h
fdE[µ]
f : Ω2h →R≥0,
Z"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.693446088794926,"Ω2h
ℓ−q
ω f(ω)dω ≤R

,
and"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.6955602536997886,"f
FR =

eΨ =
Z"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.6976744186046512,"Ω
fdE[˜µ]
f : Ω→R≥0,
Z"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.6997885835095138,"Ω
f(ω)dω ≤R

."
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7019027484143763,"Then, any linear representations Ψ ∈F2h,R and eΨ ∈f
FR can be estimated by
270"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7040169133192389,"ˆΨh =
Z"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7061310782241015,"Ω2h
f(ω)ˆph(ω)dω,
and
ˇΨh =
Z"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7082452431289641,"Ω
f(ω)ˇph(ω)dω,
(9)"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7103594080338267,"respectively. The following theorems provide uniform bounds on the bias and variation of
271"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7124735729386892,"these kernel-based estimators.
272"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7145877378435518,"Theorem 3.8 Under Assumption 3.2, it holds that
273"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7167019027484144,"sup
Ψ∈F2h,R"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.718816067653277,"E[ˆΨh] −Ψ
 ≤LphsR
Z"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7209302325581395,"∥v∥2≤1
K(v)∥v∥2
2dv;
and sup"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7230443974630021,"Ψ∈e
FR"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7251585623678647,"E[ˇΨh] −eΨ
 ≤L˜phsR
Z"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7272727272727273,"∥v∥2≤1
K(v)∥v∥2
2dv."
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7293868921775899,"Theorem 3.9 Assume that Assumptions 3.2 and 3.3 hold. Then,
274"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7315010570824524,"(a) there exists a constant C depending on M, ∥K∥∞, ∥K∥2, ∥¯p∥∞and q such that for
275"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.733615221987315,"any δ ∈(0, 1), it can be guaranteed with probability at least 1 −δ that
276"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7357293868921776,"sup
Ψ∈F2h,R"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7378435517970402,"ˆΨh −E[ˆΨh]
 ≤CR · max"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7399577167019028,"(
1
nh2 log
1
δh2 , r 1
nh2 r"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7420718816067653,"log
1
δh2 ) ;"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7441860465116279,"(b) there exists a constant C depending on M, ∥K∥∞, ∥K∥2, ∥˜p∥∞and q such that for
277"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7463002114164905,"any δ ∈(0, 1), it can be guaranteed with probability at least 1 −δ that
278 sup"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7484143763213531,"Ψ∈e
FR"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7505285412262156,"ˇΨh −E[ˇΨh]
 ≤CR · max"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7526427061310782,"(
1
nh2 log
1
δh2 , r 1
nh2 r"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7547568710359408,"log
1
δh2 ) ."
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7568710359408034,"It is important to highlight the fact that the above bounds hold uniformly over the choice of
279"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.758985200845666,"linear representations under only mild integrability assumptions.
280"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7610993657505285,"Theorems 3.8 and 3.9 are direct corollaries of Theorems 3.5 and 3.6. We again stress the
281"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7632135306553911,"difference between the two upper bounds of Theorem 3.9: part (a) shows that for a linear
282"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7653276955602537,"functional of the original persistent measure to have controlled variation, we need the field
283"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7674418604651163,"of integral to be at least 2h away from the diagonal ∂Ω, a requirement that is not necessary
284"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7695560253699789,"for linear functionals of the normalized persistent measure, as is shown in part (b).
285"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7716701902748414,"Next, we apply Theorems 3.9 and 3.9(a) to the persistent Betti number, which, for any
286"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.773784355179704,"x ∈Ω, can be estimated by
287"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7758985200845666,"ˆβx,h =
Z"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7780126849894292,"Bx
ˆph(ω)dω.
(10) 288"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7801268498942917,"Corollary 3.10 Under Assumption 3.2, it holds that
289"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7822410147991543,"sup
x∈Ω"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7843551797040169,"E[ˆβx,h] −βx
 ≤Lphs L2 4 Z"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7864693446088795,"∥v∥2≤1
K(v)∥v∥2
2dv."
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7885835095137421,"Corollary 3.11 Under Assumptions 3.2 and 3.3(a), there exists a constant C depending on
290"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7906976744186046,"M, ∥K∥∞, ∥K∥2, ∥¯p∥∞and q > 2 such that for any δ ∈(0, 1),
291"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7928118393234672,"sup
x∈Ω: ℓx>h
ℓq−2
x
ˆβx,h −E[ˆβx,h]
 ≤C max"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7949260042283298,"(
1
nh2 log
1
δh2 , r 1
nh2 r"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7970401691331924,"log
1
δh2 )"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.7991543340380549,"holds with probability at least 1 −δ.
292"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8012684989429175,"Notice that in order for the variation of ˆβx,h to be bounded, we need x to be at least 2h
293"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8033826638477801,"away from the diagonal ∂Ω, and that the upper bound for the variation increases as x
294"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8054968287526427,"approaches the diagonal. Therefore, based on our analysis, the kernel-based estimator ˆph
295"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8076109936575053,"will not be guaranteed to yield a stable estimation of the Betti number βx. As remarked
296"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8097251585623678,"above, this issue arises as the intensity function may not be uniformly bounded near the
297"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8118393234672304,"diagonal. Indeed, in the supplementary material, we describe an alternative proof technique
298"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.813953488372093,"based on an extension of the standard VC inequality and arrive at a very similar rate.
299"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8160676532769556,"If instead we target the normalized Betti numbers ˜βx, this issue disappears when we deploy
300"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8181818181818182,"the analogous estimator ˇβx,h =
R"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8202959830866807,"Bx ˇph(ω)dω, constructed using ˇph. Indeed, Theorem 3.9(b)
301"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8224101479915433,"leads to the following uniform bounds.
302"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8245243128964059,"Corollary 3.12 Assume that Assumptions 3.2 and 3.3 hold true. Then there exist a constant
303"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8266384778012685,"C > 0 depending on M, ∥K∥∞, ∥K∥2, ∥˜p∥∞and q such that for any δ ∈(0, 1), it can be
304"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.828752642706131,"guaranteed with probability at least 1 −δ that
305"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8308668076109936,"sup
x∈Ω"
KERNEL-BASED ESTIMATORS FOR LINEAR FUNCTIONALS OF THE PERSISTENT MEASURE,0.8329809725158562,"ˇβx,h −E[ˇβx,h]
 ≤CL2"
MAX,0.8350951374207188,"4
max"
MAX,0.8372093023255814,"(
1
nh2 log
1
δh2 , r 1
nh2 r"
MAX,0.8393234672304439,"log
1
δh2 )"
MAX,0.8414376321353065,"As a direct consequence of the previous result, we obtain a uniform error bound for the
306"
MAX,0.8435517970401691,"expected normalized Betti curve, i.e.
307"
MAX,0.8456659619450317,"sup
x∈(0,L)"
MAX,0.8477801268498943,"ˇβx,h −E[ˇβx,h]
 ≤CL2"
MAX,0.8498942917547568,"4
max"
MAX,0.8520084566596194,"(
1
nh2 log
1
δh2 , r 1
nh2 r"
MAX,0.854122621564482,"log
1
δh2 ) ,"
MAX,0.8562367864693446,"To the best of our knowledge this is the first result of this kind, as typically one can only
308"
MAX,0.8583509513742071,"establish pointwise and not uniform consistency of Betti numbers.
309"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8604651162790697,"4
Numerical Illustration and discussion
310"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8625792811839323,"To illustrate our methodology and highlight the differences between the persistence intensity
311"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.864693446088795,"and density functions, we consider the MNIST handwritten digits dataset and the ORBIT5K
312"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8668076109936576,"dataset.
The ORBIT5K dataset contains independent simulations for the linked twist
313"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.86892177589852,"map, dynamical systems for fluid flow as described in [AEK+17]; see also Appendix G.2 of
314"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8710359408033826,"[KKZ+20]. In Section E of the supplementary material, we show the estimated persistence
315"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8731501057082452,"intensity and density functions computed from persistence diagrams obtained over a varying
316"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8752642706131079,"number of random samples from the ORBIT5K datasets, for different model parameters.
317"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8773784355179705,"The figures confirm our theoretical finding that the values of the persistence density function
318"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.879492600422833,"near the diagonal are not as high (on a relative scale) as those of the persistence intensity
319"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8816067653276956,"function. An analogous conclusion can be reached when inspecting the persistence intensity
320"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8837209302325582,"and density functions for different draws of the MNIST datasets for the digits 4 and 8. We
321"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8858350951374208,"further include plots of the average Betti and normalized Betti curves from the ORBIT5K
322"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8879492600422833,"dataset, along with the curves of the empirical point-wise 5% and 95% quantiles. These
323"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8900634249471459,"plots reveal the different scales of the Betti curves and normalized Betti curves, and of their
324"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8921775898520085,"uncertainty.
325"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8942917547568711,"In this paper, we have taken the first step towards developing a new set of methods and
326"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8964059196617337,"theories for statistical inference for TDA based on samples of persistence diagrams. Our main
327"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.8985200845665962,"focus is on the estimation of the persistence intensity function [CD19, CWRW15], a TDA
328"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.9006342494714588,"summary of a functional type that encodes the entire distribution of a random persistence
329"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.9027484143763214,"diagram and is naturally suited to handle linear representations. We have analyzed a simple
330"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.904862579281184,"kernel estimator and derived uniform consistency rates that hold under very mild assumptions.
331"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.9069767441860465,"We also propose the persistence density function, a novel functional TDA summary that
332"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.9090909090909091,"enjoys stronger statistical guarantees. Though our results guarantee that the proposed
333"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.9112050739957717,"estimators are consistent, in order to carry out statistical inference, it is necessary to develop
334"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.9133192389006343,"more sophisticated procedures that quantify the uncertainty of our estimators. Towards that
335"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.9154334038054969,"goal, it would be interesting to develop bootstrap-based methods for constructing confidence
336"
NUMERICAL ILLUSTRATION AND DISCUSSION,0.9175475687103594,"bands for both the persistence intensity and density functions.
337"
REFERENCES,0.919661733615222,"References
338"
REFERENCES,0.9217758985200846,"[AEK+17] Henry Adams, Tegan Emerson, Michael Kirby, Rachel Neville, Chris Peterson, Patrick
339"
REFERENCES,0.9238900634249472,"Shipman, Sofya Chepushtanova, Eric Hanson, Francis Motta, and Lori Ziegelmeier.
340"
REFERENCES,0.9260042283298098,"Persistence images: A stable vector representation of persistent homology. Journal of
341"
REFERENCES,0.9281183932346723,"Machine Learning Research, 18, 2017.
342"
REFERENCES,0.9302325581395349,"[CD19] Frédéric Chazal and Vincent Divol. The density of expected persistence diagrams and
343"
REFERENCES,0.9323467230443975,"its kernel based estimation. Journal of Computational Geometry, 10(2), 2019.
344"
REFERENCES,0.9344608879492601,"[CM21] Frédéric Chazal and Bertrand Michel. An introduction to topological data analysis:
345"
REFERENCES,0.9365750528541226,"Fundamental and practical aspects for data scientists. Frontiers Artif. Intell., 4:667963,
346"
REFERENCES,0.9386892177589852,"2021.
347"
REFERENCES,0.9408033826638478,"[CSEHM10] David Cohen-Steiner, Herbert Edelsbrunner, John Harer, and Yuriy Mileyko. Lipschitz
348"
REFERENCES,0.9429175475687104,"functions have l p-stable persistence.
Foundations of computational mathematics,
349"
REFERENCES,0.945031712473573,"10(2):127–139, 2010.
350"
REFERENCES,0.9471458773784355,"[CWRW15] Yen-Chi Chen, Daren Wang, Alessandro Rinaldo, and Larry Wasserman. Astatistical
351"
REFERENCES,0.9492600422832981,"analysis of persistence intensity functions. https://arxiv.org/pdf/1510.02502.pdf, 2015.
352"
REFERENCES,0.9513742071881607,"[DL21] Vincent Divol and Théo Lacombe. Estimation and quantization of expected persistence
353"
REFERENCES,0.9534883720930233,"diagrams. In International Conference on Machine Learning, pages 2760–2770. PMLR,
354"
REFERENCES,0.9556025369978859,"2021.
355"
REFERENCES,0.9577167019027484,"[DP19] Vincent Divol and Wolfgang Polonik. On the choice of weight functions for linear
356"
REFERENCES,0.959830866807611,"representations of persistence diagrams. Journal of Applied and Computational Topology,
357"
REFERENCES,0.9619450317124736,"3(3):249–283, 2019.
358"
REFERENCES,0.9640591966173362,"[GN21] Evarist Giné and Richard Nickl. Mathematical foundations of infinite-dimensional
359"
REFERENCES,0.9661733615221987,"statistical models. Cambridge university press, 2021.
360"
REFERENCES,0.9682875264270613,"[KKZ+20] Kwangho Kim, Jisu Kim, Manzil Zaheer, Joon Kim, Frederic Chazal, and Larry
361"
REFERENCES,0.9704016913319239,"Wasserman. Pllay: Efficient topological layer based on persistent landscapes. In
362"
REFERENCES,0.9725158562367865,"H. Larochelle, M. Ranzato, R. Hadsell, M.F. Balcan, and H. Lin, editors, Advances
363"
REFERENCES,0.9746300211416491,"in Neural Information Processing Systems, volume 33, pages 15965–15977. Curran
364"
REFERENCES,0.9767441860465116,"Associates, Inc., 2020.
365"
REFERENCES,0.9788583509513742,"[NGK21] Sloan Nietert, Ziv Goldfeld, and Kengo Kato. Smooth p-wasserstein distance: Structure,
366"
REFERENCES,0.9809725158562368,"empirical approximation, and statistical applications. In International Conference on
367"
REFERENCES,0.9830866807610994,"Machine Learning, pages 8172–8183. PMLR, 2021.
368"
REFERENCES,0.985200845665962,"[Pey18] Rémi Peyre. Comparison between w2 distance and ˙H−1 norm, and localization of
369"
REFERENCES,0.9873150105708245,"wasserstein distance.
ESAIM: Control, Optimisation and Calculus of Variations,
370"
REFERENCES,0.9894291754756871,"24(4):1489–1501, 2018.
371"
REFERENCES,0.9915433403805497,"[WNv+21] Georg Wilding, Keimpe Nevenzeel, Rien van de Weygaert, Gert Vegter, Pratyush
372"
REFERENCES,0.9936575052854123,"Pranav, Bernard J T Jones, Konstantinos Efstathiou, and Job Feldbrugge. Persistent
373"
REFERENCES,0.9957716701902748,"homology of the cosmic web – I. Hierarchical topology in ΛCDM cosmologies. Monthly
374"
REFERENCES,0.9978858350951374,"Notices of the Royal Astronomical Society, 507(2):2968–2990, 2021.
375"
