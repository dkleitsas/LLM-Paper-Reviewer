Section,Section Appearance Order,Paragraph
ABSTRACT,0.0,Abstract
ABSTRACT,0.0008149959250203749,"What action sequence aa′a′′ was likely responsible for reaching state s′′′ (from state
1"
ABSTRACT,0.0016299918500407497,"s) in 3 steps? Addressing such questions is important in causal reasoning and in re-
2"
ABSTRACT,0.0024449877750611247,"inforcement learning. Inverse “MDP” models p(aa′a′′|ss′′′) can be used to answer
3"
ABSTRACT,0.0032599837000814994,"them. In the traditional “forward” view, transition “matrix” p(s′|sa) and policy
4"
ABSTRACT,0.004074979625101874,"π(a|s) uniquely determine “everything”: the whole dynamics p(as′a′s′′a′′...|s),
5"
ABSTRACT,0.004889975550122249,"and with it, the action-conditional state process p(s′s′′...|saa′a′′), the multi-step
6"
ABSTRACT,0.0057049714751426246,"inverse models p(aa′a′′...|ssi), etc. If the latter is our primary concern, a natural
7"
ABSTRACT,0.006519967400162999,"question, analogous to the forward case is to which extent 1-step inverse model
8"
ABSTRACT,0.007334963325183374,"p(a|ss′) plus policy π(a|s) determine the multi-step inverse models or even the
9"
ABSTRACT,0.008149959250203748,"whole dynamics. In other words, can forward models be inferred from inverse
10"
ABSTRACT,0.008964955175224124,"models or even be side-stepped. This work addresses this question and variations
11"
ABSTRACT,0.009779951100244499,"thereof, and also whether there are efficient decision/inference algorithms for this.
12"
ABSTRACT,0.010594947025264874,"Keywords
inverse models; reinforcement learning; causality; theory; multi-step models; planning.
13"
INTRODUCTION,0.011409942950285249,"1
Introduction
14"
INTRODUCTION,0.012224938875305624,"Consider an MDP with actions a∈{0,..,k−1} and states s∈{1,...,d}. Rewards play no role in our
15"
INTRODUCTION,0.013039934800325998,"analysis, so controlled Markov process [DY79] or conditional Markov chain may be a more apt
16"
INTRODUCTION,0.013854930725346373,"naming. Transition “matrix” p(s′|sa) (“Forward model”) and policy π(a|s) uniquely determine the
17"
INTRODUCTION,0.014669926650366748,"whole dynamics
18"
INTRODUCTION,0.015484922575387123,"p(as′a′s′′a′′...|s) = π(a|s)·p(s′|sa)·π(a′|s′)·p(s′′|s′a′)·...
(1)"
INTRODUCTION,0.016299918500407497,"and also determines the action-conditional state process (“Multi-Step Forward Model”):
19"
INTRODUCTION,0.017114914425427872,"p(s′s′′...|saa′a′′) = p(as′a′s′′a′′...|s)/
X"
INTRODUCTION,0.017929910350448247,"s′s′′...
p(as′a′s′′a′′...|s)
(2)"
INTRODUCTION,0.018744906275468622,"Here we consider Inverse Model p(a|ss′) and Multi-Step Inverse Models p(aa′a′′...|ss′s′′s′′′...)
20"
INTRODUCTION,0.019559902200488997,"and p(a|ssi) and variations thereof. Inverse MDP models should not be confused with inverse
21"
INTRODUCTION,0.020374898125509373,"reinforcement learning [AD21], which infers rewards, which play no role here.
22"
INTRODUCTION,0.021189894050529748,"Motivation.
One motivation to consider inverse models is causal inference: An inverse model
23"
INTRODUCTION,0.022004889975550123,"captures the likelihood that an action a was the cause of the transition from state s to state s′. A
24"
INTRODUCTION,0.022819885900570498,"multi-step inverse model captures the likelihood that a first action a or action sequence aa′...ai−1
25"
INTRODUCTION,0.023634881825590873,"was the cause of the state sequence ss′...si or the cause of the transition from state s to state si. The
26"
INTRODUCTION,0.02444987775061125,"latter is the primary goal in (automatic/stochastic) planning [HSHB99]: to find an action sequence
27"
INTRODUCTION,0.02526487367563162,"that leads to a desired goal state si =sgoal. The shortest path, i.e. smallest i, that reaches sgoal (with
28"
INTRODUCTION,0.026079869600651995,"high probability in the stochastic case) can easily be found via a trivial search over i=1,2,3,... if the
29"
INTRODUCTION,0.02689486552567237,"fixed-i planning problem can be solved efficiently.
30"
INTRODUCTION,0.027709861450692746,"Another machine-learning motivation is that inverse models may be substantially smaller than
31"
INTRODUCTION,0.02852485737571312,"forward models. For instance, an action-independent Markov process p(s′|sa) = p(s′|s) may
32"
INTRODUCTION,0.029339853300733496,"be very complex for large d, but for a state-independent (known) policy π(a|s) = π(a), the in-
33"
INTRODUCTION,0.03015484922575387,"verse model p(aa′...|s..s′′..) = π(a)π(a′)... is trivial (and known). Of course this extreme case
34"
INTRODUCTION,0.030969845150774247,"is uninteresting, but a partial similar simplification happens if state s decomposes into s = ( ˙s,¨s)
35"
INTRODUCTION,0.03178484107579462,"[EMK+22]. In this case, if the forward model p(s′|sa) factors into a (simple) controlled p( ˙s′| ˙sa)
36"
INTRODUCTION,0.032599837000814993,"and (complex) uncontrolled p(¨s′|¨s), and the policy π(a|s)=π(a| ˙s) only depends on (small) ˙s, then
37"
INTRODUCTION,0.03341483292583537,"p(aa′...|s..s′′..)=p(aa′...| ˙s.. ˙s′′..) is independent of (large) ¨s. Note that this simplification happens
38"
INTRODUCTION,0.034229828850855744,"“automatically”. We do not need to know the factorization structure, say ( ˙s,¨s) = f(s) for some
39"
INTRODUCTION,0.03504482477587612,"unknown f. Appendix B contains a bit of practical context/motivation/application.
40"
INTRODUCTION,0.035859820700896494,"Main questions.
41"
INTRODUCTION,0.03667481662591687,"The main question we consider here is:
42"
INTRODUCTION,0.037489812550937245,"to which extent do inverse model p(a|ss′) plus policy π(a|s)
43"
INTRODUCTION,0.03830480847595762,"determine the multi-step inverse model or even the whole dynamics.
44"
INTRODUCTION,0.039119804400977995,"For instance, do p(a|ss′) plus π(a|s) determine
45"
INTRODUCTION,0.03993480032599837,"(i) the full dynamics (1),
46"
INTRODUCTION,0.040749796251018745,"(ii) the full dynamics, if also p(aa′|ss′′) is provided,
47"
INTRODUCTION,0.04156479217603912,"(iii) the multi-step inverse model p(aa′...|ssi) (or p(aa′...|ss′s′′...)),
48"
INTRODUCTION,0.042379788101059496,"(iv) the multi-step inverse model p(aa′...|ssi) (or p(aa′...|ss′s′′)), if also p(a|ss′′) is provided,
49"
INTRODUCTION,0.04319478402607987,"(v) just the initial action p(a|ss′′) from just final state s′′,
50"
INTRODUCTION,0.044009779951100246,"(vi) p(a|ssi) if also p(a|ss′′) is provided,
51"
INTRODUCTION,0.04482477587612062,"and variations thereof? Also, is there an efficient algorithm that can decide whether the solution is
52"
INTRODUCTION,0.045639771801140996,"unique and/or computes any or all of them?
53"
INTRODUCTION,0.04645476772616137,"Unlike in the “forward” case (1), the answer to all these questions is ‘complicated’ and ‘sometimes’.
54"
INTRODUCTION,0.04726976365118175,"For instance, (i) is true iff k ≥d and p(s′|sa) has full rank. (ii) seems true for “most” transition
55"
INTRODUCTION,0.04808475957620212,"matrices. (iii-vi) can fail, but (iv) and (vi) seem to hold for interesting cases. In some situations there
56"
INTRODUCTION,0.0488997555012225,"are efficient algorithms which sometimes work.
57"
INTRODUCTION,0.04971475142624287,"Related work.
There is of course abundant literature on causal reasoning in general [PGJ16], and
58"
INTRODUCTION,0.05052974735126324,"in the modern context of Deep Learning in particular [OKD+21], but to the best of our knowledge,
59"
INTRODUCTION,0.05134474327628362,"the setup and questions we are asking are novel, at least in this generality and rigor.
60"
INTRODUCTION,0.05215973920130399,"A special case of our setup is considered in [EMK+22]. The authors consider Exogenous Block MDPs
61"
INTRODUCTION,0.05297473512632437,"(EX-BMDPs) which correspond to the motivating decomposition example above, and formalized in
62"
INTRODUCTION,0.05378973105134474,"Section 3 as tensor-product MDPs. Additionally they assume episodic MDPs with near-deterministic
63"
INTRODUCTION,0.05460472697636512,"dynamics. Their PPE algorithm finds action sequences of high inverse probability p(aa′...ai−1|ssi)
64"
INTRODUCTION,0.05541972290138549,"in polynomial time in ˙s rather than s, while our aim is to infer higher- from lower-step inverse models
65"
INTRODUCTION,0.05623471882640587,"for general MDPs.
66"
INTRODUCTION,0.05704971475142624,"In the context of Deep Learning, there is ample empirical work that would benefit from a positive
answer to our main question: Variational Intrinsic Control [GRW17] and Diversity is All You
Need [EGIL18] are representative of a broad class of methods that learn diverse options (policies /
action sequences) that are inferrable from their effects on the environment. This relies on inverse
modelling, as their mutual information objective is decomposed into maximizing skill/policy entropy
and minimizing the entropy of an inverse model:"
INTRODUCTION,0.05786471067644662,I(si;a...ai−1|s)≡H(a...ai−1|s)–H(aa′...ai−1|ssi)
INTRODUCTION,0.05867970660146699,"This is akin to finding all action sequences of sufficiently high probability p(aa′...ai−1|ssi), or all
67"
INTRODUCTION,0.059494702526487364,"skills when the policy space is captured by an auxiliary variable p(z|ssi). The EDDICT algorithm
68"
INTRODUCTION,0.06030969845150774,"[HDB+21] also maximizes this objective, and parameterizes the requisite inverse models such that
69"
INTRODUCTION,0.061124694376528114,"they yield forward predictions, but as detailed in Section 4 its unlikely that such models would yield
70"
INTRODUCTION,0.06193969030154849,"optimal multi-step inverse predictions in general. Dynamics-Aware Unsupervised Discovery of Skills
71"
INTRODUCTION,0.06275468622656886,"[SGL+19] decomposes the mutual information in the opposite direction, so as to avoid learning an
72"
INTRODUCTION,0.06356968215158924,"inverse model and instead relies on a conventional forward model. Uniting all of the above mentioned
73"
INTRODUCTION,0.06438467807660962,"methods is that the action sequence/skill horizon i must be fixed a priori. Inferring long horizon
74"
INTRODUCTION,0.06519967400162999,"inverse models from shorter ones (the topic of the present work) would allow all of these methods to
75"
INTRODUCTION,0.06601466992665037,"circumvent this constraint.
76"
INTRODUCTION,0.06682966585167074,"A second stream of empirical work uses single-step inverse models for representation learning
77"
INTRODUCTION,0.06764466177669112,"[BEP+18]. Agent57 is arguably the most prominent of these methods [BPK+20], and therein the
78"
INTRODUCTION,0.06845965770171149,"authors note that this choice of representation limits the generality of their approach, as multi-step
79"
INTRODUCTION,0.06927465362673187,"effects can be aliased over. Despite this being a known limitation, multi-step inverse models are not
80"
INTRODUCTION,0.07008964955175224,"used as they are too cumbersome to effectively learn online. A positive result to our questions (iii)
81"
INTRODUCTION,0.07090464547677261,"or (iv) would allow such methods to leverage multi-step inverse predictions despite only learning a
82"
INTRODUCTION,0.07171964140179299,"single-step model.
83"
INTRODUCTION,0.07253463732681337,"These two beneficiaries of improvements to the construction of multi-step inverse models (filtering
84"
INTRODUCTION,0.07334963325183375,"action sequences and state abstraction) dovetail into potential benefits for a broad range of planning
85"
INTRODUCTION,0.07416462917685411,"algorithms. Exploiting this relationship between the questions addressed here and planning problems
86"
INTRODUCTION,0.07497962510187449,"is left to future work, but we sketch out the motivation more fully in Section B.
87"
INTRODUCTION,0.07579462102689487,"Contents.
In Section 2 we will formalize questions (i)-(vi) in matrix/tensor notation. Section 3
88"
INTRODUCTION,0.07660961695191525,"gives a first probe into these questions by considering various degenerate cases. In Section 4 we
89"
INTRODUCTION,0.07742461287693561,"study the solvability and uniqueness questions (i),(iii),(v), when only Ba is given, i.e. the case
90"
INTRODUCTION,0.07823960880195599,"i = 1, in preparation for and showing the necessity of considering i > 1. In Section 5 we provide
91"
INTRODUCTION,0.07905460472697637,"a polynomial-time algorithm via linear relaxation that works under certain conditions. Section 6
92"
INTRODUCTION,0.07986960065199673,"provides some validation experiments on toy domains. Section 7 concludes, followed by references.
93"
INTRODUCTION,0.08068459657701711,"Appendices A-R contain a list of notation, more motivation, counter-examples, experiments, and
94"
INTRODUCTION,0.08149959250203749,"more.
95"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.08231458842705787,"2
Problem Formalization and Preliminaries
96"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.08312958435207823,"We now formalize our questions (i)-(vi) from the introduction, and for this purpose introduce some
97"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.08394458027709861,"useful matrix notation. We are not aware of prior work addressing these questions, so quite some
98"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.08475957620211899,"ground-work to suitably formalize the various question is needed, and many little results are derived
99"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.08557457212713937,"or mentioned in passing to give better insight into the structure of the problem. To avoid clutter, we
100"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.08638956805215973,"will not constantly point out edge cases or domain constraints. For instance quantities that represent
101"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.08720456397718011,"probabilities are obviously non-negative and sum to one. The reader worried about divisions by 0
102"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.08801955990220049,"here and there should best assume that all probabilities are strictly positive, but most considerations
103"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.08883455582722087,"and results naturally generalize with some care, e.g. by adding “almost surely” w.r.t. to the joint
104"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.08964955175224124,"distribution (1). Appendix Q contains a proper treatment of 0/0.
105"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.09046454767726161,"Notation.
Capital letters B,D,I,M,W,... are used for d×d matrices over [0;1] ⊂R and tensors
106"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.09127954360228199,"by adding further upper indices, e.g. M ·
·· is an order-3 tensor, and M a
·· a matrix for each a ∈{0 :
107"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.09209453952730236,"k−1}:={0,...,k−1}, and A,C,V,... are other tensors. We define Id to be the identity (eye) matrix
108"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.09290953545232274,"Idss′ := δss′ := [[s = s′]] ∀s,s′ ∈{1 : d}, and I to be the all-one matrix Iss′ = 1 ∀ss′. We drop all-
109"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.09372453137734311,"quantifiers ∀s,s′,... if clear from context. Let ⊙denote element-wise (Hadamard) multiplication
110"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.0945395273023635,"([A⊙B]ss′ =Ass′Bss′), and similarly ⊘, while (no) · represents (conventional) matrix multiplication
111"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.09535452322738386,"and has operator precedence over ⊙and ⊘. Matrices form a ring under conventional (+,·) and
112"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.09616951915240424,"a commutative ring under (+,⊙), but (A·B)⊙C ̸= A·(B ⊙C). A diagonal matrix D has the
113"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.09698451507742462,"property D = D⊙Id, i.e. Dss′ = Dss[[s = s′]]. V := I ·D is a matrix with Dss in the whole of
114"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.097799511002445,column s (Vss′ =V∗s′ =Ds′s′). Note that A·D=A⊙V ([A·D]ss′′ =P
PROBLEM FORMALIZATION AND PRELIMINARIES,0.09861450692746536,"s′Ass′Ds′s′′ =Ass′′Ds′′s′′ =
115"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.09942950285248574,"Ass′′V∗s′′ = [A⊙V ]ss′′). Similar left-right reversed identities hold. ⊥denotes ‘undefined’. See
116"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.10024449877750612,"Appendix A for a full List of Notation.
117"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.10105949470252648,"Matrix/tensor formalization.
We define M a
ss′ :=p(as′|s)=π(a|s)p(s′|sa). Marginalizing out the
118"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.10187449062754686,"action, gives p(s′|s)=P"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.10268948655256724,ap(as′|s)=P
PROBLEM FORMALIZATION AND PRELIMINARIES,0.10350448247758762,"aM a
ss′ =:M +
ss′. Marginalizing out the next-state, gives back
119"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.10431947840260798,π(a|s)=P
PROBLEM FORMALIZATION AND PRELIMINARIES,0.10513447432762836,s′p(as′|s)=P
PROBLEM FORMALIZATION AND PRELIMINARIES,0.10594947025264874,"s′M a
ss′ =:M +
sa. For instance, the multi-step dynamics can be written as
120"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.10676446617766912,"p(as′a′s′′...|s) = p(as′|s)·p(a′s′′|a′)·... = M a
ss′M a′
s′s′′..."
PROBLEM FORMALIZATION AND PRELIMINARIES,0.10757946210268948,"Marginalizing out the intermediate states gives
121"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.10839445802770986,p(aa′...ai−1si|s) = [M a·M a′...·M ai−1]ssi
PROBLEM FORMALIZATION AND PRELIMINARIES,0.10920945395273024,"The inverse MDP model can then be expressed as
122"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1100244498777506,"Ba
ss′ := p(a|ss′) = p(as′|s)/p(s′|s) = M a
ss′/M +
ss′ = [M a⊘M +]ss′"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.11083944580277098,"The multi-step inverse model given the whole state sequence becomes
123"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.11165444172779136,p(aa′...|ss′s′′...) = p(as′|s)p(a′s′′|s′)...
PROBLEM FORMALIZATION AND PRELIMINARIES,0.11246943765281174,"p(s′|s)p(s′′|s′)...
= M a
ss′M a′
s′s′′...
M +
ss′M +
s′s′′... = p(a|ss′)p(a′|s′s′′)...
(3)"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1132844335778321,"and can easily be computed from the 1-step inverse models. To answer the primary question: which
124"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.11409942950285248,"action sequence can lead to (desired) state si from state s, we need to marginalize out s′...si−1. For
125"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.11491442542787286,"instance, the two-step inverse model from s to s′′ with s′ marginalized out becomes
126"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.11572942135289324,"Baa′
ss′′ := p(aa′|ss′′) =
P"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1165444172779136,"s′M a
ss′M a′
s′s′′
P"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.11735941320293398,"s′M +
ss′M +
s′s′′
= [M a·M a′ ⊘(M +)2]ss′′
(4)"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.11817440912795436,"Note that unlike the forward case, Baa′ ̸= Ba·Ba′, which is responsible for all the problems we
127"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.11898940505297473,"will face. Also Ba+ ̸=Ba but B+ =1=B++. We always use brackets to denote and disambiguate
128"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1198044009779951,"(matrix) powers ()2 from upper indices M a. The initial-action 2-step (and similarly i-step) inverse
129"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.12061939690301549,"models follow from further marginalizing a′a′′...:
130"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.12143439282803586,"Ba+
ss′′ = p(a|ss′′) = [M aM +⊘(M +)2]ss′′,"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.12224938875305623,Ba+i−1
PROBLEM FORMALIZATION AND PRELIMINARIES,0.12306438467807661,"ssi
= p(a|ssi) = [M a(M +)i−1⊘(M +)i]ssi
(5)"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.12387938060309699,"With this notation, questions (i-vi) in the introduction can formally be written as
131"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.12469437652811736,"(i) Can M be inferred from Ba :=M a⊘M +?
132"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.12550937245313773,"(ii) Can M be inferred from Ba and Baa′ :=M aM a′ ⊘(M +)2?
133"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1263243683781581,"(iii) Can Baa′...ai :=M aM a′...M ai ⊘(M +)i be inferred from Ba?
134"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1271393643031785,"(iv) Can Baa′...ai be inferred from Ba and Baa′?
135"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.12795436022819887,"(v) Can Ba+ :=M aM +⊘(M +)2 be inferred from Ba?
136"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.12876935615321924,"(vi) Can Ba++ :=M a(M +)2⊘(M +)3 be inferred from Ba and Ba+?
137"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1295843520782396,"Each question comes in two versions, given also π, or not knowing π. We mainly consider the former
138"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.13039934800325997,"version, i.e. knowing M a
s+:
139"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.13121434392828035,"Constraint on M for known π: M a
s+ = π(a|s) and in particular M +
s+ = 1
(6)"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.13202933985330073,"Questions (i)-(vi) also have multiple variations:
140"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1328443357783211,"(I) Assume some arbitrary Ba (and Baa′) is given, but not defined via M.
141"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1336593317033415,"Is there no, exactly one, or multiple M consistent with these B?
142"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.13447432762836187,"(II) Is there an efficient algorithm that can decide the previous question?
143"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.13528932355338225,"(III) Is there an efficient algorithm that can compute any/all solutions if one/many exist, and
144"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1361043194784026,"halts/loops if not (4 non-trivial combinations of /).
145"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.13691931540342298,"(IV) Can we efficiently determine the “number” of solutions,
146"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.13773431132844335,"e.g. the dimension of the variety formed by the set of all solutions.
147"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.13854930725346373,"Formulation of the uniqueness questions.
Abstractly, these questions ask whether M (in case
148"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1393643031784841,"of (i-ii)) or g(M) for some function g (in case of (iii-vi)) can be inferred from some other function
149"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1401792991035045,"f(M). Let us define another MDP q(s′|sa) with same policy π(s|a) and shorthand
150"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.14099429502852487,"W a
ss′ := π(a|s)q(s′|sa)"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.14180929095354522,"(In applications, Ba would be learned from data, and W or Baa′... inferred from Ba in the hope
151"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1426242868785656,"that W ≈M.) One way to rephrase the questions is whether f(M) = f(W) implies M = W or
152"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.14343928280358598,"g(M) = g(W) for all (or most or some) M and W. The condition that π is the same for p and q,
153"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.14425427872860636,"translates to
154"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.14506927465362673,"Constraint on M and W: M a
s+ =π(a|s)=W a
s+
and in particular M +
s+ = 1 = W +
s+
(7)"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1458842705786471,"We name the two most interesting equation versions as follows:
155"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1466992665036675,"EqIM(ia): Baa′...ai := M aM a′...M ai ⊘(M +)i
?= W aW a′...W ai ⊘(W +)i
(8)"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.14751426242868787,"EqIM(i+): Ba+...+ :=
M a(M +)i−1⊘(M +)i
?= W a(W +)i−1⊘(W +)i
(9)"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.14832925835370822,"We allow M +
ss′ = 0 and keep probabilistic convention that p(a|ss′) = π(a|s)p(s′|sa)/p(s′|s) is
156"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.1491442542787286,"undefined iff p(s′|s)=0 (see end of Appendix J and Appendix Q for more discussion). Formally,
157"
PROBLEM FORMALIZATION AND PRELIMINARIES,0.14995925020374898,"Ba
ss′ =⊥=0/0 iff M +
ss′ =0, also W +
ss′ =0 iff M +
ss′ =0, and similarly for larger i.
158"
DEGENERATIVE CASES,0.15077424612876936,"3
Degenerative Cases
159"
DEGENERATIVE CASES,0.15158924205378974,"To get some feeling about why these questions are so more intricate than analogous ones in for-
160"
DEGENERATIVE CASES,0.15240423797881011,"ward models, we consider some simple examples and special cases first, with details provided in
161"
DEGENERATIVE CASES,0.1532192339038305,"Appendix D. Some further special cases (deterministic planning, deterministic reachability, and
162"
DEGENERATIVE CASES,0.15403422982885084,"deterministic inverse models) are considered in Appendix E. There is a strong relationship between
163"
DEGENERATIVE CASES,0.15484922575387122,"the examples violating (i,iii,v) and counter-examples to seemingly different conjectures found in
164"
DEGENERATIVE CASES,0.1556642216788916,"related work. See Section C for details.
165"
DEGENERATIVE CASES,0.15647921760391198,It is easy to see that e.g. M 0 = 1
DEGENERATIVE CASES,0.15729421352893236,"4
 0 2
1 1

, M 1 = 1"
DEGENERATIVE CASES,0.15810920945395274,"4
 2 0
1 1

, W 0 = 1"
DEGENERATIVE CASES,0.15892420537897312,"2
 0 1
1 0

, W 1 = 1"
DEGENERATIVE CASES,0.15973920130399347,"2
 1 0
1 0

satisfy EqIM(1) but
166"
DEGENERATIVE CASES,0.16055419722901385,"violate EqIM(2), which means that the 1-step inverse model Ba does not always uniquely determine
167"
DEGENERATIVE CASES,0.16136919315403422,"the 2-step inverse model Baa′, i.e. (i,iii,v) can fail. M =W trivially implies g(M)=g(W), which
168"
DEGENERATIVE CASES,0.1621841890790546,"means that if (i) is true, then trivially also (iii&v), and if (ii) is true, then trivially also (iv&vi). If M a
ss′
169"
DEGENERATIVE CASES,0.16299918500407498,"is independent a or s′ or M a
ss′ = Mss′πa, then Baa′a′′... = k−i is independent M, so any W ̸= M
170"
DEGENERATIVE CASES,0.16381418092909536,"leads to the same B, which shows that (i) and (ii) and higher order analogues can fail. If M and W
171"
DEGENERATIVE CASES,0.16462917685411574,"are independent s, then EqIM(1) actually implies EqIM(i)∀i. Since there are such M ̸=W satisfying
172"
DEGENERATIVE CASES,0.16544417277913612,"EqIM(1), this constitutes another failure case of (i) and (ii). For block-diagonal M =
  ˙
M 0
0 ¨
M

and
173"
DEGENERATIVE CASES,0.16625916870415647,"W =
  ˙W 0
0 ¨
W

, all operations (+−×/⊙⊘) preserve the block structure, so the above degenerative
174"
DEGENERATIVE CASES,0.16707416462917685,"cases can be combined, one for the upper-left block and another for the lower-right block. The most
175"
DEGENERATIVE CASES,0.16788916055419723,"interesting special case is as follows:
176"
DEGENERATIVE CASES,0.1687041564792176,"Tensor-product M and W .
Let [ ˙M⊗¨
M]ss′ := ˙M ˙s ˙s′ ¨
M¨s¨s′ with s:=( ˙s,¨s) and s′:=( ˙s′,¨s′) be the ten-
177"
DEGENERATIVE CASES,0.16951915240423798,"sor product of ˙M and ¨
M (not to be confused with the element-wise product ⊙). Assume M a= ˙M a⊗
178"
DEGENERATIVE CASES,0.17033414832925836,"¨
M, where the second factor is action-independent. In this case, M aM a′...=( ˙M a ˙M a′...)⊗( ¨
M ¨
M...),
179"
DEGENERATIVE CASES,0.17114914425427874,"and similarly if a,a′,... is replaced by +, hence M aM a′...M ai ⊘(M +)i = ˙M a ˙M a′... ˙M ai ⊘( ˙M +)i
180"
DEGENERATIVE CASES,0.1719641401792991,"is independent of ¨
M, and similarly for W a = ˙W a⊗¨W. That means, EqIM(i) hold if ˙M a = ˙W a,
181"
DEGENERATIVE CASES,0.17277913610431947,"whatever ¨
M and ¨W are. This formalizes our motivating example that if some part of the state (¨s)
182"
DEGENERATIVE CASES,0.17359413202933985,"is not controlled (by a) and the dynamics factorizes (p(s′|sa) = p( ˙s′| ˙sa)p(¨s′|¨s)) and the policy is
183"
DEGENERATIVE CASES,0.17440912795436023,"independent ¨s (π(a|s)=π(a| ˙s)), then the multi-step inverse models (3-5) become much simpler than
184"
DEGENERATIVE CASES,0.1752241238793806,"the forward model (2), namely independent ¨s. This case has been studied in [EMK+22] for episodic
185"
DEGENERATIVE CASES,0.17603911980440098,"near-deterministic M.
186"
DEGENERATIVE CASES,0.17685411572942136,"4
(Non)Uniqueness of Inverse MDP Models
187"
DEGENERATIVE CASES,0.17766911165444174,"We will now consider EqIM(1) and EqIM(2). We first provide a dimensional analysis which gives
188"
DEGENERATIVE CASES,0.1784841075794621,"some insight and tentative answers about the solution space for W (given B or M): No, one, finitely
189"
DEGENERATIVE CASES,0.17929910350448247,"many, or a polynomial variety (of some dimension) of solutions. We then consider EqIM(1) only
190"
DEGENERATIVE CASES,0.18011409942950285,"and characterize M and W for which it holds. This will be used to provide an algorithm that can
191"
DEGENERATIVE CASES,0.18092909535452323,"determine a (and in some sense all) solution for W and hence Baa′..., given only Ba. EqIM(1)
192"
DEGENERATIVE CASES,0.1817440912795436,"is quite simple, since it is effectively linear, but EqIM(2) is quadratic in W, which is where the
193"
DEGENERATIVE CASES,0.18255908720456399,"difficulties start.
194"
DEGENERATIVE CASES,0.18337408312958436,"Dimensional analysis / counting solutions.
Assume k ≤d and B· or M · are given. The kd2
195"
DEGENERATIVE CASES,0.18418907905460472,"equations EqIM(1) in W constitute (k−1)d2 (linear) constraints on (the kd2 real entries in) W. It’s
196"
DEGENERATIVE CASES,0.1850040749796251,"only (k−1)d2, since summing over a gives d2 vacuous equations B+ =1=W +⊘W +. There are
197"
DEGENERATIVE CASES,0.18581907090464547,"kd further (linear) constraints W a
s+ =π(a|s). Assuming no further (missed/accidental) redundancies,
198"
DEGENERATIVE CASES,0.18663406682966585,"this leads to a kd2−(k−1)d2−kd = d(d−k) dimensional (linear) solution space for W. This is
199"
DEGENERATIVE CASES,0.18744906275468623,"consistent with the algorithm below inferring Baa′ from Ba if all Ba have full rank. Hence the set of
200"
DEGENERATIVE CASES,0.1882640586797066,"solutions for Baa′ forms a polynomial variety of dimension at least d(d−k).
201"
DEGENERATIVE CASES,0.189079054604727,"If also Ba+ is given, EqIM(2+) provides (k−1)d2 further (quadratic) constraints (EqIM(ia) even
202"
DEGENERATIVE CASES,0.18989405052974734,"provides (ki−1)d2 constraints). Since d(d−k)<(k−1)d2, this now gives an over-determined system
203"
DEGENERATIVE CASES,0.19070904645476772,"which generally has no solution. But by assumption, M is a solution, which gives hope that there
204"
DEGENERATIVE CASES,0.1915240423797881,"may be only one or a finite number of solutions.
205"
DEGENERATIVE CASES,0.19233903830480847,"We can use the kd+(k−1)d2 linear equations to eliminate this number of variables in W, which leaves
206"
DEGENERATIVE CASES,0.19315403422982885,"(k−1)d2 quadratic equations, now in only d(d−k) variables, and no further equality constraints.
207"
DEGENERATIVE CASES,0.19396903015484923,"By B´ezout’s bound [FW89], such a System of Quadratic Equations (SQE), either has a continuum
208"
DEGENERATIVE CASES,0.1947840260798696,"number of solutions (as in the counter-example of Appendix K) or at most 2d(d−k) solutions (as
209"
DEGENERATIVE CASES,0.19559902200489,"possibly in the counter-example in Appendix J). Multiple discrete solutions are often caused by
210"
DEGENERATIVE CASES,0.19641401792991034,"symmetries, so for random Ba and Ba+ consistent with M, the solution may indeed be unique.
211"
DEGENERATIVE CASES,0.19722901385493072,"Inferring some Baa′ from Ba.
Even if Ba does not uniquely determine Baa′, we can ask for
212"
DEGENERATIVE CASES,0.1980440097799511,"an algorithm inferring some consistent Baa′ from Ba. Indeed this was our primary goal before
213"
DEGENERATIVE CASES,0.19885900570497148,"realizing that the answer is not always unique. We know that Ba = W a⊘W + for some W. This
214"
DEGENERATIVE CASES,0.19967400162999185,"implies W a = Ba⊙W +. So W a = Ba⊙J for some J independent a. We need to ensure proper
215"
DEGENERATIVE CASES,0.20048899755501223,"normalization W a
s+ = π(a|s), i.e. [Ba⊙J]s+ = π(a|s). This leads to the following algorithm to
216"
DEGENERATIVE CASES,0.2013039934800326,"produce some (and indeed all) Baa′:
217"
DEGENERATIVE CASES,0.20211898940505296,"• Given inverse 1-step model Ba
ss′ :=p(a|ss′) and policy π(a|s)
218"
DEGENERATIVE CASES,0.20293398533007334,"• For each s, choose some d-vector Js·
219"
DEGENERATIVE CASES,0.20374898125509372,satisfying the k linear equations P
DEGENERATIVE CASES,0.2045639771801141,"s′Ba
ss′Jss′ =π(a|s)
220"
DEGENERATIVE CASES,0.20537897310513448,"• Compute forward model W a :=Ba⊙J
221"
DEGENERATIVE CASES,0.20619396903015486,"• Compute 2-step inverse model Baa′ :=W aW a′ ⊘(W +)2
222"
DEGENERATIVE CASES,0.20700896495517523,"• Then p(aa′|ss′′)≡Baa′
ss′′ is some solution.
223"
DEGENERATIVE CASES,0.2078239608801956,"If for every s, matrix B·
s· has rank d, then Baa′ is unique. The equations have no solution iff B is
224"
DEGENERATIVE CASES,0.20863895680521596,"invalid in the sense that no underlying MDP M could have produced such B. This can only happen
225"
DEGENERATIVE CASES,0.20945395273023634,"for k>d, i.e. B based on M have some intrinsic constraints beyond B+ =1 for k>d. For instance
226"
DEGENERATIVE CASES,0.21026894865525672,B0 = 1
DEGENERATIVE CASES,0.2110839445802771,"2
 1 0
1 0

, B1 = 1"
DEGENERATIVE CASES,0.21189894050529748,"2
 0 1
0 1

, B2 = 1"
DEGENERATIVE CASES,0.21271393643031786,"2
 1 1
1 1

is inconsistent with π(a|s)= 1"
DEGENERATIVE CASES,0.21352893235533824,"3. For unknown π, any J with
227"
DEGENERATIVE CASES,0.2143439282803586,"Js+ = 1 will do. In general, the valid J span a linear subspace, but the set of all consistent Baa′
228"
DEGENERATIVE CASES,0.21515892420537897,"forms an algebraic variety of equal or lower dimension. Baa′ may even be unique even if J and W
229"
DEGENERATIVE CASES,0.21597392013039934,"are not (see Section 3). Noting that the ranks of M ·
s· and W ·
s· are the same, this gives the precise
230"
DEGENERATIVE CASES,0.21678891605541972,"conditions under which (i) is true:
231"
DEGENERATIVE CASES,0.2176039119804401,Proposition 1 (Conditions under which (i) is true)
DEGENERATIVE CASES,0.21841890790546048,"M a⊘M + =W a⊘W + implies M =W
iff
M ·
s· has rank ≥d for every s."
DEGENERATIVE CASES,0.21923390383048086,"For this to be possible at all, we need k≥d, i.e. more actions than states. This is typically not the most
232"
DEGENERATIVE CASES,0.2200488997555012,"interesting regime. See Appendix F for an alternative derivation of this result without an intermediary
233"
DEGENERATIVE CASES,0.2208638956805216,"algorithm.
234"
DEGENERATIVE CASES,0.22167889160554197,"We will next show that EqIM(2) removes this limitation, but we do not know of a general and efficient
235"
DEGENERATIVE CASES,0.22249388753056235,"algorithm for inferring (some) Baa′a′′ from Ba and Baa′. We cannot even rule out that finding
236"
DEGENERATIVE CASES,0.22330888345558272,"approximate solutions is NP-hard.
237"
DEGENERATIVE CASES,0.2241238793806031,"(Non)Uniqueness of Inverse MDP Models for i≥2.
Above we have established that Ba does not
238"
DEGENERATIVE CASES,0.22493887530562348,"uniquely determine Baa′ for the interesting regime of k<d. From the dimensional analysis, providing
239"
DEGENERATIVE CASES,0.22575387123064386,"2-step inverse model Baa′ in addition, has the potential of uniquely determining forward model W
240"
DEGENERATIVE CASES,0.2265688671556642,"and/or multi-step inverse models Baa′a′′.... We have numerically verified that this is indeed the case
241"
DEGENERATIVE CASES,0.2273838630806846,"for Ba and Baa′ based on random M a. A more detailed analysis of the linear/quadratic structure of
242"
DEGENERATIVE CASES,0.22819885900570497,"the problem is provided in Appendix G and a rank analyses in Appendices H and R. Unfortunately,
243"
DEGENERATIVE CASES,0.22901385493072535,"even providing Ba and Baa′ does not always uniquely determine M a, nor higher B, and (ii,iv,vi) fail
244"
DEGENERATIVE CASES,0.22982885085574573,"for some M a. Furthermore this remains true for higher i-versions, i.e. even EqIM(1)...EqIM(i) do
245"
DEGENERATIVE CASES,0.2306438467807661,"not always uniquely determine EqIM(i+1). We provide (potential) counter-examples in Appendices I
246"
DEGENERATIVE CASES,0.23145884270578648,"and J, but they involve “bad” 0/0. We discuss what this means at the end of Appendix J. We provide a
247"
DEGENERATIVE CASES,0.23227383863080683,"fully satisfactory counter-example in Appendix K. If the solution is not unique, the set of solutions
248"
DEGENERATIVE CASES,0.2330888345558272,"forms a polynomial variety. Its (local) dimension measures the “number” of other solutions (in a
249"
DEGENERATIVE CASES,0.2339038304808476,"neighborhood). In Appendix R we provide explicit expressions for the tangent spaces from which
250"
DEGENERATIVE CASES,0.23471882640586797,"these dimension can efficiently be calculated.
251"
LINEAR RELAXATION,0.23553382233088835,"5
Linear Relaxation
252"
LINEAR RELAXATION,0.23634881825590873,"In Section 4 we provided an algorithm if only Ba is given. Here we consider the i > 1 case, and
253"
LINEAR RELAXATION,0.2371638141809291,"derive an algorithm for ki ≥d, provided the solution is unique and further conditions on B are met.
254"
LINEAR RELAXATION,0.23797881010594946,"That is, we require i≥logk(d), which is greater than the minimum necessary in theory i=2 from
255"
LINEAR RELAXATION,0.23879380603096984,"the dimensional analysis. E.g. for i = 1 we recover k ≥d, and i = 2 improves this to k ≥
√"
LINEAR RELAXATION,0.2396088019559902,"d, and
256"
LINEAR RELAXATION,0.2404237978810106,"i=⌈log2(d)⌉works for all k.
257"
LINEAR RELAXATION,0.24123879380603097,"Recursive formulation.
From EqIM(1) we know that W a=Ba⊙W +. Plugging this into EqIM(ia)
258"
LINEAR RELAXATION,0.24205378973105135,"and abbreviating a:i :=aa′...ai and a<i :=aa′...ai−1 and j :=i+1, this gives
259"
LINEAR RELAXATION,0.24286878565607173,"Ba:i ⊙(W +)i = (Ba⊙W +)·...·(Bai ⊙W +)
(10)"
LINEAR RELAXATION,0.2436837815810921,"If we plug EqIM((i−1)a) into EqIM(ia) and abbreviate V :=(W +)i−1 this simplifies to
260"
LINEAR RELAXATION,0.24449877750611246,Ba:i ⊙(V ·W +) = (Ba<i ⊙V )·(Bai ⊙W +)
LINEAR RELAXATION,0.24531377343113284,"which written out becomes
261 X"
LINEAR RELAXATION,0.24612876935615322,"si
Ba:i
ssjVssiW +
sisj =
X"
LINEAR RELAXATION,0.2469437652811736,"si
Ba<i
ssi VssiBai
sisjW +
sisj
(11)"
LINEAR RELAXATION,0.24775876120619397,"Linear relaxation.
We can consider a linear relaxation of this System of Polynomial Equations
262"
LINEAR RELAXATION,0.24857375713121435,"(SPE) by introducing new variables Ussisj (aiming at Ussisj =VssiW +
sisj):
263 X"
LINEAR RELAXATION,0.24938875305623473,"si
Aa:i
ssisjUssisj = 0
with
Aa:i
ssisj := Ba:i
ssj −Ba<i
ssi Bai
sisj
(12)"
LINEAR RELAXATION,0.2502037489812551,"These are kid2 potentially independent linear equations in d3 unknowns U. The solution can only be
264"
LINEAR RELAXATION,0.25101874490627546,"unique if ki ≥d. For random B, for each fixed (s,sj), the ki×d matrix A···
s·sj has indeed full rank
265"
LINEAR RELAXATION,0.25183374083129584,"min{ki,d}≥d, hence Ussisj ≡0 is the only solution. This is inconsistent with the constraints (7),
266"
LINEAR RELAXATION,0.2526487367563162,"and hence shows that (unrestricted random) B do not come from some M. This makes the validity of
267"
LINEAR RELAXATION,0.2534637326813366,"the B’s sometimes semi-decidable in time O(d4(d+ki)) or typically/randomized time O(d5). For
268"
LINEAR RELAXATION,0.254278728606357,"the B’s originating from some M, ˆUssisj =(M +)i−1
ssi M +
sisj solves (12). Since for different ssj the
269"
LINEAR RELAXATION,0.25509372453137735,"equations in (12) are independent, Ussisj := ˆUssisjKssj also solves (12) for any K. In other words,
270"
LINEAR RELAXATION,0.25590872045639773,"the rank of A···
s·sj is bounded by min{ki,d−1}, and achieved e.g. for random matrices B consistent
271"
LINEAR RELAXATION,0.2567237163814181,"with M. Since the solution is not unique, for many solutions U there will be no W + satisfying
272"
LINEAR RELAXATION,0.2575387123064385,"Ussisj =(W +)i−1
ssi W +
sisj, not to speak of M +, even if the original problem (10)+(7) has a unique
273"
LINEAR RELAXATION,0.25835370823145887,"solution.
274"
LINEAR RELAXATION,0.2591687041564792,"Unique solution by lifted constraints.
So we must (and at least for random M can) make the
275"
LINEAR RELAXATION,0.25998370008149957,"solution unique by taking into account the linear constraints (7). Applying them to s;si,s′;sj,a;
276"
LINEAR RELAXATION,0.26079869600651995,"ai and multiplying from the left with Vssi and using Vssi =Ussi+ we lift them to
277 X"
LINEAR RELAXATION,0.2616136919315403,"sj
Bai
sisjUssisj = Ussi+π(ai|si)
and
Us++ = 1
(13)"
LINEAR RELAXATION,0.2624286878565607,"These kd2+d further linear constraints have the potential to make the solution of (12) unique, i.e.
278"
LINEAR RELAXATION,0.2632436837815811,"resolve the d2 degeneracy Kssi. If so, we can recover M +
sisj = W +
sisj = Ussisj/Vssi (and finally
279"
LINEAR RELAXATION,0.26405867970660146,"M a =W a =Ba⊙W +) in polynomial time. It actually suffices to solve (12) and (13) for one fixed
280"
LINEAR RELAXATION,0.26487367563162184,"s, e.g. s=1, which with some care can be done in time O(d4). In practice, for approximate B one
281"
LINEAR RELAXATION,0.2656886715566422,"would solve a least-squares problem using all equations or a random projection for speed.
282"
LINEAR RELAXATION,0.2665036674816626,"Algorithm.
Putting pieces together, we have the following algorithm for computing W a and hence
283"
LINEAR RELAXATION,0.267318663406683,"Ba:j for all j via EqIM(ja) from Ba and Ba<i and Ba:i
284"
LINEAR RELAXATION,0.26813365933170336,"• Given: Policy π(a|s) and for j−1:=i≥2, inverse 1,i−1,i-step models
285"
LINEAR RELAXATION,0.26894865525672373,"Ba
ss′ =p(a|ss′) and Ba<i
ssj =p(a<i|ssi) and Ba:i
ssj =p(a:i|ssj)
286"
LINEAR RELAXATION,0.2697636511817441,"• Do the following calculations for one s (e.g. s=1),
287"
LINEAR RELAXATION,0.2705786471067645,"or a few or all s or some random linear combinations of s:
288"
LINEAR RELAXATION,0.2713936430317848,"• For each sj, let ˆUssisj be a solution of (12) with ˆUs+sj =1
289"
LINEAR RELAXATION,0.2722086389568052,"• If a non-zero solution does not exist, set ˆUssisj =0 ∀si.
290"
LINEAR RELAXATION,0.27302363488182557,"• Optional: If multiple solutions exist, return “W may not be unique”
291"
LINEAR RELAXATION,0.27383863080684595,"• If ˆUs++ =0, return “B is not consistent with any M”
292"
LINEAR RELAXATION,0.27465362673186633,• Solve P
LINEAR RELAXATION,0.2754686226568867,"sjCai
ssisjKssj =0 and Ks+ =1 for Ks∗, where Cai
ssisj :=(Bai
sisj −π(ai|si)) ˆUssisj
293"
LINEAR RELAXATION,0.2762836185819071,"• If no solution, return “B is not consistent with any M”
294"
LINEAR RELAXATION,0.27709861450692747,"• Optional: If multiple solutions exist, return “W may not be unique”
295"
LINEAR RELAXATION,0.27791361043194784,"• ˜Ussisj := ˆUssisjKssj,
Ussisj := ˜Ussisj/ ˜Us++,
Vssi :=Ussi+,
W +
sisj :=Ussisj/Vssi
296"
LINEAR RELAXATION,0.2787286063569682,"• Optional: If different s lead to different W + or V ̸=(W +)i−1,
297"
LINEAR RELAXATION,0.2795436022819886,"return “W may not be unique”
298"
LINEAR RELAXATION,0.280358598207009,"• Return forward model W a :=Ba⊙W + and other inverse B··· computed via (8)
299"
LINEAR RELAXATION,0.28117359413202936,"Variations that don’t work.
For unknown π, we only have d lifted constraints Us++=1, which are
300"
LINEAR RELAXATION,0.28198859005704974,"not sufficient to make the solution unique, also resulting in too many solutions for the relinearization
301"
LINEAR RELAXATION,0.2828035859820701,"trick [CKPS00] to work. The same is true if we had relaxed Uss′sj =W +
ss′Vs′sj. If we had applied
302"
LINEAR RELAXATION,0.28361858190709044,"linear relaxation directly to EqIM(ia), this would have led to order-i+1 tensors and require k≥d1−1/i,
303"
LINEAR RELAXATION,0.2844335778321108,"which is much worse than k≥d1/i for i>2. Including Ba:j and EqIM(ja) for some or all j <i−1 is
304"
LINEAR RELAXATION,0.2852485737571312,"not only unhelpful but even counter-productive.
305"
EXPERIMENTS,0.2860635696821516,"6
Experiments
306"
EXPERIMENTS,0.28687856560717195,"The algorithm described in Section 5 was motivated by the dimensional analysis and properties of
307"
EXPERIMENTS,0.28769356153219233,"random matrices. Namely, that A···
s·sj is likely “full” rank, and thus yielding a unique solution. In
308"
EXPERIMENTS,0.2885085574572127,"order to explore the plausibility of this assumption in practice, we have evaluated the algorithm
309"
EXPERIMENTS,0.2893235533822331,"on a set of toy (but structured) environments. This includes the canonical ‘four-rooms’ grid-world
310"
EXPERIMENTS,0.29013854930725347,"and samples from the distribution over all grid-worlds of that size. All environments have k = 5
311"
EXPERIMENTS,0.29095354523227385,"(local movement on the grid) and d=24, thus satisfying the k≥d2 constraint which permits solving
312"
EXPERIMENTS,0.2917685411572942,"EqIM(2).
313"
EXPERIMENTS,0.2925835370823146,"Experiments on naturalistic environments.
As detailed in Appendix P, for all environments
314"
EXPERIMENTS,0.293398533007335,"tested the algorithm yielded a unique solution (recovering M a) up to a reasonable level of numerical
315"
EXPERIMENTS,0.29421352893235536,"precision. This remained true even after injecting noise (across several orders of magnitude) into
316"
EXPERIMENTS,0.29502852485737574,"the environmental transition dynamics. This is in contrast to related methods which rely on near-
317"
EXPERIMENTS,0.29584352078239606,"deterministic environments [EMK+22].
318"
EXPERIMENTS,0.29665851670741644,"This result is non-trivial, as the statistics of these environments differ significantly from those
319"
EXPERIMENTS,0.2974735126324368,"produced by random matrices. For example, grid-world dynamics are both local and sparse, unlike
320"
EXPERIMENTS,0.2982885085574572,"random matrix dynamics which almost always have non-zero probability for all transitions. It remains
321"
EXPERIMENTS,0.2991035044824776,"to be seen whether or not larger-scale environments yield similar results, but it is at least non-obvious
322"
EXPERIMENTS,0.29991850040749796,"what additional environmental properties would break the constraints of the algorithm.
323"
EXPERIMENTS,0.30073349633251834,"Experiments illustrating robustness to noise.
The propositions (and previous experimental result)
324"
EXPERIMENTS,0.3015484922575387,"assume that we know the one and two step inverse models (B1:=Ba, B2:=Ba+) exactly, but in
325"
EXPERIMENTS,0.3023634881825591,"practice these distributions must be estimated from data. Here we investigate the extent to which our
326"
EXPERIMENTS,0.30317848410757947,"algorithm is robust to noise arising from learning.
327"
EXPERIMENTS,0.30399348003259985,"Rather than committing to a specific learning algorithm, we instead directly inject noise into the
328"
EXPERIMENTS,0.30480847595762023,"true inverse distributions. Figure 2 shows that noise doesn’t substantially degrade performance
329"
EXPERIMENTS,0.3056234718826406,"across several orders of magnitude (see Appendix P for details). Additionally, the effect of this
330"
EXPERIMENTS,0.306438467807661,"noise is substantially diminished as the horizon of the inverse model is increased (from B1:=Ba
331"
EXPERIMENTS,0.3072534637326813,"to B3:=Ba++). While the is perhaps not surprising, as the entropy of such inverse distributions
332"
EXPERIMENTS,0.3080684596577017,"increases monotonically with the horizon, it still shows that noise is not compounding in a way that
333"
EXPERIMENTS,0.30888345558272207,"renders long-horizon predictions meaningless.
334"
EXPERIMENTS,0.30969845150774244,"Experiments on the Tensor-product special case.
As detailed in Section 3, if M factors into two
335"
EXPERIMENTS,0.3105134474327628,"processes ˙M a⊗¨
M, where ¨
M is action-independent, then only the complexity of the action-dependent
336"
EXPERIMENTS,0.3113284433577832,"process ˙M a matters for all of our questions. The significance of this special case, as well as the
337"
EXPERIMENTS,0.3121434392828036,"details of environments construction, can be found in Appendix P.
338"
EXPERIMENTS,0.31295843520782396,"The linear algorithm of Section 4 can (implicitly) output all W and B2 consistent with B1, and the
339"
EXPERIMENTS,0.31377343113284434,"formulas derived in Appendix R allow to (explicitly) calculate the dimensions of the solution spaces.
340"
EXPERIMENTS,0.3145884270578647,"In the experiments shown in Figure 3, the environments complexity is systematically varied. The
341"
EXPERIMENTS,0.3154034229828851,"results show that the space of forward dynamics W is always larger than the space of the 2-step
342"
EXPERIMENTS,0.3162184189079055,"inverse models (B2). This confirms that inverse models can be simpler than forward models.
343"
CONCLUSION,0.31703341483292585,"7
Conclusion
344"
CONCLUSION,0.31784841075794623,"Summary.
We have shown that the 1-step inverse model p(a|ss′) does not uniquely determine
345"
CONCLUSION,0.3186634066829666,"the 2-step probabilities p(a|ss′′) if there are less actions than states (k < d). Even for k ≥d, the
346"
CONCLUSION,0.31947840260798693,"implication can fail, e.g. if the extra actions are ineffective, but if p(s′|sa) = M a
ss′ considered as
347"
CONCLUSION,0.3202933985330073,"matrices in a and s′ for each s have full rank, the implication holds. Even providing p(aa′...aj−1|ssj)
348"
CONCLUSION,0.3211083944580277,"for all j <i not necessarily determines p(a|ssi). Since the involved SPE is (heavily) over-determined,
349"
CONCLUSION,0.32192339038304807,"we expect the failure cases to be sparse/rare in some sense. For (B based on) random M, we provided
350"
CONCLUSION,0.32273838630806845,"evidence that a=2 suffices to determine M and hence p(aa′...|ss′s′′...) from p(a|ss′) and p(a|ss′′).
351"
CONCLUSION,0.3235533822330888,"For low-rank M the implication may fail.
352"
CONCLUSION,0.3243683781581092,"Open Problems.
Maybe characterizing all M for which EqIM(1) and EqIM(2) uniquely determine
353"
CONCLUSION,0.3251833740831296,"W is hopeless, not to speak of finding some or all W in case not. More formally, we can ask the
354"
CONCLUSION,0.32599837000814996,"question of whether there exists an efficient algorithm that can decide whether EqIM(i) has a unique
355"
CONCLUSION,0.32681336593317034,"solution.
356"
CONCLUSION,0.3276283618581907,"Conjecture 2 (NP-hardness) Deciding (ii), (iv), (vi) is NP-hard. Deciding whether Ba and Baa′
357"
CONCLUSION,0.3284433577832111,"are consistent with some M is also NP-hard. Computing some solution is FNP-hard.
358"
CONCLUSION,0.3292583537082315,"In Appendix L we provide some weak preliminary evidence, why this problem may be NP-hard.
359"
CONCLUSION,0.33007334963325186,"Appendix O contains fully self-contained a few versions of this open problem in their simplest
360"
CONCLUSION,0.33088834555827223,"instantiation and most elegant form.
361"
CONCLUSION,0.33170334148329256,"Discussion.
Given our analysis, we would expect that in practice, Ba and Baa′ determines Baa′a′′...
362"
CONCLUSION,0.33251833740831294,"and W sufficiently well. Sufficiently well in case of W means all and only those aspects of the
363"
CONCLUSION,0.3333333333333333,"forward model relevant for the inverse model. Then of course the question remains how to compute
364"
CONCLUSION,0.3341483292583537,"the/an answer. While the linear relaxation developed in Section 5 fails for k < d1/i as an exact
365"
CONCLUSION,0.33496332518337407,"method, it might still lead to useful approximate solutions [Stu02] without formal guarantees. Indeed,
366"
CONCLUSION,0.33577832110839445,"EqIM(ia) is heavily over-determined for i≥2, and heuristic solvers often work well in this regime.
367"
CONCLUSION,0.33659331703341483,"Handling non-uniqueness: In practice, the state space is very often infinite, and no finite amount
368"
CONCLUSION,0.3374083129584352,"of data will determine even Ba uniquely without further structural assumptions. Neural networks
369"
CONCLUSION,0.3382233088834556,"intrinsically restrict the solution space, but this may not suffice for modern over-parametrized deep
370"
CONCLUSION,0.33903830480847597,"networks. Aiming for the maximum-entropy distribution consistent with the (constraints from) data
371"
CONCLUSION,0.33985330073349634,"is popular, and could make the solution unique, as well as any other optimization constraint.
372"
CONCLUSION,0.3406682966585167,"Environment Layout
True M+ (noisy)
Inferred M+ (noisy)
True M+
Inferred M+"
CONCLUSION,0.3414832925835371,"Figure 1: Environments, their transition matrices (i.e. M +) and the matrices inferred by the algorithm
(i.e. W +). Results shown on the most and least noisiest variants of each environment. Top ‘four-
rooms’ grid-world. Bottom One of the randomly generated grid-worlds."
CONCLUSION,0.3422982885085575,"6
4
2
0
Noise Exponent 0.00 0.02 0.04 0.06 0.08"
CONCLUSION,0.34311328443357786,Average KL
CONCLUSION,0.3439282803585982,"B1
B2
B3"
CONCLUSION,0.34474327628361856,"Figure 2: Noise-induced reconstruction error:
In practice W must be inferred from learned es-
timates of B1 and B2. We investigate the ef-
fect of the resulting error on the inverse models
(B1,B2,B3) recovered from the inferred W in
terms of their proximity to the ground truth distri-
butions. At each noise level the algorithm was run
on 10 randomly generated grids, with the shaded
region representing ±2σ."
CONCLUSION,0.34555827220863894,"5
10
15
20
25
30
# of states in M 0 200 400 600 800"
CONCLUSION,0.3463732681336593,"Manifold Dimension W
B2"
CONCLUSION,0.3471882640586797,"Figure 3: Solution dimensions of W and B2
given B1: When the solution to an inverse model
(B2) given only B1 is not unique, we can charac-
terize the solution space in terms of its manifold
dimension. By comparing this to the dimension
of that of the inferred forward model (W), we
can see that our algorithm has narrowed down
the space of inverse models further. If also B2 is
given, the solution dimension of W reduces from
dW (blue curve) to dW −dB (blue minus orange
curve)."
REFERENCES,0.3480032599837001,"References
373"
REFERENCES,0.34881825590872045,"[AD21]
Saurabh Arora and Prashant Doshi. A survey of inverse reinforcement learning: Chal-
374"
REFERENCES,0.34963325183374083,"lenges, methods and progress. Artificial Intelligence, 297:103500, August 2021.
375"
REFERENCES,0.3504482477587612,"[BEP+18]
Yuri Burda, Harri Edwards, Deepak Pathak, Amos Storkey, Trevor Darrell, and Alexei A
376"
REFERENCES,0.3512632436837816,"Efros. Large-scale study of curiosity-driven learning. arXiv preprint arXiv:1808.04355,
377"
REFERENCES,0.35207823960880197,"2018.
378"
REFERENCES,0.35289323553382235,"[BPK+20]
Adri`a Puigdom`enech Badia, Bilal Piot, Steven Kapturowski, Pablo Sprechmann, Alex
379"
REFERENCES,0.3537082314588427,"Vitvitskyi, Zhaohan Daniel Guo, and Charles Blundell. Agent57: Outperforming the
380"
REFERENCES,0.3545232273838631,"atari human benchmark. In International Conference on Machine Learning, pages
381"
REFERENCES,0.3553382233088835,"507–517. PMLR, 2020.
382"
REFERENCES,0.3561532192339038,"[CKPS00]
Nicolas Courtois, Alexander Klimov, Jacques Patarin, and Adi Shamir. Efficient Al-
383"
REFERENCES,0.3569682151589242,"gorithms for Solving Overdefined Systems of Multivariate Polynomial Equations. In
384"
REFERENCES,0.35778321108394456,"Gerhard Goos, Juris Hartmanis, Jan van Leeuwen, and Bart Preneel, editors, Advances
385"
REFERENCES,0.35859820700896494,"in Cryptology — EUROCRYPT 2000, volume 1807, pages 392–407. Springer Berlin
386"
REFERENCES,0.3594132029339853,"Heidelberg, Berlin, Heidelberg, 2000.
387"
REFERENCES,0.3602281988590057,"[DY79]
E. B. Dynkin and A. A. Yushkevich. Controlled Markov processes. Number 235 in
388"
REFERENCES,0.3610431947840261,"Grundlehren der mathematischen Wissenschaften. Springer-Verlag, Berlin ; New York,
389"
REFERENCES,0.36185819070904646,"1979.
390"
REFERENCES,0.36267318663406684,"[EGIL18]
Benjamin Eysenbach, Abhishek Gupta, Julian Ibarz, and Sergey Levine. Diversity is all
391"
REFERENCES,0.3634881825590872,"you need: Learning skills without a reward function. arXiv preprint arXiv:1802.06070,
392"
REFERENCES,0.3643031784841076,"2018.
393"
REFERENCES,0.36511817440912797,"[EMK+22] Yonathan Efroni, Dipendra Misra, Akshay Krishnamurthy, Alekh Agarwal, and John
394"
REFERENCES,0.36593317033414835,"Langford. Provable RL with Exogenous Distractors via Multistep Inverse Dynamics.
395"
REFERENCES,0.36674816625916873,"arXiv:2110.08847 [cs], March 2022.
396"
REFERENCES,0.36756316218418905,"[FW89]
William Fulton and Richard Weiss. Algebraic Curves: An Introduction to Algebraic
397"
REFERENCES,0.36837815810920943,"Geometry. Addison-Wesley, 1989.
398"
REFERENCES,0.3691931540342298,"[GRW17]
Karol Gregor, Danilo Jimenez Rezende, and Daan Wierstra. Variational Intrinsic Control.
399"
REFERENCES,0.3700081499592502,"In Workshop, February 2017.
400"
REFERENCES,0.37082314588427057,"[HDB+21] Steven Stenberg Hansen, Guillaume Desjardins, Kate Baumli, David Warde-Farley,
401"
REFERENCES,0.37163814180929094,"Nicolas Heess, Simon Osindero, and Volodymyr Mnih. Entropic Desired Dynamics for
402"
REFERENCES,0.3724531377343113,"Intrinsic Control. In Advances in Neural Information Processing Systems, May 2021.
403"
REFERENCES,0.3732681336593317,"[HL13]
Christopher J. Hillar and Lek-Heng Lim. Most Tensor Problems Are NP-Hard. Journal
404"
REFERENCES,0.3740831295843521,"of the ACM, 60(6):1–39, November 2013.
405"
REFERENCES,0.37489812550937246,"[HSHB99]
Jesse Hoey, Robert St-Aubin, Alan Hu, and Craig Boutilier. SPUDD: Stochastic
406"
REFERENCES,0.37571312143439284,"planning using decision diagrams. In Proceedings of the Fifteenth Conference on
407"
REFERENCES,0.3765281173594132,"Uncertainty in Artificial Intelligence, pages 279–288, 1999.
408"
REFERENCES,0.3773431132844336,"[KF09]
Daphne Koller and Nir Friedman. Probabilistic Graphical Models: Principles and
409"
REFERENCES,0.378158109209454,"Techniques. Adaptive Computation and Machine Learning. MIT Press, Cambridge, MA,
410"
REFERENCES,0.37897310513447435,"2009.
411"
REFERENCES,0.3797881010594947,"[LFLDP21] Bonnie Li, Vincent Franc¸ois-Lavet, Thang Doan, and Joelle Pineau. Domain adversarial
412"
REFERENCES,0.38060309698451505,"reinforcement learning. arXiv preprint arXiv:2102.07097, 2021.
413"
REFERENCES,0.38141809290953543,"[MHKL20] Dipendra Misra, Mikael Henaff, Akshay Krishnamurthy, and John Langford. Kinematic
414"
REFERENCES,0.3822330888345558,"state abstraction and provably efficient rich-observation reinforcement learning. In
415"
REFERENCES,0.3830480847595762,"International conference on machine learning, pages 6961–6971. PMLR, 2020.
416"
REFERENCES,0.38386308068459657,"[MJR15]
Shakir Mohamed and Danilo Jimenez Rezende. Variational information maximisation
417"
REFERENCES,0.38467807660961695,"for intrinsically motivated reinforcement learning. Advances in neural information
418"
REFERENCES,0.3854930725346373,"processing systems, 28, 2015.
419"
REFERENCES,0.3863080684596577,"[OKD+21] Pedro A. Ortega, Markus Kunesch, Gr´egoire Del´etang, Tim Genewein, Jordi Grau-
420"
REFERENCES,0.3871230643846781,"Moya, Joel Veness, Jonas Buchli, Jonas Degrave, Bilal Piot, Julien Perolat, Tom Everitt,
421"
REFERENCES,0.38793806030969846,"Corentin Tallec, Emilio Parisotto, Tom Erez, Yutian Chen, Scott Reed, Marcus Hutter,
422"
REFERENCES,0.38875305623471884,"Nando de Freitas, and Shane Legg. Shaking the foundations: Delusions in sequence
423"
REFERENCES,0.3895680521597392,"models for interaction and control. arXiv:2110.10819 [cs], October 2021.
424"
REFERENCES,0.3903830480847596,"[PGJ16]
Judea Pearl, Madelyn Glymour, and Nicholas P. Jewell. Causal Inference in Statistics:
425"
REFERENCES,0.39119804400978,"A Primer. Wiley, Chichester, West Sussex, 2016.
426"
REFERENCES,0.3920130399348003,"[Pre00]
Doina Precup. Temporal Abstraction in Reinforcement Learning, 2000.
427"
REFERENCES,0.3928280358598207,"[SGL+19]
Archit Sharma, Shixiang Gu, Sergey Levine, Vikash Kumar, and Karol Hausman.
428"
REFERENCES,0.39364303178484106,"Dynamics-Aware Unsupervised Discovery of Skills. In International Conference on
429"
REFERENCES,0.39445802770986144,"Learning Representations, September 2019.
430"
REFERENCES,0.3952730236348818,"[SP02]
Martin Stolle and Doina Precup. Learning Options in Reinforcement Learning. In Sven
431"
REFERENCES,0.3960880195599022,"Koenig and Robert C. Holte, editors, Abstraction, Reformulation, and Approximation,
432"
REFERENCES,0.39690301548492257,"Lecture Notes in Computer Science, pages 212–223, Berlin, Heidelberg, 2002. Springer.
433"
REFERENCES,0.39771801140994295,"[Stu02]
Bernd Sturmfels. Solving Systems of Polynomial Equations. Number 97 in Regional
434"
REFERENCES,0.39853300733496333,"Conference Series in Mathematics. American Mathematical Society, Providence, RI,
435"
REFERENCES,0.3993480032599837,"2002.
436"
REFERENCES,0.4001629991850041,"[WDG+16] Grady Williams, Paul Drews, Brian Goldfain, James M Rehg, and Evangelos A
437"
REFERENCES,0.40097799511002447,"Theodorou. Aggressive driving with model predictive path integral control. In 2016
438"
REFERENCES,0.40179299103504484,"IEEE International Conference on Robotics and Automation (ICRA), pages 1433–1440.
439"
REFERENCES,0.4026079869600652,"IEEE, 2016.
440"
REFERENCES,0.4034229828850856,"Checklist
441"
REFERENCES,0.4042379788101059,"1. For all authors...
442"
REFERENCES,0.4050529747351263,"(a) Do the main claims made in the abstract and introduction accurately reflect the paper’s
443"
REFERENCES,0.4058679706601467,"contributions and scope? [Yes]
444"
REFERENCES,0.40668296658516706,"(b) Did you describe the limitations of your work? [Yes]
445"
REFERENCES,0.40749796251018744,"(c) Did you discuss any potential negative societal impacts of your work? [N/A]
446"
REFERENCES,0.4083129584352078,"(d) Have you read the ethics review guidelines and ensured that your paper conforms to
447"
REFERENCES,0.4091279543602282,"them? [Yes]
448"
REFERENCES,0.4099429502852486,"2. If you are including theoretical results...
449"
REFERENCES,0.41075794621026895,"(a) Did you state the full set of assumptions of all theoretical results? [Yes]
450"
REFERENCES,0.41157294213528933,"(b) Did you include complete proofs of all theoretical results? [Yes]
451"
REFERENCES,0.4123879380603097,"3. If you ran experiments...
452"
REFERENCES,0.4132029339853301,"(a) Did you include the code, data, and instructions needed to reproduce the main experi-
453"
REFERENCES,0.41401792991035047,"mental results (either in the supplemental material or as a URL)? [No]
454"
REFERENCES,0.41483292583537085,"(b) Did you specify all the training details (e.g., data splits, hyperparameters, how they
455"
REFERENCES,0.4156479217603912,"were chosen)? [N/A]
456"
REFERENCES,0.41646291768541155,"(c) Did you report error bars (e.g., with respect to the random seed after running experi-
457"
REFERENCES,0.4172779136104319,"ments multiple times)? [N/A]
458"
REFERENCES,0.4180929095354523,"(d) Did you include the total amount of compute and the type of resources used (e.g., type
459"
REFERENCES,0.4189079054604727,"of GPUs, internal cluster, or cloud provider)? [No]
460"
REFERENCES,0.41972290138549306,"4. If you are using existing assets (e.g., code, data, models) or curating/releasing new assets...
461"
REFERENCES,0.42053789731051344,"(a) If your work uses existing assets, did you cite the creators? [N/A]
462"
REFERENCES,0.4213528932355338,"(b) Did you mention the license of the assets? [N/A]
463"
REFERENCES,0.4221678891605542,"(c) Did you include any new assets either in the supplemental material or as a URL? [N/A]
464 465"
REFERENCES,0.4229828850855746,"(d) Did you discuss whether and how consent was obtained from people whose data you’re
466"
REFERENCES,0.42379788101059496,"using/curating? [N/A]
467"
REFERENCES,0.42461287693561534,"(e) Did you discuss whether the data you are using/curating contains personally identifiable
468"
REFERENCES,0.4254278728606357,"information or offensive content? [N/A]
469"
REFERENCES,0.4262428687856561,"5. If you used crowdsourcing or conducted research with human subjects...
470"
REFERENCES,0.42705786471067647,"(a) Did you include the full text of instructions given to participants and screenshots, if
471"
REFERENCES,0.4278728606356968,"applicable? [N/A]
472"
REFERENCES,0.4286878565607172,"(b) Did you describe any potential participant risks, with links to Institutional Review
473"
REFERENCES,0.42950285248573755,"Board (IRB) approvals, if applicable? [N/A]
474"
REFERENCES,0.43031784841075793,"(c) Did you include the estimated hourly wage paid to participants and the total amount
475"
REFERENCES,0.4311328443357783,"spent on participant compensation? [N/A]
476"
REFERENCES,0.4319478402607987,"Inverse MDP Models – Supplementary Material
477"
REFERENCES,0.43276283618581907,"A
List of Notation
478"
REFERENCES,0.43357783211083945,"Symbol
Type
Explanation
⊥
undefined
[[bool]]
∈{0,1}
=1 if bool=True, =0 if bool=False
δss′
:=[[s=s′]]
Kronecker delta
d
∈N
number of states
k
∈N
number of actions
i,j
∈N
time index/step
{i:j}
⊂Z
Set of integers from i to j (empty if j <i)
s,s′,...,si
∈{1:d}
state at time step 1,2,...,i
a,a′,...,ai
∈{0:k−1} action at time step 1,2,...,i
b,b′,...,bi
∈{0:k−1} alternative action at time step 1,2,...,i
a:i
:= aa′...ai sequence of i actions
a<i
:= aa′...ai−1 sequence of i−1 actions
˙s,¨s
∈{1: ˙d}
parts of state, usually s=( ˙s,¨s)
ε
>0
small number >0
p(...)
∈[0;1]
(conditional) probability distribution over states and actions
π(a|s)
∈[0;1]
policy. Probability of action a in state s
M a,W a
∈[0;1]d×d
transition-policy tensor M a
ss′ =p(s′|sa)·π(a|s), similarly W =q
Ba
∈[0;1]d×d
inverse 1-step model Ba
ss′ =p(a|ss′) for each action a
Ba++
ss′′′
∈[0;1]
3-step first-action inverse model p(a|ss′′′)
J,K,∆
∈Rd×d
action-independent d×d “transition” matrices
+ +
·n →·
index summation, e.g. M +
s+ =P"
REFERENCES,0.4343928280358598,"as′M a
ss′
·
(·,·)→·
matrix multiplication: [AB]ss′′ =P"
REFERENCES,0.4352078239608802,"s′Ass′Bs′s′′
⊙
(·,·)→·
element-wise multiplication of matrix elements: [A⊙B]ss′ =Ass′Bss′
⊘
(·,·)→·
element-wise division of matrix elements: [A⊘B]ss′ =Ass′/Bss′
⊗
(·,·)→·
tensor product: [ ˙M ⊗¨
M]ss′ := ˙M ˙s ˙s′ ¨
M¨s¨s′ with s=( ˙s,¨s) and s′ =( ˙s′,¨s′)"
REFERENCES,0.4360228198859006,"B
Application to Planning
479"
REFERENCES,0.43683781581092096,"In Section 1, various streams of applied work were highlighted; here we focus on spelling out the
480"
REFERENCES,0.43765281173594134,"overarching impact that compositional inverse models (an affirmative answer to question (iv)) would
481"
REFERENCES,0.4384678076609617,"have for planning problems.
482"
REFERENCES,0.4392828035859821,"Many forms of planning involve the evaluation of candidate i-step action sequences (e.g. model
483"
REFERENCES,0.4400977995110024,"predictive path integral control [WDG+16]). Ideally, all possible action sequences would be evaluated,
484"
REFERENCES,0.4409127954360228,"but as the space of i-step action sequences grows exponentially in i, this is often intractable.
485"
REFERENCES,0.4417277913610432,"Access to the i-step inverse distribution p(a...ai|s...si+1) allows determining the subset of action
486"
REFERENCES,0.44254278728606355,"sequences that likely reach state si+1 post-execution (e.g. those whose probability is above some
487"
REFERENCES,0.44335778321108393,"threshold). It is often the case that only action sequences that are distinguished in this way are of
488"
REFERENCES,0.4441727791361043,"interest (e.g. goal-reach tasks), thus access to an inverse model of the appropriate horizon allows for
489"
REFERENCES,0.4449877750611247,"filtering candidates. This filtering method is a particularly appealing approach when the cost/reward
490"
REFERENCES,0.44580277098614507,"function is initially unknown and frequently changes, as in [MJR15].
491"
REFERENCES,0.44661776691116545,"Motivating Example.
Consider an agent who has control over ˙s but not over ¨s. For instance a robot
492"
REFERENCES,0.4474327628361858,"equipped with a camera can control its position and orientation, but not the shape and color of objects
493"
REFERENCES,0.4482477587612062,"in its path. The forward model p(s′|as) essentially involves modelling the whole observable world.
494"
REFERENCES,0.4490627546862266,"The inverse model p(a|ss′) on the other hand can ignore inputs that the agent has no control over. Of
495"
REFERENCES,0.44987775061124696,"course in practice, s does not come neatly separated into ˙s and ¨s, so a (say) deep neural network still
496"
REFERENCES,0.45069274653626734,"has to learn the controllable features, but neither needs to learn nor predict the uncontrollable features
497"
REFERENCES,0.4515077424612877,"(under the factorization assumptions described in Section 3, now in feature space).
498"
REFERENCES,0.45232273838630804,"If the goal is to navigate from s to si in i time steps, and open-loop control suffices as e.g. in
499"
REFERENCES,0.4531377343113284,"(near)-deterministic problems [EMK+22], then action sequences for which p(aa′...ai−1|ssi) is large
500"
REFERENCES,0.4539527302363488,"are the most likely that caused the transition to si, hence these sequences are promising candidates
501"
REFERENCES,0.4547677261613692,"for macro actions (temporally extended actions, options) in Reinforcement Learning [SP02, Pre00].
502"
REFERENCES,0.45558272208638956,"Since the action space is typically much smaller than the state space (the former often finite, the
503"
REFERENCES,0.45639771801140994,"latter often even infinite-dimensional), even learning p(aa′...ai−1|s...si) directly for all small i can
504"
REFERENCES,0.4572127139364303,"be feasible and may be more data-efficient than learning the one-step forward model. A closed-loop
505"
REFERENCES,0.4580277098614507,"alternative would be to learn only p(a|s...si), find the likely first action a that caused the ultimate
506"
REFERENCES,0.4588427057864711,"transition to si, then take action a, iterate, and store the resulting sequence as an option.
507"
REFERENCES,0.45965770171149145,"The required sample complexity to learn inverse MDP models for larger i directly from data may
508"
REFERENCES,0.46047269763651183,"grow exponentially in i, which is why inferring i-step inverse models from 1-step and 2-step inverse
509"
REFERENCES,0.4612876935615322,"models would be useful. The fact that this problem borders NP-hardness probably prevents even
510"
REFERENCES,0.4621026894865526,"powerful transformer models to finding the structure in p(aa′...ai−1|s...si) by themselves.
511"
REFERENCES,0.46291768541157297,"C
Counter-Examples in Related Work
512"
REFERENCES,0.46373268133659334,"In Section 3 we presented a counter-example to questions (i,iii,v). Question (i) (i.e. Can M be
513"
REFERENCES,0.46454767726161367,"inferred from Ba := M a⊘M +?) has been implicitly addressed in previous work. In [EMK+22,
514"
REFERENCES,0.46536267318663405,"App.A.3] the authors present a counter-example to the claim that a state representation constructed
515"
REFERENCES,0.4661776691116544,"via an inverse model (i.e. two states have the same representation iff they yield the same inverse
516"
REFERENCES,0.4669926650366748,"distribution for all of their possible successor states) is sufficient for representing a set of policies
517"
REFERENCES,0.4678076609616952,"that differentially visit all states. This fails whenever two states are aliased by the inverse model.
518"
REFERENCES,0.46862265688671556,"Technically, as per their Definition 2, this ‘policy cover’ need only account for all ‘endogenous’ states.
519"
REFERENCES,0.46943765281173594,"But omit the ‘exogenous’ states from their counter-example and it can be seen to address our question
520"
REFERENCES,0.4702526487367563,"(i).
521"
REFERENCES,0.4710676446617767,"Note that this failure of state representation learning implies a negative answer to our question (i),
522"
REFERENCES,0.4718826405867971,"as W would differ from M on these aliased states. Unlike our counter-example, theirs involves
523"
REFERENCES,0.47269763651181745,"deterministic forward dynamics, and therefor buttresses our claims by showing that M cannot always
524"
REFERENCES,0.47351263243683783,"be inferred even in this simpler case. Similar to our counter-example in Section 3, [MHKL20]
525"
REFERENCES,0.4743276283618582,"proposes a stochastic counter-example to inverse modeling for state representation learning.
526"
REFERENCES,0.4751426242868786,"In general, the transferability of these counter-examples suggests a strong relationship between
527"
REFERENCES,0.4759576202118989,"the literature on using single-step inverse models for state representation learning and using them
528"
REFERENCES,0.4767726161369193,"for inferring the forward model. It is an interesting open question whether or not algorithms for
529"
REFERENCES,0.47758761206193967,"representation learning on the basis of multi-step inverse models (like those put forward in [EMK+22])
530"
REFERENCES,0.47840260798696005,"might be used to shed light on the questions put forward here and vice versa.
531"
REFERENCES,0.4792176039119804,"D
Degenerative Cases - Details
532"
REFERENCES,0.4800325998370008,"To get some feeling about why these questions are so more intricate than analogous ones in forward
533"
REFERENCES,0.4808475957620212,"models, we consider some simple examples and special cases first. Some further special cases
534"
REFERENCES,0.48166259168704156,"(deterministic planning, deterministic reachability, and deterministic inverse models) are considered
535"
REFERENCES,0.48247758761206194,"in Appendix E.
536"
REFERENCES,0.4832925835370823,"Example violating (i,iii,v).
A specific example for M and W which satisfy EqIM(1) but violate
537"
REFERENCES,0.4841075794621027,"EqIM(2+) and hence EqIM(2a) is as follows:
538"
REFERENCES,0.4849225753871231,M 0 = 1
REFERENCES,0.48573757131214346,"4
 0 2
1 1

, M 1 = 1"
REFERENCES,0.48655256723716384,"4
 2 0
1 1

, W 0 = 1"
REFERENCES,0.4873675631621842,"2
 0 1
1 0

, W 1 = 1"
REFERENCES,0.48818255908720454,"2
 1 0
1 0
"
REFERENCES,0.4889975550122249,"which satisfies (7) (M a
s+ = 1"
REFERENCES,0.4898125509372453,"2 =W a
s+). In this example, M + = 1"
REFERENCES,0.4906275468622657,"2
 1 1
1 1

and W + = 1"
REFERENCES,0.49144254278728605,"2
 1 1
2 0

, which shows
539"
REFERENCES,0.49225753871230643,"M a⊘M + =W a⊘W +, except that W +
22 =0̸=1=M +
22, hence there is one “dubious” 1
?=0/0 case.
540"
REFERENCES,0.4930725346373268,"A simple calculation shows that EqIM(2+) is violated (w/o any division by 0). The division by 0 can
541"
REFERENCES,0.4938875305623472,"easily avoided by mixing U a
ss′ ≡1"
REFERENCES,0.49470252648736757,"4 into M and W, e.g. M ; 1"
REFERENCES,0.49551752241238795,2(M +U) and W ; 1
REFERENCES,0.4963325183374083,"2(W +U). This
542"
REFERENCES,0.4971475142624287,"means that the 1-step inverse model Ba does not always uniquely determine the 2-step inverse model
543"
REFERENCES,0.4979625101874491,"Baa′, i.e. (i,iii,v) can fail.
544"
REFERENCES,0.49877750611246946,"M =W .
This trivially implies g(M)=g(W). This means if (i) is true, then trivially also (iii) and
545"
REFERENCES,0.49959250203748984,"(v), and if (ii) is true, then trivially also (iv) and (vi).
546"
REFERENCES,0.5004074979625102,"M and W are independent a.
Note that M a
ss′ ≡p(s′|sa) independent a implies M a
s+ independent
547"
REFERENCES,0.5012224938875306,"a, hence π(a|s) = M a
s+ = 1/k independent a as well, hence M a = 1"
REFERENCES,0.5020374898125509,"kM +. The latter implies
548"
REFERENCES,0.5028524857375714,"M aM a′...M ai ⊘(M +)i =k−i is independent M hence is the same as for W. Since we can choose
549"
REFERENCES,0.5036674816625917,"M ̸=W, this shows that (i) and (ii) and higher order analogues fail for these degenerate M and W.
550"
REFERENCES,0.5044824775876121,"M and W are nearly independent a.
The above degeneracy generalizes to M a
ss′ =Mss′πa and
551"
REFERENCES,0.5052974735126324,"W a
ss′ =Wss′πa, i.e. action-independent dynamics, and state-independent actions, which in turn is a
552"
REFERENCES,0.5061124694376528,"special case of the tensor product below (with s= ¨s and ˙s≡0).
553"
REFERENCES,0.5069274653626732,"M and W are independent s′.
In this case, M a
ss′ = 1"
REFERENCES,0.5077424612876935,"dM a
s+ = 1"
REFERENCES,0.508557457212714,"dπ(a|s)=W a
ss′, hence is a special
554"
REFERENCES,0.5093724531377343,"case of case M =W above.
555"
REFERENCES,0.5101874490627547,"M and W are independent s.
In this case, [M aM a′]ss′′ =P"
REFERENCES,0.511002444987775,"s′M a
∗s′M a′
∗s′′ =π(a|∗)M a′
∗s′′. Also
556"
REFERENCES,0.5118174409127955,"the policy π(a|s)=M a
s+ is independent s. If we assume EqIM(1), this implies
557"
REFERENCES,0.5126324368378158,"[M aM a′ ⊘(M +)2]ss′′ = π(a|∗)M a′
∗s′′
π(+|∗)M +
∗s′′
= π(a|∗)W a′
∗s′′
π(+|∗)W +
∗s′′
= [W aW a′ ⊘(W +)2]ss′′"
REFERENCES,0.5134474327628362,"hence EqIM(2) holds and similarly EqIM(i)∀i. As an example, consider
558"
REFERENCES,0.5142624286878565,M 0 := 1
REFERENCES,0.515077424612877,"2
 0 1
0 1

, M 1 := 1"
REFERENCES,0.5158924205378973,"2
 1 0
1 0

, W 0 := 1"
REFERENCES,0.5167074164629177,"3
 0 1
0 1

, W 1 := 2"
REFERENCES,0.5175224123879381,"3
 1 0
1 0
"
REFERENCES,0.5183374083129584,"These M ̸=W satisfy EqIM(1) (M a⊘M + =2M a =W a⊘W +), hence constitute another failure
559"
REFERENCES,0.5191524042379788,"case of (i) and (ii).
560"
REFERENCES,0.5199674001629991,"Block-diagonal M and W .
For M =
  ˙
M 0
0 ¨
M

and W =
  ˙W 0
0 ¨
W

, all operations (+−×/⊙⊘) preserve
561"
REFERENCES,0.5207823960880196,"the block structure, so the above degenerative cases can be combined, one for the upper-left block
562"
REFERENCES,0.5215973920130399,"and another for the lower-right block.
563"
REFERENCES,0.5224123879380603,"Tensor-product M and W .
Let [ ˙M⊗¨
M]ss′ := ˙M ˙s ˙s′ ¨
M¨s¨s′ with s:=( ˙s,¨s) and s′:=( ˙s′,¨s′) be the ten-
564"
REFERENCES,0.5232273838630807,"sor product of ˙M and ¨
M (not to be confused with the element-wise product ⊙). Assume M a= ˙M a⊗
565"
REFERENCES,0.5240423797881011,"¨
M, where the second factor is action-independent. In this case, M aM a′...=( ˙M a ˙M a′...)⊗( ¨
M ¨
M...),
566"
REFERENCES,0.5248573757131214,"and similarly if a,a′,... is replaced by +, hence M aM a′...M ai ⊘(M +)i = ˙M a ˙M a′... ˙M ai ⊘( ˙M +)i
567"
REFERENCES,0.5256723716381418,"is independent of ¨
M, and similarly for W a = ˙W a⊗¨W. That means, EqIM(i) hold if ˙M a = ˙W a,
568"
REFERENCES,0.5264873675631622,"whatever ¨
M and ¨W are. This formalizes our motivating example that if some part of the state (¨s)
569"
REFERENCES,0.5273023634881826,"is not controlled (by a) and the dynamics factorizes (p(s′|sa) = p( ˙s′| ˙sa)p(¨s′|¨s)) and the policy is
570"
REFERENCES,0.5281173594132029,"independent ¨s (π(a|s)=π(a| ˙s)), then the multi-step inverse models (3-5) become much simpler than
571"
REFERENCES,0.5289323553382234,"the forward model (2), namely independent ¨s. This case has been studied in [EMK+22] for episodic
572"
REFERENCES,0.5297473512632437,"near-deterministic M.
573"
REFERENCES,0.530562347188264,"E
Deterministic Cases
574"
REFERENCES,0.5313773431132844,"Deterministic planning / reachability problem.
If we are only interested in finding some action
575"
REFERENCES,0.5321923390383048,"sequence aa′...ai that leads to si, the problem becomes easy: The only thing that matters is the
576"
REFERENCES,0.5330073349633252,"support of the various matrices, not the numerical values themselves. Since Ba
ss′ >0 iff M a
ss′ >0
577"
REFERENCES,0.5338223308883455,"(either assuming M +
ss′ >0 or regarding ⊥>0 as False), and similarly for higher orders, we can replace
578"
REFERENCES,0.534637326813366,"M a by Ba in (iii), and get Baa′...ai
ssi+1
>0 iff [BaBa′...Bai]ssi+1 >0. We could also replace M a by
579"
REFERENCES,0.5354523227383863,"Ga
ss′ :=[[Ba
ss′ >0]], then [GaGa′...Gai]ssi+1 >0 counts the number of paths of length i from s to si+1
580"
REFERENCES,0.5362673186634067,"via action sequence aa′...ai, and hence determines whether si+1 can be reached. Similarly (G+)i>0
581"
REFERENCES,0.537082314588427,"iff there is some action sequence that can reach si+1 from s. An action a such that Ga(G+)i >0 can
582"
REFERENCES,0.5378973105134475,"be chosen as the first action of such a sequence if it exists, and a′,a′′... can be found the same way by
583"
REFERENCES,0.5387123064384678,"recursion. So this deterministic planning/reachability problem has a “unique” solution, which can be
584"
REFERENCES,0.5395273023634882,"found in time O(i·d·(d+k)) (for fixed s and si+1).
585"
REFERENCES,0.5403422982885085,"B is deterministic.
Assume M a
ss′/M +
ss′ =: Ba
ss′ ∈{0,1,⊥}. This is true if and only if M a has
586"
REFERENCES,0.541157294213529,"disjoint support for different a, i.e. iff M a⊙M b=0 ∀a̸=b. This in turn means that Ba
ss′ =[[W a
ss′ >0]]
587"
REFERENCES,0.5419722901385493,"for any and only those W with same support as M, and hence also W a⊙W b =0 ∀a̸=b, which is
588"
REFERENCES,0.5427872860635696,"another failure case of (i). Here we have included the case where no action leads from s to s′, in which
589"
REFERENCES,0.5436022819885901,"case W +
ss′ =0 and Ba is undefined (⊥). This readily extends to higher orders: If Baa′... ∈{0,1,⊥},
590"
REFERENCES,0.5444172779136104,"then Baa′... =[[W aW a′...⊘(W +)i >0]] iff W aW a′... has the same support as M aM a′... and
591"
REFERENCES,0.5452322738386308,"W aW a′...W ai ⊙W bW b′...W bi =0 ∀aa′...ai ̸=bb′...bi
(14)"
REFERENCES,0.5460472697636511,"Note that W a⊙W b = 0 does not necessarily imply (14), e.g. for W 0 = 1"
REFERENCES,0.5468622656886716,"2
 1 0
0 1

and W 1 = 1"
REFERENCES,0.5476772616136919,"2
 0 1
1 0

,
592"
REFERENCES,0.5484922575387123,"(W 0)2 =(W 1)2. In Appendices I&J&K we construct W such that (14) holds for larger i.
593"
REFERENCES,0.5493072534637327,"F
Characterizing M and W for which EqIM(1) holds
594"
REFERENCES,0.5501222493887531,"M a⊘M + =W a⊘W +
⇐⇒
W a =M a⊙J
with
J :=W +⊘M +"
REFERENCES,0.5509372453137734,"That is, J is independent of a. Phrased differently
595"
REFERENCES,0.5517522412387939,"For any M and W, EqIM(1) is satisfied iff
W a⊘M a is independent a.
(15)"
REFERENCES,0.5525672371638142,"For a given M, this allows to determine all W consistent with EqIM(1), by just multiplying with any
596"
REFERENCES,0.5533822330888346,"a-independent J ≥0. Not all J though lead to W consistent with (7). In order to also satisfy (7), J
597"
REFERENCES,0.5541972290138549,"needs to be restricted as follows: With ∆ss′ :=Jss′ −1, (7) becomes
598"
REFERENCES,0.5550122249388753,"0
!= W a
s+−M a
s+ =
X"
REFERENCES,0.5558272208638957,"s′
M a
ss′(∆ss′ +1)−M a
s+ =
X"
REFERENCES,0.556642216788916,"s′
M a
ss′∆ss′
(16)"
REFERENCES,0.5574572127139364,"For each fixed s, these are k homogenous linear equations (one for each a) in d variables. Given M,
599"
REFERENCES,0.5582722086389568,"all and only the W consistent with EqIM(1) and (7) can be obtained via W a =M a⊙(1+∆) with ∆
600"
REFERENCES,0.5590872045639772,"satisfying M ·
s·∆s· =0.
601"
REFERENCES,0.5599022004889975,"As a special case, ∆=0 necessarily if and only if the rank of M ·
s· is ≥d for every s. This gives the
602"
REFERENCES,0.560717196414018,"precise conditions as stated in Proposition 1 under which (i) is true. We will next show that EqIM(2)
603"
REFERENCES,0.5615321923390383,"removes this limitation.
604"
REFERENCES,0.5623471882640587,"G
Characterizing M and W for which EqIM(1) and EqIM(2+) hold
605"
REFERENCES,0.563162184189079,"From Appendix F we know that the most general Ansatz for W a satisfying EqIM(1) is M a⊙(1+∆).
606"
REFERENCES,0.5639771801140995,"Plugging this into (28) and expanding in ∆, we get
607"
REFERENCES,0.5647921760391198,0 = M aM +⊙(M +)2−M aM +⊙(M +)2
REFERENCES,0.5656071719641402,"+ M aM +⊙[M +(M +⊙∆)+(M +⊙∆)⊙M +]−[(M a⊙∆)M +M a(M +⊙∆)]⊙(M +)2]
+ M aM +⊙(M +⊙∆)2−(M a⊙∆)(M +⊙∆)⊙(M +)2"
REFERENCES,0.5664221678891606,"This is a collection of quadratic equations in ∆. The ∆-independent first line is 0. We can write this
608"
REFERENCES,0.5672371638141809,"in canonical form:
609"
REFERENCES,0.5680521597392013,"ΣklAa
ss′′,kl∆kl = Ra
kl(∆) with
(17)"
REFERENCES,0.5688671556642216,"Aa
ss′′,kl := (Σs′M a
ss′M +
s′s′′)(M +
skM +
ks′′δls′′ +M +
slM +
ls′′δsk−M a
skM +
ks′′δls′′ −M a
slM +
ls′′δsk)"
REFERENCES,0.5696821515892421,Ra(∆) := (M a⊙∆)(M +⊙∆)⊙(M +)2−M aM +⊙(M +⊙∆)2
REFERENCES,0.5704971475142624,"Let us consider Aa as a d2×d2 matrix for each a, ∆as a vector of length d2, and (wrongly) presume
610"
REFERENCES,0.5713121434392828,"Ra ≡0 at first. Aa is a sum of 4 terms. The second and fourth terms are block-diagonal matrices
611"
REFERENCES,0.5721271393643031,"(d blocks of size d×d in the diagonal) due to the δsk. The first and third terms are scrambled
612"
REFERENCES,0.5729421352893236,"block-diagonal matrices due to the δls′′, or more precisely, consist of d×d blocks, each bock being
613"
REFERENCES,0.5737571312143439,"a d×d diagonal matrix. If M a has full rank, each of the four terms has full rank d2, but Aa itself
614"
REFERENCES,0.5745721271393643,"can have lower rank, 0-eigenvalues due to some cancellations. Random M apparently achieves the
615"
REFERENCES,0.5753871230643847,"highest rank, but even then, Aa itself has only rank d(d−1).
616"
REFERENCES,0.5762021189894051,"Actually, Aa∆=0 is required to hold for all a, so the rank of A as a kd2×d2 matrix may still be d2.
617"
REFERENCES,0.5770171149144254,"But A+ ≡0 for k =2 implies A0 =−A1, hence the rank is still at most d(d−1). k >2 may rectify
618"
REFERENCES,0.5778321108394459,"this, but there is an alternative, which works for all a: ∆also needs to satisfy (16), which can be
619"
REFERENCES,0.5786471067644662,"rewritten as
620 X"
REFERENCES,0.5794621026894865,"kl
Ca
s,kl∆kl = 0 with Ca
s,kl := M a
slδsk
(18)"
REFERENCES,0.5802770986145069,"These give another kd constraints, and apparently often d new ones from random M. If we combine
621"
REFERENCES,0.5810920945395273,"A′ :=
 A·"
REFERENCES,0.5819070904645477,"C·

, this implies that A′ has often rank d2, so A′∆=0 can only be satisfied for ∆=0. For
622"
REFERENCES,0.582722086389568,"k =2, A+ =0, so inclusion of either A0 or A1 in A′ would suffice, but C0 and C1 are potentially
623"
REFERENCES,0.5835370823145885,"independent, so both have to be included.
624"
REFERENCES,0.5843520782396088,"Let us now return to the real case of Ra ̸=0 for full random M, hence full-rank A′. With R′ :=
 R·"
REFERENCES,0.5851670741646292,"0

,
625"
REFERENCES,0.5859820700896495,"we need to solve A′∆=R′. Note that R′ =R′(∆) is not a constant, but a (homogenous) quadratic
626"
REFERENCES,0.58679706601467,"function of ∆itself. Consider any ∆= Θ(ε), then A′∆= Θ(ε) while R′(∆) = Θ(ε2), which is a
627"
REFERENCES,0.5876120619396903,"contradiction for sufficiently small ε (this argument can be made rigorous). This implies that no ∆
628"
REFERENCES,0.5884270578647107,"with 0<||∆||<ε can satisfy A′∆=R′(∆). In conclusion,
629"
REFERENCES,0.589242053789731,"Proposition 3 (Random M and full-rank A′)
630"
REFERENCES,0.5900570497147515,"If A′ has full rank and W is close to M, then EqIM(1) and EqIM(2) imply W =M.
631"
REFERENCES,0.5908720456397718,"Empirically A′ has full rank for random M.
632"
REFERENCES,0.5916870415647921,"This of course implies EqIM(i)∀i and also (iv). Globally, i.e. if W is not close to M, these implica-
633"
REFERENCES,0.5925020374898126,"tions may not hold.
634"
REFERENCES,0.5933170334148329,"We have yet to establish sufficient conditions which M a lead to full-rank A′. Empirically, this has
635"
REFERENCES,0.5941320293398533,"been true for random M a, so should hold almost surely if M are sampled uniformly. One might
636"
REFERENCES,0.5949470252648736,"conjecture that full-rank M a are sufficient, but this is not the case. For instance, if M a is independent
637"
REFERENCES,0.5957620211898941,"a, then A′ ≡0.
638"
REFERENCES,0.5965770171149144,"Zero A and R for full-rank
˙
M a.
We finally we note that A and R can have low rank, indeed A≡
639"
REFERENCES,0.5973920130399348,"0≡R even for a-dependent full-rank M a: Consider the example ˙M a from (22) or its generalization
640"
REFERENCES,0.5982070089649552,"(27): First, if for two matrices M a and M a′ only one s′ (depending on s and s′′) contributes to
641"
REFERENCES,0.5990220048899756,"the sum in M aM a′ then (M a⊙J)(M a′ ⊙J)=M aM b⊙K for some K. This makes (19) valid for
642"
REFERENCES,0.5998370008149959,"M a := ˙M a and W a := ˙M a⊙J for any J, since for aa′ ̸=bb′ both sides are 0 by construction of ˙M a
643"
REFERENCES,0.6006519967400163,"(the ⊙K does nothing to it), and are trivially equal for aa′ =bb′. By summing over a′bb′, also (28) is
644"
REFERENCES,0.6014669926650367,"valid for any J, hence of course also for J =1+∆for any ∆. Since (17) is equivalent to (28), (17)
645"
REFERENCES,0.6022819885900571,"holds for any ∆. This can only be true for A≡0 and R≡0. This degeneracy in itself does not violate
646"
REFERENCES,0.6030969845150774,"(ii), since the probability constraints require W =M, as established earlier.
647"
REFERENCES,0.6039119804400978,"H
EqIM(1)∧EqIM(2+)̸→EqIM(3) for full low rank M?
648"
REFERENCES,0.6047269763651182,"The following numerical approach may lead to counter-examples with full support to (v) without
649"
REFERENCES,0.6055419722901385,"any divisions by 0 (M +
ss′ >0 and W +
ss′ >0 ∀ss′). We now consider full M a but of rank r<d. The
650"
REFERENCES,0.6063569682151589,"most interesting case is where all M a span the same row-space, i.e. M a = La·R, where La are
651"
REFERENCES,0.6071719641401793,"d×r matrices and R is a r×d matrix. Recall A′ :=
 A·"
REFERENCES,0.6079869600651997,"C·

with Aa and Ca defined in (17) and (18).
652"
REFERENCES,0.60880195599022,"Empirically, for k=2, the rank of A′ typically is min{d2,(3r−1)d−r(r−1)}, never more, and only
653"
REFERENCES,0.6096169519152405,"in degenerate cases less. Hence for r=2, A′ is singular for d≥5. Hence for d≥5, there exist ∆̸=0
654"
REFERENCES,0.6104319478402608,"with A′∆=0,
655"
REFERENCES,0.6112469437652812,"For ∆0 := ∆= Θ(ε), this is an approximate Θ(ε2) solution of A′∆= R′(∆). By iterating ∆←
656"
REFERENCES,0.6120619396903015,"∆0+A
′+R′(∆), where A
′+ is the pseudo-inverse of A′, we get an Θ(εi)-approximation after i−2
657"
REFERENCES,0.612876935615322,"iterations. This should rapidly converge to an “exact” non-zero(!) solution A′∆=R′(∆). This would
658"
REFERENCES,0.6136919315403423,"show that (ii) can fail for full M. Generically, this solution also violates EqIM(3), i.e. also (vi) can
659"
REFERENCES,0.6145069274653626,"fail. By this we mean, for randomly sampled La and R (for a=r=2 and d≥5) and performing the
660"
REFERENCES,0.615321923390383,"procedure above, EqIM(3) does not hold. There is a caveat with this argument, namely if R′ is not in
661"
REFERENCES,0.6161369193154034,"the range of A′, then this construction fails.
662"
REFERENCES,0.6169519152404238,"I
EqIM(1) does not imply EqIM(2) (⊙-version)
663"
REFERENCES,0.6177669111654441,"We have already given a simple example that violates (v) in Section 3, but the example and method-
664"
REFERENCES,0.6185819070904646,"ology provided here generalizes to (vi) and even larger i. We consider deterministic reversible
665"
REFERENCES,0.6193969030154849,"forward dynamics for any policy π(a|s)>0 ∀as. For simplicity we assume k=2 and uniform policy
666"
REFERENCES,0.6202118989405053,π(a|s)= 1
REFERENCES,0.6210268948655256,"2. We defer a discussion of 0/0 to the end of the next Appendix.
667"
REFERENCES,0.6218418907905461,"We consider M a and W a that permute states. That is, M ·
ss′ :=[[s′ =π·(s)]] and W ·
ss′ :=[[s′ =σ·(s)]]
668"
REFERENCES,0.6226568867155664,"for some permutations π·,σ· : {1,...,d} →{1,...,d}. Strictly speaking, we should multiply this
669"
REFERENCES,0.6234718826405868,by π(a|s) = 1
REFERENCES,0.6242868785656072,"k, but this global factor plays no role here, so will be dropped everywhere. Matrix
670"
REFERENCES,0.6251018744906276,"multiplication corresponds to permutation composition: [M ·W ·]ss′′ =[[s′′ =σ·(π.(s)]]. We denote
671"
REFERENCES,0.6259168704156479,"example permutation (matrices) by [π]=[π(1)...π(d)].
672"
REFERENCES,0.6267318663406682,"We now construct a counter-example for (v): For d=4, let M 0 =W 0 =Id=[1234] be the identity
673"
REFERENCES,0.6275468622656887,"matrix/permutation. Let W 1 =[2341] be the cyclic permutation 1→2→3→4→1, and M 1 =[2143]
674"
REFERENCES,0.628361858190709,"the cycle pair 1↔2 and 3↔4. We know from (15) that EqIM(1) holds iff W a⊘M a is independent
675"
REFERENCES,0.6291768541157294,"a (= J) iff W a⊘M a = W b⊘M b ∀a,b ∈{0,1} iff W a⊙M b = M a⊙W b. Case a = b is trivial,
676"
REFERENCES,0.6299918500407498,"so only W 0⊙M 1 = M 0⊙W 1 needs to be verified. Now M ·⊙W · of two permutations matrices
677"
REFERENCES,0.6308068459657702,"is not a permutation matrix (unless M · = W ·). It still a 0-1 matrix with at most one non-zero
678"
REFERENCES,0.6316218418907905,"entry in each row and column. We can generalize the permutation notation to “sub-permutations”
679"
REFERENCES,0.632436837815811,"by defining π(s) = ∅if row s is empty. For instance M 1⊙W 1 = [2∅4∅]. EqIM(1) holds, since
680"
REFERENCES,0.6332518337408313,"W 0⊙M 1 =[∅∅∅∅]=M 0⊙W 1.
681"
REFERENCES,0.6340668296658517,"Similarly EqIM(2a) holds iff W aW a′ ⊘M aM a′ is independent a,a′ iff
682"
REFERENCES,0.634881825590872,"W aW a′ ⊙M bM b′ = M aM a′ ⊙W bW b′
∀a,a′,b,b′.
(19)"
REFERENCES,0.6356968215158925,"But for a=a′ =0 and b=b′ =1 we have
683"
REFERENCES,0.6365118174409128,(W 0)2⊙(M 1)2 = [1234]⊙[1234] = [1234] ̸= [∅∅∅∅] = [1234]⊙[3412] = (M 0)2⊙(W 1)2
REFERENCES,0.6373268133659332,"hence EqIM(1) does not necessarily imply EqIM(2). The advantage of formulation (19) over (8) is
684"
REFERENCES,0.6381418092909535,"that matrix sums M + and W + are more complicated objects than the sub-permutation matrices (19).
685"
REFERENCES,0.6389568052159739,"Like random matrices, permutation matrices, have full rank, but unlike random matrices they can
686"
REFERENCES,0.6397718011409943,"violate (ii), (iv), and (vi).
687"
REFERENCES,0.6405867970660146,"J
EqIM(1a)∧...∧EqIM(ia) do not imply EqIM(i+1) (⊙-version)
688"
REFERENCES,0.6414017929910351,"Counting variables and equations made the possibility of violating (v) for k<d plausible (cf. positive
689"
REFERENCES,0.6422167889160554,"result for k≥d). A similar counting argument indicates that (vi) and higher i analogues might actually
690"
REFERENCES,0.6430317848410758,"hold. Unfortunately this is not the case. I.e. even providing inverse models for all action sequences up
691"
REFERENCES,0.6438467807660961,"to length i is not sufficient to always uniquely determine the probability of longer action sequences.
692"
REFERENCES,0.6446617766911166,"This is true even for deterministic reversible forward dynamics for any policy π(a|s)>0 ∀as. As for
693"
REFERENCES,0.6454767726161369,"i=1, we assume k=2, π(a|s)= 1"
REFERENCES,0.6462917685411573,"2, gloss over 0/0, and don’t normalize M and W.
694"
REFERENCES,0.6471067644661777,"For i=2, M 0:=W 0:=Id=[123456] and W 1:=[234561]=:σ (σ for ‘cycle’) and M 1:=[231564]=:π
695"
REFERENCES,0.6479217603911981,"can be shown to satisfy EqIM(1) and EqIM(2a) but violate EqIM(3). The calculations are not to
696"
REFERENCES,0.6487367563162184,"onerous, but lets consider directly the general i case: Consider even d=:2d′ and identity and cycle
697"
REFERENCES,0.6495517522412388,"(pair)
698"
REFERENCES,0.6503667481662592,"M 0 = W 0 = Id = [1,2,...,d−1,d],
W 1 = [2,3,...,d,1], M 1 = [2,3,...,d′,1,d′+2,...d−1,d,d′+1]"
REFERENCES,0.6511817440912795,"EqIM(ia) holds iff W aW a′...⊘M aM a′...=W +W +...⊘M +M +... is independent aa′... iff
699"
REFERENCES,0.6519967400162999,"W aW a′...W ai ⊙M bM b′...M bi = M aM a′...M ai ⊙W bW b′...W bi
∀aa′...ai,bb′...bi
(20)"
REFERENCES,0.6528117359413202,"(While this looks like k2i matrix equations, by chaining, checking ki pairs suffices, which is the
700"
REFERENCES,0.6536267318663407,"same number as in EqIM(ia)). Now W aW a′...W ai consists of only two types of matrices, a
701"
REFERENCES,0.654441727791361,"cycle for W 1 = σ and identity W 0. The W 0 = Id can be eliminated, leading to (W 1)a+, where
702"
REFERENCES,0.6552567237163814,"a+ :=a+a′+...+ai. Similarly M bM b′...M bi =(M 1)b+, etc. Hence we only need to verify
703"
REFERENCES,0.6560717196414018,"(W 1)a+ ⊙(M 1)b+ = (M 1)a+ ⊙(W 1)b+
for 0≤a+,b+ ≤i
(21) 704"
REFERENCES,0.6568867155664222,"(W 1)a+ = [a++1,a++2,...,d,1,2,...,a+], while"
REFERENCES,0.6577017114914425,"(M 1)b+ = [b++1,...,d′,1,...,b+,d′+1+b+,...,d,d′+1,...,d′+b+]"
REFERENCES,0.658516707416463,"hence (W 1)a+ ⊙(M 1)b+ =[∅...∅]=0 for 0≤a+ ̸=b+ <d′. For a+ =b+ both sides of (21) are equal
705"
REFERENCES,0.6593317033414833,"too. Hence if we choose d′ =i+1, (21) and hence EqIM(1)...EqIM(ia) are all satisfied. If we choose
706"
REFERENCES,0.6601466992665037,"d′ =i, a+ =d′, b+ =0, (21) reduces to
707"
REFERENCES,0.660961695191524,"(W 1)d′ ⊙(M 1)0 = [d′+1,...,d,1,...,d′]⊙Id = 0, and"
REFERENCES,0.6617766911165445,(M 1)d′ ⊙(W 1)0 = Id⊙Id = Id
REFERENCES,0.6625916870415648,"which are of course not equal. Hence EqIM(i) fails for d′ =i. Summing over all a′...ad′ and b′...bd′,
708"
REFERENCES,0.6634066829665851,"and noting that all other terms are 0 or cancel, shows that EqIM(i+) fails too. Together this shows
709"
REFERENCES,0.6642216788916055,"for d′ =i+1 that EqIM(1)...EqIM(ia) do not imply any version of EqIM(i+1).
710"
REFERENCES,0.6650366748166259,"Despite M a having full rank, A and A′ defined in Appendix G have very low rank, indicating
711"
REFERENCES,0.6658516707416463,"potentially many more consistent W.
712"
REFERENCES,0.6666666666666666,"A downside of this example is that it strictly only applies to the ⊙-version (20). Many entries of
713"
REFERENCES,0.6674816625916871,"M + and W + and powers thereof are 0, so (8) contains many divisions by zero. We were not able to
714"
REFERENCES,0.6682966585167074,"extend this example by mixing in e.g. a uniform matrix as done in the first counter-example to (v).
715"
REFERENCES,0.6691116544417278,"Many real-world MDPs are sparse. Only a subset G⊆S×S of transitions s→s′ is possible. For
716"
REFERENCES,0.6699266503667481,"(s,s′)̸∈G, p(s′|sa)=0 ∀a, or formally M a
ss′ =M +
ss′ =0. In this case, no action causes s→s′ and
717"
REFERENCES,0.6707416462917686,"p(a|ss′)=M a
ss′/M +
ss′ being undefined is actually appropriate. So we could restrict (s,s′) to G (and
718"
REFERENCES,0.6715566422167889,"analogously (s,...,si) and (ssi) by chaining G) in the conditions and conclusions of the various
719"
REFERENCES,0.6723716381418093,"conjectures. It is then also natural to restrict the model class to M:={M · :M +
ss′ >0 ⇔(s,s′)∈G}.
720"
REFERENCES,0.6731866340668297,"For unknown G, the condition M,W ∈M then becomes M +
ss′ > 0 ⇔W +
ss′ > 0. Unfortunately
721"
REFERENCES,0.6740016299918501,"the above counter-example does not even satisfy this weaker condition, but the more complicated
722"
REFERENCES,0.6748166259168704,"example of Appendix K does. See Appendix Q for how to treat 0/0 in practice.
723"
REFERENCES,0.6756316218418907,"K
Non-Uniqueness of Inverse MDP Models for i≥2
724"
REFERENCES,0.6764466177669112,"In Appendices I/J we provided conjectured/unsatisfactory counter-examples to EqIM(1:i)⇒EqIM(i+
725"
REFERENCES,0.6772616136919315,"1). Here we provide a fully satisfactory counter-example that avoids the “bad” 0/0.
726"
REFERENCES,0.6780766096169519,"EqIM(1) and EqIM(2a) do not imply EqIM(3).
Consider two matrices
˙M 0 and
˙M 1 with
727"
REFERENCES,0.6788916055419723,"disjoint support, i.e. ˙M 0⊙˙M 1 =0. In this case ˙M a⊘˙M + ∈{0,1,⊥} ˙d× ˙d is a partial binary matrix
728"
REFERENCES,0.6797066014669927,"with entry undefined (⊥) wherever ˙M +=0 but otherwise 0 wherever ˙M a=0 and 1 wherever ˙M a>0.
729"
REFERENCES,0.680521597392013,"That is, it is insensitive to the actual (non-zero) values of ˙M a. A simple such ˙M is ˙M 0 =
 1 0
0 1

and
730"
REFERENCES,0.6813365933170334,"˙M 1 =
 0 1
1 0

, ignoring normalization. For now we ignore ss′ for which ˙M +
ss′ =0 and return to this
731"
REFERENCES,0.6821515892420538,"issue later.
732"
REFERENCES,0.6829665851670742,"We consider M a and W a that permute states. That is, M ·
ss′ :=[[s′ =π·(s)]] and W ·
ss′ :=[[s′ =σ·(s)]]
733"
REFERENCES,0.6837815810920945,"for some permutations π·,σ· : {1,...,d} →{1,...,d}. Strictly speaking, we should multiply this by
734"
REFERENCES,0.684596577017115,e.g. π(a|s) = 1
REFERENCES,0.6854115729421353,"k, but this global factor plays no role here, so will be dropped everywhere. Matrix
735"
REFERENCES,0.6862265688671557,"multiplication corresponds to permutation composition: [M ·W ·]ss′′ =[[s′′ =σ·(π.(s)]]. We denote
736"
REFERENCES,0.687041564792176,"example permutation (matrices) by [π]=[π(1)...π(d)]. Consider now
737"
REFERENCES,0.6878565607171964,"˙M 0 ˙M 0 = [123456]
˙M 0 := [456123] =: [π0]
=⇒
˙M 0 ˙M 1 = [564312]
(22)
˙M 1 := [231645] =: [π1]
˙M 1 ˙M 0 = [645231]
˙M 1 ˙M 1 = [312564]"
REFERENCES,0.6886715566422168,"No column contains the same number twice, hence this not only satisfies ˙M 0⊙˙M 1 =0 but also
738"
REFERENCES,0.6894865525672371,"˙M a ˙M a′ ⊙˙M b ˙M b′ = 0 unless a=b and a′ =b′
(23)"
REFERENCES,0.6903015484922576,"That 6→5→4→6 is in reverse oder to 1→2→3→1 is crucial for making ˙M 0 and ˙M 1 not commute.
739"
REFERENCES,0.6911165444172779,"Note that (23) remains valid if each 1-entry of ˙M a is replaced by a different non-zero scalar, since
740"
REFERENCES,0.6919315403422983,"(23) is purely multiplicative. So if ˙W a = ˙M a⊙˙J for some J >0, then ˙W a ˙W a′ = ˙M a ˙M a′ ⊙K for
741"
REFERENCES,0.6927465362673186,"some K >0. Let ˙W a be such a matrix. Then [ ˙W a ˙W a′ ⊘˙W + ˙W +] ˙s ˙s′′ =1 if [ ˙M a ˙M a′] ˙s ˙s′′ >0 and 0
742"
REFERENCES,0.6935615321923391,"(or undefined) otherwise, i.e. is independent of the choice of J. So such ˙W ̸= ˙M satisfies EqIM(2a).
743"
REFERENCES,0.6943765281173594,"Unfortunately the probability constraints W a
s+=1 require Ja
ss′ =1 when M +
ss′ >0, and hence W =M.
744"
REFERENCES,0.6951915240423798,"But the general idea is sound and can be made work as follows:
745"
REFERENCES,0.6960065199674002,"We split one state, e.g. s=6 into two states s=6a and s=6b. We leave the permutation structure
746"
REFERENCES,0.6968215158924206,"intact, except that all deterministic transitions into s=6 are split into stochastic transitions to s=6a
747"
REFERENCES,0.6976365118174409,"and s=6b, and transitions from 6a and 6b will be to the same state as from original 6. Condition (23)
748"
REFERENCES,0.6984515077424613,"is still satisfied, so the above argument still goes through, but now we can choose different stochastic
749"
REFERENCES,0.6992665036674817,"transitions to s=6a and s=6b in W and M.
750"
REFERENCES,0.700081499592502,"Finally, we have to show violation of EqIM(3). EqIM(ia) holds iff W aW a′...⊘M aM a′... =
751"
REFERENCES,0.7008964955175224,"W +W +...⊘M +M +... is independent aa′... iff
752"
REFERENCES,0.7017114914425427,"W aW a′...W ai ⊙M bM b′...M bi = M aM a′...M ai ⊙W bW b′...W bi
∀aa′...ai,bb′...bi
(24)"
REFERENCES,0.7025264873675632,"(While this looks like k2i matrix equations, by chaining, checking ki pairs suffices, which is the same
753"
REFERENCES,0.7033414832925835,"number of equations as in EqIM(ia)).
754"
REFERENCES,0.7041564792176039,"It is easier to split every state into two states: s := ( ˙s,¨s) with ˙s ∈{1,...,6} as before and splitter
755"
REFERENCES,0.7049714751426243,"¨s ∈{0,1}. M a
ss′ := ˙M a
˙s ˙s′ ¨
M a ˙s
¨s¨s′. Note that ¨
M is flexible enough to expand each 1-entry in ˙M a to a
756"
REFERENCES,0.7057864710676447,"different 2×2 (stochastic) matrix, while the 0-entries become
 0 0
0 0

. This flexibility is important: ¨
M
757"
REFERENCES,0.706601466992665,"independent a or independent ˙s would not work. Now let us write out
758"
REFERENCES,0.7074164629176855,"[M aM a′M a′′]ss′′′ =
X"
REFERENCES,0.7082314588427058,"˙s′ ˙s′′
˙M a
˙s ˙s′ ¨
M a′
˙s′ ˙s′′ ˙M a′′
˙s′′ ˙s′′′
X"
REFERENCES,0.7090464547677262,"¨s′¨s′′
˙M a ˙s
¨s¨s′ ¨
M a′ ˙s′
¨s′¨s′′ ¨
M a′′ ˙s′′
¨s′′¨s′′′
(25)"
REFERENCES,0.7098614506927465,"The crucial difference to the i=2 case (23) is that now there are difference permutation sequences
759"
REFERENCES,0.710676446617767,"leading to the same permutation, for instance
˙M 0 ˙M 0 ˙M 1 = ˙M 1 = ˙M 1 ˙M 0 ˙M 0. Let us choose
760"
REFERENCES,0.7114914425427873,"aa′a′′ = 001 and ˙s = 1, then only ˙s′ = π0( ˙s) = 4 and ˙s′′ = π0( ˙s′) = 1 contribute to the sum and
761"
REFERENCES,0.7123064384678076,"˙s′′′ =π1( ˙s′′)=2. For this choice, (25) becomes 1·1·1·[ ¨
M 01 ¨
M 04 ¨
M 11]¨s¨s′′′. If we replace aa′a′′ in
762"
REFERENCES,0.713121434392828,"(25) by bb′b′′ and then choose bb′b′′=100 and again ˙s=1, then only ˙s′=π1( ˙s)=2 and ˙s′′=π0( ˙s′)=5
763"
REFERENCES,0.7139364303178484,"contribute and ˙s′′′ =π0( ˙s′′)=2. For this choice, (25) becomes 1·1·1·[ ¨
M 11 ¨
M 02 ¨
M 05]¨s¨s′′′. We now
764"
REFERENCES,0.7147514262428688,"define W a
ss′ := ˙M a
˙s ˙s′ ¨W a ˙s
¨s¨s′. Since ˙M remains the same, the same action and state sequences above
765"
REFERENCES,0.7155664221678891,"lead to the same result for W, just with ¨
M replaced by ¨W. If we plug the four expressions into (24)
766"
REFERENCES,0.7163814180929096,"(for i=3) we get
767"
REFERENCES,0.7171964140179299,"¨W 01 ¨W 04 ¨W 11⊙¨
M 11 ¨
M 02 ¨
M 05 = ¨
M 01 ¨
M 04 ¨
M 11⊙¨W 11 ¨W 02 ¨W 05"
REFERENCES,0.7180114099429503,"Since this expressions involves 10 different 2×2 stochastic matrices, there are plenty of choices to
768"
REFERENCES,0.7188264058679706,"make both sides different. If we choose all 2×2 matrices to have full support, then by construction,
769"
REFERENCES,0.7196414017929911,"W and M have the same support, hence constitute a proper counter-example to EqIM(3). We now
770"
REFERENCES,0.7204563977180114,"extend this construction to i>2.
771"
REFERENCES,0.7212713936430318,"EqIM(1a)∧...∧EqIM(ia) do not imply EqIM(i+1).
The construction in the previous para-
772"
REFERENCES,0.7220863895680522,"graph generalizes to i>2: We need to find two permutations ˙M 0=π0 and ˙M 1=π1 such that for each
773"
REFERENCES,0.7229013854930725,"fixed j ≤i all possible 2j concatenations (products) of these permutation (matrices) differ in the sense
774"
REFERENCES,0.7237163814180929,"that no s is mapped to the same sj (they have disjoint support). Since all ˙M a ˙M a′... ˙M aj ∈{0,1}, we
775"
REFERENCES,0.7245313773431132,"can write this condition compactly as
776 X"
REFERENCES,0.7253463732681337,"aa′...aj
˙M a ˙M a′... ˙M aj ∈{0,1}d×d"
REFERENCES,0.726161369193154,"By factoring the sum, this is equivalent to ( ˙M +)j ∈{0,1}d×d. Note that [( ˙M +)j]ssi counts the
777"
REFERENCES,0.7269763651181744,"number of action sequences aa′...aj of length j that lead from s to si. For j =i+1, we want this
778"
REFERENCES,0.7277913610431948,"condition to be violated. So in order to disprove the implication we need to find two permutations
779"
REFERENCES,0.7286063569682152,"M 0 and M 1 such that
780"
REFERENCES,0.7294213528932355,"( ˙M +)j ∈{0,1}d×d ∀j ≤i but ( ˙M +)i+1 ̸∈{0,1}d×d
(26)"
REFERENCES,0.7302363488182559,"The rest of the argument is the same as for the i=2 case above: creating two versions M a and W a of
781"
REFERENCES,0.7310513447432763,"˙M a by spitting one or all states into two, and replacing the 1s by 2×2 different stochastic matrices.
782"
REFERENCES,0.7318663406682967,"As for the choice of ˙M a, for i=3 we can choose 3-cycle and 5-cycle
783"
REFERENCES,0.732681336593317,"˙M 0 = [6,7,8,9,10,11,12,13,14,15,1,2,3,4,5]
= (1,6,11)(2,7,12)(3,8,13)(4,9,14)(5,10,15)
(27)
˙M 1 = [2,3,4,5,1,8,9,10,6,7,14,15,11,12,13]
= (1,2,3,4,5)(6,8,10,7,9)(11,14,12,15,13)"
REFERENCES,0.7334963325183375,"where we also provide the more conventional cycle notation in round brackets. Crucially the 5-cycles
784"
REFERENCES,0.7343113284433578,"have been chosen to not commute with the 3-cycles (M 0M 1 ̸=M 1M 0). Conditions (26) can easily
785"
REFERENCES,0.7351263243683781,"be verified numerically. For higher i we need p cycles and q cycles, where p and q are relative
786"
REFERENCES,0.7359413202933985,"prime and sufficiently large. We need at least d=p·q ≥2i, otherwise ˙M + ̸∈{0,1}d×d by a simple
787"
REFERENCES,0.7367563162184189,"pigeon-hole argument. To prove EqIM(1a)∧...∧EqIM(ia)̸⇒EqIM(i+1) in general for arbitrarily
788"
REFERENCES,0.7375713121434393,"large i, we need to invoke some group theory. All-together we have shown that
789"
REFERENCES,0.7383863080684596,"Proposition 4 ((i)-(vi) can fail) EqIM(1a)∧...∧EqIM(ia) do not necessarily imply EqIM(i+1) for
790"
REFERENCES,0.73920130399348,"any i. This in turn implies that (i)-(vi) each can fail for some M ·.
791"
REFERENCES,0.7400162999185004,"L
Computational Complexity
792"
REFERENCES,0.7408312958435208,"Maybe even just characterizing all M for which EqIM(1) and EqIM(2) uniquely determine W is
793"
REFERENCES,0.7416462917685411,"hopeless, not to speak of finding some or all W in case not. More formally, we can ask the question of
794"
REFERENCES,0.7424612876935616,"whether there exists an efficient algorithm that can decide whether EqIM(i) has a unique solution. We
795"
REFERENCES,0.7432762836185819,"provide some weak preliminary evidence, why this problem may be NP-hard. Appendix O contains
796"
REFERENCES,0.7440912795436023,"fully self-contained a few versions of this open problem in their simplest instantiation and most
797"
REFERENCES,0.7449062754686226,"elegant form.
798"
REFERENCES,0.7457212713936431,"Decidability and computability.
EqIM(2) converted to (24) and (7), or (28) or (29) below form a
799"
REFERENCES,0.7465362673186634,"System of Quadratic Equations (SQE). The constraint W ̸=M can also be expressed as a quadratic
800"
REFERENCES,0.7473512632436837,"equation (see below). As such, the existence and uniqueness of solutions is formally decidable
801"
REFERENCES,0.7481662591687042,"by computing a Gr¨obner basis [Stu02], and (some) solutions can be found by cylindrical algebraic
802"
REFERENCES,0.7489812550937245,"decomposition in (double) exponential time. ε-approximate solutions can of course be found by
803"
REFERENCES,0.7497962510187449,"exponential brute-force search through all W on a finite ε′-grid, and verified in polynomial time.
804"
REFERENCES,0.7506112469437652,"Complexity considerations.
3SAT is NP complete. A CNF formula in n boolean variables can
805"
REFERENCES,0.7514262428687857,"easily be converted to a System of Quadratic Equations (SQE). Therefore SQE is also NP hard.
806"
REFERENCES,0.752241238793806,"EqIM(2+) explicitly written in quadratic form
807"
REFERENCES,0.7530562347188264,"M aM +⊙(W +)2−W aW +⊙(M +)2 = 0
(28)"
REFERENCES,0.7538712306438468,"constitutes an SQE in W given M, also if we include linear EqIM(1) and probability constraints
808"
REFERENCES,0.7546862265688672,"(7). Non-negativity of W can be enforced with (slack) variables (Y a
ss′)2 = W a
ss′. (Similarly (17)
809"
REFERENCES,0.7555012224938875,"plus constraints (16) constitute an SQE in ∆.) To reduce the uniqueness question to a solvability
810"
REFERENCES,0.756316218418908,"problem we need to avoid the trivial solution W ≡M, e.g. by introducing further (slack) variables
811"
REFERENCES,0.7571312143439283,"t∈R and Γa
ss′ :=(W a
ss′−M a
ss′)2 and constraint t·Γ+
++=1. Due to the minus sign in (28), this cannot
812"
REFERENCES,0.7579462102689487,"be converted to a convex (optimization) problem. The choice of M gives significant freedom in
813"
REFERENCES,0.758761206193969,"creating SQE problems, even if only considering permutation matrices M a ∈{0,1}d×d. If one could
814"
REFERENCES,0.7595762021189894,"show that every SQE can be represented as (28) [plus W ̸=M constraint] for a suitable choice of M,
815"
REFERENCES,0.7603911980440098,"this would imply that proving the existence of W ̸=M satisfying (28) is NP hard. This in turn would
816"
REFERENCES,0.7612061939690301,"imply that computing (any) p(a|ss′′′) from p(a|ss′) and p(a|ss′′) is NP hard. On the other hand,
817"
REFERENCES,0.7620211898940505,"matrix multiplication W aW b is a very specific quadratic form, which may not be flexible enough to
818"
REFERENCES,0.7628361858190709,"incorporate every SQE within (28).
819"
REFERENCES,0.7636511817440913,"We could not find any work on NP-hardness of Systems of Polynomial Matrix Equations (SPME).
820"
REFERENCES,0.7644661776691116,"There is work on the NP-hardness of tensor problems [HL13], but this refers to the design tensors, e.g.
821
P"
REFERENCES,0.7652811735941321,"jkAjk
i xjxk+P"
REFERENCES,0.7660961695191524,"jBj
i xj+Ci =0 ∀i, but the unknowns are always treated as scalars or vectors. Of
822"
REFERENCES,0.7669111654441728,course [X·Y ]ik =P
REFERENCES,0.7677261613691931,"abcdAabcd
ik
XabYcd, but Aabcd
ik
=δaiδdkδbc is a very special fixed tensor (actually
823"
REFERENCES,0.7685411572942136,"of low tensor rank d) with no flexibility of encoding NP-hard problems therein.
824"
REFERENCES,0.7693561532192339,"That inference in Bayesian networks is NP-complete [KF09] does not help us either for two reasons:
825"
REFERENCES,0.7701711491442543,"First, in our problem the probability distribution over states and actions is only partially given. More
826"
REFERENCES,0.7709861450692747,"importantly, our network for i=2 has only 5 nodes (s,a,s′,a′,s′′), while the NP-hardness proofs we
827"
REFERENCES,0.771801140994295,"are aware of require large networks. Even for fixed i>2, it is not obvious how to encode NP-hard
828"
REFERENCES,0.7726161369193154,"problems into EqIM(i), due to the severe structural constraints in EqIM(i) compared to a general
829"
REFERENCES,0.7734311328443357,"network with 2i+3 nodes. It is not clear how to exploit the fact that our (few) state nodes are large.
830"
REFERENCES,0.7742461287693562,"SQE are polynomially equivalent to Systems of Quadratic Matrix Equations (SQME), which may be
831"
REFERENCES,0.7750611246943765,"the reason complexity theorists have ignored the latter. We suspect but do not know whether SQME
832"
REFERENCES,0.7758761206193969,"of bounded structural complexity (only the definitions of the constant matrices scale with d×d) is
833"
REFERENCES,0.7766911165444172,"NP-hard (Open Problem 7). If we allow sparse encoding of SQE variables in W, i.e. we allow one
834"
REFERENCES,0.7775061124694377,"equation involving ⊙of the form B⊙W =0 with boolean matrix B, then bounded SQME becomes
835"
REFERENCES,0.778321108394458,"NP-hard. See Appendix M for details.
836"
REFERENCES,0.7791361043194784,"Below we directly reduce 1in3SAT to a Bounded-SQME with ⊙that resembles our problem as close
837"
REFERENCES,0.7799511002444988,"as we were able to make it.
838"
REFERENCES,0.7807660961695192,"An NP-hard matrix problem.
From EqIM(1) we know that W a =Ba⊙W +. Plugging this into
839"
REFERENCES,0.7815810920945395,"EqIM(2a) gives
840"
REFERENCES,0.78239608801956,"Baa′ ⊙(W +·W +) = (Ba⊙W +)(Ba′ ⊙W +) with constraints [Ba⊙W +]s+ =π(a|s)
(29)"
REFERENCES,0.7832110839445803,"This set of equations is purely in terms of what is given (Ba and Baa′) and only involves unknowns
841"
REFERENCES,0.7840260798696006,"W + without reference to W a. See Appendix N for some further simplification and discussion. We
842"
REFERENCES,0.784841075794621,"will show:
843"
REFERENCES,0.7856560717196414,"Proposition 5 (An NP-hard matrix problem) Given A,B,C,Π, deciding whether the following
844"
REFERENCES,0.7864710676446618,"quadratic matrix problem has a solution in W is NP-hard:
845"
REFERENCES,0.7872860635696821,"A⊙(W ·W)=(C⊙W)(C⊙W),
[B⊙W]s+ =1,
Π·W =W
(30)"
REFERENCES,0.7881010594947025,"This has some resemblance to (29). Since the boundary between P and NP is very fractal/subtle,
846"
REFERENCES,0.7889160554197229,"this in-itself may not imply much, but is more meant as a demonstration of how one may approach
847"
REFERENCES,0.7897310513447433,"proving NP-hardness of (29).
848"
REFERENCES,0.7905460472697636,"Proof. We reduce 1in3SAT, which is an NP-complete variant of 3SAT, where each clause must have
849"
REFERENCES,0.7913610431947841,"exactly one satisfying assignment, to (30). A 3CNF(n,m,g) formula is a boolean conjunction of m
850"
REFERENCES,0.7921760391198044,"clauses in n variables, where each clause ci =ℓi1 ˙∨ℓi2 ˙∨ℓi3 for i∈{1:m} is a 1-in-3 disjunction of 3
851"
REFERENCES,0.7929910350448248,"literals, and each literal is ℓia =xj or it’s complement ℓia =¬xj ≡¯xj, where j =g(i,a) is the variable
852"
REFERENCES,0.7938060309698451,"index of clause i in position a.
853"
REFERENCES,0.7946210268948656,"We arithmetize the 3CNF expression in the standard way by replacing True;1, False;0, and ˙∨;+,
854"
REFERENCES,0.7954360228198859,"i.e. we ask whether the system of linear equations ℓi1+ℓi2+ℓi3 =1 ∀i has a solution in xj ∈{0,1}.
855"
REFERENCES,0.7962510187449062,"We need to encode the x’s into W somehow: We aim at the following embedding:
856 W = "
REFERENCES,0.7970660146699267,"
x1
¯x1
...
xn
¯xn
y0
...
yk
...
...
...
...
...
...
...
...
x1
¯x1
...
xn
¯xn
y0
...
yk  "
REFERENCES,0.797881010594947,"The y are k+1:=max{1,m−n+2} extra dummy variables to make the matrix a square d×d matrix
857"
REFERENCES,0.7986960065199674,"with d:=max{m+n+2,2n+1}.
858"
REFERENCES,0.7995110024449877,"Choosing a cyclic permutation matrix Π=[234...d1] ensures that all rows of W are indeed the same
859"
REFERENCES,0.8003259983700082,"via Π·W =W. The standard way of achieving xj,yj ∈{0,1} is via x2
j =xj and y2
j =yj. This can be
860"
REFERENCES,0.8011409942950285,"achieved via (Id⊙W)2 =Id⊙W, were Idss′ =δss′ is the identity matrix.
861"
REFERENCES,0.8019559902200489,"We use [B⊙W]s+ =1 to ensure ¯xj =1−xj, y0 =1, and y1 =...=yk =0 and ℓi1+ℓi2+ℓi3 =1 by
862"
REFERENCES,0.8027709861450693,"setting Bs,2s−1=Bs,2s=1 for s∈{1:n}, and Bi+n,2j−1=1 if ℓia=xj and Bi+n,2j =1 if ℓia=¬xj
863"
REFERENCES,0.8035859820700897,"for i∈{1:m} and a∈{1,2,3}, and Bd−1,2n+1 =...=Bd−1,2n+m =1, and Bd,2n+1 =1, and Bss′ =0
864"
REFERENCES,0.80440097799511,"for all other ss′. This also ensures that all rows of W sum to n+1, hence W ·W = (n+1)W, so
865"
REFERENCES,0.8052159739201304,"xj ∈{0,1} can be achieved via C =Id and A=
1
n+1Id in A⊙(W ·W)=(C⊙W)(C⊙W).
866"
REFERENCES,0.8060309698451508,"The construction implies that the 3CNF(n,m,g) formula is satisfiable iff (30) has a solution in W
867"
REFERENCES,0.8068459657701712,"with the A,B,C,Π as constructed above. This shows NP-hardness of deciding whether (30) has a
868"
REFERENCES,0.8076609616951915,"solution. A solution can trivially be verified (in the rationals or to ε-precision over the reals) in time
869"
REFERENCES,0.8084759576202118,"O(d3), hence the problem is in NP, hence NP-complete.
870"
REFERENCES,0.8092909535452323,"M
Systems of Quadratic Matrix Equations
871"
REFERENCES,0.8101059494702526,"A System of Polynomial Equations (SPE) is a set of multivariate polynomial equations
872"
REFERENCES,0.810920945395273,"Polyj(x,y,z,...) = 0 over R in n variables x,y,z,u,v,w,... ∈R for j ∈{1 : m}. This class is NP-
873"
REFERENCES,0.8117359413202934,"hard (via a simple reduction from 1in3SAT, see Section L). We can recursively replace each product
874"
REFERENCES,0.8125509372453138,"xy (sum bu+cv) in the polynomials by a new variable z (w) and add “polynomial” equation z =xy
875"
REFERENCES,0.8133659331703341,"(w=bu+cv). This results in SPEs consisting of only linear equations with a single + (bu+cv=w)
876"
REFERENCES,0.8141809290953546,"and quadratic equations without any + (xy=z), which are still (even with all a=b=1 and x=y=z)
877"
REFERENCES,0.8149959250203749,"NP-hard. We call them Simple Systems of Quadratic Equations (Simple SQE). For the reduction pro-
878"
REFERENCES,0.8158109209453953,"cess to actually work we need one further dummy variable and equation q=1 (to reduce bu+c=w).
879"
REFERENCES,0.8166259168704156,"Alternatively, with some extra work, we can reduce any SPE into a Simple SQE asking for a non-zero
880"
REFERENCES,0.8174409127954361,"solution. We will pursue the latter, since this is closer to our interest (SQE (17) with solution ∆̸≡0).
881"
REFERENCES,0.8182559087204564,"We can even merge the linear and quadratic equations into a single form xy=bu+cv by choosing
882"
REFERENCES,0.8190709046454768,"b=1 and c=0 (replacing xy by w and adding xy=0·u+1·w).
883"
REFERENCES,0.8198859005704972,"We define a System of Polynomial/Quadratic Matrix Equations (SPME/SQME) as a set of m
884"
REFERENCES,0.8207008964955175,"multivariate (quadratic) polynomials Polyj(∆,Γ,...|A,B,C,...)=0 in the (unknown) matrix variables
885"
REFERENCES,0.8215158924205379,"∆,Γ,... and the (given) matrix constants (“coefficients”) A,B,C,.... Alternatively, Polyj might be
886"
REFERENCES,0.8223308883455582,"viewed as generalized polynomials over a non-commutative matrix ring in the unknowns only. In any
887"
REFERENCES,0.8231458842705787,"case, note that
888"
REFERENCES,0.823960880195599,A·∆·A′·∆·A′′+B·∆·B′+C ̸= (A·A′·A′′)·∆2+(B·B′)·∆+C
REFERENCES,0.8247758761206194,"By writing out all matrix operations in terms of their scalar operations, SPME is of course a sub-class
889"
REFERENCES,0.8255908720456397,"of SPE. SPE is also a sub-class of SPME (choose all matrices to be 1×1 matrices), which implies
890"
REFERENCES,0.8264058679706602,"SPME is NP-hard. But we are interested in NP-hard small subclasses of SPME, so will construct
891"
REFERENCES,0.8272208638956805,"a more economical embedding: Assume we have a Simple SQE with n variables x,y,z,u,v,.... We
892"
REFERENCES,0.8280358598207009,"place them into d×d matrix ∆(d≥√n) introducing dummy variables for the remaining entries. We
893"
REFERENCES,0.8288508557457213,"can extract variable w=∆ss′ via w=es⊤·∆·es′, where es is basis vector (d×1-matrix) (es)s′1=δss′.
894"
REFERENCES,0.8296658516707417,"If we replace all variables in the Simple SQE expressions xy=au+bv by such expressions, we get a
895"
REFERENCES,0.830480847595762,"Simple SQME with Polyj equations of the form (dropping · as usual)
896"
REFERENCES,0.8312958435207825,"aj∆A′j∆a′′j = bj∆b′j+cj∆c′j
∀j
(31)"
REFERENCES,0.8321108394458028,"While these are scalar equations, since the outer matrices are 1×d on the left and d×1 on the right,
897"
REFERENCES,0.8329258353708231,"technically they are matrix equations. We could pad all involved matrices, including the outer ones,
898"
REFERENCES,0.8337408312958435,"with zeros to square Rd×d matrices of the same size (for sufficiently large d, and only polynomial
899"
REFERENCES,0.8345558272208639,"overhead).
900"
REFERENCES,0.8353708231458843,"We can reduce (31) to just one equation at the cost of making the equations more complicated as
901"
REFERENCES,0.8361858190709046,"follows: Write each equation Polyj =0 in the form es·Polyj·es′⊤=0, with a different (s,s′)-pair for
902"
REFERENCES,0.837000814995925,"each j. These are now “proper” matrix equations, but with all entries identically 0 except entry (s,s′)
903"
REFERENCES,0.8378158109209454,"being Polyj. This allows us to sum all equations without conflating them into one (complex) matrix
904"
REFERENCES,0.8386308068459658,"equations
905 P"
REFERENCES,0.8394458027709861,jAj∆A′j∆A′′j = P
REFERENCES,0.8402607986960066,"jBj∆B′j+Cj∆C′j
(32)"
REFERENCES,0.8410757946210269,"Another way to combine (31) into one equation is by putting all M j for all j into one block-diagonal
906"
REFERENCES,0.8418907905460473,"matrix ˜
M :=Diag(M 1,...,M m) for M ∈{a,A′,a′′,b,b′,c,c′,∆}. For ˜∆we need to ensure that indeed
907"
REFERENCES,0.8427057864710676,"all blocks ∆j =∆are equal. This can be done via ˜Π⊤˜∆˜Π= ˜∆for some cyclic block permutation ˜Π.
908"
REFERENCES,0.843520782396088,"We further need to ensure that the off-diagonal blocks of ˜∆are zero. We can zero each block with
909"
REFERENCES,0.8443357783211084,"one equation, but it seems impossible to zero all with a bounded number of Simple QMEs. We can
910"
REFERENCES,0.8451507742461287,"modify the decision problem to decide whether specific sparse solutions ˜∆exist. Formally, we can
911"
REFERENCES,0.8459657701711492,"introduce element-wise multiplication ⊙and allow one equation of the form ˜B⊙˜∆=0 with ˜B being
912"
REFERENCES,0.8467807660961695,"0/1 on the on/off-diagonal blocks. This leads to a Simple SQME with ⊙in 3 equations (dropping the
913"
REFERENCES,0.8475957620211899,"∼)
914"
REFERENCES,0.8484107579462102,"A∆A′∆A′′ = B∆B′+C∆C′,
Π⊤∆Π=∆,
B⊙∆=0
(33)"
REFERENCES,0.8492257538712307,"Proposition 6 (NP-hardness of Simple SQME) Systems of Polynomial Equations (SPE) can be
915"
REFERENCES,0.850040749796251,"polynomially reduced to Simple Systems of Quadratic Matrix Equations (Simple SQME) (31). The
916"
REFERENCES,0.8508557457212714,"number of equations can be reduced to 1 at the expense of making the equations complex (32), or to
917"
REFERENCES,0.8516707416462918,"2 by asking for sparse solutions or by enforcing sparsity via B⊙∆=0 (33). Since SPE are NP-hard,
918"
REFERENCES,0.8524857375713122,"deciding the existence of non-zero solutions for all three SQME versions is also NP-hard.
919"
REFERENCES,0.8533007334963325,"An NP-hardness proof for a Simple SQME with ⊙with 3 equations via reduction from 1in3SAT
920"
REFERENCES,0.8541157294213529,"that looks much closer to the desired form (29) or (34) is given in Section L. By a similar reduction,
921"
REFERENCES,0.8549307253463733,"encoding all n variables and their complement in the diagonal of ∆=Diag(x,¯x,y,¯y,...,), one can also
922"
REFERENCES,0.8557457212713936,"show that solvability of
923"
REFERENCES,0.856560717196414,"∆2 =∆,
A∆1=1,
Id⊙∆=∆,
with A∈{0,1}m×2n"
REFERENCES,0.8573757131214343,"is NP-complete (1 is the all-1 vector, sparse A with 2 or 3 ones in each row suffice), but not all SPE
924"
REFERENCES,0.8581907090464548,"can be reduced to this form.
925"
REFERENCES,0.8590057049714751,"Open Problem 7 (Are Bounded SPME NP-hard?) Are Systems of Polynomial Matrix Equations
926"
REFERENCES,0.8598207008964955,"(without ⊙) of bounded structural complexity NP-hard? Bounded means, only the definitions of the
927"
REFERENCES,0.8606356968215159,"constant matrices scale with d×d, but the polynomial degrees, number of equations, and number of
928"
REFERENCES,0.8614506927465363,"matrix operations are bounded.
929"
REFERENCES,0.8622656886715566,"N
Compact Representation of EqIM(2+)
930"
REFERENCES,0.863080684596577,"If only Ba+ (EqIM(2+)) is given, we can sum (29) over a′. If we further assume a=2 and define
931"
REFERENCES,0.8638956805215974,"B =B0 and A=B0+ and W =W + and exploit B+ =B++ =1, this reduces to the elegant quadratic
932"
REFERENCES,0.8647106764466178,"matrix equation
933"
REFERENCES,0.8655256723716381,"A⊙(W ·W) = (B⊙W)·W
(34)"
REFERENCES,0.8663406682966586,"with constraints as in (29), or even simpler Ws+=1 if π is unknown. This is the most pure formulation
934"
REFERENCES,0.8671556642216789,"of the problem we are trying but are unable to solve we could come up with. For A and B defined via
935"
REFERENCES,0.8679706601466992,"M, we know that (34) has a solution (namely W =M +).
936"
REFERENCES,0.8687856560717196,"We neither know whether there exists an efficient algorithm to find some solution (34), nor to find the
937"
REFERENCES,0.86960065199674,"solution in case it is unique, nor to decide whether there exist solutions in case A and B are chosen
938"
REFERENCES,0.8704156479217604,"arbitrarily.
939"
REFERENCES,0.8712306438467807,"The condition Ws+=1 can be relaxed to Ws+>0. If Wss′ is a solution of (34), then also v−1
s Wss′vs′
940"
REFERENCES,0.8720456397718012,"for any v· > 0 (most easily checked via (11)). Every non-negative matrix has a real non-negative
941"
REFERENCES,0.8728606356968215,"Eigenvector v, and Ws+>0 implies vs>0 and Eigenvalue λ>0, hence for W norm
ss′ :=(λvs)−1Wss′vs′,
942"
REFERENCES,0.8736756316218419,"we have W norm
s+ =1.
943"
REFERENCES,0.8744906275468622,"Ba ≥0 and B+ = 1 iff B ∈[0;1] (and B1 = 1−B). Ba+ ≥0 and B++ = 1 iff A ∈[0;1] (and
944"
REFERENCES,0.8753056234718827,"B1+ =1−A). But we can scale back any A and B by the same 0<λ<1 to satisfy these without
945"
REFERENCES,0.876120619396903,"changing (34), i.e. these extra conditions (A and B bounded by 1) do not make the problem any
946"
REFERENCES,0.8769356153219234,"simpler.
947"
REFERENCES,0.8777506112469438,"O
Open Problem
948"
REFERENCES,0.8785656071719642,"We present the most important open problem(s) in their simplest instantiation and most elegant form,
949"
REFERENCES,0.8793806030969845,"fully self-contained here: Consider matrices A,B,W ∈[0;1]d×d with d ∈N, tied by the quadratic
950"
REFERENCES,0.8801955990220048,"matrix equation
951"
REFERENCES,0.8810105949470253,"A⊙(W ·W) = (B⊙W)·W
and
Ws+ =1 ∀s
(35)"
REFERENCES,0.8818255908720456,"where ⊙is element-wise (Hadamard) multiplication and · is standard matrix multiplication. The open
952"
REFERENCES,0.882640586797066,"problems are as follows: Given A and B, are there efficient algorithms which
953"
REFERENCES,0.8834555827220864,"(a) decide whether there exists a W satisfying (35)?
954"
REFERENCES,0.8842705786471068,"(b) decide whether the solution is unique, assuming (35) has a solution?
955"
REFERENCES,0.8850855745721271,"(c) compute a solution, assuming (35) has a solution?
956"
REFERENCES,0.8859005704971475,"(d) compute the solution, assuming (35) has a unique solution?
957"
REFERENCES,0.8867155664221679,0.00e+00
REFERENCES,0.8875305623471883,0.00e+00
REFERENCES,0.8883455582722086,0.00e+00
REFERENCES,0.8891605541972291,0.00e+00
REFERENCES,0.8899755501222494,1.18e-12
REFERENCES,0.8907905460472698,5.40e-07
REFERENCES,0.8916055419722901,3.45e-08
REFERENCES,0.8924205378973105,7.30e-05
REFERENCES,0.8932355338223309,1.64e-10
REFERENCES,0.8940505297473512,5.46e-05
REFERENCES,0.8948655256723717,3.53e-06
REFERENCES,0.895680521597392,7.71e-04
REFERENCES,0.8964955175224124,1.85e-03
REFERENCES,0.8973105134474327,5.24e-03
REFERENCES,0.8981255093724532,7.72e-04
REFERENCES,0.8989405052974735,7.66e-02
REFERENCES,0.8997555012224939,3.73e-02
REFERENCES,0.9005704971475142,1.29e-02
REFERENCES,0.9013854930725347,4.28e-03
REFERENCES,0.902200488997555,5.27e-01
REFERENCES,0.9030154849225754,"Figure 4: Reconstructing inverse and forward models from inverse models with noise injected. Rows,
from top to bottom, show reconstructions of Ba,Ba+,Ba++, and M a. Noise increases exponentially
across columns, from left to right, [0,10−6,10−5,10−4,10−3]. The subplot titles show the average
KL divergence of the recovered distribution from the ground truth."
REFERENCES,0.9038304808475958,"Computing a real number means, given any ε>0, computing an ε-approximation. Efficient means
958"
REFERENCES,0.9046454767726161,"running time is polynomial in d, ideally with a degree independent of 1/ε. General systems of
959"
REFERENCES,0.9054604726976365,"quadratic equations are known to be NP-hard, but we do not know the complexity of this particular
960"
REFERENCES,0.9062754686226568,"matrix sub-class.
961"
REFERENCES,0.9070904645476773,"The upper bounds A,B,W ≤1 can always be satisfied by scaling, hence are irrelevant. Ws+=1 can be
962"
REFERENCES,0.9079054604726976,"relaxed to Ws+ >0 except in the uniqueness questions. If helpful: One may assume A,B,W strictly
963"
REFERENCES,0.908720456397718,"positive. Also, any finite (d-independent) number of equations of the form A′⊙(W ·W) = (B′⊙W)·
964"
REFERENCES,0.9095354523227384,"W with other general matrices A′,B′ ∈[0;1]d×d may be added, which further constrain the solution
965"
REFERENCES,0.9103504482477588,"space.
966"
REFERENCES,0.9111654441727791,"P
Experimental Details
967"
REFERENCES,0.9119804400977995,"Here we provide further experiments supporting and illustrating the theory.
In Appendix Q we
968"
REFERENCES,0.9127954360228199,"show how we numerically dealt with B =0/0=⊥. Appendix R derives the formulas for the plotted
969"
REFERENCES,0.9136104319478403,"solution dimensions.
970"
REFERENCES,0.9144254278728606,"Experiments illustrating robustness to noise.
As mentioned in the main text, rather than commit-
971"
REFERENCES,0.9152404237978811,"ting to a specific learning algorithm, we instead directly inject noise into the true inverse distributions.
972"
REFERENCES,0.9160554197229014,"This is done by adding ε×10c to the true distribution and renormalizing B, where ε is drawn from
973"
REFERENCES,0.9168704156479217,"the unit uniform distribution: ε∼U[0,1]). In Figure 2, this noise is evaluated across several orders of
974"
REFERENCES,0.9176854115729421,"magnitude (c varied −7 to 0).
975"
REFERENCES,0.9185004074979625,"The main text also mentions that the effect of this noise is substantially diminished as the horizon of
976"
REFERENCES,0.9193154034229829,"the inverse model is increased (from B1:=Ba to B3:=Ba++). Figure 4 buttresses this interpretation
977"
REFERENCES,0.9201303993480032,"Figure 5: Reproduced from [LFLDP21], this ‘half-cheetah’ environment has been augmented with
videos of complex scenes. This highlights how non-controllable aspects of the environment can
be made more complex without changing the underlying control problem. The fact that such
environments are of interest motivates our focus on the Tensor-product special case."
REFERENCES,0.9209453952730237,"by showing that the recovered Ba++ is qualitatively similar to the ground truth even with substantial
978"
REFERENCES,0.921760391198044,"noise.
979"
REFERENCES,0.9225753871230644,"Experiments on the Tensor-product special case.
As mentioned in the main text, if M factors
980"
REFERENCES,0.9233903830480847,"into two processes
˙M a ⊗¨
M, where ¨
M is action-independent, then only the complexity of the
981"
REFERENCES,0.9242053789731052,"action-dependent process ˙M a matters for all of our questions.
982"
REFERENCES,0.9250203748981255,"This particular special case is important because of its frequency in applied work. Many environments
983"
REFERENCES,0.9258353708231459,"have most of their complexity in sub-spaces that the agent has no control over. This is illustrated by
984"
REFERENCES,0.9266503667481663,"Figure 5, reproduced from [LFLDP21], wherein naturalistic videos are superimposed on relatively
985"
REFERENCES,0.9274653626731867,"simple continuous control environments. Clearly, the background dynamics can be arbitrarily complex
986"
REFERENCES,0.928280358598207,"without impacting the underlying control problem.
987"
REFERENCES,0.9290953545232273,"We can construct small environments of this form via a simple procedure. We construct ˙M a with ˙d
988"
REFERENCES,0.9299103504482478,"states and k actions by sampling each element of the appropriately sized matrices from U[0,1] and
989"
REFERENCES,0.9307253463732681,"then normalizing. ¨
M has ¨d=2 states that transition uniformly regardless of the action. For the results
990"
REFERENCES,0.9315403422982885,"shown in Figure 3, k=5 as in the main text, and d=2 ˙d is varied from 2 to 32.
991"
REFERENCES,0.9323553382233088,"Note that in Figure 3, the solution dimension is non-zero even when ˙d≤k<d=2 ˙d (here k=5, hence
992"
REFERENCES,0.9331703341483293,"for d=6|8|10) despite there necessarily being a unique solution as per Section 4. This is due to the
993"
REFERENCES,0.9339853300733496,"fact that the algorithm does not exploit knowledge of the fact that M is a tensor product, resulting
994"
REFERENCES,0.93480032599837,"in the solution dimension being correct for the more general case where W is not confined to being
995"
REFERENCES,0.9356153219233904,"tensor product.
996"
REFERENCES,0.9364303178484108,"Q
How to Deal with 0/0
997"
REFERENCES,0.9372453137734311,"If for some pair of states (s,s′), no action a of positive π-probability leads from state s to s′, i.e. if
998"
REFERENCES,0.9380603096984516,"M +
ss′ =0, then B+
ss′ and Ba
ss′∀a are 0/0=⊥= undefined. To also handle B·
ss′ =⊥, we need to adapt
999"
REFERENCES,0.9388753056234719,"the linear algorithm in Section 4. We provide 2 different ways of doing so, with a couple of variations,
1000"
REFERENCES,0.9396903015484923,"all leading to the same correct result.
1001"
REFERENCES,0.9405052974735126,We have to restrict the sum in P
REFERENCES,0.941320293398533,"s′Ba
ss′Jss′ =π(a|s) to those s′ for which Ba
ss′ is defined. We then
1002"
REFERENCES,0.9421352893235534,"solve for Jss′, again for s′ for which Ba
ss′ is defined, and set Jss′ =0 for those s′ for which Ba
ss′ =⊥.
1003"
REFERENCES,0.9429502852485737,"Technically this can be achieved by removing the s′ columns from matrix B·
s· and J·· for which
1004"
REFERENCES,0.9437652811735942,"B·
ss′ =⊥, solve the reduced linear equation system, and finally reinsert Jss′ =0 for the removed s′.
1005"
REFERENCES,0.9445802770986145,"Simpler is to replace Ba
ss′ =⊥by Ba
ss′ =0, solve the equation for J, and then set Jss′ =0 for the s′
1006"
REFERENCES,0.9453952730236349,"for which the original Ba
ss′ was ⊥. Some solvers automatically result in Jss′ =0, since this is the
1007"
REFERENCES,0.9462102689486552,"minimum norm solution, but it is better not to reply on this. Instead of setting Jss′ =0 after solving
1008"
REFERENCES,0.9470252648736757,"the linear system, one could also augment B·
s· with extra rows that enforce Jss′ =0.
1009"
REFERENCES,0.947840260798696,"Alternatively, we could replace B·
ss′ =⊥by a random vector which sums to 1, e.g. Ba
ss′ =ra/r+,
1010"
REFERENCES,0.9486552567237164,"where ra=−logua with ua∼Uniform[0;1]. Provided that the solution is unique, this also leads to the
1011"
REFERENCES,0.9494702526487367,"correct solution (almost surely), and in this way Jss′ =0 automatically. If the solution is not unique,
1012"
REFERENCES,0.9502852485737572,"W · will still satisfy Ba =W a⊘W + when for Ba
ss′ ̸=⊥, but W ·
ss′ may not be 0.
1013"
REFERENCES,0.9511002444987775,"The adaptation of the Linear Relaxation Algorithm in Section 5 follows the same pattern: A··
ssisj =⊥
1014"
REFERENCES,0.9519152404237978,"in (12), whenever one of the three involved B’s is undefined. For such ssisj, we need to ensure that
1015"
REFERENCES,0.9527302363488183,"ˆUssisj =0, which can be done with any of the variations described above. Once we have ˆUssisj, we
1016"
REFERENCES,0.9535452322738386,"set Cai
ssisj =0 if Bai
sisj =⊥. No further intervention is needed, since ˆUssisj =0 already.
1017"
REFERENCES,0.954360228198859,"R
Solution Dimensions of W and Baa′.
1018"
REFERENCES,0.9551752241238793,"In Section 4 we presented an algorithm for inferring W and Baa′ from Ba. Even if M cannot
1019"
REFERENCES,0.9559902200488998,"uniquely be reconstructed ¬(i), Baa′ may still be unique (iii). More generally, the solutions J and
1020"
REFERENCES,0.9568052159739201,"W a form linear spaces of dimension dJ =dW ≤d(d−1) (dJ ≥dW since W · is a linear function of J
1021"
REFERENCES,0.9576202118989405,"and dJ ≤dW since W + =J). Baa′ is a (non-linear, polynomial) variety of dimension dB ≤dW at
1022"
REFERENCES,0.9584352078239609,"regular points (it is a smooth function of W).
1023"
REFERENCES,0.9592502037489813,"Parameterizing the solutions for J and W and B.
We can determine the solution dimensions
1024"
REFERENCES,0.9600651996740016,"dJ, dW , and dB as follows: Let Γss′ be a solution of [Ba⊙Γ]s+ = 0. If Jss′ is a solution of
1025"
REFERENCES,0.960880195599022,"[Ba⊙J]s+ =π(a|s), then so is ¯J :=J +Γ, hence W a :=M a+Λa is a solution of Ba =W a⊘W +
1026"
REFERENCES,0.9616951915240424,"and W a
s+ =π(a|s), where M a :=Ba⊙J and Λa :=Ba⊙Γ.
1027"
REFERENCES,0.9625101874490628,"If we plug in W a ≡M a+Λa into ¯Baa′ :=W aW a′ ⊘(MW+)2, we get the variety of ¯Baa′ parame-
1028"
REFERENCES,0.9633251833740831,"terized in terms Λa. If we expand this non-linear expression up to linear order in Λa, we get after
1029"
REFERENCES,0.9641401792991035,"some algebra
1030"
REFERENCES,0.9649551752241239,"Baa′ =[M aM a′ +M aΛa′+ΛaM a′ −(M aM a′)⊘(M +)2⊙(M +Λ++Λ+M +)]⊘(M +)2+O(Λ2)
(36)"
REFERENCES,0.9657701711491442,"The linear part forms a tangent direction on the ¯Baa′ variety at Baa′ :=M aM a′ ⊘(M +)2.
1031"
REFERENCES,0.9665851670741646,"Determining the solution dimensions for J and W and B.
Now, for each s, let Γr
ss′ for
1032"
REFERENCES,0.967400162999185,"r ∈{1:dJs} span all solutions of [Ba⊙Γ]s+ =0, which can easily be determined by SVD: dJs is
1033"
REFERENCES,0.9682151589242054,"the number zero singular values of matrix B·
s·:, and Γr
s· the corresponding singular vectors. Then,
1034"
REFERENCES,0.9690301548492257,¯Jss′ =Jss′ +P
REFERENCES,0.9698451507742462,"rΓr
ss′zsr for any z ∈RdJ with dJ =P"
REFERENCES,0.9706601466992665,"sdJs is a solution of [Ba⊙J]s+ =π(a|s).
1035"
REFERENCES,0.9714751426242869,"Similarly, W a
ss′ :=M a
ss′ +P"
REFERENCES,0.9722901385493072,"rΛar
ss′zsr with Λar :=Ba⊙Γr span all solutions consistent with Ba and
1036"
REFERENCES,0.9731051344743277,π. The solution dimension is dW =P
REFERENCES,0.973920130399348,"sdW s, where for each s, dW s is the rank of Λ··
s· if interpreted
1037"
REFERENCES,0.9747351263243684,"as a kd×dJs matrix in as′×r. dW s may be smaller than dJs, since unlike Γr
s·, Λ··
s· may not be full
1038"
REFERENCES,0.9755501222493888,"rank.
1039"
REFERENCES,0.9763651181744091,"If we plug Λa
ss′ =P"
REFERENCES,0.9771801140994295,"rΛar
ss′zsr into (36), after some index manipulation we get
1040"
REFERENCES,0.9779951100244498,"¯Baa′ = Baa′ + d
X t=1 dJt
X"
REFERENCES,0.9788101059494703,"r=1
Caa′rtztr⊘(M +)2⊘(M +)2 + O(z2) with"
REFERENCES,0.9796251018744906,"Caa′rt
ss′′
:= (M a
stΛa′r
ts′′ +[ΛarM a′]ss′′δts)[(M +)2]ss′′ −[M aM a′]ss′′(M +
stΛ+r
ts′′ +[Λ+rM +]ss′′δts)"
REFERENCES,0.980440097799511,"¯Baa′(z) is a local parametrization of B, and if we drop the +O(z2), it parameterizes its tangential
1041"
REFERENCES,0.9812550937245313,"hyperplane at Baa′. Its dimension dB is the rank of C interpreted as a k2d2×dJ matrix in aa′ss′′×rt.
1042"
REFERENCES,0.9820700896495518,"Again, dB may be smaller than dW , since C may not be full rank.
1043"
REFERENCES,0.9828850855745721,"Remarks.
For r∈{1:dJ}, the columns of matrix C span the tangential space of “rescaled” variety
1044"
REFERENCES,0.9837000814995925,"¯Baa′ at Baa′. Again, the columns may not be linearly independent. If [(M +)2]ss′′ = 0, then
1045"
REFERENCES,0.9845150774246129,"Baa′
ss′′ =⊥∀aa′, hence all such ss′′ should be ignored in Caa′r
ss′′ , but since the corresponding rows in
1046"
REFERENCES,0.9853300733496333,"C are 0, they don’t contribute to the rank anyway. Numerically, we need to regard all singular values
1047"
REFERENCES,0.9861450692746536,"below some threshold as 0. For (to numerical precision) exact B, the threshold can be fairly small
1048"
REFERENCES,0.986960065199674,"(10−13 in all our experiments). For approximate/learned B, the threshold needs to be of the order of
1049"
REFERENCES,0.9877750611246944,"the accuracy of B.
1050"
REFERENCES,0.9885900570497147,"Sampling estimate of dB.
A simpler, but less elegant, and more fragile method to estimate dB is
1051"
REFERENCES,0.9894050529747351,"as follows: Fix one solution J. Add random noise in direction of the null-space spanned by Γr so
1052"
REFERENCES,0.9902200488997555,"that it stays a solution, i.e. compute ¯J =J +P
rΓrz·r for random z, and from this, W and ¯Baa′ for
1053"
REFERENCES,0.9910350448247759,"many such random J. The resulting point cloud spans covers the solution variety ¯Baa′. Various tools
1054"
REFERENCES,0.9918500407497962,"could be used to analyze this point cloud, e.g. determine its dimension. If z is chosen small, the point
1055"
REFERENCES,0.9926650366748166,"cloud concentrates around Baa′ and forms a near-linear space, whose dimension dB can easily be
1056"
REFERENCES,0.993480032599837,"determined by PCA.
1057"
REFERENCES,0.9942950285248574,"Higher-order B and higher i.
In the same way we can derive the solution dimensions dB... for
1058"
REFERENCES,0.9951100244498777,"higher-order B.... Also, even though we don’t have (yet) an efficient algorithm for solving EqIM(i)
1059"
REFERENCES,0.9959250203748982,"for i > 1 if the solution is not unique, we still can determine the dimension of the solutions (at a
1060"
REFERENCES,0.9967400162999185,"particular point M). Algorithmically already covered is the case of W satisfying EqIM(1)∧EqIM(2),
1061"
REFERENCES,0.9975550122249389,"whose solution dimension turns out to be dW −dB. The general procedure is to plug W =M +Λ into
1062"
REFERENCES,0.9983700081499592,"and linearly expand EqIM(i) for i we to hold. Together they form a system of linear equations whose
1063"
REFERENCES,0.9991850040749797,"solution dimension can be determined by SVD as above.
1064"
