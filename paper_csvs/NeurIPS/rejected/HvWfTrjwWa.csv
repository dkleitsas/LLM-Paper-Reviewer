Section,Section Appearance Order,Paragraph
ABSTRACT,0.0,Abstract
ABSTRACT,0.0048543689320388345,"Estimating causal effects from observational data is a central problem in many
2
domains. A general approach is to balance covariates with weights such that the
3
distribution of the data mimics randomization. We present generalized balanc-
4
ing weights, Neural Balancing Weights (NBW), to estimate the causal effects of
5
an arbitrary mixture of discrete and continuous interventions. The weights were
6
obtained through direct estimation of the density ratio between the source and bal-
7
anced distributions by optimizing the variational representation of f-divergence.
8
For this, we selected Œ±-divergence as it presents efÔ¨Åcient optimization because
9
it has an estimator whose sample complexity is independent of its ground truth
10
value and unbiased mini-batch gradients; moreover, it is advantageous for the
11
vanishing-gradient problem. In addition, we provide the following two methods
12
for estimating the balancing weights: improving the generalization performance
13
of the balancing weights and checking the balance of the distribution changed by
14
the weights. Finally, we discuss the sample size requirements for the weights as
15
a general problem of a curse of dimensionality when balancing multidimensional
16
data. Our study provides a basic approach for estimating the balancing weights of
17
multidimensional data using variational f-divergences.
18"
INTRODUCTION,0.009708737864077669,"1
Introduction
19"
INTRODUCTION,0.014563106796116505,"Estimating causal effects from observational data is a central problem in many application domains,
20
including public health, social sciences, clinical pharmacology, and clinical decision-making. One
21
standard approach is balancing covariates with weights that are the same as the density ratios be-
22
tween the source and balanced distributions, such that their distribution mimics randomization.
23
Many methods have been developed to estimate the balancing weights, such as inverse propen-
24
sity weighting (IPW) Rosenbaum and Rubin [24], augmented inverse propensity weighting (AIPW)
25
[22], generalized propensity score (GPS) [10], covariate balancing propensity score (CBPS) [9],
26
overlap weighting [13], and entropy balancing (EB) [8, 30]. However, these methods are limited to
27
categorical or continuous interventions.
28"
INTRODUCTION,0.019417475728155338,"In this study, we propose generalized balancing weights to estimate the causal effects of an arbitrary
29
mixture of discrete and continuous interventions. To the best of our knowledge, no causal infer-
30
ence method focusing on the balancing weights exists for this problem. We approach this problem
31
by directly estimating the density ratio, more precisely, the Radon‚ÄìNikod√Ωm derivatives, between
32
the source and balanced distributions using a neural network algorithm by optimizing a variational
33
representation of a f-divergence. f-divergences, whose values are greater than or equal to zero and
34
considered zero if the two distributions are equal, are the statistics used to measure the closeness
35
of the two distributions. The optimal functions for the variational representations derived from f-
36
divergences with the Legendre transform correspond to the density ratio between the distributions
37"
INTRODUCTION,0.024271844660194174,"[16]. An approach to estimate the density ratio by optimizing a variational representation of a f-
38
divergence was developed in the domain adaptation region [29].
39"
INTRODUCTION,0.02912621359223301,"However, optimizing the f-divergences, including estimating the density ratio, is challenging. This
40
is due to the following reasons. First, for KL-divergence, the dominant f-divergence, the require-
41
ments for sample size increase exponentially with the true amount of the divergence [14, 28]. Sec-
42
ond, a naive gradient estimate over mini-batch samples leads to a biased estimate of the full gradient
43
[4]. Third, gradients of neural networks often vanish when the estimated probability ratios are close
44
to zero [2].
45"
INTRODUCTION,0.03398058252427184,"To avoid the Ô¨Årst problem, we focus on Œ±-divergence, which is a subgroup of f-divergence. Œ±-
46
divergence has an estimator whose sample complexity is independent of its ground truth value and
47
unbiased mini-batch gradients. In addition, by selecting Œ± from a particular interval, we avoid
48
vanishing gradients of neural networks when the neural networks reach extreme local minima.
49"
INTRODUCTION,0.038834951456310676,"In addition, we provide two techniques for estimating the balancing weights. First, we propose
50
a validation method using test data and an early stopping method to improve the generalization
51
performance of balancing. The generalization performance of the weights worsens as the dimensions
52
of the data increase, and the sample size requirements of the weights increase exponentially with the
53
dimensions. Next, we present a method for measuring the performance of balancing weights by
54
estimating the Œ±-divergence information to check the balance of the distribution,
55"
INTRODUCTION,0.043689320388349516,"This study is divided into seven parts. First, we introduce the background of the study. Second,
56
we review related studies. Third, we deÔ¨Åne the terminology and concepts for causal inferences.
57
Fourth, we present our novel method for estimating balancing weights. Fifth, we provide techniques
58
for estimating the weights. Sixth, we discuss the sample requirements for the weights. Finally, we
59
conclude this paper. All the numerical experiments and proofs are described in the appendix.
60"
RELATED WORK,0.04854368932038835,"2
Related Work
61"
RELATED WORK,0.05339805825242718,"Balancing weight: Balancing weight: Many methods have been proposed to estimate the balanc-
62
ing weights. The following methods are proposed for binary intervention: IPW [24], AIPW [22],
63
CBPS [9], and overlap weighting [13]. The following methods have been proposed for continu-
64
ous intervention: GPS [10] and EB [8, 30]. Statistical divergences and density ratio estimation:
65
Despite the abundance of classic studies [15, 29], we focused on studies that directly estimate den-
66
sity ratios or optimize statistical divergences using neural networks. In this review, these studies
67
have beenclassiÔ¨Åed into four groups. First is the estimation of KL-divergence or mutual information
68
[3, 18, 21]; the second is density ratio estimation [11]; the third is generative adversarial networks
69
(GANs) [17, 31, 6, 32] (statistical divergences were used as discriminators for GANs); and the
70
fourth is domain generation [27, 6, 35, 1]. In addition to these application studies, divergences were
71
improved [5].
72"
RELATED WORK,0.05825242718446602,"3
Terminologies and DeÔ¨Ånitions
73"
RELATED WORK,0.06310679611650485,"Here, we brieÔ¨Çy introduce the terminology and deÔ¨Ånitions used in this study.
74"
RELATED WORK,0.06796116504854369,"Notations and Terminologies.
Random variables are denoted by capital letters; for example, A.
75
Small letters are used for the values of random variables of the corresponding capital letters; a is
76
the value of the random variable A. Bold letters A or a represent a set of variables or random
77
variable values. In particular, V = {V1, . . . , Vn} are used for the observed random variables and
78
U = {U1, . . . , Um} are used as unobserved random variables. For example, the domain of the
79
variable A is denoted by XA, and XA1 √ó ¬∑ ¬∑ ¬∑ √ó XAn is denoted by XA for A = A1 √ó ¬∑ ¬∑ ¬∑ √ó An.
80
V ‚à™U are assumed to be semi-Markovian models and G = GVU denotes the causal graph for
81
V ‚à™U. Pa(A)G, Ch(A)G, An(A)G, and De(A)G represent parents, children, ancestors, and
82
descendants of the observed variables in G, respectively, for A ‚äÇV. In this study, Pa(A)G,
83
Ch(A)G, An(A)G, and De(A)G do not include A. P and Q are used as the probability measures
84
on (Rd, F), where F denotes the œÉ-algebra of subsets of Rd. EP [¬∑] and EP [¬∑|¬∑] denote expectation
85
and conditional expectation under the distribution P, respectively. For example, EP [X] =
R"
RELATED WORK,0.07281553398058252,"XX dP
86"
RELATED WORK,0.07766990291262135,"and EP [Y|X] =
R"
RELATED WORK,0.0825242718446602,"XY dP(Y|X).
ÀÜEP [¬∑] denotes the empirical expectation under P; that is, the
87"
RELATED WORK,0.08737864077669903,"sample mean of the Ô¨Ånite observations drawn from P. P is called absolute continuous with respect
88
to Q, P(A) = 0 whenever Q(A) = 0 for any A ‚ààF, which is represented as P ‚â™Q. dP"
RELATED WORK,0.09223300970873786,"dQ denotes
89
the Radon‚ÄìNikod√Ωm derivative of P with respect to Q for P and Q with P ‚â™Q. In this study,
90
we refer to density ratios as the Radon‚ÄìNikod√Ωm derivatives. ¬µ denotes a probability measure
91
on Rd with P ‚â™¬µ and Q ‚â™¬µ. X(N) = {X1, . . . , XN} denotes N i.i.d. random variables
92
from ¬µ. X(N)
P
= {X1
‚àºP , . . . , XN
‚àºP } and X(N)
Q
= {X1
‚àºQ, . . . , XN
‚àºQ} denote variables deÔ¨Åned as
93
P(Xi
‚àºP ‚â§x) = ¬µ(Xi ‚â§x) and Q(Xi
‚àºQ ‚â§x) = ¬µ(Xi ‚â§x), ‚àÄx ‚ààRd, for 1 ‚â§i ‚â§N. We
94
represent f ‚â≤g when lim supn‚Üí‚àûf(n)/g(n) < ‚àûholds. The notation f ‚â≥g is deÔ¨Åned similarly.
95"
RELATED WORK,0.0970873786407767,"3.1
DeÔ¨Ånitions
96"
RELATED WORK,0.10194174757281553,"In this study, we considered the causal effects of joint and multidimensional interventions. For
97
clarity, we used different notations,‚Äú do ‚Äùand‚Äú do, ‚Äùfor single-dimensional and multidimensional
98
interventions, respectively. 1 For a single-dimensional intervention, a do symbol is used, which is
99
the same as Pearl‚Äôs do-calculation.
100
DeÔ¨Ånition 3.1 (do-calculation, Pearl(2009)). For the two given disjoint sets of X, Y ‚äÇV, the
101
causal effect on Y for intervention in X with values x, denoted by P(Y|do(X = x)), is deÔ¨Åned as
102
the probability distribution, such that
103"
RELATED WORK,0.10679611650485436,"P(Y|do(X = x)) =
X"
RELATED WORK,0.11165048543689321,"v‚Ä≤‚ààXV‚Ä≤
pax‚ààXP a(X)G"
RELATED WORK,0.11650485436893204,"P(Y, X = x, Pa(X)G = pax, V‚Ä≤ = v‚Ä≤)"
RELATED WORK,0.12135922330097088,"P(X = x|Pa(X)G = pax)
,
(1)"
RELATED WORK,0.1262135922330097,"where V‚Ä≤ = V \ (X ‚à™Pa(X)G ‚à™Y). The causal effect of X on Y under the conditions Z denoted
104
by P(Y = y|do(X = x), Z = z) is deÔ¨Åned as the probability distribution, such that
105"
RELATED WORK,0.13106796116504854,"P(Y = y|do(X = x), Z) = P(Y = y, Z|do(X = x))"
RELATED WORK,0.13592233009708737,"P(Z|do(X = x))
.
(2)"
RELATED WORK,0.1407766990291262,"Notably, from DeÔ¨Ånition 3.1, a do-calculation for a set of variables coincides with the simultaneous
106
interventions for each variable:
107"
RELATED WORK,0.14563106796116504,"P(Y|do(X)) = P(Y|do(X1), do(X2), . . . , do(Xn)),
(3)"
RELATED WORK,0.15048543689320387,"where X = {X1, X2, . . . , Xn}. Here, we refer to each intervention in (3) as a‚Äú single-dimensional
108
intervention ‚Äù.
109"
RELATED WORK,0.1553398058252427,"Furthermore, we use the do symbol for multidimensional intervention. Intuitively, a do symbol
110
represents the intervention of the variables that preserves the functional relationship within the vari-
111
ables.
112
DeÔ¨Ånition 3.2 (do symbol). do symbol deÔ¨Ånes the following probability distribution:
113"
RELATED WORK,0.16019417475728157,"P(Y|do(X1), do(X2), . . . , do(Xn)) = P(Y|do(X)) √ó P(X1) √ó P(X2) √ó ¬∑ ¬∑ ¬∑ √ó P(Xn),
(4)"
RELATED WORK,0.1650485436893204,"where X = X1 ‚à™X2 ‚à™¬∑ ¬∑ ¬∑ ‚à™Xn.
114"
RELATED WORK,0.16990291262135923,"do symbols are useful, particularly when we consider interventions in a multivalued discrete variable
115
expressed using one-hot encoding. In this case, we cannot express the causal effect effectively using
116
do symbols. For example, let us consider the case of an intervention in the ternary variable X, XX =
117
{x1, x2, x3} and let X be expressed by X‚Ä≤ = (X‚Ä≤
1, X‚Ä≤
2, X‚Ä≤
3), such that X‚Ä≤
i = 1 if X = xi otherwise
118
X‚Ä≤
i = 0 for i = 1, 2, 3. Then, P(¬∑|do(X = x3)) is the same as P(¬∑|do(X‚Ä≤ = (0, 0, 1))), which
119
differs from P(¬∑|do(X‚Ä≤ = (0, 0, 1))). We refer to this type of intervention as a‚Äú multidimensional
120
intervention ‚Äù.
121"
RELATED WORK,0.17475728155339806,"Next, we provide deÔ¨Ånitions of the f-divergence and f-divergence information.
122
DeÔ¨Ånition 3.3 (f-divergence). The f-divergence Df between the two probability measures P and
123
Q with Q ‚â™P induced by a convex function f satisfying f(1) = 0 is deÔ¨Åned by Df(Q||P) =
124
EP [f(dQ/dP)].
125"
THE VALUES OF THE VARIABLES IN THE PARENTHESES FOR BOTH SYMBOLS CAN BE DROPPED IF NOT NECESSARY IN THE,0.1796116504854369,"1The values of the variables in the parentheses for both symbols can be dropped if not necessary in the
context. For example, we sometimes represent do(X = x) or do(X = x) as do(X) or do(X), respectively."
THE VALUES OF THE VARIABLES IN THE PARENTHESES FOR BOTH SYMBOLS CAN BE DROPPED IF NOT NECESSARY IN THE,0.18446601941747573,"Many divergences are speciÔ¨Åc cases obtained by selecting a suitable generator function f. For
126
example, f(u) = u log u corresponds to the KL-divergence. In particular, we focus on Œ±-divergence,
127
which is expressed as follows:
128"
THE VALUES OF THE VARIABLES IN THE PARENTHESES FOR BOTH SYMBOLS CAN BE DROPPED IF NOT NECESSARY IN THE,0.18932038834951456,DŒ±(Q||P) = EP
THE VALUES OF THE VARIABLES IN THE PARENTHESES FOR BOTH SYMBOLS CAN BE DROPPED IF NOT NECESSARY IN THE,0.1941747572815534,"""
1
Œ±(Œ± ‚àí1) (dQ dP"
THE VALUES OF THE VARIABLES IN THE PARENTHESES FOR BOTH SYMBOLS CAN BE DROPPED IF NOT NECESSARY IN THE,0.19902912621359223,"1‚àíŒ±
‚àí1 )# ,
(5)"
THE VALUES OF THE VARIABLES IN THE PARENTHESES FOR BOTH SYMBOLS CAN BE DROPPED IF NOT NECESSARY IN THE,0.20388349514563106,"where Œ± ‚ààR \ {0, 1}. From (5), Hellinger divergence is obtained as Œ± = 1/2, and œá2 divergence
129
by Œ± = ‚àí1.
130"
THE VALUES OF THE VARIABLES IN THE PARENTHESES FOR BOTH SYMBOLS CAN BE DROPPED IF NOT NECESSARY IN THE,0.2087378640776699,"From f-divergence, the f-divergence information is deÔ¨Åned as the mutual information if we choose
131
the KL-divergence as the f-divergence. Here, we present a deÔ¨Ånition of f-divergence information
132
for multi-variables.
133
DeÔ¨Ånition 3.4 (f-divergence information). For disjoint variables X = {X1, X2, . . . , Xn} ‚äÇV, let
134
PX be the joint probability measure for X. For each i = 1, 2, . . . , n, PXi =
R"
THE VALUES OF THE VARIABLES IN THE PARENTHESES FOR BOTH SYMBOLS CAN BE DROPPED IF NOT NECESSARY IN THE,0.21359223300970873,"XX\Xi dPX is a mea-
135
sure of the marginal distribution of PX for Xi. The f-divergence information for X1, X2, . . . , Xn
136
under PX and a convex function f satisfying f(1) = 0 is deÔ¨Åned as the f-divergence between PX
137
and PX1 √ó PX2 √ó ¬∑ ¬∑ ¬∑ √ó PXn:
138"
THE VALUES OF THE VARIABLES IN THE PARENTHESES FOR BOTH SYMBOLS CAN BE DROPPED IF NOT NECESSARY IN THE,0.21844660194174756,"If(X1, X2, . . . , Xn; PX)
=
EPX"
THE VALUES OF THE VARIABLES IN THE PARENTHESES FOR BOTH SYMBOLS CAN BE DROPPED IF NOT NECESSARY IN THE,0.22330097087378642,"
f
dPX1 √ó dPX2 √ó ¬∑ ¬∑ ¬∑ √ó dPXn dPX"
THE VALUES OF THE VARIABLES IN THE PARENTHESES FOR BOTH SYMBOLS CAN BE DROPPED IF NOT NECESSARY IN THE,0.22815533980582525,"
.
(6)"
PROBLEM SET UP,0.23300970873786409,"4
Problem Set Up
139"
PROBLEM SET UP,0.23786407766990292,"Before describing the details of the problem, we provide a notation for the probability distribution,
140
which is the goal of balancing. Hereafter, P denotes the probability distribution of observational
141
data. For the given disjoint sets X1, X2, . . . , Xn, Y, Z ‚äÇV, let eP be a probability distribution, as
142
follows:
143
eP
=
P(Y|do(X1), do(X2), . . . , do(Xn), Z) √ó P(Z)
=
P(Y|do(X), Z) √ó P(X1) √ó P(X2) √ó ¬∑ ¬∑ ¬∑ √ó P(Xn) √ó P(Z),
(7)"
PROBLEM SET UP,0.24271844660194175,"where X = X1 ‚à™X2 ‚à™¬∑ ¬∑ ¬∑ ‚à™Xn. eP is the probability distribution of the counterfactual data from
144
simultaneous (multidimensional) interventions in X1, X2, . . . , Xn under the condition Z.
145"
PROBLEM SET UP,0.24757281553398058,"Objective.
The objective of this study is to obtain the balancing weights that transform
146
P(Y, X, Z) into eP(Y, X, Z). More precisely, given the i.i.d. observational data {(xi, zi)|i =
147
1, 2, . . . , N}, we aim to estimate the weights BW (X, Z), such that
148"
PROBLEM SET UP,0.2524271844660194,"E e
P [f(X, Z)] = EP [f(X, Z) ¬∑ BW (X, Z)]
(8)"
PROBLEM SET UP,0.25728155339805825,"holds for any measurable function f on Rd. If we obtain the weights, we estimate the conditional av-
149
erage causal effect (CACE) for P(Y|do(X1), do(X2), . . . , do(Xn), Z), that is E e
P [Y|X, Z], using
150
state-of-the-art supervised machine learning algorithms, with the weights assigned as the individual
151
weights for each sample.
152"
PROBLEM SET UP,0.2621359223300971,"Assumptions.
We assumed the following to achieve our objective:
153"
PROBLEM SET UP,0.2669902912621359,"‚Ä¢ Assumption 1. The causal effect P(Y|do(X)) is identiÔ¨Åable, or equivalently, eP from (7)
154
can be identiÔ¨Åed. 2 3
155
‚Ä¢ Assumption 2. Let P = P(X1, X2, . . . , Xn, Z) and let Q = P(X1) √ó P(X2) √ó ¬∑ ¬∑ ¬∑ √ó
156
P(Xn) √ó P(Z). Subsequently, we assume that Q ‚â™P.
157"
PROBLEM SET UP,0.27184466019417475,"Assumption 2 is the same as the overlap assumption if we consider this a single-dimensional inter-
158
vention. Here, we propose overlapped assumptions for joint and multidimensional interventions.
159"
PROBLEM SET UP,0.2766990291262136,"2The simplest case that satisÔ¨Åes Assumption 1 is that no confounding exists among the data ([20], P78,
Theorem 3.2.5).
3If certain unobserved data are assumed to exist, the identiÔ¨Åability of the causal effect is determined by the
structure of the causal diagram for P. One criterion for the identiÔ¨Åability of a causal effect is expressed by [26].
The discussion of the identiÔ¨Åability of the causal effect is beyond the scope of this study."
ESTIMATION OF BALANCING WEIGHTS,0.2815533980582524,"5
Estimation of Balancing Weights
160"
ESTIMATION OF BALANCING WEIGHTS,0.28640776699029125,"In this section, we present the way to effectively estimate the probability density ratios by optimizing
161
f-divergence.
162"
ESTIMATION OF BALANCING WEIGHTS,0.2912621359223301,"Density Ratios as Balancing Weights.
We Ô¨Årst note that the density ratios, which are referred to
163
as the Radon‚ÄìNikod√Ωm derivative in this paper, are equal to the balancing weight of the target. For
164
a density ratio of P to eP, that is d e
P
dP , it holds that
165"
ESTIMATION OF BALANCING WEIGHTS,0.2961165048543689,"E e
P [f] =
Z
f ¬∑ d eP"
ESTIMATION OF BALANCING WEIGHTS,0.30097087378640774,"dP ¬∑ dP = EP """
ESTIMATION OF BALANCING WEIGHTS,0.3058252427184466,"f ¬∑ d eP dP # ,
(9)"
ESTIMATION OF BALANCING WEIGHTS,0.3106796116504854,"for any measurable function f in Rd. Then, (8) and (9) are equivalent. As an example of the
166
aforementioned density ratio, let X be a binary variable with XX = {1, 0} and let Z be covariates.
167
Using propensity score e(z) = P(X = 1|Z = z), we observe that d e
P
dP (X = 1, z) = P(X =
168"
ESTIMATION OF BALANCING WEIGHTS,0.3155339805825243,"1)/e(z) and d e
P
dP (X = 0, z) = P(X = 0)/(1‚àíe(z)). That is, d e
P
dP is the stabilized inverse probability
169
of the treatment weighting [23].
170"
OUR APPROACH,0.32038834951456313,"5.1
Our Approach
171"
OUR APPROACH,0.32524271844660196,"Our approach involves obtaining the density ratios as an optimal function for a variational represen-
172
tation of an f-divergence. This approach is based on the fact that the optimal function is connected
173
to density ratios [15].
174"
OUR APPROACH,0.3300970873786408,"Variational representation.
Using the Legendre transform of the convex conjugate of a twice dif-
175
ferentiable convex function f, f ‚àó(œà) = supr‚ààR{œà¬∑r‚àíf(r)}, we obtain a variational representation
176
of f-divergence:
177
Df(Q||P) = sup
œÜ‚â•0
{EQ[f ‚Ä≤(œÜ)] ‚àíEP [f ‚àó(f ‚Ä≤(œÜ))]},
(10)"
OUR APPROACH,0.33495145631067963,"where supremum is considered over all measurable functions with EQ[f ‚Ä≤(œÜ)]
<
‚àûand
178
EP [f ‚àó(f ‚Ä≤(œÜ))] < ‚àû. The maximum value is achieved at œÜ = dQ/dP.
179"
OUR APPROACH,0.33980582524271846,"We obtained the optimal function for (10) by replacing œÜ in the equation with a neural network
180
model œÜŒ∏ and training it through back-propagation with a loss function, such that
181"
OUR APPROACH,0.3446601941747573,"L(Œ∏) = ‚àí
n
ÀÜEQ[f ‚Ä≤(œÜŒ∏)] ‚àíÀÜEP [f ‚àó(f ‚Ä≤(œÜŒ∏))]
o
.
(11)"
OUR APPROACH,0.34951456310679613,"Selecting Œ±-divergence for Optimization.
We select Œ±-divergence for the following reasons.
182
First, the sample size requirements for Œ±-divergence is independent of its ground truth value: second,
183
it has unbiased mini-batch gradients; third, it can avoid a vanishing gradient problem.
184"
OUR APPROACH,0.35436893203883496,"The variational representation of Œ±-divergence is as follows (Lemma C.1 in Appendix C):
185"
OUR APPROACH,0.3592233009708738,"DŒ±(Q||P) = sup
œÜ‚â•0"
OUR APPROACH,0.3640776699029126,"
1
Œ±(1 ‚àíŒ±) ‚àí1"
OUR APPROACH,0.36893203883495146,"Œ±EQ

œÜ‚àíŒ±
‚àí
1
1 ‚àíŒ±EP

œÜ1‚àíŒ±
.
(12)"
OUR APPROACH,0.3737864077669903,"Sample size requirements for Œ±-divergence.
The Œ±-divergence has an estimator with sample
186
complexity O(1) (Corollary 1 in Birrell et al., 2022, P19; Corollary C.10 in Appendix C). Con-
187
versely, the sample complexity of KL-divergence is O(eKL(Q||P )) [14, 28]:
188"
OUR APPROACH,0.3786407766990291,"lim
N‚Üí‚àû"
OUR APPROACH,0.38349514563106796,"N ¬∑ Var
h
\
KLN(Q||P)
i"
OUR APPROACH,0.3883495145631068,"KL(Q||P)2
‚â•eKL(Q||P ) ‚àí1"
OUR APPROACH,0.3932038834951456,"KL(Q||P)2 ,
(13)"
OUR APPROACH,0.39805825242718446,"where \
KLN(Q||P) is the KL-divergence estimator for sample size N using a variational represen-
189
tation of the divergence, and KL(Q||P) is the ground truth value.
190"
OUR APPROACH,0.4029126213592233,"Unbiasedness for mini-batch gradients.
œÜ in (12) can be expressed in a Gibbs density form
191
(Proposition C.2 in Appendix C). Then, we observe that
192"
OUR APPROACH,0.4077669902912621,"DŒ±(Q||P) = sup
T"
OUR APPROACH,0.41262135922330095,"
1
Œ±(1 ‚àíŒ±) ‚àí1"
OUR APPROACH,0.4174757281553398,"Œ±EQ

eŒ±¬∑T 
‚àí
1
1 ‚àíŒ±EP
h
e(Œ±‚àí1)¬∑T i
,
(14)"
OUR APPROACH,0.4223300970873786,"where supremum is considered over all measurable functions T : Rd ‚ÜíR with EP [e(Œ±‚àí1)¬∑T ] < ‚àû
193
and EQ[eŒ±¬∑T ] < ‚àû.
194"
OUR APPROACH,0.42718446601941745,"From this equation, we obtain our loss function, which has unbiasedness for mini-batch gradients
195
(Proposition C.8 in Appendix C), as follows :
196"
OUR APPROACH,0.4320388349514563,LŒ±(Œ∏) = 1
OUR APPROACH,0.4368932038834951,"Œ±
ÀÜEQ

eŒ±¬∑TŒ∏
+
1
1 ‚àíŒ±
ÀÜEP
h
e(Œ±‚àí1)¬∑TŒ∏
i
.
(15)"
OUR APPROACH,0.441747572815534,"Advantage in vanishing gradients problem.
By setting Œ± within (0, 1), we can avoid vanishing
197
gradients of neural networks when they reach the extreme local minima. The vanishing-gradient
198
problem for optimizing divergence is known in GANs [2]. Now, we consider the case where the
199
probability ratio eTŒ∏(x) in (15) is nearly zero or large for some point x, corresponding to cases in
200
which the probabilities for P or Q at some points are much smaller than those for the other.
201"
OUR APPROACH,0.44660194174757284,"To show the relation between eTŒ∏(x) and the learning of the neural networks, we obtain gradient of
202
(15):
203
‚àáŒ∏LŒ±(Œ∏) = ÀÜEQ
h
‚àáŒ∏TŒ∏ ¬∑ eŒ±¬∑TŒ∏
i
‚àíÀÜEP
h
‚àáŒ∏TŒ∏ ¬∑ e(Œ±‚àí1)¬∑TŒ∏
i
.
(16)"
OUR APPROACH,0.45145631067961167,"The behavior of ‚àáŒ∏LŒ±(Œ∏) when EQ[eTŒ∏] ‚Üí0 or EQ[eTŒ∏] ‚Üí‚àû, under some regular conditions for
204
TŒ∏ and an assumption that P ‚â™Q, can be summarized as follows: Let E[ ¬∑ ] denote EP [EQ[ ¬∑ ]],
205
then
206"
OUR APPROACH,0.4563106796116505,"Œ± > 1:
E[‚àáŒ∏LŒ±(Œ∏)] ‚Üí‚Éó0 (as EQ[eTŒ∏] ‚Üí0), and E[‚àáŒ∏LŒ±(Œ∏)] ‚Üí‚Éó‚àû‚àí‚Éó‚àû(as EQ[eTŒ∏] ‚Üí‚àû).
207"
OUR APPROACH,0.46116504854368934,"Œ± < 0:
E[‚àáŒ∏LŒ±(Œ∏)] ‚Üí‚Éó0 (as EQ[eTŒ∏] ‚Üí‚àû), and E[‚àáŒ∏LŒ±(Œ∏)] ‚Üí‚Éó‚àû‚àí‚Éó‚àû(as EQ[eTŒ∏] ‚Üí0).
208"
OUR APPROACH,0.46601941747572817,"0 < Œ± < 1: E[‚àáŒ∏LŒ±(Œ∏)] ‚Üí‚àí‚Éó‚àû(as EQ[eTŒ∏] ‚Üí0), and E[‚àáŒ∏LŒ±(Œ∏)] ‚Üí‚Éó‚àû(as EQ[eTŒ∏] ‚Üí‚àû).
209"
OUR APPROACH,0.470873786407767,"Notably, EQ[eTŒ∏] ‚Üí0 ‚áîEP [eTŒ∏] ‚Üí0 EQ[eTŒ∏] ‚Üí‚àû‚áîEP [eTŒ∏] ‚Üí‚àû, because Q ‚â™P and
210
P ‚â™Q.
211"
OUR APPROACH,0.47572815533980584,"For Œ± > 1 and Œ± < 0, cases exist where E[‚àáŒ∏LŒ±(Œ∏)] ‚Üí‚Éó0. This implies the possibility that the
212
neural networks reach extreme local minima such that their estimations for density ratios are 0 or ‚àû.
213
However, this problem can be avoided by selecting Œ± from interval (0, 1). We note that the selecting
214
of Œ± does not cause instability in numerical calculations for cases where E[‚àáŒ∏LŒ±(Œ∏)] ‚Üí‚Éó‚àû‚àí‚Éó‚àû.
215
In Appendix D.1, we present numerical experimental results for different values of Œ±.
216"
METHOD,0.48058252427184467,"6
Method
217"
METHOD,0.4854368932038835,"In this section, we Ô¨Årst present the main theorem that summarizes the new balancing weight method
218
proposed herein. Next, we present the balancing weight method.
219"
MAIN THEOREM,0.49029126213592233,"6.1
Main Theorem
220"
MAIN THEOREM,0.49514563106796117,"Here, we present the main theorem that summarizes the new balancing weight method proposed
221
herein.
222
Theorem 6.1. Given disjoint sets of X = {X1, X2, . . . , Xn}, Y, Z ‚äÇV satisfying
223
X = {X1, X2, . . . , Xn} ‚äÇAn(Y)G
and
Z ‚à©De(Y)G = œÜ.
(17)"
MAIN THEOREM,0.5,"Let P = P(X1, X2, . . . , Xn, Z) and Q = P(X1) √ó P(X2) √ó ¬∑ ¬∑ ¬∑ √ó P(Xn) √ó P(Z), and eP =
224
P(Y|do(X), Z)√óP(X1)√óP(X2)√ó¬∑ ¬∑ ¬∑√óP(Xn)√óP(Z). We assume that P satisÔ¨Åes Assumptions 1
225"
MAIN THEOREM,0.5048543689320388,"and 2 in the aforementioned setting, and it holds that EP
h
(dQ/dP)1‚àíŒ±i
< ‚àûfor some 0 < Œ± < 1,
226
then, for the optimal function T ‚àó, such that
227"
MAIN THEOREM,0.5097087378640777,"T ‚àó(X1, X2, . . . , Xn, Z) = arg inf
T ‚ààT Œ±  1"
MAIN THEOREM,0.5145631067961165,"Œ±EQ

eŒ±¬∑T 
+
1
1 ‚àíŒ±EP
h
e(Œ±‚àí1)¬∑T i
,
(18)"
MAIN THEOREM,0.5194174757281553,Algorithm 1 Training a Neural Balancing Weight model
MAIN THEOREM,0.5242718446601942,"Input: Train Data (x1, {(xi
1, . . . , xi
n, zi)}N
i=1
Output: A Neural Balancing Weight Model
TŒ∏K
œÉx
1 ‚ÜêSHUFFLE({1 : N})
...
œÉx
n ‚ÜêSHUFFLE({1 : N})
œÉz ‚ÜêSHUFFLE({1 : N})"
MAIN THEOREM,0.529126213592233,"for t = 1 to K do
ÀÜEP ‚Üê1"
MAIN THEOREM,0.5339805825242718,"N Œ£N
i=1e(Œ±‚àí1)¬∑TŒ∏t(xi
1,...,xi
n,zi)"
MAIN THEOREM,0.5388349514563107,ÀÜEQ ‚Üê1
MAIN THEOREM,0.5436893203883495,"N Œ£N
i=1eŒ±¬∑TŒ∏t(x
œÉx
1 (i)
1
,...,x
œÉx
n(i)
n
,zœÉz(i))"
MAIN THEOREM,0.5485436893203883,"LŒ±(Œ∏t) ‚ÜêÀÜEQ/Œ± + ÀÜEP/(1 ‚àíŒ±)
Œ∏t+1 ‚ÜêŒ∏t ‚àí‚àáŒ∏tLŒ±(Œ∏t)
end for"
MAIN THEOREM,0.5533980582524272,"it holds that
228
d eP
dP = e‚àíT ‚àó(X1,X2,...,Xn,Z).
(19)"
MAIN THEOREM,0.558252427184466,"Here, T Œ± denotes the set of all non-constant functions T(x) : Rd ‚ÜíR with EP[e(Œ±‚àí1)¬∑T (X)] < ‚àû.
229"
MAIN THEOREM,0.5631067961165048,"Proof. See Appendix C.
230"
MAIN THEOREM,0.5679611650485437,"Here, we mention that the assumption (17) is necessary for the (19) to hold, which is derived from
231
our Theorem C.15 in Appendix C.
232"
BALANCING WEIGHT METHOD,0.5728155339805825,"6.2
Balancing Weight Method
233"
BALANCING WEIGHT METHOD,0.5776699029126213,"We present the implementation of training a neural balancing weights (NBW) model in Algorithm
234
1. It is important to consider the stopping time K for neural network model TŒ∏K in Algorithm 1,
235
which is discussed in the next section. To obtain the sample mean under Q, that is, the estimator
236
for EQ

eŒ±¬∑TŒ∏
in (18), a shufÔ¨Çing operation can be used for the samples. Now, we deÔ¨Åne neural
237
balancing weights (NBW). 4 5
238"
BALANCING WEIGHT METHOD,0.5825242718446602,"DeÔ¨Ånition 6.2 (Neural Balancing Weights). Let TŒ∏K be a neural networks obtained from Algorithm
239
1. Then, the NBW of TŒ∏K, expressed as BW (X1, X2, . . . , Xn, Z; TŒ∏K), are deÔ¨Åned as
240"
BALANCING WEIGHT METHOD,0.587378640776699,"BW (X1, X2, . . . , Xn, Z; TŒ∏K) = 1"
BALANCING WEIGHT METHOD,0.5922330097087378,"Z e‚àíTŒ∏K (X1,X2,...,Xn,Z),
(20)"
BALANCING WEIGHT METHOD,0.5970873786407767,"where Z = ÀÜEP

e‚àíTŒ∏K (X1,X2,...,Xn,Z)
.
241"
BALANCING WEIGHT METHOD,0.6019417475728155,"We estimate E e
P [Y|X, Z], that is the CACE for P(Y|do(X1), do(X2), . . . , do(Xn), Z), using
242
BW (X1, X2, . . . , Xn, Z; TŒ∏K) as the sample weights of the supervised algorithm:
243"
BALANCING WEIGHT METHOD,0.6067961165048543,"bE e
P [Y|X, Z] = bEP [Y ¬∑ BW Œ∏K | X, Z] .
(21)"
BALANCING WEIGHT METHOD,0.6116504854368932,"Here, bEP corresponds to the model of a supervised machine learning algorithm. As an example,
244
we demonstrate a back-propagation algorithm using balancing weights for the mean squared error
245
(MSE) loss in Algorithm 3 in Appendix E.
246"
TECHNIQUES FOR NBW,0.616504854368932,"7
Techniques for NBW
247"
TECHNIQUES FOR NBW,0.6213592233009708,"We propose two techniques for estimating balancing weights: (i) improves generalization perfor-
248
mance of the balancing weights. (ii) measures the performance of the balancing weights by estimat-
249
ing the Œ±-divergence information.
250"
TECHNIQUES FOR NBW,0.6262135922330098,"4We distinguish the notation of BW (¬∑) by the expression of the variables in the parentheses. For example,
for disjoint variables X1, X2, X3 ‚äÇV, let X = {X1, X2}. Then, BW (X, X3; TŒ∏) is used to indicate the
balancing weights for dP(X1, X2) √ó dP(X3)/dP(X1, X2, X3). Conversely, BW (X1, X2, X3; TŒ∏) denotes
the balancing weights for dP(X1) √ó dP(X2) √ó dP(X3)/dP(X1, X2, X3).
5However, we drop the variables in the parentheses and write BW (X1, X2, . . . , Xn, Z; TŒ∏) as BW Œ∏ if not
necessary in the context."
IMPROVING THE GENERALIZATION PERFORMANCE OF THE BALANCING WEIGHTS,0.6310679611650486,"7.1
Improving the Generalization Performance of the Balancing Weights
251"
IMPROVING THE GENERALIZATION PERFORMANCE OF THE BALANCING WEIGHTS,0.6359223300970874,"In this section, we Ô¨Årst present an overÔ¨Åtting problem for balancing distributions. We then present
252
two methods for improving the generalization performance of the weights: a validation method using
253
test data and an early stopping method. Herein, let TŒ∏t denote an NBW model at step t in Algorithm
254
1. Let ÀÜX(N)
Q (t) = e‚àíTŒ∏t ¬∑ X(N)
P
, that is, the data balanced by the weights of e‚àíTŒ∏t. Subsequently,
255"
IMPROVING THE GENERALIZATION PERFORMANCE OF THE BALANCING WEIGHTS,0.6407766990291263,"let ÀÜQ(N)
t
and ÀÜQ(N) denote the probability distributions of ÀÜX(N)
Q (t) and ÀÜX(N)
Q , respectively, which
256
correspond to the estimated and true distributions for balancing.
257"
IMPROVING THE GENERALIZATION PERFORMANCE OF THE BALANCING WEIGHTS,0.6456310679611651,"An overÔ¨Åtting problem for balancing distributions.
From Corollary C.12 in Appendix C, we
258
observe ÀÜX(N)
Q (t)
d
‚àí‚àí‚ÜíX(N)
Q
as t ‚Üí‚àû. Then, Theorem 1 in [33] shows that
259"
IMPROVING THE GENERALIZATION PERFORMANCE OF THE BALANCING WEIGHTS,0.6504854368932039,"lim
t‚Üí‚àûW1(Q, ÀÜQ(N)
t
) = W1(Q, ÀÜQ(N)) ‚â≥N ‚àí1/(d‚àíŒ¥)
( ‚àÄŒ¥ > 0 ),
(22)"
IMPROVING THE GENERALIZATION PERFORMANCE OF THE BALANCING WEIGHTS,0.6553398058252428,"where W1 is the Wasserstein distance of order 1 and d is the lower Wasserstein dimension deÔ¨Åned
260
in [33]. (22) implies that, for balancing Ô¨Ånite data, the destination of the balanced distribution is
261
an empirical distribution, and the generalization performance of balancing worsens exponentially
262
when the dimension of the data is larger. In view of optimizations of GANs, [34] referred to this
263
phenomenon the‚Äú momorization ‚Äùand proposed an early stopping method.
264"
IMPROVING THE GENERALIZATION PERFORMANCE OF THE BALANCING WEIGHTS,0.6601941747572816,"Validation method using test data.
We can use a validation method using test data. Because ÀÜQ(N)
265
and ÀÜP (N) are empirical probability distributions, we observe that d ÀÜQ(N)/d ÀÜP (N)(x) = dQ/dP(x)
266
if x ‚ààX(N), otherwise d ÀÜQ(N)/d ÀÜP (N)(x) = 0 (Proposition C.17 in Appendix C). Then, the optimal
267
function of (15) for both distributions, that is T (N)
‚àó
= ‚àílog(d ÀÜQ(N)/d ÀÜP (N)), is inÔ¨Ånite except for
268
the observations, and the loss of the T (N)
‚àó
is inÔ¨Ånite for data independent of the observations. This
269
implies that the loss of T (N)
t
for the test data turns to increase from the middle of the training period,
270
and we can determine the training step at which the generalization performance of the weights begins
271
to worsen. In Section D.2 in Appendix D, we provide numerical experimental results to conÔ¨Årm the
272
relationship between dimensions of data (d) and steps in training (K).
273"
IMPROVING THE GENERALIZATION PERFORMANCE OF THE BALANCING WEIGHTS,0.6650485436893204,"Early stopping method.
In addition, we present an early stopping method for estimating the bal-
274
ancing weights as follows, which is inspired by the method developed in [34] (Corollary C.24 in
275
Appendix C): for some Œ¥ > 0, let
276
K0 = C ¬∑ N 2/(d+Œ¥),
(23)"
IMPROVING THE GENERALIZATION PERFORMANCE OF THE BALANCING WEIGHTS,0.6699029126213593,"where C > 0 is constant. Then, we have W1(Q, ÀÜQ(N)
K0 ) ‚â≤N ‚àí1/(d+Œ¥). Unfortunately, the curse of
277
dimensionality remains in the proposed method. This will be discussed in the next section.
278"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.6747572815533981,"7.2
Measuring the Performance of the Balancing Weights
279"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.6796116504854369,"Let us assume that we obtain an NBW model TŒ∏0 and let BW Œ∏0 = BW (X1, X2, . . . , Xn, Z; TŒ∏0)
280
be the balancing weights of TŒ∏0. If BW Œ∏0 successfully estimates dQ"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.6844660194174758,"dP , then the Œ±-divergence between
281
Q and P0 will be nearly zero. Conversely, if BW Œ∏0 fails to estimate dQ"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.6893203883495146,"dP , the Œ±-divergence between
282
Q and P0 is signiÔ¨Åcantly different from zero. This implies that we can measure the performance of
283
the balancing weights using the Œ±-divergence information for P0.
284"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.6941747572815534,"Next, we present the deÔ¨Ånition of an Œ±-divergence information estimator using neural networks.
285"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.6990291262135923,"DeÔ¨Ånition 7.1 (Neural Œ±-divergence Information Estimator). For disjoint variables X1, X2, . . . ,
286
Xn ‚äÇV, the neural Œ±-divergence information estimator for P is deÔ¨Åned as
287"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7038834951456311,"bIŒ±(X1, X2, . . . , Xn; TŒ∏‚àó) =
1
Œ±(1 ‚àíŒ±) ‚àíinf
Œ∏‚ààŒò  1"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7087378640776699,"Œ±
ÀÜEQ

eŒ±¬∑TŒ∏
+
1
1 ‚àíŒ±
ÀÜEP
h
e(Œ±‚àí1)¬∑TŒ∏
i
.
(24)"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7135922330097088,"To measure the performance of balancing the weights from the NBW model, we estimate the Œ±-
288
divergence information for balanced distribution from the weights. That is, we use the sample mean
289
under a balanced distribution, despite the sample mean under P for (24). For example, we assume
290"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7184466019417476,Algorithm 2 Algorithm for checking the balance
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7233009708737864,"Input: Train Data {(xi
1, . . . , xi
n, zi)}N
i=1, Test
Data {(exi
1, . . . , exi
n,ezi)}N
i=1, A Neural Balanc-
ing Weight Model TŒ∏
Output: The estimated Œ±-divergence informa-
tion bIŒ± for the balanced distribution with the
balancing weights from TŒ∏"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7281553398058253,"œÉx
1 ‚ÜêSHUFFLE({1 : N})
...
œÉx
n ‚ÜêSHUFFLE({1 : N})
œÉz ‚ÜêSHUFFLE({1 : N})"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7330097087378641,"{bwi}N
i ‚Üê
e‚àíTŒ∏(xi
1,xi
2,...,xi
n,zi)
P{e‚àíTŒ∏(xi
1,xi
2,...,xin,zi)}
bIŒ± ‚Üê{}"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7378640776699029,"for t = 1 to K do
ÀÜEP0 ‚Üê1"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7427184466019418,"N Œ£N
i=1e(Œ±‚àí1)¬∑Tœà(xi
1,...,xi
n,zi) ¬∑ bwi"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7475728155339806,"ÀÜEQ ‚Üê
1
N Œ£N
i=1eŒ±¬∑Tœà(x
œÉx
1 (i)
1
,...,x
œÉx
n(i)
n
,zœÉz(i))"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7524271844660194,"LŒ±(œà) ‚ÜêÀÜEQ/Œ± + ÀÜEP0/(1 ‚àíŒ±)
œà ‚Üêœà ‚àí‚àáœàLŒ±(œà)
ÀÜEte
P0 ‚Üê1"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7572815533980582,"N Œ£N
i=1e(Œ±‚àí1)¬∑Tœà(exi
1,...,exi
n,ezi) ¬∑ bwi"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7621359223300971,"ÀÜEte
Q ‚Üê1"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7669902912621359,"N Œ£N
i=1eŒ±¬∑Tœà(ex
œÉx
1 (i)
1
,...,ex
œÉx
n(i)
n
,ezœÉz(i))"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7718446601941747,"bIt
Œ± ‚Üê1/{Œ± ¬∑ (1 ‚àíŒ±)}
‚àíÀÜEte
Q /Œ± ‚àíÀÜEte
P0/(1 ‚àíŒ±)
bIŒ± ‚ÜêbIŒ± ‚à™{bIt
Œ±}
end for
bIŒ± ‚Üêmaxt bIŒ±"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7766990291262136,"that we have certain weights BW ‚Ä≤ = {bwi : i = 1, 2, ..., N}, where bwi denotes the weight of
291
sample i of N. The balanced distribution from the weights is
292"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7815533980582524,"dP ‚Ä≤ = BW ‚Ä≤ ¬∑ dP.
(25)"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7864077669902912,"The Œ±-divergence information for P ‚Ä≤ is estimated by replacing P with P ‚Ä≤ for (24) in the following
293
manner: despite the sample mean ÀÜEP [e(Œ±‚àí1)¬∑TŒ∏] for these equations, we use the weighted sample
294
mean, such that
295
ÀÜEP ‚Ä≤[e(Œ±‚àí1)¬∑TŒ∏] = 1"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7912621359223301,"N Œ£N
i=1bwi ¬∑ e(Œ±‚àí1)¬∑TŒ∏(xi
1,xi
2,...,xi
n,zi).
(26)"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.7961165048543689,"Details on the implementation for measuring the performance of balancing weights from an NBW
296
model are provided in Algorithm 2, which includes the validation method for the overÔ¨Åtting problem
297
in Section 7.1.
298"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.8009708737864077,"8
Limitations: Sample Size Requirements.
299"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.8058252427184466,"In Section 7.1, we noted that our method has a curse of dimensionality. The sample size require-
300
ment of the proposed method is N >
  1"
MEASURING THE PERFORMANCE OF THE BALANCING WEIGHTS,0.8106796116504854,"Œµ
d+Œ¥ for W1(Q, ÀÜQ(N)
K0 ) < Œµ (Corollary C.25 in Appendix
301
C). However, the curse of dimensionality is an essential problem when balancing multivariate data
302
owing to the following factors. Because the optimal balancing weights deÔ¨Åned as (8) for (Ô¨Ånite)
303
observational data are the density ratios of the empirical distributions, the distribution of the data
304
balanced by them is the empirical distribution. Subsequently, owing to the balancing of the weights,
305
the curse of dimensionality of the empirical distribution occurs, which is the same as that described
306
in Section 7.1. Therefore, to achieve high generalization performance, we need to obtain weights
307
that differ from the ideal density ratio between the source and target of the empirical distribution.
308
Further research is required to address this problem. In Appendix D.3, we present the numerical
309
examination results in which the causal effects of joint and multidimensional interventions were
310
estimated with different sample sizes.
311"
CONCLUSION,0.8155339805825242,"9
Conclusion
312"
CONCLUSION,0.8203883495145631,"We propose generalized balancing weights to estimate the causal effects of an arbitrary mixture of
313
discrete and continuous interventions. Three methods for training the weights were provided: an
314
optimization method to learn the weights, a method to improve the generalization performance of
315
the balancing weights, and a method to measure the performance of the weights. We showed the
316
sample size requirements for the weights and then discussed the curse of dimensionality that occurs
317
as a general problem when balancing multidimensional data. Although the curse of dimensionality
318
remains in our method, we believe that this study provides a basic approach for estimating the
319
balancing weights of multidimensional data using variational f-divergence.
320"
REFERENCES,0.8252427184466019,"References
321"
REFERENCES,0.8300970873786407,"[1] David Acuna, Guojun Zhang, Marc T Law, and Sanja Fidler.
f-domain adversarial learn-
322
ing: Theory and algorithms. In International Conference on Machine Learning, pages 66‚Äì75.
323
PMLR, 2021.
324"
REFERENCES,0.8349514563106796,"[2] Martin Arjovsky and L√©on Bottou. Towards principled methods for training generative adver-
325
sarial networks. arXiv preprint arXiv:1701.04862, 2017.
326"
REFERENCES,0.8398058252427184,"[3] Mohamed Ishmael Belghazi, Aristide Baratin, Sai Rajeshwar, Sherjil Ozair, Yoshua Bengio,
327
Aaron Courville, and Devon Hjelm. Mutual information neural estimation. In International
328
conference on machine learning, pages 531‚Äì540. PMLR, 2018.
329"
REFERENCES,0.8446601941747572,"[4] Marc G Bellemare, Ivo Danihelka, Will Dabney, Shakir Mohamed, Balaji Lakshminarayanan,
330
Stephan Hoyer, and R√©mi Munos. The cramer distance as a solution to biased wasserstein
331
gradients. arXiv preprint arXiv:1705.10743, 2017.
332"
REFERENCES,0.8495145631067961,"[5] Jeremiah Birrell, Markos A Katsoulakis, and Yannis Pantazis. Optimizing variational repre-
333
sentations of divergences and accelerating their statistical estimation. IEEE Transactions on
334
Information Theory, 2022.
335"
REFERENCES,0.8543689320388349,"[6] Yaroslav Ganin, Evgeniya Ustinova, Hana Ajakan, Pascal Germain, Hugo Larochelle, Fran√ßois
336
Laviolette, Mario Marchand, and Victor Lempitsky. Domain-adversarial training of neural
337
networks. The journal of machine learning research, 17(1):2096‚Äì2030, 2016.
338"
REFERENCES,0.8592233009708737,"[7] Gustavo L Gilardoni. On pinsker‚Äôs and vajda‚Äôs type inequalities for csisz√°r‚Äôs f-divergences.
339
IEEE Transactions on Information Theory, 56(11):5377‚Äì5386, 2010.
340"
REFERENCES,0.8640776699029126,"[8] Jens Hainmueller. Entropy balancing for causal effects: A multivariate reweighting method to
341
produce balanced samples in observational studies. Political analysis, 20(1):25‚Äì46, 2012.
342"
REFERENCES,0.8689320388349514,"[9] Kosuke Imai and Marc Ratkovic. Covariate balancing propensity score. Journal of the Royal
343
Statistical Society: Series B (Statistical Methodology), 76(1):243‚Äì263, 2014.
344"
REFERENCES,0.8737864077669902,"[10] Kosuke Imai and David A Van Dyk. Causal inference with general treatment regimes: General-
345
izing the propensity score. Journal of the American Statistical Association, 99(467):854‚Äì866,
346
2004.
347"
REFERENCES,0.8786407766990292,"[11] Masahiro Kato and Takeshi Teshima.
Non-negative bregman divergence minimization for
348
deep direct density ratio estimation. In International Conference on Machine Learning, pages
349
5320‚Äì5333. PMLR, 2021.
350"
REFERENCES,0.883495145631068,"[12] Simon Lacoste-Julien, Mark Schmidt, and Francis Bach. A simpler approach to obtaining
351
an o (1/t) convergence rate for the projected stochastic subgradient method. arXiv preprint
352
arXiv:1212.2002, 2012.
353"
REFERENCES,0.8883495145631068,"[13] Fan Li, Kari Lock Morgan, and Alan M Zaslavsky. Balancing covariates via propensity score
354
weighting. Journal of the American Statistical Association, 113(521):390‚Äì400, 2018.
355"
REFERENCES,0.8932038834951457,"[14] David McAllester and Karl Stratos. Formal limitations on the measurement of mutual infor-
356
mation. In International Conference on ArtiÔ¨Åcial Intelligence and Statistics, pages 875‚Äì884.
357
PMLR, 2020.
358"
REFERENCES,0.8980582524271845,"[15] XuanLong Nguyen, Martin J Wainwright, and Michael Jordan. Estimating divergence func-
359
tionals and the likelihood ratio by penalized convex risk minimization. Advances in neural
360
information processing systems, 20, 2007.
361"
REFERENCES,0.9029126213592233,"[16] XuanLong Nguyen, Martin J Wainwright, and Michael I Jordan. Estimating divergence func-
362
tionals and the likelihood ratio by convex risk minimization. IEEE Transactions on Information
363
Theory, 56(11):5847‚Äì5861, 2010.
364"
REFERENCES,0.9077669902912622,"[17] Sebastian Nowozin, Botond Cseke, and Ryota Tomioka. f-gan: Training generative neural
365
samplers using variational divergence minimization. Advances in neural information process-
366
ing systems, 29, 2016.
367"
REFERENCES,0.912621359223301,"[18] Aaron van den Oord, Yazhe Li, and Oriol Vinyals. Representation learning with contrastive
368
predictive coding. arXiv preprint arXiv:1807.03748, 2018.
369"
REFERENCES,0.9174757281553398,"[19] Judea Pearl. Causal diagrams for empirical research. Biometrika, 82(4):669‚Äì688, 1995.
370"
REFERENCES,0.9223300970873787,"[20] Judea Pearl. Causality: Models, reasoning and inference, 2009.
371"
REFERENCES,0.9271844660194175,"[21] Ben Poole, Sherjil Ozair, Aaron Van Den Oord, Alex Alemi, and George Tucker. On variational
372
bounds of mutual information. In International Conference on Machine Learning, pages 5171‚Äì
373
5180. PMLR, 2019.
374"
REFERENCES,0.9320388349514563,"[22] James M Robins, Andrea Rotnitzky, and Lue Ping Zhao. Estimation of regression coefÔ¨Åcients
375
when some regressors are not always observed. Journal of the American statistical Association,
376
89(427):846‚Äì866, 1994.
377"
REFERENCES,0.9368932038834952,"[23] James M Robins, Miguel Angel Hernan, and Babette Brumback. Marginal structural models
378
and causal inference in epidemiology, 2000.
379"
REFERENCES,0.941747572815534,"[24] Paul R Rosenbaum and Donald B Rubin. Reducing bias in observational studies using sub-
380
classiÔ¨Åcation on the propensity score. Journal of the American statistical Association, 79(387):
381
516‚Äì524, 1984.
382"
REFERENCES,0.9466019417475728,"[25] Albert Nikolaevich Shiryaev. Probability, 1995.
383"
REFERENCES,0.9514563106796117,"[26] Ilya Shpitser and Judea Pearl. IdentiÔ¨Åcation of conditional interventional distributions. arXiv
384
preprint arXiv:1206.6876, 2012.
385"
REFERENCES,0.9563106796116505,"[27] Si Si, Dacheng Tao, and Bo Geng.
Bregman divergence-based regularization for transfer
386
subspace learning. IEEE Transactions on Knowledge and Data Engineering, 22(7):929‚Äì942,
387
2009.
388"
REFERENCES,0.9611650485436893,"[28] Jiaming Song and Stefano Ermon. Understanding the limitations of variational mutual infor-
389
mation estimators. arXiv preprint arXiv:1910.06222, 2019.
390"
REFERENCES,0.9660194174757282,"[29] Masashi Sugiyama, Taiji Suzuki, and Takafumi Kanamori. Density-ratio matching under the
391
bregman divergence: a uniÔ¨Åed framework of density-ratio estimation. Annals of the Institute
392
of Statistical Mathematics, 64(5):1009‚Äì1044, 2012.
393"
REFERENCES,0.970873786407767,"[30] Stefan T√ºbbicke. Entropy balancing for continuous treatments. Journal of Econometric Meth-
394
ods, 11(1):71‚Äì89, 2022.
395"
REFERENCES,0.9757281553398058,"[31] Masatoshi Uehara, Issei Sato, Masahiro Suzuki, Kotaro Nakayama, and Yutaka Matsuo.
396
Generative adversarial nets from a density ratio estimation perspective.
arXiv preprint
397
arXiv:1610.02920, 2016.
398"
REFERENCES,0.9805825242718447,"[32] Ananya Uppal, Shashank Singh, and Barnab√°s P√≥czos. Nonparametric density estimation &
399
convergence rates for gans under besov ipm losses. Advances in neural information processing
400
systems, 32, 2019.
401"
REFERENCES,0.9854368932038835,"[33] Jonathan Weed and Francis Bach. Sharp asymptotic and Ô¨Ånite-sample rates of convergence of
402
empirical measures in wasserstein distance. 2019.
403"
REFERENCES,0.9902912621359223,"[34] Hongkang Yang and E Weinan. Generalization and memorization: The bias potential model.
404
In Mathematical and ScientiÔ¨Åc Machine Learning, pages 1013‚Äì1043. PMLR, 2022.
405"
REFERENCES,0.9951456310679612,"[35] Yuchen Zhang, Tianle Liu, Mingsheng Long, and Michael Jordan. Bridging theory and al-
406
gorithm for domain adaptation.
In International Conference on Machine Learning, pages
407
7404‚Äì7413. PMLR, 2019.
408"
