Section,Section Appearance Order,Paragraph
ABSTRACT,0.0,ABSTRACT
ABSTRACT,0.001402524544179523,"Neural networks in the lazy training regime converge to kernel machines. Can
neural networks in the rich feature learning regime learn a kernel machine with
a data-dependent kernel? We demonstrate that this can indeed happen due to a
phenomenon we term silent alignment, which requires that the tangent kernel of
a network evolves in eigenstructure while small and before the loss appreciably
decreases, and grows only in overall scale afterwards. We empirically show that
such an effect takes place in homogenous neural networks with small initialization
and whitened data. We provide an analytical treatment of this effect in the fully
connected linear network case. In general, we ﬁnd that the kernel develops a
low-rank contribution in the early phase of training, and then evolves in overall
scale, yielding a function equivalent to a kernel regression solution with the ﬁnal
network’s tangent kernel. The early spectral learning of the kernel depends on
the depth. We also demonstrate that non-whitened data can weaken the silent
alignment effect."
INTRODUCTION,0.002805049088359046,"1
INTRODUCTION"
INTRODUCTION,0.004207573632538569,"Despite the numerous empirical successes of deep learning, much of the underlying theory remains
poorly understood. One promising direction forward to an interpretable account of deep learning
is in the study of the relationship between deep neural networks and kernel machines. Several
studies in recent years have shown that gradient ﬂow on inﬁnitely wide neural networks with a
certain parameterization gives rise to linearized dynamics in parameter space (Lee et al., 2019; Liu
et al., 2020) and consequently a kernel regression solution with a kernel known as the neural tangent
kernel (NTK) in function space (Jacot et al., 2018; Arora et al., 2019). Kernel machines enjoy ﬁrmer
theoretical footing than deep neural networks, which allows one to accurately study their training
and generalization (Rasmussen & Williams, 2006; Sch¨olkopf & Smola, 2002). Moreover, they share
many of the phenomena that overparameterized neural networks exhibit, such as interpolating the
training data (Zhang et al., 2017; Liang & Rakhlin, 2018; Belkin et al., 2018). However, the exact
equivalence between neural networks and kernel machines breaks for ﬁnite width networks. Further,
the regime with approximately static kernel, also referred to as the lazy training regime (Chizat et al.,
2019), cannot account for the ability of deep networks to adapt their internal representations to the
structure of the data, a phenomenon widely believed to be crucial to their success."
INTRODUCTION,0.005610098176718092,"In this present study, we pursue an alternative perspective on the NTK, and ask whether a neural
network with an NTK that changes signiﬁcantly during training can ever be a kernel machine for a
data-dependent kernel: i.e. does there exist a kernel function K for which the ﬁnal neural network
function f is f(x) ≈PP
µ=1 αµK(x, xµ) with coefﬁcients αµ that depend only on the training
data? We answer in the afﬁrmative: that a large class of neural networks at small initialization
trained on approximately whitened data are accurately approximated as kernel regression solutions
with their ﬁnal, data-dependent NTKs up to an error dependent on initialization scale. Hence, our
results provide a further concrete link between kernel machines and deep learning which, unlike the
inﬁnite width limit, allows for the kernel to be shaped by the data."
INTRODUCTION,0.0070126227208976155,∗These authors contributed equally.
INTRODUCTION,0.008415147265077139,Published as a conference paper at ICLR 2022
INTRODUCTION,0.009817671809256662,"The phenomenon we study consists of two training phases. In the ﬁrst phase, the kernel starts off
small in overall scale and quickly aligns its eigenvectors toward task-relevant directions. In the
second phase, the kernel increases in overall scale, causing the network to learn a kernel regression
solution with the ﬁnal NTK. We call this phenomenon the silent alignment effect because the feature
learning happens before the loss appreciably decreases. Our contributions are the following"
INTRODUCTION,0.011220196353436185,"1. In Section 2, we demonstrate the silent alignment effect by considering a simpliﬁed model where
the kernel evolves while small and then subsequently increases only in scale. We theoretically
show that if these conditions are met, the ﬁnal neural network is a kernel machine that uses the
ﬁnal, data-dependent NTK. A proof is provided in Appendix B."
INTRODUCTION,0.012622720897615708,"2. In Section 3, we provide an analysis of the NTK evolution of two layer linear MLPs with scalar
target function with small initialization. If the input training data is whitened, the kernel aligns its
eigenvectors towards the direction of the optimal linear function early on during training while
the loss does not decrease appreciably. After this, the kernel changes in scale only, showing this
setup satisﬁes the requirements for silent alignment discussed in Section 2."
INTRODUCTION,0.014025245441795231,"3. In Section 4, we extend our analysis to deep MLPs by showing that the time required for align-
ment scales with initialization the same way as the time for the loss to decrease appreciably. Still,
these time scales can be sufﬁciently separated to lead to the silent alignment effect for which we
provide empirical evidence. We further present an explicit formula for the ﬁnal kernel in linear
networks of any depth and width when trained from small initialization, showing that the ﬁnal
NTK aligns to task-relevant directions."
INTRODUCTION,0.015427769985974754,"4. In Section 5, we show empirically that the silent alignment phenomenon carries over to nonlinear
networks trained with ReLU and Tanh activations on isotropic data, as well as linear and non-
linear networks with multiple output classes. For anisotropic data, we show that the NTK must
necessarily change its eigenvectors when the loss is signiﬁcantly decreasing, destroying the silent
alignment phenomenon. In these cases, the ﬁnal neural network output deviates from a kernel
machine that uses the ﬁnal NTK."
RELATED WORKS,0.016830294530154277,"1.1
RELATED WORKS"
RELATED WORKS,0.0182328190743338,"Jacot et al. (2018) demonstrated that inﬁnitely wide neural networks with an appropriate parame-
terization trained on mean square error loss evolve their predictions as a linear dynamical system
with the NTK at initalization. A limitation of this kernel regime is that the neural network inter-
nal representations and the kernel function do not evolve during training. Conditions under which
such lazy training can happen is studied further in (Chizat et al., 2019; Liu et al., 2020). Domingos
(2020) recently showed that every model, including neural networks, trained with gradient descent
leads to a kernel model with a path kernel and coefﬁcients αµ that depend on the test point x. This
dependence on x makes the construction not a kernel method in the traditional sense that we pursue
here (see Remark 1 in (Domingos, 2020))."
RELATED WORKS,0.019635343618513323,"Phenomenological studies and models of kernel evolution have been recently invoked to gain insight
into the difference between lazy and feature learning regimes of neural networks. These include
analysis of NTK dynamics which revealed that the NTK in the feature learning regime aligns its
eigenvectors to the labels throughout training, causing non-linear prediction dynamics (Fort et al.,
2020; Baratin et al., 2021; Shan & Bordelon, 2021; Woodworth et al., 2020; Chen et al., 2020; Geiger
et al., 2021; Bai et al., 2020). Experiments have shown that lazy learning can be faster but less robust
than feature learning (Flesch et al., 2021) and that the generalization advantage that feature learning
provides to the ﬁnal predictor is heavily task and architecture dependent (Lee et al., 2020). Fort et al.
(2020) found that networks can undergo a rapid change of kernel early on in training after which
the network’s output function is well-approximated by a kernel method with a data-dependent NTK.
Our ﬁndings are consistent with these results."
RELATED WORKS,0.021037868162692847,"St¨oger & Soltanolkotabi (2021) recently obtained a similar multiple-phase training dynamics involv-
ing an early alignment phase followed by spectral learning and reﬁnement phases in the setting of
low-rank matrix recovery. Their results share qualitative similarities with our analysis of deep linear
networks. The second phase after alignment, where the kernel’s eigenspectrum grows, was studied
in linear networks in (Jacot et al., 2021), where it is referred to as the saddle-to-saddle regime."
RELATED WORKS,0.02244039270687237,Published as a conference paper at ICLR 2022
RELATED WORKS,0.023842917251051893,"Unlike prior works (Dyer & Gur-Ari, 2020; Aitken & Gur-Ari, 2020; Andreassen & Dyer, 2020),
our results do not rely on perturbative expansions in network width. Also unlike the work of Saxe
et al. (2014), our solutions for the evolution of the kernel do not depend on choosing a speciﬁc set of
initial conditions, but rather follow only from assumptions of small initialization and whitened data."
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.025245441795231416,"2
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.02664796633941094,"Neural networks in the overparameterized regime can ﬁnd many interpolators: the precise function
that the network converges to is controlled by the time evolution of the NTK. As a concrete example,
we will consider learning a scalar target function with mean square error loss through gradient ﬂow.
Let x ∈RD represent an arbitrary input to the network f(x) and let {xµ, yµ}P
µ=1 be a supervised
learning training set. Under gradient ﬂow the parameters θ of the neural network will evolve, so the
output function is time-dependent and we write this as f(x, t). The evolution for the predictions of
the network on a test point can be written in terms of the NTK K(x, x′, t) = ∂f(x,t)"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.028050490883590462,"∂θ
· ∂f(x′,t) ∂θ
as"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.029453015427769985,"d
dtf(x, t) = η
X"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.030855539971949508,"µ
K(x, xµ, t)(yµ −f(xµ, t)),
(1)"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.03225806451612903,"where η is the learning rate. If one had access to the dynamics of K(x, xµ, t) throughout all t, one
could solve for the ﬁnal learned function f ∗with integrating factors under conditions discussed in
Appendix A"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.033660589060308554,"f ∗(x) = f0(x) +
X µν Z ∞"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.03506311360448808,"0
dt kt(x)µ

exp

−η
Z t"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.0364656381486676,"0
Kt′ dt′
"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.037868162692847124,"µν
(yν −f0(xν)) .
(2)"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.03927068723702665,"Here, kt(x)µ = K(x, xµ, t), [Kt]µ,ν = K(xµ, xν, t), and yµ −f0(xµ) is the initial error on
point xµ. We see that the ﬁnal function has contributions throughout the full training interval t ∈
(0, ∞). The seminal work by Jacot et al. (2018) considers an inﬁnite-width limit of neural networks,
where the kernel function Kt(x, x′) stays constant throughout training time. In this setting where
the kernel is constant and f0(xµ) ≈0, then we obtain a true kernel regression solution f(x) =
P
µ,ν k(x)µK−1
µν yν for a kernel K(x, x′) which does not depend on the training data."
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.04067321178120617,"Much less is known about what happens in the rich, feature learning regime of neural networks,
where the kernel evolves signiﬁcantly during time in a data-dependent manner. In this paper, we
consider a setting where the initial kernel is small in scale, aligns its eigenfunctions early on during
gradient descent, and then increases only in scale monotonically. As a concrete phenomenological
model, consider depth L networks with homogenous activation functions with weights initialized
with variance σ2. At initialization K0(x, x′) ∼O(σ2L−2), f0(x) ∼O(σL) (see Appendix B). We
further assume that after time τ, the kernel only evolves in scale in a constant direction"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.04207573632538569,"K(x, x′, t) =
σ2L−2 ˜K(x, x′, t)
t ≤τ
g(t)K∞(x, x′)
t > τ ,
(3)"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.043478260869565216,"where ˜K(x, x′, t) evolves from an initial kernel at time t = 0 to K∞(x, x′) by t = τ and g(t)
increases monotonically from σ2L−2 to 1. In this model, one also obtains a kernel regression solution
in the limit where σ →0 with the ﬁnal, rather than the initial kernel: f(x) = k∞(x) · K−1
∞y +
O(σL). We provide a proof of this in the Appendix B."
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.04488078541374474,"The assumption that the kernel evolves early on in gradient descent before increasing only in scale
may seem overly strict as a model of kernel evolution. However, we analytically show in Sections 3
and 4 that this can happen in deep linear networks initialized with small weights, and consequently
that the ﬁnal learned function is a kernel regression with the ﬁnal NTK. Moreover, we show that for
a linear network with small weight initialization, the ﬁnal NTK depends on the training data in a
universal and predictable way."
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.04628330995792426,"We show empirically that our results carry over to nonlinear networks with ReLU and tanh activa-
tions under the condition that the data is whitened. For example, see Figure 1, where we show the
silent alignment effect on ReLU networks with whitened MNIST and CIFAR-10 images. We deﬁne
alignment as the overlap between the kernel and the target function
y⊤Ky
∥K∥F |y|2 , where y ∈RP is"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.047685834502103785,Published as a conference paper at ICLR 2022
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.04908835904628331,"0
100
200
300
400
500
t 0.0 0.2 0.4 0.6 0.8 1.0"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.05049088359046283,Kernel and Loss
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.051893408134642355,"Lt
|K(t)|"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.05329593267882188,Alignment
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.0546984572230014,(a) Whitened Data MLP Dynamics
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.056100981767180924,"2
0
2
4
Test Prediction NN 4 2 0 2 4"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.05750350631136045,Test Prediction NTK
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.05890603085553997,"ReLU MLP on Whitened MNIST K0
K"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.06030855539971949,(b) Prediction MNIST
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.061711079943899017,"7.5
5.0
2.5
0.0
2.5
5.0
7.5
Test Prediction NN 5 0 5"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.06311360448807854,Test Prediction NTK
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.06451612903225806,"ReLU MLP on Whitened CIFAR K0
K"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.06591865357643759,(c) Prediction CIFAR-10
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.06732117812061711,"0
250
500
750
1000 1250 1500
t 0.0 0.2 0.4 0.6 0.8 1.0"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.06872370266479663,Loss and Alignment
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.07012622720897616,"Lt
|K(t)|"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.07152875175315568,Alignment
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.0729312762973352,(d) Wide Res-Net Dynamics
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.07433380084151472,"2
1
0
1
2
Test Prediction NN 2 1 0 1 2"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.07573632538569425,Test Prediction NTK
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.07713884992987377,"Wide Res-Net on Whitened CIFAR K0
K"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.0785413744740533,(e) Prediction Res-Net
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.07994389901823282,"Figure 1: A demonstration of the Silent Alignment effect. (a) We trained a 2-layer ReLU MLP
on P = 1000 MNIST images of handwritten 0’s and 1’s which were whitened. Early in training,
around t ≈50, the NTK aligns to the target function and stay ﬁxed (green). The kernel’s overall
scale (orange) and the loss (blue) begin to move at around t = 300. The analytic solution for the
maximal ﬁnal alignment value in linear networks is overlayed (dashed green), see Appendix E.2.
(b) We compare the predictions of the NTK and the trained network on MNIST test points. Due
to silent alignment, the ﬁnal learned function is well described as a kernel regression solution with
the ﬁnal NTK K∞. However, regression with the initial NTK is not a good model of the network’s
predictions. (c) The same experiment on P = 1000 whitened CIFAR-10 images from the ﬁrst two
classes. Here we use MSE loss on a width 100 network with initialization scale σ = 0.1. (d)
Wide-ResNet with width multiplier k = 4 and blocksize of b = 1 trained with P = 100 training
points from the ﬁrst two classes of CIFAR-10. The dashed orange line marks when the kernel starts
growing signiﬁcantly, by which point the alignment has already ﬁnished. (e) Predictions of the ﬁnal
NTK are strongly correlated with the ﬁnal NN function."
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.08134642356241234,"a vector of the target values, quantifying the projection of the labels onto the kernel, as discussed
in (Cortes et al., 2012). This quantity increases early in training but quickly stabilizes around its
asymptotic value before the loss decreases. Though Equation 2 was derived under assumption of
gradient ﬂow with constant learning rate, the underlying conclusions can hold in more realistic
settings as well. In Figure 1 (d) and (e) we show learning dynamics and network predictions for
Wide-ResNet (Zagoruyko & Komodakis, 2017) on whitened CIFAR-10 trained with the Adam op-
timizer (Kingma & Ba, 2014) with learning rate 10−5, which exhibits silent alignment and strong
correlation with the ﬁnal NTK predictor. In the unwhitened setting, this effect is partially degraded,
as we discuss in Section 5 and Appendix J. Our results suggest that the ﬁnal NTK may be useful for
analyzing generalization and transfer as we discuss for the linear case in Appendix F."
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.08274894810659186,"3
KERNEL EVOLUTION IN 2 LAYER LINEAR NETWORKS"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.08415147265077139,"We will ﬁrst study shallow linear networks trained with small initialization before providing analysis
for deeper networks in Section 4. We will focus our discussion in this section on the scalar output
case but we will provide similar analysis in the multiple output channel case in a subsequent section.
We demonstrate that our analytic solutions match empirical simulations in Appendix C.5."
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.08555399719495091,"We assume the P data points xµ ∈RD, µ = 1, . . . , P of zero mean with correlation matrix
Σ =
1
P
PP
µ=1 xµxµ⊤. Further, we assume that the target values are generated by a linear teacher
function yµ = sβT · xµ for a unit vector βT . The scalar s merely quantiﬁes the size of the su-
pervised learning signal: the variance of |y|2 = s2β⊤
T ΣβT . We deﬁne the two-layer linear neu-"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.08695652173913043,Published as a conference paper at ICLR 2022 1 2 t = 0
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.08835904628330996,"(a) Initialization 1 2 t
t1"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.08976157082748948,(b) Phase 1 1 2 t
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.091164095371669,(c) Phase 2
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.09256661991584852,"Figure 2: The evolution of the kernel’s eigenfunctions happens during the early alignment phase for
t1 ≈1"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.09396914446002805,"s, but signiﬁcant evolution in the network predictions happens for t > t2 = 1"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.09537166900420757,"2 log(sσ−2). (a)
Contour plot of kernel’s norm for linear functions f(x) = β · x. The black line represents the space
of weights which interpolate the training set, ie X⊤β = y. At initialization, the kernel is isotropic,
resulting in spherically symmetric level sets of RKHS norm. The network function is represented
as a blue dot. (b) During Phase I, the kernel’s eigenfunctions have evolved, enhancing power in the
direction of the min-norm interpolator, but the network function has not moved far from the origin.
(c) In Phase II, the network function W ⊤a moves from the origin to the ﬁnal solution."
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.0967741935483871,"ral network with N hidden units as f(x) = a⊤W x. Concretely, we initialize the weights with
standard parameterization ai ∼N(0, σ2/N), Wij ∼N(0, σ2/D). Understanding the role of σ
in the dynamics will be crucial to our study. We analyze gradient ﬂow dynamics on MSE cost
L =
1
2P
P"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.09817671809256662,µ (f(xµ) −yµ)2.
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.09957924263674614,"Under gradient ﬂow with learning rate η = 1, the weight matrices in each layer evolve as
d
dta = −∂L"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.10098176718092566,"∂a = W Σ
 
sβT −W ⊤a

,
d
dtW = −∂L"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.10238429172510519,"∂W = a
 
sβT −W ⊤a
⊤Σ.
(4)"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.10378681626928471,The NTK takes the following form throughout training.
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.10518934081346423,"K(x, x′; t) = x⊤W ⊤W x′ + |a|2x⊤x′.
(5)"
THE SILENT ALIGNMENT EFFECT AND APPROXIMATE KERNEL SOLUTION,0.10659186535764376,"Note that while the second term, a simple isotropic linear kernel, does not reﬂect the nature of the
learning task, the ﬁrst term x⊤W ⊤W x′ can evolve to yield an anisotropic kernel that has learned
a representation from the data."
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.10799438990182328,"3.1
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK"
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.1093969144460028,"We next show that there are essentially two phases of training when training a two-layer linear
network from small initialization on whitened-input data."
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.11079943899018233,• Phase I: An alignment phase which occurs for t ∼1
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.11220196353436185,"s. In this phase the weights align to their low
rank structure and the kernel picks up a rank-one term of the form x⊤ββ⊤x′. In this setting, since
the network is initialized near W , a = 0, which is a saddle point of the loss function, the gradient
of the loss is small. Consequently, the magnitudes of the weights and kernel evolve slowly.
• Phase II: A data ﬁtting phase which begins around t ∼1"
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.11360448807854137,"s log(sσ−2). In this phase, the system
escapes the initial saddle point W , a = 0 and loss decreases to zero. In this setting both the
kernel’s overall scale and the scale of the function f(x, t) increase substantially."
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.1150070126227209,"If Phase I and Phase II are well separated in time, which can be guaranteed by making σ small,
then the ﬁnal function solves a kernel interpolation problem for the NTK which is only sensitive
to the geometry of gradients in the ﬁnal basin of attraction. In fact, in the linear case, the kernel
interpolation at every point along the gradient descent trajectory would give the ﬁnal solution as we
show in Appendix G. A visual summary of these phases is provided in Figure 2."
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.11640953716690042,"3.1.1
PHASE I: EARLY ALIGNMENT FOR SMALL INITIALIZATION"
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.11781206171107994,"In this section we show how the kernel aligns to the correct eigenspace early in training. We focus
on the whitened setting, where the data matrix X has all of its nonzero singular values equal. We let"
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.11921458625525946,Published as a conference paper at ICLR 2022
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.12061711079943899,"β represent the normalized component of βT in the span of the training data {xµ}. We will discuss
general Σ in section 3.2. We approximate the dynamics early in training by recognizing that the
network output is small due to the small initialization. Early on, the dynamics are given by:
d
dta = sW β + O(σ3) ,
d
dtW = saβ⊤+ O(σ3).
(6)"
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.12201963534361851,"Truncating terms order σ3 and higher, we can solve for the kernel’s dynamics early on in training"
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.12342215988779803,"K(x, x′; t) = q0 cosh(2ηst) x⊤
ββ⊤+ I

x′ + O(σ2),
t ≪s−1 log(s/σ2).
(7)
where q0 is an initialization dependent quantity, see Appendix C.1. The bound on the error is ob-
tained in Appendix C.2. We see that the kernel picks up a rank one-correction ββ⊤which points
in the direction of the task vector β, indicating that the kernel evolves in a direction sensitive to
the target function y = sβT · x. This term grows exponentially during the early stages of train-
ing, and overwhelms the original kernel K0 with timescale 1/s. Though the neural network has
not yet achieved low loss in this phase, the alignment of the kernel and learned representation has
consequences for the transfer ability of the network on correlated tasks as we show in Appendix F."
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.12482468443197756,"3.1.2
PHASE II: SPECTRAL LEARNING"
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.12622720897615708,"We now assume that the weights have approached their low rank structure, as predicted from the
previous analysis of Phase I dynamics, and study the subsequent NTK evolution. We will show that,
under the assumption of whitening, the kernel only evolves in overall scale."
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.1276297335203366,"First, following (Fukumizu, 1998; Arora et al., 2018; Du et al., 2018), we note the following conser-
vation law d"
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.12903225806451613,"dt

a(t)a(t)⊤−W (t)W (t)⊤
= 0 which holds for all time. If we assume small initial
weight variance σ2, aa⊤−W W ⊤= O(σ2) ≈0 at initialization, and stays that way during the
training due to the conservation law. This condition is surprisingly informative, since it indicates
that W is rank-one up to O(σ) corrections. From the analysis of the alignment phase, we also have
that W ⊤W ∝ββ⊤. These two observations uniquely determine the rank one structure of W to be
aβ⊤+ O(σ). Thus, from equation 5 it follows that in Phase II, the kernel evolution takes the form"
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.13043478260869565,"K(x, x′; t) = u(t)2x⊤
ββ⊤+ I

x′ + O(σ),
(8)"
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.13183730715287517,where u(t)2 = |a|2. This demonstrates that the kernel only changes in overall scale during Phase II.
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.1332398316970547,"Once the weights are aligned with this scheme, we can get an expression for the evolution of u(t)2
analytically, u(t)2 = se2st(e2st −1 + s/u2
0)−1, using the results of (Fukumizu, 1998; Saxe et al.,
2014) as we discuss in C.4. This is a sigmoidal curve which starts at u2
0 and approaches s. The
transition time where active learning begins occurs when est ≈s/u2
0
=⇒
t ≈s−1 log(s/σ2).
This analysis demonstrates that the kernel only evolves in scale during this second phase in training
from the small initial value u2
0 ∼O(σ2) to its asymptote."
PHASES OF TRAINING IN TWO LAYER LINEAR NETWORK,0.13464235624123422,"Hence, kernel evolution in this scenario is equivalent to the assumptions discussed in Section 2,
with g(t) = u(t)2, showing that the ﬁnal solution is well approximated by kernel regression with
the ﬁnal NTK. We stress that the timescale for the ﬁrst phase t1 ∼1/s, where eigenvectors evolve,
is independent of the scale of the initialization σ2, whereas the second phase occurs around t2 ≈
t1 log(s/σ2). This separation of timescales t1 ≪t2 for small σ guarantees the silent alignment
effect. We illustrate these learning curves and for varying σ in Figure C.2."
UNWHITENED DATA,0.13604488078541374,"3.2
UNWHITENED DATA"
UNWHITENED DATA,0.13744740532959326,"When data is unwhitened, the right singular vector of W aligns with Σβ early in training, as
we show in Appendix C.3.
This happens since, early on, the dynamics for the ﬁrst layer are
d
dtW ∼a(t)β⊤Σ. Thus the early time kernel will have a rank-one spike in the Σβ direction.
However, this conﬁguration is not stable as the network outputs grow. In fact, at late time W
must realign to converge to W ∝aβ⊤since the network function converges to the optimum and
f = a⊤W x = sβ · x, which is the minimum ℓ2 norm solution (Appendix G.1). Thus, the ﬁnal
kernel will always look like K∞(x, x′) = sx⊤
ββ⊤+ I

x′. However, since the realignment of
W ’s singular vectors happens during the Phase II spectral learning, the kernel is not constant up to
overall scale, violating the conditions for silent alignment. We note that the learned function still is
a kernel regression solution of the ﬁnal NTK, which is a peculiarity of the linear network case, but
this is not achieved through the silent alignment phenomenon as we explain in Appendix C.3."
UNWHITENED DATA,0.1388499298737728,Published as a conference paper at ICLR 2022
EXTENSION TO DEEP LINEAR NETWORKS,0.1402524544179523,"4
EXTENSION TO DEEP LINEAR NETWORKS"
EXTENSION TO DEEP LINEAR NETWORKS,0.14165497896213183,"We next consider scalar target functions approximated by deep linear neural networks and show
that many of the insights from the two layer network carry over. The neural network function
f : RD →R takes the form f(x) = wL⊤W L−1...W 1x. The gradient ﬂow dynamics under mean
squared error (MSE) loss become"
EXTENSION TO DEEP LINEAR NETWORKS,0.14305750350631136,"d
dtW ℓ= −η ∂L"
EXTENSION TO DEEP LINEAR NETWORKS,0.14446002805049088,∂W ℓ= η Y
EXTENSION TO DEEP LINEAR NETWORKS,0.1458625525946704,"ℓ′>ℓ
W ℓ′
!⊤"
EXTENSION TO DEEP LINEAR NETWORKS,0.14726507713884993,"(sβ −˜
w)⊤Σ Y"
EXTENSION TO DEEP LINEAR NETWORKS,0.14866760168302945,"ℓ′<ℓ
W ℓ′
!⊤ ,
(9)"
EXTENSION TO DEEP LINEAR NETWORKS,0.15007012622720897,"where ˜
w = W 1⊤W 2⊤...wL ∈RD is shorthand for the effective one-layer linear network weights.
Inspired by observations made in prior works (Fukumizu, 1998; Arora et al., 2018; Du et al., 2018),
we again note that the following set of conservation laws hold during the dynamics of gradient
descent
d
dt

W ℓW ℓ⊤−W ℓ+1⊤W ℓ+1
= 0. This condition indicates a balance in the size of
weight updates in adjacent layers and simpliﬁes the analysis of linear networks. This balancing
condition between weights of adjacent layers is not speciﬁc to MSE loss, but will also hold for any
loss function, see Appendix D. We will use this condition to characterize the NTK’s evolution."
NTK UNDER SMALL INITIALIZATION,0.1514726507713885,"4.1
NTK UNDER SMALL INITIALIZATION"
NTK UNDER SMALL INITIALIZATION,0.15287517531556802,"We now consider the effects of small initialization. When the initial weight variance σ2 is sufﬁciently
small, W ℓW ℓ⊤−W ℓ+1⊤W ℓ+1 = O(σ2) ≈0 at initialization.1 This conservation law implies that
these matrices remain approximately equal throughout training. Performing an SVD on each matrix
and inductively using the above formula from the last layer to the ﬁrst, we ﬁnd that all matrices
will be approximately rank-one wL = u(t)rL(t) , W ℓ= u(t)rℓ+1(t)rℓ(t)⊤, where rℓ(t) are unit
vectors. Using only this balancing condition and expanding to leading order in σ, we ﬁnd that the
NTK’s dynamics look like"
NTK UNDER SMALL INITIALIZATION,0.15427769985974754,"K(x, x′, t) = u(t)2(L−1)x⊤
(L −1)r1(t)r1(t)⊤+ I

x′ + O(σ).
(10)"
NTK UNDER SMALL INITIALIZATION,0.15568022440392706,"We derive this formula in the Appendix E. We observe that the NTK consists of a rank-1 correction
to the isotropic linear kernel x · x′ with the rank-one spike pointing along the r1(t) direction. This
is true dynamically throughout training under the assumption of small σ. At convergence r(t) →β,
which is the unique ﬁxed point reachable through gradient descent. We discuss evolution of u(t)
below. The alignment of the NTK with the direction β increases with depth L."
WHITENED DATA VS ANISOTROPIC DATA,0.1570827489481066,"4.1.1
WHITENED DATA VS ANISOTROPIC DATA"
WHITENED DATA VS ANISOTROPIC DATA,0.1584852734922861,"We now argue that in the case where the input data is whitened, the trained network function is again
a kernel machine that uses the ﬁnal NTK. The unit vector r1(t) quickly aligns to β since the ﬁrst
layer weight matrix evolves in the rank-one direction
d
dtW 1 = v(t)β⊤throughout training for a
time dependent vector function v(t). As a consequence, early in training the top eigenvector of the
NTK aligns to β. Due to gradient descent dynamics, W 1⊤W 1 grows only in the ββ⊤direction.
Since the r1 quickly aligns to β due to W 1 growing only along the β direction, then the global
scalar function c(t) = u(t)L satisﬁes the dynamics ˙c(t) = c(t)2−2/L [s −c(t)] in the whitened data
case, which is consistent with the dynamics obtained when starting from the orthogonal initialization
scheme of Saxe et al. (2014). We show in the Appendix E.1 that spectral learning occurs over a
timescale on the order of t1/2 ≈
L
s(L−2)σ−L+2, where t1/2 is the time required to reach half the
value of the initial loss. We discuss this scaling in detail in Figure 3, showing that although the
timescale of alignment shares the same scaling with σ for L > 2, empirically alignment in deep
networks occurs faster than spectral learning. Hence, the silent alignment conditions of Section 2
are satisﬁed. In the case where the data is unwhitened, the r1(t) vector aligns with Σβ early in
training. This happens since, early on, the dynamics for the ﬁrst layer are
d
dtW 1 ∼v(t)β⊤Σ for
time dependent vector v(t). However, for the same reasons we discussed in Section 3.2 the kernel
must realign at late times, violating the conditions for silent alignment."
WHITENED DATA VS ANISOTROPIC DATA,0.15988779803646563,"1Though we focus on neglecting the O(σ2) initial weight matrices in the main text, an approximate anal-
ysis for wide networks at ﬁnite σ2 and large width is provided in Appendix H.2, which reveals additional
dependence on relative layer widths."
WHITENED DATA VS ANISOTROPIC DATA,0.16129032258064516,Published as a conference paper at ICLR 2022
WHITENED DATA VS ANISOTROPIC DATA,0.16269284712482468,"10
2
10
1 100 101 102 103 104 105 106 107 t1/2"
WHITENED DATA VS ANISOTROPIC DATA,0.1640953716690042,"L = 3
L = 4
L = 5"
WHITENED DATA VS ANISOTROPIC DATA,0.16549789621318373,(a) ODE Time to Learn
WHITENED DATA VS ANISOTROPIC DATA,0.16690042075736325,"100
101
102
103
t 0.0 0.2 0.4 0.6 0.8 1.0"
WHITENED DATA VS ANISOTROPIC DATA,0.16830294530154277,Loss and Alignment
WHITENED DATA VS ANISOTROPIC DATA,0.1697054698457223,"2 = 10
5"
WHITENED DATA VS ANISOTROPIC DATA,0.17110799438990182,"2 = 10
4"
WHITENED DATA VS ANISOTROPIC DATA,0.17251051893408134,"2 = 10
3"
WHITENED DATA VS ANISOTROPIC DATA,0.17391304347826086,"2 = 10
2"
WHITENED DATA VS ANISOTROPIC DATA,0.1753155680224404,"2 = 10
1"
WHITENED DATA VS ANISOTROPIC DATA,0.1767180925666199,(b) L = 3 Dynamics
WHITENED DATA VS ANISOTROPIC DATA,0.17812061711079943,"10
2
10
1 102 103"
WHITENED DATA VS ANISOTROPIC DATA,0.17952314165497896,"t1/2, talign"
WHITENED DATA VS ANISOTROPIC DATA,0.18092566619915848,"t1/2
talign L + 2"
WHITENED DATA VS ANISOTROPIC DATA,0.182328190743338,(c) Time To Learn L = 3
WHITENED DATA VS ANISOTROPIC DATA,0.18373071528751753,"Figure 3:
(a) Time to half loss scales in a power law with σ for networks with L ≥3:
t1/2 ∼
L
(L−2)σ−L+2 (black dashed) is compared with numerically integrating the dynamics"
WHITENED DATA VS ANISOTROPIC DATA,0.18513323983169705,"˙c(t) = c2−2/L(s −c) (solid). The power law scaling of t1/2 with σ is qualitatively different than
what happens for L = 2, where we identiﬁed logarithmic scaling t1/2 ∼log(σ−2). (b) Linear
networks with D = 30 inputs and N = 50 hidden units trained on synthetic whitened data with
|β| = 1. We show for a L = 3 linear network the cosine similarity of W 1⊤W 1 with ββ⊤(dashed)
and the loss (solid) for different initialization scales. (c) The time to get to 1/2 the initial loss and
the time for the cosine similarity of W 1⊤W 1 with ββ⊤to reach 1/2 both scale as σ−L+2, however
one can see that alignment occurs before half loss is achieved."
MULTIPLE OUTPUT CHANNELS,0.18653576437587657,"4.2
MULTIPLE OUTPUT CHANNELS"
MULTIPLE OUTPUT CHANNELS,0.1879382889200561,"We next discuss the case where the network has multiple C output channels. Each network output,
we denote as fc(x′) resulting in C2 kernel sub-blocks Kc,c′(x, x′) = ∇fc(x) · ∇fc′(x′). In this
context, the balanced condition W ℓW ℓ⊤≈W ℓ+1⊤W ℓ+1 implies that each of the weight matrices
is rank-C, implying a rank-C kernel. We give an explicit formula for this kernel in Appendix H.
For concreteness, consider whitened input data Σ = I and a teacher with weights β ∈RC×D. The
singular value decomposition of the teacher weights β = P"
MULTIPLE OUTPUT CHANNELS,0.18934081346423562,"α sαzαv⊤
α determines the evolution of
each mode (Saxe et al., 2014). Each singular mode begins to be learned at tα =
1
sα log
 
sαu−2
0

.
To guarantee silent alignment, we need all of the Phase I time constants to be smaller than all of
the Phase II time constants. In the case of a two layer network, this is equivalent to the condition
1
smin ≪
1
smax log
 
smaxu−2
0

so that the kernel alignment timescales are well separated from the
timescales of spectral learning. We see that alignment precedes learning in Figure H.1 (a). For
deeper networks, as discussed in 4.1.1, alignment scales in the same way as the time for learning."
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.19074333800841514,"5
SILENT ALIGNMENT ON REAL DATA AND RELU NETS"
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.19214586255259467,"In this section, we empirically demonstrate that many of the phenomena described in the previous
sections carry over to the nonlinear homogenous networks with small initialization provided that
the data is not highly anisotropic. A similar separation in timescales is expected in the nonlinear
L-homogenous case since, early in training, the kernel evolves more quickly than the network pre-
dictions. This argument is based on a phenomenon discussed by Chizat et al. (2019). Consider an
initial scaling of the parameters by σ. We ﬁnd that the relative change in the loss compared to the
relative change in the features has the form | d"
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.1935483870967742,dt ∇f|
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.1949509116409537,"|∇f|
L
| d"
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.19635343618513323,"dt L| ≈O(σ−L) which becomes very large for
small initialization σ as we show in Appendix I. This indicates, that from small initialization, the
parameter gradients and NTK evolve much more quickly than the loss. This is a necessary, but not
sufﬁcient condition for the silent alignment effect. To guarantee the silent alignment, the gradients
must be ﬁnished evolving except for overall scale by the time the loss appreciably decreases. How-
ever, we showed that for whitened data that nonlinear ReLU networks do in fact enjoy the separation
of timescales necessary for the silent alignment effect in Figure 1. In even more realistic settings,
like ResNet in Figure 1 (d), we also see signatures of the silent alignment effect since the kernel
does not grow in magnitude until the alignment has stabilized."
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.19775596072931276,"We now explore how anisotropic data can interfere with silent alignment. We consider the partial
whitening transformation: let the singular value decomposition of the data matrix be X = USV ⊤
and construct a new partially whitened dataset Xγ = USγV ⊤, where γ ∈(0, 1). As γ →0"
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.19915848527349228,Published as a conference paper at ICLR 2022
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.2005610098176718,"the dataset becomes closer to perfectly whitened. We compute loss and kernel aligment for depth
2 ReLU MLPs on a subset of CIFAR-10 and show results in Figure 4. As γ →0 the agreement
between the ﬁnal NTK and the learned neural network function becomes much closer, since the
kernel alignment curve is stable after a smaller number of training steps. As the data becomes more
anisotropic, the kernel’s dynamics become less trivial at later time: rather than evolving only in
scale, the alignment with the target function varies in a non-trivial way while the loss is decreasing.
As a consequence, the NN function deviates from a kernel machine with the ﬁnal NTK."
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.20196353436185133,"100
101
102
103
k 10
4 10
3 10
2 10
1 100 /2
k"
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.20336605890603085,Partial Whitened Spectrum
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.20476858345021037,= 0.00
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.2061711079943899,= 0.25
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.20757363253856942,= 0.50
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.20897615708274894,= 0.75
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.21037868162692847,= 1.00
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.211781206171108,(a) Input Spectra
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.2131837307152875,"0
200
400
600
800
t 0.0 0.2 0.4 0.6 0.8 1.0 Lt Loss"
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.21458625525946703,(b) Train Loss
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.21598877980364656,"0
200
400
600
800
t 0.22 0.24 0.26 0.28 0.30 0.32 Lt"
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.21739130434782608,Classification Test Error
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.2187938288920056,(c) Test Error
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.22019635343618513,"0
200
400
600
800
t 0 200 400 600 800"
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.22159887798036465,|K(t)|
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.22300140252454417,Kernel Norm
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.2244039270687237,(d) Kernel Norm
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.22580645161290322,"0
200
400
600
800
t 0.0 0.2 0.4 0.6"
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.22720897615708274,"y, Ky /|K|"
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.22861150070126227,Kernel Alignment
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.2300140252454418,(e) Phase I alignment
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.2314165497896213,"0.0
0.2
0.4
0.6
0.8
1.0 10
5 10
3 10
1"
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.23281907433380084,"|fNN
fNTK|/|fNN|"
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.23422159887798036,"NTK Predictor vs NN K
K0"
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.23562412342215988,(f) Predictor Comparison
SILENT ALIGNMENT ON REAL DATA AND RELU NETS,0.2370266479663394,"Figure 4: Anisotropy in the data introduces multiple timescales which can interfere with the silent
alignment effect in a ReLU network. Here we train an MLP to do two-class regression using Adam
at learning rate 5 × 10−3. (a) We consider the partial whitening transformation on the 1000 CIFAR-
10 images λk →λγ
k for γ ∈(0, 1) for covariance eigenvalues Σvk = λkvk. (b) The loss dynamics
for unwhitened data have a multitude of timescales rather than a single sigmoidal learning curve. As
a consequence, kernel alignment does not happen all at once before the loss decreases and the ﬁnal
solution is not a kernel machine with the ﬁnal NTK. (c) The network’s test error on classiﬁcation. (d)
Anisotropic data gives a slower evolution in the kernel’s Frobenius norm. (e) The kernel alignment
very rapidly approaches an asymptote for whitened data but exhibits a longer timescale for the
anisotropic data. (f) The ﬁnal NTK predictor gives a better predictor for the neural network when
the data is whitened, but still substantially outperforms the initial kernel even in the anisotropic case."
CONCLUSION,0.23842917251051893,"6
CONCLUSION"
CONCLUSION,0.23983169705469845,"We provided an example of a case where neural networks can learn a kernel regression solution while
in the rich regime. Our silent alignment phenomenon requires a separation of timescales between
the evolution of the NTK’s eigenfunctions and relative eigenvalues and a separate phase where the
NTK grows only in scale. We demonstrate that, if these conditions are satisﬁed, then the ﬁnal neural
network function satisﬁes a representer theorem for the ﬁnal NTK. We show analytically that these
assumptions are realized in linear neural networks with small initialization trained on approximately
whitened data and observe that the results hold for nonlinear networks and networks with multiple
outputs. We demonstrate that silent alignment is highly sensitive to anisotropy in the input data."
CONCLUSION,0.24123422159887797,"Our results demonstrate that representation learning is not at odds with the learned neural network
function being a kernel regression solution; i.e. a superposition of a kernel function on the training
data. While we provide one mechanism for a richly trained neural network to learn a kernel regres-
sion solution through the silent alignment effect, perhaps other temporal dynamics of the NTK could
also give rise to the neural network learning a kernel machine for a data-dependent kernel. Further,
by asking whether neural networks behave as kernel machines for some data-dependent kernel, one
can hopefully shed light on their generalization and transfer learning capabilities (Bordelon et al.,
2020; Canatar et al., 2021; Loureiro et al., 2021; Geiger et al., 2021) and see Appendix F."
CONCLUSION,0.2426367461430575,Published as a conference paper at ICLR 2022
CONCLUSION,0.24403927068723702,ACKNOWLEDGMENTS
CONCLUSION,0.24544179523141654,"CP acknowledges support from the Harvard Data Science Initiative. AA acknowledges support from
an NDSEG Fellowship and a Hertz Fellowship. BB acknowledges the support of the NSF-Simons
Center for Mathematical and Statistical Analysis of Biology at Harvard (award #1764269) and the
Harvard Q-Bio Initiative. We thank Jacob Zavatone-Veth and Abdul Canatar for helpful discussions
and feedback."
REFERENCES,0.24684431977559607,REFERENCES
REFERENCES,0.2482468443197756,"Kyle Aitken and Guy Gur-Ari. On the asymptotics of wide networks with polynomial activations.
ArXiv, abs/2006.06687, 2020."
REFERENCES,0.2496493688639551,"Guillaume Alain and Yoshua Bengio.
Understanding intermediate layers using linear classiﬁer
probes. arXiv preprint arXiv:1610.01644, 2016."
REFERENCES,0.25105189340813466,"Anders Johan Andreassen and Ethan Dyer. Asymptotics of wide convolutional neural networks.
ArXiv, abs/2008.08675, 2020."
REFERENCES,0.25245441795231416,"Sanjeev Arora, Nadav Cohen, and Elad Hazan. On the optimization of deep networks: Implicit
acceleration by overparameterization. In Jennifer Dy and Andreas Krause (eds.), Proceedings of
the 35th International Conference on Machine Learning, volume 80 of Proceedings of Machine
Learning Research, pp. 244–253. PMLR, 10–15 Jul 2018. URL https://proceedings.
mlr.press/v80/arora18a.html."
REFERENCES,0.2538569424964937,"Sanjeev Arora, Simon Shaolei Du, Wei Hu, Zhiyuan Li, Ruslan Salakhutdinov, and Ruosong Wang.
On exact computation with an inﬁnitely wide neural net. In NeurIPS, 2019."
REFERENCES,0.2552594670406732,"Michael Baake and Ulrike Schlaegel. The peano-baker series. Proceedings of the Steklov Institute
of Mathematics, 275(1):155–159, 2011."
REFERENCES,0.25666199158485276,"Yu Bai, Ben Krause, Huan Wang, Caiming Xiong, and Richard Socher. Taylorized training: Towards
better approximation of neural network training at ﬁnite width, 2020."
REFERENCES,0.25806451612903225,"Aristide Baratin, Thomas George, C´esar Laurent, R. Devon Hjelm, Guillaume Lajoie, Pascal Vin-
cent, and Simon Lacoste-Julien. Implicit regularization via neural feature alignment. In AISTATS,
2021."
REFERENCES,0.2594670406732118,"Mikhail Belkin, Siyuan Ma, and Soumik Mandal. To understand deep learning we need to un-
derstand kernel learning. In Jennifer Dy and Andreas Krause (eds.), Proceedings of the 35th
International Conference on Machine Learning, volume 80 of Proceedings of Machine Learn-
ing Research, pp. 541–549. PMLR, 10–15 Jul 2018. URL https://proceedings.mlr.
press/v80/belkin18a.html."
REFERENCES,0.2608695652173913,"Blake Bordelon, Abdulkadir Canatar, and Cengiz Pehlevan. Spectrum dependent learning curves
in kernel regression and wide neural networks. In Hal Daum´e III and Aarti Singh (eds.), Pro-
ceedings of the 37th International Conference on Machine Learning, volume 119 of Proceed-
ings of Machine Learning Research, pp. 1024–1034. PMLR, 13–18 Jul 2020. URL https:
//proceedings.mlr.press/v119/bordelon20a.html."
REFERENCES,0.26227208976157085,"Roger W Brockett. Finite dimensional linear systems. SIAM, 2015."
REFERENCES,0.26367461430575034,"Abdulkadir Canatar, Blake Bordelon, and Cengiz Pehlevan. Spectral bias and task-model alignment
explain generalization in kernel regression and inﬁnitely wide neural networks. Nature Commu-
nications, 12, 2021."
REFERENCES,0.2650771388499299,"Shuxiao Chen, Hangfeng He, and Weijie J. Su. Label-aware neural tangent kernel: Toward better
generalization and local elasticity, 2020."
REFERENCES,0.2664796633941094,"L´ena¨ıc Chizat, Edouard Oyallon, and Francis R. Bach. On lazy training in differentiable program-
ming. In NeurIPS, 2019."
REFERENCES,0.26788218793828894,"Uri Cohen, SueYeon Chung, Daniel D Lee, and Haim Sompolinsky. Separability and geometry of
object manifolds in deep neural networks. Nature communications, 11(1):1–13, 2020."
REFERENCES,0.26928471248246844,Published as a conference paper at ICLR 2022
REFERENCES,0.270687237026648,"Corinna Cortes, Mehryar Mohri, and Afshin Rostamizadeh. Algorithms for learning kernels based
on centered alignment. The Journal of Machine Learning Research, 13(1):795–828, 2012."
REFERENCES,0.2720897615708275,"Pedro Domingos. Every model learned by gradient descent is approximately a kernel machine.
arXiv preprint arXiv:2012.00152, 2020."
REFERENCES,0.27349228611500703,"Simon Shaolei Du, Wei Hu, and J. Lee. Algorithmic regularization in learning deep homogeneous
models: Layers are automatically balanced. In NeurIPS, 2018."
REFERENCES,0.27489481065918653,"Ethan Dyer and Guy Gur-Ari. Asymptotics of wide networks from feynman diagrams. In Interna-
tional Conference on Learning Representations, 2020. URL https://openreview.net/
forum?id=S1gFvANKDS."
REFERENCES,0.2762973352033661,"Timo Flesch, Keno Juechems, Tsvetomira Dumbalska, Andrew Saxe, and Christopher Summerﬁeld.
Rich and lazy learning of task representations in brains and neural networks. bioRxiv, 2021.
doi: 10.1101/2021.04.23.441128. URL https://www.biorxiv.org/content/early/
2021/04/23/2021.04.23.441128."
REFERENCES,0.2776998597475456,"Stanislav Fort, Gintare Karolina Dziugaite, Mansheej Paul, Sepideh Kharaghani, Daniel M Roy, and
Surya Ganguli. Deep learning versus kernel learning: an empirical study of loss landscape geom-
etry and the time evolution of the neural tangent kernel. In H. Larochelle, M. Ranzato, R. Hadsell,
M. F. Balcan, and H. Lin (eds.), Advances in Neural Information Processing Systems, volume 33,
pp. 5850–5861. Curran Associates, Inc., 2020. URL https://proceedings.neurips.
cc/paper/2020/file/405075699f065e43581f27d67bb68478-Paper.pdf."
REFERENCES,0.2791023842917251,"Kenji Fukumizu. Effect of batch learning in multilayer neural networks. Gen, 1(04):1E–03, 1998."
REFERENCES,0.2805049088359046,"Mario Geiger, Leonardo Petrini, and Matthieu Wyart.
Landscape and training regimes in deep
learning. Physics Reports, 924:1–18, 2021. ISSN 0370-1573. doi: https://doi.org/10.1016/j.
physrep.2021.04.001. URL https://www.sciencedirect.com/science/article/
pii/S0370157321001290. Landscape and training regimes in deep learning."
REFERENCES,0.28190743338008417,"Arthur Jacot, Franck Gabriel, and Cl´ement Hongler. Neural tangent kernel: convergence and gen-
eralization in neural networks (invited paper). Proceedings of the 53rd Annual ACM SIGACT
Symposium on Theory of Computing, 2018."
REFERENCES,0.28330995792426367,"Arthur Jacot, Franc¸ois Ged, Franck Gabriel, Berﬁn S¸ims¸ek, and Cl´ement Hongler. Deep linear
networks dynamics: Low-rank biases induced by initialization scale and l2 regularization. arXiv
preprint arXiv:2106.15933, 2021."
REFERENCES,0.2847124824684432,"Diederik P Kingma and Jimmy Ba. Adam: A method for stochastic optimization. arXiv preprint
arXiv:1412.6980, 2014."
REFERENCES,0.2861150070126227,"Jaehoon Lee, Lechao Xiao, Samuel S. Schoenholz, Yasaman Bahri, Roman Novak, Jascha Sohl-
Dickstein, and Jascha Sohl-Dickstein. Wide neural networks of any depth evolve as linear models
under gradient descent. ArXiv, abs/1902.06720, 2019."
REFERENCES,0.28751753155680226,"Jaehoon Lee, Samuel S. Schoenholz, Jeffrey Pennington, Ben Adlam, Lechao Xiao, Roman Novak,
and Jascha Sohl-Dickstein. Finite versus inﬁnite neural networks: an empirical study, 2020."
REFERENCES,0.28892005610098176,"Tengyuan Liang and Alexander Rakhlin. Just interpolate: Kernel ”ridgeless” regression can gener-
alize. CoRR, abs/1808.00387, 2018. URL http://arxiv.org/abs/1808.00387."
REFERENCES,0.2903225806451613,"Chaoyue Liu, Libin Zhu, and Misha Belkin. On the linearity of large non-linear models: when
and why the tangent kernel is constant. In H. Larochelle, M. Ranzato, R. Hadsell, M. F. Bal-
can, and H. Lin (eds.), Advances in Neural Information Processing Systems, volume 33, pp.
15954–15964. Curran Associates, Inc., 2020.
URL https://proceedings.neurips.
cc/paper/2020/file/b7ae8fecf15b8b6c3c69eceae636d203-Paper.pdf."
REFERENCES,0.2917251051893408,"Bruno Loureiro, C´edric Gerbelot, Hugo Cui, Sebastian Goldt, Florent Krzakala, Marc M´ezard, and
Lenka Zdeborov´a. Capturing the learning curves of generic features maps for realistic data sets
with a teacher-student model. CoRR, abs/2102.08127, 2021. URL https://arxiv.org/
abs/2102.08127."
REFERENCES,0.29312762973352036,Published as a conference paper at ICLR 2022
REFERENCES,0.29453015427769985,"Roman Novak, Lechao Xiao, Jiri Hron, Jaehoon Lee, Alexander A. Alemi, Jascha Sohl-Dickstein,
and Samuel S. Schoenholz. Neural tangents: Fast and easy inﬁnite neural networks in python. In
International Conference on Learning Representations, 2020. URL https://openreview.
net/forum?id=SklD9yrFPS."
REFERENCES,0.2959326788218794,"Carl Edward Rasmussen and Christopher K. I. Williams. Gaussian processes for machine learning.
Adaptive computation and machine learning. MIT Press, 2006. ISBN 026218253X."
REFERENCES,0.2973352033660589,"Andrew M. Saxe, James L. McClelland, and Surya Ganguli. Exact solutions to the nonlinear dy-
namics of learning in deep linear neural network. In In International Conference on Learning
Representations, 2014."
REFERENCES,0.29873772791023845,"Bernhard Sch¨olkopf and Alexander J. Smola. Learning with kernels : support vector machines, reg-
ularization, optimization, and beyond. Adaptive computation and machine learning. MIT Press,
2002. URL http://www.worldcat.org/oclc/48970254."
REFERENCES,0.30014025245441794,"Haozhe Shan and Blake Bordelon. Rapid feature evolution accelerates learning in neural networks,
2021."
REFERENCES,0.3015427769985975,"Dominik St¨oger and Mahdi Soltanolkotabi. Small random initialization is akin to spectral learning:
Optimization and generalization guarantees for overparameterized low-rank matrix reconstruc-
tion. arXiv preprint arXiv:2106.15013, 2021."
REFERENCES,0.302945301542777,"Blake Woodworth, Suriya Gunasekar, Jason D. Lee, Edward Moroshko, Pedro Savarese, Itay Golan,
Daniel Soudry, and Nathan Srebro. Kernel and rich regimes in overparametrized models. In Jacob
Abernethy and Shivani Agarwal (eds.), Proceedings of Thirty Third Conference on Learning The-
ory, volume 125 of Proceedings of Machine Learning Research, pp. 3635–3673. PMLR, 09–12
Jul 2020. URL https://proceedings.mlr.press/v125/woodworth20a.html."
REFERENCES,0.30434782608695654,"Chulhee Yun, Shankar Krishnan, and Hossein Mobahi. A unifying view on implicit bias in training
linear neural networks. arXiv preprint arXiv:2010.02501, 2020."
REFERENCES,0.30575035063113604,"Sergey Zagoruyko and Nikos Komodakis. Wide residual networks, 2017."
REFERENCES,0.3071528751753156,"Chiyuan Zhang, Samy Bengio, Moritz Hardt, Benjamin Recht, and Oriol Vinyals. Understanding
deep learning requires rethinking generalization. In 5th International Conference on Learning
Representations, ICLR 2017, Toulon, France, April 24-26, 2017, Conference Track Proceedings.
OpenReview.net, 2017. URL https://openreview.net/forum?id=Sy8gdB9xx."
REFERENCES,0.3085553997194951,Published as a conference paper at ICLR 2022
REFERENCES,0.30995792426367463,Appendix
REFERENCES,0.31136044880785413,"A
DERIVATION OF EQUATION 2"
REFERENCES,0.3127629733520337,"A.1
TRAINING POINT PREDICTIONS WITH TIME VARYING KERNEL"
REFERENCES,0.3141654978962132,"Given a training set of P data points {(xµ, yµ)}P
µ=1, the dynamics of the network training er-
rors [∆t]µ := f(xµ, t) −yµ close in terms of a time-varying neural tangent kernel [Kt]µν =
K(xµ, xν, t)"
REFERENCES,0.3155680224403927,"d
dt∆t = −Kt∆t.
(11)"
REFERENCES,0.3169705469845722,"We introduce the transition matrix Φt ∈RP ×P which has the property that ∆t = Φt∆0 and
Φ0 = I, we obtain the matrix evolution equation ˙Φt = −KtΦt. This equation can be solved
formally in terms of the Peano-Baker series (Baake & Schlaegel, 2011; Brockett, 2015)"
REFERENCES,0.31837307152875177,"Φt =I −
Z t"
REFERENCES,0.31977559607293127,"0
ds1Ks1 +
Z t"
REFERENCES,0.3211781206171108,"0
ds1Ks1 Z s1"
REFERENCES,0.3225806451612903,"0
ds2Ks2
(12) −
Z t"
REFERENCES,0.32398316970546986,"0
ds1Ks1 Z s1"
REFERENCES,0.32538569424964936,"0
ds2Ks2 Z s2"
REFERENCES,0.3267882187938289,"0
ds3Ks3 + ...
(13)"
REFERENCES,0.3281907433380084,which can easily be veriﬁed to solve d
REFERENCES,0.32959326788218796,"dtΦ(t) = −K(t)Φ(t) with initial condition Φ(0) = I. Under
the condition that
R t
0 K(t) commutes with K(t), which is true in the settings of interest in this
paper, speciﬁcally the setting discussed in Appendix B, we can simplify the Peano-Baker series into
a simple matrix exponential"
REFERENCES,0.33099579242636745,"Φt = I −
Z t"
DSKS,0.332398316970547,"0
dsKs 
+ 1 2 Z t"
DSKS,0.3338008415147265,"0
dsKs 2
−1 6 Z t"
DSKS,0.33520336605890605,"0
dsKs"
DSKS,0.33660589060308554,"3
... + (−1)k k! Z t"
DSKS,0.3380084151472651,"0
dsKs"
DSKS,0.3394109396914446,"k
+ ..."
DSKS,0.34081346423562414,"= exp

−
Z t"
KSDS,0.34221598877980364,"0
Ksds

.
(14)"
KSDS,0.3436185133239832,"Thus, under the condition that Kt commutes with
R t
0 Ksds we can exactly solve for the training
error dynamics in terms of integrating factors"
KSDS,0.3450210378681627,"∆t = Φt∆0 = exp

−
Z t"
KSDS,0.34642356241234223,"0
Ksds

∆0.
(15)"
KSDS,0.34782608695652173,"We expect this formula to hold approximately whenever the eigenvectors of K are approximately
equal to the eigenvectors of
R t
0 Ksds."
KSDS,0.3492286115007013,"A.2
TEST POINT PREDICTIONS WITH TIME VARYING KERNEL"
KSDS,0.3506311360448808,"Given access to the value of the function on training points, one can evaluate the function on test
points. We have that the evolution of the function on a test point f(x) is given by"
KSDS,0.3520336605890603,"d
dtft(x) = −kt(x)∆t,
(16)"
KSDS,0.3534361851332398,"where [kt(x)]µ := K(x, xµ, t). This gives the ﬁnal value of f to be"
KSDS,0.3548387096774194,"f ∗(x) := f∞(x) = f0(x) +
Z ∞"
KSDS,0.35624123422159887,"0
dt kt(x)µ

exp

−η
Z t"
KSDS,0.3576437587657784,"0
Kt′dt′

(y −f0).
(17)"
KSDS,0.3590462833099579,This is exactly equation 2.
KSDS,0.36044880785413747,Published as a conference paper at ICLR 2022
KSDS,0.36185133239831696,"B
KERNEL EVOLUTION IN SCALE ONLY"
KSDS,0.3632538569424965,"We consider the model of kernel evolution introduced in Section 2 where the kernel evolves only in
scale for t > τ(ϵ) and is of small overall size for t < τ(ϵ),"
KSDS,0.364656381486676,"K(x, x′, t) =
ϵK0(x, x′, t)
t ≤τ(ϵ)
g(t)K∞(x, x′)
t > τ(ϵ) .
(18)"
KSDS,0.36605890603085556,"This model allows for alignment of the kernel while small in the time window t ∈(0, τ), followed
by scale growth only for t ∈(τ, ∞). The time threshold τ will generally depend on the initial kernel
scale ϵ. For example, in depth L linear MLPs, ϵ ∼σ2L−2 and τ ∼σ−L+2 with initialization scale
σ as we show in Figure E.3. We will deﬁne a differentiable function h(t) =
R t
τ g(t′)dt′ so that
h′(t) = g(t), h(τ) = 0, and limt→∞h(t) = ∞. This last condition follows from g’s continuity
and the assumption that limt→∞g(t) = 1. We will ﬁrst show that the ﬁnal neural network has the
form f(x) = f0(x) + k∞(x) · K−1
∞(y −f0) + O(ϵτ(ϵ)). First, we need to calculate the errors
∆(t) = y −f(t) ∈RP made on the P training examples. These satisfy the dynamics"
KSDS,0.36746143057503505,"d
dt∆(t) = −
ϵK0(t)∆(t)
t ≤τ
h′(t)K∞∆(t)
t > τ ,
(19)"
KSDS,0.3688639551192146,"where K0(t), K∞∈RP ×P are P × P gram matrices; e.g. [K0(t)]µν = K0(xµ, xν, t). The
vector k(x) has entries given by [k(x)]µ = K(x, xµ). For t ∈(0, τ), the error vector follows the
dynamics
d
dt∆(t) = −ϵK0(t)∆(t).
(20)"
KSDS,0.3702664796633941,"Introducing operator norm of a matrix, |Φ|op = max|v|2=1 |Φv|2, we will now bound the operator
norm of the change in the transition matrix Φ(t) introduced in section A.1.
Lemma 1. Let k0 = maxt∈(0,τ) |K0(t)|op represent the maximum operator norm of K0 achieved
on the interval (0, τ). Let Φ(t) ∈RP ×P be the transition matrix for the linear dynamics of equation
(20) so that d"
KSDS,0.37166900420757365,"dtΦ(t) = −ϵK0(t)Φ(t) and Φ(0) = I. Then,"
KSDS,0.37307152875175315,"|Φ(τ) −Φ(0)|op < ϵτ(ϵ)k0.
(21)"
KSDS,0.3744740532959327,"Proof. We begin by noting that, due to the triangle inequality,"
KSDS,0.3758765778401122,|Φ(τ) −Φ(0)|op = ϵ Z τ
KSDS,0.37727910238429174,"0
K0(t)Φ(t)dt

op
≤ϵ
Z τ"
KSDS,0.37868162692847124,"0
|K0(t)Φ(t)|op dt"
KSDS,0.3800841514726508,"≤ϵ
Z τ"
KSDS,0.3814866760168303,"0
|K0(t)| |Φ(t)|op dt ≤ϵk0 Z τ"
KSDS,0.38288920056100983,"0
|Φ(t)|op dt.
(22)"
KSDS,0.38429172510518933,We will now establish that |Φ(t)|op ≤1. Note that for any vector v ∈RP that
KSDS,0.3856942496493689,"1
2
d
dt|Φ(t)v|2
2 = v⊤Φ⊤˙Φ(t)v = −ϵv⊤Φ(t)⊤K(t)Φ(t)v ≤0,
(23)"
KSDS,0.3870967741935484,"where the ﬁnal inequality follows from the fact that K(t) is positive semideﬁnite for all t. Therefore
we have shown that |Φ(t)|op ≤|Φ(0)|op = |I|op = 1. Using this inequality, we ﬁnd that"
KSDS,0.3884992987377279,|Φ(τ) −Φ(0)|op ≤ϵk0 Z τ
KSDS,0.3899018232819074,"0
|Φ(t)|op dt ≤ϵk0τ(ϵ).
(24)"
KSDS,0.391304347826087,"With the above Lemma 1, we can bound the discrepancy ∆(τ) and ∆(0), namely"
KSDS,0.39270687237026647,"|∆(τ) −∆(0)|2 = |(Φ(τ) −Φ(0))∆(0)|2
≤|Φ(τ) −Φ(0)|op|∆(0)|2 ≤ϵk0τ(ϵ)|∆(0)|2.
(25)"
KSDS,0.394109396914446,"This inequality must therefore hold entry-wise as well, so that"
KSDS,0.3955119214586255,"∆(τ) = ∆(0) + O(ϵk0τ(ϵ)).
(26)"
KSDS,0.39691444600280507,"We will now establish how the training predictions ∆(t) evolve for the second interval t ∈(τ, ∞)."
KSDS,0.39831697054698456,Published as a conference paper at ICLR 2022
KSDS,0.3997194950911641,"Lemma 2. Suppose that from t ∈(τ, ∞) that ∆(t) obeys the dynamics d"
KSDS,0.4011220196353436,"dt∆(t) = −h′(t)K∞∆(t)
where ∆(τ) is as in equation 26. Then, for all t ∈(τ, ∞),"
KSDS,0.40252454417952316,"∆(t) = exp (−h(t)K∞) [(y −f0) + O(ϵτ(ϵ)k0)] .
(27)"
KSDS,0.40392706872370265,"Proof. The differential equation can be solved through eigendecomposition and integrating factors.
Let ∆k(t) represent the k-th component of ∆(t) in the eigenbasis of K∞which is static for t ∈
(τ, ∞). Let the corresponding eigenvalue of K∞be λk. The scalar variable ∆k(t) obeys the
dynamics"
KSDS,0.4053295932678822,"d
dt∆k(t) = −λkh′(t)∆k(t).
(28)"
KSDS,0.4067321178120617,"This can be solved with integrating factors, noting that
d
dt

eλkh(t)∆k(t)

= 0. This implies that
∆k(t) = e−λkh(t)∆k(τ). Written as a vector, ∆(t) = exp (−h(t)K∞) ∆(τ). Since by Lemma 1
we have ∆(τ) = ∆(0) + O(ϵk0τ(ϵ)), we obtain the desired result."
KSDS,0.40813464235624125,"We will now combine the results of the previous two lemmas which analyze the evolution of the
network predictions on the training set to give our main silent alignment result, which speciﬁes what
the neural network function predicts for an arbitrary test point x."
KSDS,0.40953716690042075,"Theorem 1. Let the kernel have dynamics of Equation 18 where g(t) is a continuous, integrable
function with limt→∞g(t) = 1. The function learned by the neural network is"
KSDS,0.4109396914446003,"f(x) −f0(x) = k∞(x) · K−1
∞y + Oϵ(ϵτ(ϵ)).
(29)"
KSDS,0.4123422159887798,"Proof. Using Lemma 1 and 2, we know the full dynamics for training predictions ∆(t). Using
∆(t), we can solve for the ﬁnal predictor f(x) by integrating dynamics ˙f(x, t) = k(x, t) · ∆(t)."
KSDS,0.41374474053295934,"f(x) −f0(x) = ϵ
Z τ"
KSDS,0.41514726507713884,"0
k0(x, t) · ∆(t)dt + k∞(x) ·
Z ∞"
KSDS,0.4165497896213184,"τ
h′(t) exp (−h(t)K∞) ∆(τ)dt
(30)"
KSDS,0.4179523141654979,"We will now bound the ﬁrst term. Taking ˜k0 = maxt∈(0,τ),x∈RD |k0(x, t)|2, we get that
ϵ
Z τ"
KSDS,0.41935483870967744,"0
k0(x, t) · ∆(t)
 ≤ϵ
Z τ"
KSDS,0.42075736325385693,"0
|k(x)||∆(t)|dt ≤ϵ(1 + ϵτ(ϵ)k0)|∆0|
Z τ"
KSDS,0.4221598877980365,"0
|k0(x, t)|dt"
KSDS,0.423562412342216,≤ϵτ(ϵ)˜k0(1 + ϵτ(ϵ)k0)|∆(0)| = Oϵ(ϵτ(ϵ)).
KSDS,0.42496493688639553,"We can now integrate the matrix exponential in the second term, using the fact that
Z ∞"
KSDS,0.426367461430575,"τ
h′(t) exp (−h(t)K∞) dt =
Z ∞"
KSDS,0.4277699859747546,"0
exp (−hK∞) dh = K−1
∞.
(31)"
KSDS,0.42917251051893407,"Using the fact that ∆(τ) = ∆(0) + O(τ(ϵ)ϵ) from Lemma 1, we arrive at the desired result"
KSDS,0.4305750350631136,"f(x) −f0(x) = k∞(x)K−1
∞∆0 + Oϵ(ϵτ(ϵ)).
(32)"
KSDS,0.4319775596072931,"We have now established that, given the kernel dynamics in Equation 18, f(x) −f0(x) converges
to the kernel regression solution with ﬁnal NTK as ϵ →0 provided limϵ→0 ϵτ(ϵ) = 0. This is
generic in the settings we consider in this paper for networks with small initialization. In this small
initialization setting, f0 is also negligible so that f(x) itself is a kernel regression solution. For
example, in a linear depth L neural network with initial weight scale σ, the initial scale of the kernel
is ϵ ∼σ2L−2 while the time to alignment scales as τ ∼σ2−L thus ϵτ ∼σL can be made arbitrarily
small by taking σ →0. Lastly, the initial network outputs f0(x) ∼σL can also be made arbitrarily
small."
KSDS,0.43338008415147267,Published as a conference paper at ICLR 2022
KSDS,0.43478260869565216,"C
PHASES OF LEARNING AT SMALL INITIALIZATION"
KSDS,0.4361851332398317,"C.1
PHASE I: TWO LAYER NETWORK AND KERNEL ALIGNMENT"
KSDS,0.4375876577840112,"We now present an analysis distinct from that of the previous subsection to go beyond the ﬁrst step
of gradient descent. The NTK for the two layer linear network has the form K = x⊤Mx′ with
M = W ⊤W + |a|2I. Our goal is to determine the eigendecomposition of M. Introduce the
variables q(t) = 1"
KSDS,0.43899018232819076,2β⊤Mβ = 1
KSDS,0.44039270687237025,"2

|a|2 + β⊤W ⊤W β

and r(t) = a⊤W β. These dynamics form
a closed two dimensional linear system early in training d
dt"
KSDS,0.4417952314165498,"
q(t)
r(t)"
KSDS,0.4431977559607293,"
= 2ηs

0
1
1
0"
KSDS,0.44460028050490885," 
q(t)
r(t)"
KSDS,0.44600280504908835,"
+ O(σ3) ,
t, σ →0"
KSDS,0.4474053295932679,"=⇒

q(t)
r(t) 
= 1"
KSDS,0.4488078541374474,"2(q0 + r0)

1
1"
KSDS,0.45021037868162694,"
e2ηst + 1"
KSDS,0.45161290322580644,"2(q0 −r0)

1
−1"
KSDS,0.453015427769986,"
e−2ηst + O(σ3)
(33)"
KSDS,0.4544179523141655,"The variable q(t) represents the alignment of the NTK with the optimal direction β while r(t)
deﬁnes the alignment of the network with the teacher. We see that this alignment increases expo-
nentially with timescale t ∼η−1s−1. While the above equations hold for early time and small
initialization for any initial condition q0, r0, we can further estimate these initial values under
random initialization provided the input dimension is large. We stress that this limit is not nec-
essary for the silent alignment, but allows for a nice simpliﬁcation. For Gaussian initialization
ai ∼N(0, σ2/N), Wij ∼N(0, σ2/D) with large D, we have"
KSDS,0.45582047685834504,⟨q0⟩= σ2 2
KSDS,0.45722300140252453,"
1 + N D"
KSDS,0.4586255259467041,"
, ⟨r0⟩= 0 ,

r2
0

= σ4"
KSDS,0.4600280504908836,"D .
(34)"
KSDS,0.46143057503506313,"In the large D limit, we have with high probability q0 ≫r0 and thus r(t) = q0 sinh(2ηst) and
q = q0 cosh(2ηst). Note that this gives the quantities q(t) = 1"
KSDS,0.4628330995792426,"2β⊤M(t)β, r(t) = β⊤W ⊤a early
in training. Now consider a unit vector v which is orthogonal to the solution β⊤v = 0. We ﬁnd that
the projection of M along this direction evolves dynamically as:"
KSDS,0.4642356241234222,"d
dtv⊤M(t)v = 2v⊤
βa⊤W + β⊤W ⊤aI

v"
KSDS,0.46563814866760167,"= 2r(t).
(35)"
KSDS,0.4670406732117812,"We can conclude that v⊤Mv is equal to q(t) up to an additive initialization constant. We see that
this is evolving half as quickly as β⊤Mβ = 2q(t). Since v⊤M0v ∼O(σ2) is small compared to
the exponentially growing M(t), the only matrix that satisﬁes these two conditions must necessarily
take the form"
KSDS,0.4684431977559607,"M(t) = q0 cosh(2ηst)

ββ⊤+ I

+ M0.
(36)"
KSDS,0.46984572230014027,"The ﬁrst term, which is growing exponentially in t will eventually overwhelm the randomly initial-
ized kernel M0, which is O(σ2)."
KSDS,0.47124824684431976,"C.2
PHASE I: ERROR IN THE LEADING ORDER APPROXIMATION"
KSDS,0.4726507713884993,"In solving the equations of the previous section, we truncated the full gradient descent equations at
order σ3. It is important to conﬁrm that the error generated by this truncation remains bounded. We
will argue by self-consistency. The full equations are"
KSDS,0.4740532959326788,"d
dta = W
 
sβ −W ⊤a

,
d
dtW = a
 
sβ −W ⊤a
⊤.
(37)"
KSDS,0.47545582047685836,"One can use these equations to solve for the dynamics of the r, q variables:"
KSDS,0.47685834502103785,"d
dtq(t) = 2sr −β⊤
W ⊤aa⊤W + a⊤W W ⊤a

β = 2sr −[2r2 +
X"
KSDS,0.4782608695652174,"vi⊥β
(a⊤W vi)2]
(38)"
KSDS,0.4796633941093969,"d
dtr(t) = 2sq −a⊤[W W ⊤+ aa⊤]W β = 2sq −2|a|2r + a⊤[aa⊤−W W ⊤]W β
(39)"
KSDS,0.48106591865357645,Published as a conference paper at ICLR 2022
KSDS,0.48246844319775595,"The second equality in equation 38 comes from inserting a complete basis of states including β and
vi ⊥β into the last term of the left-hand side. The second equality in equation 39 comes from
writing W W ⊤+ aa⊤= 2aa⊤+ (W W ⊤−aa⊤). Note that the ﬁnal term in brackets on the
right hand side is a conserved quantity for linear networks, and so is always of order O(σ2)."
KSDS,0.4838709677419355,"Assuming the solutions for q, r are valid to order σ2, we get that d"
KSDS,0.485273492286115,"dta⊤W vi = O(σ4).
d
dta⊤W vi = (β −ˆβ)⊤W ⊤W vi + |a|2(β −ˆβ)⊤vi
(40)"
KSDS,0.48667601683029454,"Further noting that because of the conservation law aa⊤−W W ⊤= O(σ2) is also constant in
time. This gives us that
|a⊤[aa⊤−W W ⊤]W β| ≤σ2|a⊤W β| = σ2r.
(41)
We now note that r, |a|2 both grow as a (σ, s-independent) constant times times σ2e2st. The correc-
tion to the dynamics of both equations is then bounded by a constant times σ4e4st. This will be less
than σ2 as long as t satisﬁes t ≪1"
S LOG,0.48807854137447404,"4s log
 s σ2"
S LOG,0.4894810659186536,"
.
(42)"
S LOG,0.4908835904628331,"For σ2 ≪s, the alignment time t = 1/s falls within this range and we are guaranteed alignment to
the Ganguli-Saxe conﬁguration."
S LOG,0.49228611500701264,"The error of the full solution at time t can be bounded by the integral of this error bound from 0 to
t, namely a constant times σ4/s. As long as s ≫σ4, we are guaranteed that the error of the kernel
is O(σ2) as given in equation 7."
S LOG,0.49368863955119213,"C.3
PHASE I: TWO LAYER ANALYSIS WITH UNWHITENED DATA"
S LOG,0.4950911640953717,"We now study the same linearization around the initial ﬁxed point used in the main text but for the
two layer network with unwhitened data. In this case,
d
dta ∼sW Σβ,
(43)"
S LOG,0.4964936886395512,"d
dtW ∼saβ⊤Σ.
(44)"
S LOG,0.49789621318373073,"which holds asymptotically as t/ log(σ−1) →0. We introduce the following variables which form
a closed linear dynamical system
r1(t) = β⊤W ⊤a,"
S LOG,0.4992987377279102,"r2(t) = |a|2,"
S LOG,0.5007012622720898,"r3(t) = β⊤W ⊤W Σβ,"
S LOG,0.5021037868162693,"r4(t) = β⊤ΣW ⊤a,"
S LOG,0.5035063113604488,r5(t) = β⊤ΣW ⊤W Σβ. (45)
S LOG,0.5049088359046283,"Introduce the constants a = β⊤Σβ , b = β⊤Σ2β. Using the weight dynamics, it is straightforward
to show that"
S LOG,0.5063113604488079,˙r(t) ∼s  
A,0.5077138849929874,"0
a
1
0
0
0
0
0
2
0
b
0
0
a
0
0
b
0
0
1
0
0
0
2b
0 "
A,0.5091164095371669,"r(t) , t ≪log(σ−2).
(46)"
A,0.5105189340813464,"This matrix has eigenvalues λ ∈{0, −
√ b,
√"
A,0.511921458625526,"b, −2
√"
A,0.5133239831697055,"b, 2
√"
A,0.514726507713885,"b}. Since there are only two positive
eigenvalues
√"
A,0.5161290322580645,"b, 2
√"
A,0.517531556802244,"b, it sufﬁces to consider evolution along those two eigendirections, where the
kernel and neural network function will be ampliﬁed. Evolution along these direcions give"
A,0.5189340813464236,"r(t) ∼c1es
√ bt   1
0
√ b
0
0 "
A,0.520336605890603,"+ c2e2s
√ bt   a
√ b
a
√"
A,0.5217391304347826,"b
b
b
√ b "
A,0.5231416549789621,"
,
(47)"
A,0.5245441795231417,Published as a conference paper at ICLR 2022 1 2 t = 0
A,0.5259467040673211,"(a) Initialization 1 2 t
t1"
A,0.5273492286115007,(b) Transition Time 1 2 t
A,0.5287517531556802,(c) Min ℓ2 norm solution
A,0.5301542776998598,"Figure C.1: Kernel evolution on anisotropic data consists of two alignment phases. (a) At ini-
tialization the level curves of β⊤M −1β exhibit spherical symmetry. (b) After the initial phase I
alignment, the matrix M exhibits a spike in the Σβ direction. (c) At long times, the network func-
tion and kernel’s spiked direction need to converge to the minimum ℓ2 norm solution as we explain
in G.1. This requires realignment of the kernel at late times, eliminating the preconditions for the
silent alignment effect."
A,0.5315568022440392,"where c1, c2 are constants determined by intialization. At large time, the large eigenvalue mode
λ = 2
√"
A,0.5329593267882188,"b will dominate. Decomposing W = W0 + a(t) [v1(t)β + v2(t)Σβ]⊤we ﬁnd that the
only self consistent solution is v1(t) = 0, v2(t) = b−1/2. This implies that the kernel evolution will
take the form
K(x, x′, t) ∼K(x, x′, 0) + |a(t)|2x⊤Mx′, M = ""
1
p"
A,0.5343618513323983,"β⊤Σ2β
Σββ⊤Σ + I #"
A,0.5357643758765779,".
(48)"
A,0.5371669004207573,"We see that the kernel evolves along the directions Σβ early in training for unwhitened data. We
visualize the two stages of learning for unwhitened data in Figure C.1."
A,0.5385694249649369,"C.4
PHASE II: WHITENED DATA"
A,0.5399719495091164,"Consider a two layer network f = a⊤W x where balance has been achieved W = u(t)ˆaβ⊤and
a(t) = u(t)ˆa. Once this balance condition is stable for ﬁxed ˆa, we can calculate the time derivative
of u(t)"
A,0.541374474053296,"d
dta(t) = ˙u(t)ˆa = u(t)

s −u(t)2
ˆa.
(49)"
A,0.5427769985974754,"Letting c(t) = u(t)2, we ﬁnd that ˙c(t) = 2u(t)2 
s −u(t)2
= 2c(t) [s −c(t)], which is the two
layer dynamics derived in Saxe et al. (2014). This dynamics has solution c(t) =
se2st
e2st−1+s/c0 ."
A,0.544179523141655,"C.5
SOLUTIONS TO THE FULL TRAINING DYNAMICS OF LINEAR NETWORKS AT SMALL
INITIALIZATION"
A,0.5455820476858345,"By combining the analyses of the subsection C.1 with the exact solutions discussed in C.4 we can
match both solutions to obtain formulas for r(t) and q(t) for the entire network’s training path that
are exact up to O(σ2) corrections. Up to O(σ2) we then have that"
A,0.5469845722300141,"r(t) = s
2 sinh(2st)
(e2st −1) + 2s/q0
,
(50)"
A,0.5483870967741935,"q(t) = s
2 cosh(2st)
(e2st −1) + 2s/q0
.
(51)"
A,0.5497896213183731,"This yields that the initialization constant q0/2 plays the effective role of c0 in the Ganguli-Saxe
solution for phase II. Equation 34 yields the expected value of this initialization constant. We have"
A,0.5511921458625526,Published as a conference paper at ICLR 2022
A,0.5525946704067322,"0
500
1000
1500
2000
t 0.0 0.2 0.4 0.6 0.8 1.0 Lt"
A,0.5539971949509116,"= 10
5"
A,0.5553997194950911,"= 10
4"
A,0.5568022440392707,"= 10
3"
A,0.5582047685834503,"= 10
2"
A,0.5596072931276297,(a) Loss Dynamics
A,0.5610098176718092,"10
5
10
4
10
3
10
2
2 400 600 800 1000 1200 t1/2"
A,0.5624123422159888,Experiment
LN,0.5638148667601683,"1 ln
2"
LN,0.5652173913043478,(b) Time to Lt = 0.5
LN,0.5666199158485273,"0
500
1000
1500
2000
t 0.0 0.2 0.4 0.6 0.8 1.0"
LN,0.5680224403927069,Kernel and Loss
LN,0.5694249649368864,"Lt
|K(t)|"
LN,0.5708274894810659,Alignment
LN,0.5722300140252454,(c) Alignment σ = 10−4.
LN,0.573632538569425,"Figure C.2: Initialization scale controls the time spent in phase I, where the network escapes the
saddle point near W , a = 0 and the kernel aligns to the task. (a) The loss curves for two-layer
linear networks with small initialization follow sigmoidal trajectories as in Saxe et al. (2014) which
transition from their maximum to minimum at a time which decreases with initialization scale.
Theory is shown in black dashed lines. (b) Veriﬁcation of the Phase I time t1/2, measured as the
time for the loss to reach one half its original value. This scales logarithmically with σ2. (c) The
alignment of the kernel eigenfunctions happens before the loss appreciably decreases for σ = 10−4,
evidenced by the kernel alignment curve. The analytically obtained maximum alignment value is
overlayed in dashed green."
LN,0.5750350631136045,"empirically veriﬁed that these exact equations hold to high accuracy across a variety network sizes,
initialization scales, and whitened datasets. We illustrate some of these in ﬁgure C.3."
LN,0.576437587657784,"0
200
400
600
800
t 10
4 10
3 10
2 10
1 100"
LN,0.5778401122019635,Exact vs Analytic Solutions
LN,0.5792426367461431,q(t) empirical
LN,0.5806451612903226,q(t) analytic
LN,0.5820476858345021,r(t) empirical
LN,0.5834502103786816,r(t) analytic
LN,0.5848527349228612,(a) Synthetic
LN,0.5862552594670407,"0
20
40
60
80
100
t 10
3 10
1 101"
LN,0.5876577840112202,Exact vs Analytic Solutions
LN,0.5890603085553997,q(t) empirical
LN,0.5904628330995793,q(t) analytic
LN,0.5918653576437588,r(t) empirical
LN,0.5932678821879382,r(t) analytic
LN,0.5946704067321178,(b) Whitened MNIST
LN,0.5960729312762973,"Figure C.3: Overlay of empirical and exact solutions for q(t), r(t) in two layer linear feedforward
networks for synthetic and two-class MNIST whitened datasets. (a) We take D = 25, N = 10. (b)
We take D = 784, N = 100."
LN,0.5974754558204769,"D
BALANCING OF WEIGHTS IN DEEP LINEAR NETWORKS"
LN,0.5988779803646563,"The balance condition discussed in the main text holds for deep linear trained with any loss function
of the form L = P"
LN,0.6002805049088359,"µ ℓ(f µ, yµ) (not just MSE) since, as was shown by Arora et al. (2018); Du et al.
(2018)"
LN,0.6016830294530154,"1
η
d
dt
 
W ℓW ℓ⊤
=
X µ"
LN,0.603085553997195,"∂ℓ
∂f µ"
LN,0.6044880785413744,"""
∂f µ"
LN,0.605890603085554,"∂W ℓW ℓ⊤+ W ℓ∂f µ ∂W ℓ ⊤# =
X µ"
LN,0.6072931276297335,"∂ℓ
∂f µ"
LN,0.6086956521739131,"""
∂f µ"
LN,0.6100981767180925,∂W ℓ+1
LN,0.6115007012622721,"⊤
W ℓ+1 + W ℓ+1⊤
∂f µ"
LN,0.6129032258064516,∂W ℓ+1 # = 1
LN,0.6143057503506312,"η
d
dt
 
W ℓ+1⊤W ℓ+1
. (52)"
LN,0.6157082748948106,Published as a conference paper at ICLR 2022
LN,0.6171107994389902,The second line follows from the ﬁrst since the following quantities are identical ∂f µ
LN,0.6185133239831697,"∂W ℓW ℓ⊤= W ℓ+1⊤...W L−1⊤wL  
xµ⊤W 1⊤...W ℓ−1⊤
W ℓ⊤,
(53)"
LN,0.6199158485273493,"W ℓ+1⊤
∂f µ"
LN,0.6213183730715287,"∂W ℓ+1 = W ℓ+1⊤ 
W ℓ⊤...wL
xµ⊤W 1⊤...W ℓ⊤.
(54)"
LN,0.6227208976157083,"By inspection these two quantities are equal. Thus we have, for any loss function, a deep linear
network has the following conservation laws"
LN,0.6241234221598878,"d
dt

W ℓW ℓ⊤−W ℓ+1⊤W ℓ+1
= 0.
(55)"
LN,0.6255259467040674,"We show in the next section that this balancing condition is very helpful in identifying the time
evolution of the neural tangent kernel. In the case where the network has a single output, we can
inductively prove that each layer’s weight matrix is W ℓ= u(t)rℓ+1(t)rℓ(t)⊤. We will assume this
formula is true for layer ℓ+ 1 and prove it must hold for layer ℓsince"
LN,0.6269284712482468,"W ℓW ℓ⊤= W ℓ+1⊤W ℓ+1 = u(t)2rℓ+1(t)rℓ+1(t)⊤.
(56)"
LN,0.6283309957924264,"This implies that W ℓis rank one with right singular vector equal to rℓ+1(t). Thus, the decomposi-
tion for each layer the form W ℓ= u(t)rℓ+1(t)rℓ(t)⊤for some unit vector rℓ(t). Similar analysis
can be performed for the multi-class setting."
LN,0.6297335203366059,"E
NTK FORMULA FOR DEEP LINEAR NETWORKS"
LN,0.6311360448807855,"The neural tangent kernel for a linear network f(x) = wL⊤W L−1...W 1x is deﬁned as an inner-
product over all gradients"
LN,0.6325385694249649,"K(x, x′) = L
X ℓ=1 ∂f(x)"
LN,0.6339410939691444,"∂W ℓ, ∂f(x′) ∂W ℓ  =  L
Y"
LN,0.635343618513324,"ℓ=2
W ℓ 2"
LN,0.6367461430575035,"x · x′ + L
X ℓ=2  Y"
LN,0.638148667601683,"ℓ′>ℓ
W ℓ′ 2"
LN,0.6395511921458625,x⊤W 1⊤...W ℓ−1⊤W ℓ−1...W 1x′. (57)
LN,0.6409537166900421,"Under the balanced assumption that W ℓ= u(t)rℓ+1(t)rℓ(t)⊤+ O(σ), expanding the kernel to
leading order in σ yields the following form:"
LN,0.6423562412342216,"K(x, x′) = u(t)2L−2x⊤
(L −1)I + r1(t)r1(t)⊤
x′ + O(σ),
(58)"
LN,0.6437587657784011,"100
101
102
103
t 0.0 0.2 0.4 0.6 0.8 1.0 Loss"
LN,0.6451612903225806,"L = 2
L = 3
L = 4
L = 5"
LN,0.6465638148667602,"100
101
102
103
t 0.2 0.4 0.6"
LN,0.6479663394109397,Kernel Alignment
LN,0.6493688639551192,"L = 2
L = 3
L = 4
L = 5"
LN,0.6507713884992987,"100
101
102
103
t 0.2 0.4 0.6 0.8 1.0"
LN,0.6521739130434783,W1 Alignment
LN,0.6535764375876578,"L = 2
L = 3
L = 4
L = 5"
LN,0.6549789621318373,"Figure E.1: The depth dependence of loss dynamics, kernel alignment and the alignment of ﬁrst layer
weights in a linear network on synthetic whitened data in D = 30 dimensions. (a) The loss reaches
half its initial value after t ∼σ−L+2 steps for L > 2. The decay rate of the loss becomes sharper
with depth. (b) Final kernel alignment increases monotonically with depth L and approaches 1 as
L →∞. (c) The alignment of the ﬁrst layer weights W1 with the optimal direction β approaches 1
for all models."
LN,0.6563814866760168,Published as a conference paper at ICLR 2022
LN,0.6577840112201964,"100
101
102
103
t 0.0 0.2 0.4 0.6 0.8 1.0 Loss"
LN,0.6591865357643759,"L = 2
L = 3
L = 4
L = 5"
LN,0.6605890603085554,(a) Loss
LN,0.6619915848527349,"102
103
t 0.00 0.02 0.04 0.06 0.08"
LN,0.6633941093969145,Alignment
LN,0.664796633941094,(b) Alignment
LN,0.6661991584852734,"1.5
2.0
2.5
3.0
3.5
4.0
4.5
5.0
5.5
ReLU MLP Depth 0.00 0.05 0.10 0.15 0.20 0.25"
LN,0.667601683029453,"|fNTK
fNN|/|fNN| K0
K"
LN,0.6690042075736325,(c) Test Comparison
LN,0.6704067321178121,"Figure E.2: ReLU networks across depths trained on two-class whitened CIFAR. The hidden widths
are all of size 100. We use 3k train points and 7k test points. (a) The loss exhibits the same scaling as
σ−L+2 as in the linear setting. (b) Deep networks with nonlinearities are seen to undergo the silent
alignment effect early on in training. The dashed lines indicate when the kernel has grown to 10%
of its ﬁnal value. (c) The trained network outputs on test data match closely the kernel regression
with the ﬁnal learned kernel, but do not match regression the initial kernel."
LN,0.6718092566619915,"E.1
DEEP LINEAR NETWORK DYNAMICS UNDER BALANCE"
LN,0.6732117812061711,"In this section, we will consider the dynamics of the variable u once the balance condition is satisﬁed.
Let wL = ˆ
wu(t). Then the dynamics for u(t) under the balancing assumption is"
LN,0.6746143057503506,"d
dtwL = ˆ
w d"
LN,0.6760168302945302,"dtu(t) = L−1
Y"
LN,0.6774193548387096,"ℓ=1
W ℓ
!"
LN,0.6788218793828892,"(s −u(t)L) L−1
Y"
LN,0.6802244039270687,"ℓ=1
W ℓβ = u(t)2L−2(s −u(t)L) ˆ
w,
(59)"
LN,0.6816269284712483,which implies the fact ˙u(t) = u(t)L−1(s −u(t)L). Changing variables to c(t) = u(t)L we obtain
LN,0.6830294530154277,"˙c(t) = u(t)L−1 ˙u = u(t)2L−2(s −u(t)L) = c(t)2−2/L(s −c(t)).
(60)"
LN,0.6844319775596073,"When cL
0 is initialized to a very small value compared to s we can"
LN,0.6858345021037868,"d
dtc(t) ∼c(t)2−2/Ls
=⇒
h
c(t)−1+2/L −c−1+2/L
0
i
= −L −2 L
st"
LN,0.6872370266479664,"=⇒c(t) =

c
−L−2"
LN,0.6886395511921458,"L
0
−(L −2)"
LN,0.6900420757363254,"L
st
−
L
L−2
.
(61)"
LN,0.6914446002805049,"This implies a timescale to learn of t ∼s−1
L
L−2σ−L+2."
LN,0.6928471248246845,"We can approximate the timescale for the ﬁrst layer’s singular vector r1(t) to align to β as well. Let
v be a vector orthogonal to β."
LN,0.6942496493688639,"d
dt
|W (1)β|2"
LN,0.6956521739130435,|W (1)v|2 = 2β⊤W (1)⊤...wL
LN,0.697054698457223,"|W (1)v|2
∼O(σL−2).
(62)"
LN,0.6984572230014026,"This suggests that alignment in a deep network should also occur on a timescale of t ∼σ−L+2.
While there is no strict separation of timescales in terms of the scaling of alignment and learning
with σ, we ﬁnd that alignment tends to precede a signiﬁcant drop in the loss as we show in Figure 3."
LN,0.699859747545582,"E.2
FINAL NTK FOR DEEP LINEAR NETWORKS"
LN,0.7012622720897616,"Independent of the structure of the data, the ﬁrst vector r1 →β and the ﬁnal NTK has the following
form:"
LN,0.7026647966339411,"K(x, x′) = s2L−2x⊤
(L −1)ββ⊤+ I

x′ + O(σ).
(63)"
LN,0.7040673211781207,"This formula is merely a consequence of the balancing condition and convergence to the optimum
u(t)L →s. We provide empirical support that ﬁnal kernel alignment increases with depth in Figure
E.3."
LN,0.7054698457223001,Published as a conference paper at ICLR 2022
LN,0.7068723702664796,"0
500
1000
1500
2000
2500
t 0.1 0.2 0.3 0.4"
LN,0.7082748948106592,Kernel Alignment
LN,0.7096774193548387,"L = 2
L = 4
L = 6"
LN,0.7110799438990182,(a) Alignment Dynamics and Depth K0 L = 2 K
LN,0.7124824684431977,"L = 4
L = 6"
LN,0.7138849929873773,(b) Initial and Final NTKs
LN,0.7152875175315568,"Figure E.3: The ﬁnal NTK for a deep linear network aligns with the class speciﬁc directions with
strength that depends on network depth L. This experiment is a partially whitened (γ = 0.25
see Section 5) subset of 100 CIFAR-10 images. (a) The dynamics of alignment for different depth
models. (b) The ﬁnal gram matrix has the form K∞∝(L−1)yy⊤+K0, illustrating why alignment
of the ﬁnal NTK to class structure increases with depth L."
LN,0.7166900420757363,"E.3
FORMULA FOR THE INTERMEDIATE NNGP KERNELS"
LN,0.7180925666199158,"Let β represent the unit vector pointing in the optimal direction for the scalar output case. To
calculate this, all that needs to be assumed is that the network has converged to its optimum and that
the weights satisfy the balance property so that W ℓ= u∗r∗
ℓ+1r∗
ℓ. By the convergence assumption
u∗= s1/L and r∗
1 = β. We stress that this holds for arbitrary input correlation structure Σ, the
ﬁnal NNGP kernel for layer ℓcan also be computed. Expanding the weights and collecting terms at
leading order in σ yields:"
LN,0.7194950911640954,"Kℓ(x, x′) ∼s2ℓ/Lx⊤ββ⊤x′ + O(σ).
(64)"
LN,0.7208976157082749,"Evaluating on the training set gives Kℓ=
 
yy⊤ℓ/L ∈RP ×P ."
LN,0.7223001402524544,"F
GENERALIZATION ERROR IN TRANSFER LEARNING TASK"
LN,0.7237026647966339,"The structure of the ﬁnal kernel can alter the ability of the network to ﬂexibly transfer to new tasks
with a small amount of data. In this section, we examine how learned intermediate representations
compares with the inductive bias of the original isotropic kernel x · x′. In particular, we study the
ofﬂine generalization performance of kernels of the form"
LN,0.7251051893408135,"K(x, x′; A) = x⊤
Aββ⊤+ I

x′.
(65)"
LN,0.726507713884993,"In Section 4 we showed that A could be altered by changing the network depth. Concretely, our
transfer learning problem consists of training a linear probe on one of the intermediate layers of the
network (Alain & Bengio (2016); Cohen et al. (2020)). This would also produce a kernel regression
solution for kernel K(x, x′, A) with A which depends on the chosen layer and the depth of the
network. For simplicity, we assume that the data are generated according to a simple Gaussian
distribution x ∼N(0, I) and that the target values are generated with a linear function y(x) = w·x.
We decompose the new task vector w = αβ +
p"
LN,0.7279102384291725,"(1 −α2)w⊥where w⊥· β = 0. The expected
generalization error after training with P samples can be computed with methods from the physics
of disordered systems (Bordelon et al., 2020; Canatar et al., 2021; Loureiro et al., 2021). For any
A > 0, the easiest transfer task is w = β (α = 1). If w = β, increasing the alignment A strictly
decreases the generalization error. This is illustrated in Figure F.1."
LN,0.729312762973352,"F.1
DERIVATION OF LEARNING CURVES"
LN,0.7307152875175316,"We will discuss the average case generalization error in the transfer learning setting. Prior work has
shown that the generalization performance of kernel regression can be calculated through a kernel"
LN,0.7321178120617111,Published as a conference paper at ICLR 2022
LN,0.7335203366058906,"0
5
10
15
20
25
P 0.4 0.5 0.6 0.7 0.8 0.9 1.0 Eg"
LN,0.7349228611500701,Kernel Alignment Strength
LN,0.7363253856942497,"A = 0
A = 1
A = 5
A = 10"
LN,0.7377279102384292,(a) α = 0.75
LN,0.7391304347826086,"0
5
10
15
20
25
P 0.5 0.6 0.7 0.8 0.9 1.0 Eg"
LN,0.7405329593267882,Transfer Task Alignment
LN,0.7419354838709677,"= 0.0
= 0.2
= 0.5
= 0.7"
LN,0.7433380084151473,(b) A = 1
LN,0.7447405329593267,"0.0
2.5
5.0
7.5
10.0
A 1.0 0.75 0.5 0.25 0.0"
LN,0.7461430575035063,Eg with P = 10 0.2 0.4 0.6 0.8
LN,0.7475455820476858,(c) Fixed P
LN,0.7489481065918654,"Figure F.1: The ofﬂine generalization error in a transfer task with the learned linear kernel K =
x⊤
Aβ⊤β⊤+ I

x′ and ynew =
h
αβ +
p"
LN,0.7503506311360448,"(1 −α2)w⊥
i
· x. (a) For a new transfer task which
is correlated with the learned function β, neural networks with large feature learning A give lower
generalization error at small sample sizes. (b) For ﬁxed A = 1, the tasks w which are strongly
correlated with β are easier to learn during transfer. (c) The lowest generalization error in a transfer
learning setup occurs when feature learning strength A and correlation between tasks α are both
large."
LN,0.7517531556802244,"eigenvalue problem (Bordelon et al., 2020; Canatar et al., 2021; Loureiro et al., 2021)"
LN,0.7531556802244039,"⟨K(x, x′)φk(x)⟩x = λkφk(x).
(66)"
LN,0.7545582047685835,"Once this integral eigenvalue problem is solved for eigenvalues λk and orthonormal eigenfunctions
φk, the average case generalization error at P training examples is"
LN,0.7559607293127629,"Eg =
1
1 −γ X k"
LN,0.7573632538569425,⟨y(x)φk(x)⟩2
LN,0.758765778401122,"(λkP + κ)2
, κ = λ + κ
X k"
LN,0.7601683029453016,"λk
λkP + κ , γ = P
X k"
LN,0.761570827489481,"λ2
k
(λkP + κ)2 .
(67)"
LN,0.7629733520336606,"In our case, we are interested in the generalization performance of the linear kernel"
LN,0.7643758765778401,"K(x, x′) = x⊤
ββ⊤+ I

x′.
(68)"
LN,0.7657784011220197,"Since K is a linear kernel, its eigenfunctions should be linear functions φk(x) = φk · x. Assuming
that the data distribution has identity covariance, we ﬁnd

x⊤
Aββ⊤+ I

x′φ⊤
k x

= φ⊤
k

Aββ⊤+ I

x′ = λkφ⊤
k x′.
(69)"
LN,0.7671809256661991,"This implies that the φk vectors are eigenvectors of M. The ﬁrst eigenvector is φ1 = β with
eigenvalue λ1 = A + 1. The other D −1 eigenvectors can be chosen as any frame in the D −1
dimensional subspace orthogonal to β. Each of these D −1 eigenvectors has eigenvalue λk = 1.
Using these results, and the fact that w = αφ1 +
√"
LN,0.7685834502103787,"1 −α2w⊥, we can calculate the expected
generalization error."
LN,0.7699859747545582,"Eg =
1
1 −γ 
α2"
LN,0.7713884992987378,"((1 + A)P + κ)2 +
1 −α2"
LN,0.7727910238429172,(P + κ)2 
LN,0.7741935483870968,"κ = λ + κ

1 + A
(1 + A)P + κ + D −1 P + κ"
LN,0.7755960729312763,"
, γ = P

(1 + A)2"
LN,0.7769985974754559,"((1 + A)P + κ)2 +
D −1
(P + κ)2 
."
LN,0.7784011220196353,"By the result proven in Canatar et al. (2021), the lowest possible error for ﬁxed A occurs by maxi-
mizing the fraction of variance along the large eigenvalue direction, corresponding to α = ±1."
LN,0.7798036465638148,"G
LINEAR NTKS DURING GD LEARN THE SAME FUNCTION"
LN,0.7812061711079944,"In the overparameterized setting where D > P, all linear networks discussed in the Section 4
converge to the minimum norm interpolator when the data is whitened. Speciﬁcally, letting the
learned neural network function be written as f(x) = ˆβ⊤x, and the data matrix X ∈RD×P and"
LN,0.782608695652174,Published as a conference paper at ICLR 2022
LN,0.7840112201963534,"target labels y ∈RP represent the training data. The solution vector β solves the constrained
optimization problem"
LN,0.7854137447405329,"min
ˆ
β
|| ˆβ||2 , s.t. X⊤ˆβ = y,
(70)"
LN,0.7868162692847125,"which is the kernel regression solution for the initial kernel K0(x, x′) = x · x′.
This is un-
surprising due to a symmetry argument: when β0 ≈0, the only privileged point on the afﬁne
space X⊤β = y is the point closest to the origin, which is precisely the solution above. Surpris-
ingly, the ﬁnal pseudo-inverse solution sβ also minimizes the RKHS norms for any of the kernels
throughout gradient descent. Up to an overall scale, the kernels throughout evolution take the form
K(x, x′; t) = x⊤
A(t)ββ⊤+ I

x′ (see Section 4.1) which would induce the following kernel
interpolation problems"
LN,0.788218793828892,"min
ˆ
β
ˆβ⊤
A(t)ββ⊤+ I
−1 ˆβ , s.t. X⊤ˆβ = y.
(71)"
LN,0.7896213183730715,"The solution to this optimization problem is indeed the kernel regression solution with kernel K(t)
since the learned function takes the form f(x) = P"
LN,0.791023842917251,"µ αµK(x, xµ, t) with α = K(t)−1y. Using
the Sherman-Morrison rule, we show that the solution to each of these problems t ≥0 gives the
same result, namely the pseudo-inverse solution. This can be seen from the following"
LN,0.7924263674614306,"ˆβ⊤
A(t)ββ⊤+ I
−1 ˆβ = | ˆβ|2 −
A(t)
1 + A(t)"
LN,0.7938288920056101,"
β · ˆβ
2
.
(72)"
LN,0.7952314165497896,"Now, we let ˆβ = sβ + β⊥, where β · β⊥= 0. This is the general decomposition for the set of
interpolators which have the property X⊤[β + β⊥] = y."
LN,0.7966339410939691,"min
β⊥|β⊥|2.
(73)"
LN,0.7980364656381487,"The solution is merely to set β⊥= 0. Thus the optimal solution is therefore the same for any ﬁ-
nite value of A. However, the ﬁnal RKHS norm of the learned function β⊤
A(t)ββ⊤+ I
−1 β
decreases with time, indicating that the kernel becomes more aligned with the pseudo-inverse direc-
tion as A increases."
LN,0.7994389901823282,"G.1
DEEP LINEAR NETWORKS FROM SMALL INITIALIZATION LEARN PSEUDO-INVERSE"
LN,0.8008415147265077,"In this subsection of the appendix, we will use our theoretical technology for balanced linear net-
works to demonstrate the universal learned function for any data, not just whitened input, pro-
viding an alternative derivation to the result proven in Theorem 7 of Yun et al. (2020).
This
analysis is performed in the σ →0 limit, where Wℓ= u(t)rℓ+1(t)rℓ(t)⊤as we showed in
Section D. Under this condition the learned function f(x) = ˆβ · x is deﬁned through weights
ˆβ = W ⊤
1 W ⊤
2 ...wL = u(t)Lr1(t). We see that the direction of the learned function is controlled
entirely by r1(t). It sufﬁces to prove that r1(t) ∈span{x1, ..., xP } for all t to show that the network
learns the pseudo-inverse solution β∗= X(X⊤X)−1y, where X ∈RD×P and y ∈RP are the
training data and targets respectively. Note that by gradient descent, we have"
LN,0.8022440392706872,"d
dtW1(t) = W ⊤
2 ...wL
X"
LN,0.8036465638148668,"µ
(yµ −fµ(t))x⊤
µ = u(t)L−1r2(t)
X"
LN,0.8050490883590463,"µ
(yµ −fµ(t))x⊤
µ .
(74)"
LN,0.8064516129032258,"From the balance condition W1(t) = u(t)r2(t)r1(t)⊤, we also have"
LN,0.8078541374474053,"d
dtW1(t) = [ ˙u(t)r2(t) + u(t) ˙r2(t)] r1(t)⊤+ u(t)r2(t) ˙r1(t)⊤.
(75)"
LN,0.8092566619915849,"Equating the two above expressions for
d
dtW1(t) and taking an inner product with r2(t) from the
left gives the following"
LN,0.8106591865357644,u(t) ˙r1(t) = u(t)L−1 X
LN,0.8120617110799438,"µ
(yµ −fµ(t))xµ −[ ˙u(t) + u(t)r2(t) · ˙r2(t)] r1(t).
(76)"
LN,0.8134642356241234,Published as a conference paper at ICLR 2022
LN,0.814866760168303,"Thus, if r1(t) ∈span{x1, ..., xP } then ˙r1(t) ∈span{x1, ..., xP } so that the full dynamics
of r1(t) lie in the subspace spanned by the training data. At initialization, we have
˙W1(t) ∝
z(t) P"
LN,0.8162692847124825,"µ yµx⊤
µ + O(σ3) so the initial r1 vector will indeed align with the span of the training data
in the σ →0 limit."
LN,0.8176718092566619,"By the fact that ˆβ = u(t)Lr1(t), the learned linear coefﬁcients ˆβ must also be in span{x1, ..., xP }
so ˆβ = P"
LN,0.8190743338008415,"µ αµxµ. These must also interpolate the data provided D ≥P, giving the following
condition
ˆβ · xν =
X"
LN,0.820476858345021,"µ
xν · xµαµ = yν =⇒α = (X⊤X)−1y =⇒ˆβ = X(X⊤X)−1y.
(77)"
LN,0.8218793828892006,This is exactly the minimum ℓ2 norm interpolating solution which solves
LN,0.82328190743338,"min
ˆ
β
| ˆβ|2
2 , s.t. , X⊤ˆβ = y.
(78)"
LN,0.8246844319775596,"While anisotropy of the data makes no impact on what function is ultimately learned in the linear
network case, the anisotropy can have a signﬁcant inﬂuence on whether the preconditions for silent
alignment are satisﬁed in a nonlinear network, which can prevent the ﬁnal function from being a
NTK regressor with ﬁnal NTK."
LN,0.8260869565217391,"H
FINAL KERNEL IN MULTI-CLASS NETWORKS"
LN,0.8274894810659187,"For a network with C output channel, balancing and alignment guarantee that the conﬁguration of
the network is orthogonal and balanced as in the setting of Saxe et al. (2014). One can then integrate
each mode separately to obtain the ﬁnal kernel as W ℓ= C
X"
LN,0.8288920056100981,"α=1
uα(t)rα
ℓ+1(t)rα
ℓ(t)⊤, Kc,c′(x, x′) = x⊤Mc,c′x′,"
LN,0.8302945301542777,"Mc,c′ = δc,c′
X"
LN,0.8316970546984572,"α
u2(L−1)
α
(t)rα
1 rα
1 + L−1
X ℓ=1 X"
LN,0.8330995792426368,"α
u2(L−ℓ)
α
(t)e⊤
c rα
Lrα⊤
L ec′
X"
LN,0.8345021037868162,"β
u2(ℓ−1)
β
(t)rβ
1 rβ⊤
1 , (79)"
LN,0.8359046283309958,"where the Cartesian unit vectors ec ∈RC are one-hot on class output c. This shows that the
contributions to the kernel depend on how well the class output channels align with the unit vectors
rα
L. Further, the singular values uα can evolve at different timescales depending on the structure of
the data."
LN,0.8373071528751753,"Speciﬁcally, for a depth L network, both the the alignment time t(L)
α
and the time to learn a given
singular value sα scale as s−1
α σ2−L, as shown in appendix E.1. The differences in alignment times
∆tαβ := t(L)
α
−t(L)
β
for modes sα, sβ therefores scales as ∆t(L)
αβ = σ2−L∆t(2)
αβ."
LN,0.8387096774193549,"H.1
FINAL NNGP IN MULTI-OUTPUT CASE"
LN,0.8401122019635343,"We can also gain intuition about the learned representations in each layer by looking at the NNGP
kernels, which merely take inner-products between layer activations for different inputs. Let β ∈
RC×D represent the optimal weight matrix which has the property (in the over-parameterized case)
βxµ = yµ. At the optimum, the neural network must learn β = W L...W 1. Computing the SVD
of β = P
α βαzαv⊤
α reveals that u∗
α = β1/L
α
and r1
α = vα and rL
α = zα. Using these facts, it is
easy to derive the ﬁnal NNGP kernel for layer ℓ."
LN,0.8415147265077139,"Kℓ(x, x′) = x⊤W 1⊤...W ℓ⊤W ℓ...W 1x′"
LN,0.8429172510518934,"= x⊤
""X"
LN,0.844319775596073,"α
(u∗
α)2ℓr1
αr1⊤
α #"
LN,0.8457223001402524,"x′ = x⊤
β⊤β
ℓ/L x′.
(80)"
LN,0.847124824684432,"Evaluating on the training set X ∈RD×P gives Kℓ= X⊤
β⊤β
ℓ/L X, which interpolates
between X⊤X at layer ℓ= 0 and Y ⊤Y at layer L."
LN,0.8485273492286115,Published as a conference paper at ICLR 2022
LN,0.8499298737727911,"0
50
100
150
200
250
300
t 0.0 0.2 0.4 0.6 0.8 1.0"
LN,0.8513323983169705,Kernel and Loss
LN,0.85273492286115,Linear Depth 2 L |K|
LN,0.8541374474053296,Kernel Alignment
LN,0.8555399719495091,(a) Linear depth 2
LN,0.8569424964936886,"0
1000
2000
3000
4000
5000
6000
t 0.0 0.2 0.4 0.6 0.8 1.0"
LN,0.8583450210378681,Kernel and Loss
LN,0.8597475455820477,Linear Depth 4
LN,0.8611500701262272,(b) Linear depth 4
LN,0.8625525946704067,"0
200
400
600
800
1000
1200
1400
t 0.0 0.2 0.4 0.6 0.8 1.0"
LN,0.8639551192145862,Kernel and Loss
LN,0.8653576437587658,Tanh Depth 3
LN,0.8667601683029453,(c) Tanh depth 3
LN,0.8681626928471248,"Figure H.1: Demonstration of a separation between alignment and spectral learning phases across
networks trained on multi-class data. Here we train on whitened MNIST. Each network has σ so that
σL = 10−4 for L the depth of the network. (a) Depth two multi-class dynamics are very similar to
single class. The analytically predicted ﬁnal alignment is in dashed green. (b) For deeper multi-class
networks, each singular values is learned far apart in time, and alignment does not as clearly precede
loss decay. (c) Similar dynamics are obtained for tanh networks. Note for deeper networks there is
a stronger separation of the times to learn each singular value, resulting in the ten separated drops in
the loss."
LN,0.8695652173913043,"H.2
MORE REFINED BALANCING ANALYSIS"
LN,0.8709677419354839,"We can derive corrections to our decomposition of the kernel by including the initial conditions in
our derived conservation laws. In particular, we will consider balancing for large width networks.
Note that the network does not need to be in the lazy regime. The balancing condition is"
LN,0.8723702664796634,"W ℓ(t)W ℓ⊤(t) −W ℓ+1⊤(t)W ℓ+1(t) = W ℓ
0W ℓ⊤
0
−W ℓ+1⊤
0
W ℓ+1
0
.
(81)"
LN,0.8737727910238429,"Note that W ℓ
0 ∈RNℓ+1×Nℓhas entries with zero mean and variance σ2/Nℓin the standard pa-
rameterization. The products of initial matrices are therefore Wishart distributed. For sufﬁciently
large widths, we can approximate the initial weight matrix products with their expectation over the
random initialization"
LN,0.8751753155680224,"W ℓ
0W ℓ⊤
0
−W ℓ+1⊤
0
W ℓ+1
0
≈σ2

1 −Nℓ+2 Nℓ+1"
LN,0.876577840112202,"
I.
(82)"
LN,0.8779803646563815,"This concentration becomes more accurate as the widths Nℓ, Nℓ+1 →∞. For the last layer if the
number of classes C = NL is sufﬁciently large, we also obtain similar concentration for the last
layer W L⊤W L ≈σ2
NL
NL−1 I. Repeating the backward induction on the conservation law, we ﬁnd
the following recursively deﬁned singular value decompositions"
LN,0.879382889200561,"W ℓ=
X"
LN,0.8807854137447405,"α
uℓ
α(t)rα
ℓ+1(t)rα
ℓ(t)⊤,"
LN,0.8821879382889201,"uℓ
α(t)2 = uℓ+1
α
(t)2 + σ2

1 −Nℓ+2 Nℓ+1"
LN,0.8835904628330996,"
= uL
α(t)2 + σ2gℓ,"
LN,0.884992987377279,"gℓ= L −ℓ− L−1
X k=ℓ Nk+1 Nk
. (83)"
LN,0.8863955119214586,"We note that the corrections gℓvanish if all layers k > ℓhave the same width. Let uα = u(L)
α (t).
The condition for convergence is
Y ℓ"
LN,0.8877980364656382,"h
u(ℓ)
α
i2
=
Y ℓ"
LN,0.8892005610098177,"
(uα)2 + σ2gℓ

= s2
α.
(84)"
LN,0.8906030855539971,"In the σ2 →0 limit, we can solve that uα ∼s1/L as before. However, we can now obtain leading
order corrections (in σ2) which take the form of the form"
LN,0.8920056100981767,"[uα]2 ∼s2
α −
gσ2"
LN,0.8934081346423562,"2Ls1/L
α
, σ2 →0 , g = L
X"
LN,0.8948106591865358,"ℓ=1
gℓ= L(L −1) 2
− L
X ℓ=1 L
X k=ℓ Nk+1"
LN,0.8962131837307152,"Nk
,
(85)"
LN,0.8976157082748948,Published as a conference paper at ICLR 2022
LN,0.8990182328190743,"which reveals that the size of the correction depends not only on σ but also on the depth and network
widths. Suppose all network widths were equal Nℓ= Nk, then the term g = 0 and there is no
contribution from the ﬁrst moment of the random weights."
LN,0.9004207573632539,"I
LAZINESS IN HOMOGENOUS NETWORKS"
LN,0.9018232819074333,"In this section we recapitulate the argument found in Chizat et al. (2019). The goal is to estimate how
rapidly the gradient features on a test point ∇f(x) change compared to the loss early in training.
Let f ∈RP represent the function outputs on the training set. We will compute the time derivatives
of the loss and the network gradients.

d
dt∇θf(x)
 =
∇2f(x) · dθ dt ="
LN,0.9032258064516129,"∇2f(x) ·
X"
LN,0.9046283309957924,"µ
(yµ −f µ)∇f µ
 ,
(86)"
LN,0.906030855539972,"d
dtL
 =

dθ dt "
LN,0.9074333800841514,"2
= |∇f · (y −f)|2 .
(87)"
LN,0.908835904628331,"Here, | · |op denotes the operator norm of a matrix. We are interested in the ratio of the loss’ time
derivative to the gradient’s time derivative. With an initialization scale of f ∼O(σL) we ﬁnd
 d"
LN,0.9102384291725105,dt∇f(x)
LN,0.9116409537166901,"|∇f|
L
 d"
LN,0.9130434782608695,"dtL
 =
|∇2f(x) · P"
LN,0.9144460028050491,µ(yµ −f µ)∇f µ||y −f|2
LN,0.9158485273492286,"|∇f||∇f · (y −f)|2
≈
|∇2f(x) · P"
LN,0.9172510518934082,µ yµ∇f µ||y|2
LN,0.9186535764375876,"|∇f||∇f · y|2
, (88)"
LN,0.9200561009817672,"where in the last step we approximated yµ −f µ ≈yµ for small initialization scale since yµ ∼O(1)
and f µ ∼O(σL). Now we will estimate the scale of each of the terms above. For a homogenous
model ∇f ∼O(σL−1) and ∇2f ∼O(σL−2). Counting powers of σ in numerator and denominator,
we ﬁnd that this quantity of interest scales as
 d"
LN,0.9214586255259467,dt∇f(x)
LN,0.9228611500701263,"|∇f|
L
 d"
LN,0.9242636746143057,"dtL
 = O(σ−L).
(89)"
LN,0.9256661991584852,"This result indicates that, from small initialization, the gradient NTK features and thus the kernel
itself will evolve much more rapidly than the loss. This effect can be ampliﬁed by increasing depth
and decreasing initialization scale."
LN,0.9270687237026648,"J
RESNET EXPERIMENTAL DETAILS"
LN,0.9284712482468443,"Below, we provide the alignment and loss dynamics for wide resnet for CIFAR-10 with 100 training
points. Because the loss decreases signiﬁcantly before the kernel reaches its ﬁnal alignment value,
the ﬁnal NTK is not perfectly correlated with the ﬁnal neural network function. The wide ResNet
model is taken from Novak et al. (2020) and is based on the original architecture of Zagoruyko &
Komodakis (2017) with a widening factor of k = 4 and a single block per ResNet group b = 1,
giving a ﬁnal network with 8 trainable layers. For both Figure 1 (d) and (e) as well as Figure
J.1 use Adam with a learning rate of η = 10−5 and initial weight scale of σ = 0.3 in standard
parameterization for all intermediate blocks. For the ﬁrst conv layer, we used σ = 6.0. We ﬁnd
that small initial weight variance in the ﬁrst layer gives rise to less stable learning and worse kernel
alignment."
LN,0.9298737727910238,"Below, in Figure J.2, we provide comprehensive results for different depths which we control by
increasing the number of blocks per group b, corresponding to WRNs with 6b + 1 trainable conv
layers."
LN,0.9312762973352033,"J.1
ADAPTIVE OPTIMIZERS AND THE RELEVANT KERNEL"
LN,0.9326788218793829,Many adaptive gradient methods compute updates to parameters θj according to
LN,0.9340813464235624,˙θj(t) = −ηj(t) ∂L
LN,0.9354838709677419,"∂θj,t
(90)"
LN,0.9368863955119214,Published as a conference paper at ICLR 2022
LN,0.938288920056101,"0
500
1000
1500
2000
2500
t 0.0 0.2 0.4 0.6 0.8 1.0"
LN,0.9396914446002805,Loss and Alignment
LN,0.94109396914446,"Lt
|K(t)|"
LN,0.9424964936886395,Alignment
LN,0.9438990182328191,(a) Dynamics
LN,0.9453015427769986,"2
1
0
1
2
Test Prediction NN 2 1 0 1 2"
LN,0.9467040673211781,Test Prediction NTK
LN,0.9481065918653576,"Wide Res-Net on Unwhitened CIFAR K0
K"
LN,0.9495091164095372,(b) Predictions
LN,0.9509116409537167,"Figure J.1: The dynamics and predictions of a Wide-Resnet with k = 4 and b = 1 on P = 100
unwhited CIFAR-10 images from the ﬁrst two classes."
LN,0.9523141654978962,"0
1000
2000
3000
t 0.0 0.2 0.4 0.6 0.8 1.0 Loss"
LN,0.9537166900420757,"b = 1
b = 2
b = 3
b = 4"
LN,0.9551192145862553,(a) Training Loss
LN,0.9565217391304348,"0
1000
2000
3000
t 0 1 2 3 4 5"
LN,0.9579242636746143,Kernel Norm
LN,0.9593267882187938,(b) Kernel Norm
LN,0.9607293127629734,"0
1000
2000
3000
t 0.0 0.1 0.2 0.3 0.4 0.5"
LN,0.9621318373071529,Alignment
LN,0.9635343618513323,(c) Alignment Dynamics
LN,0.9649368863955119,"1
2
3
4
Wide Res-Net Blocks 0.0 0.2 0.4 0.6 0.8"
LN,0.9663394109396914,"|fNTK
fNN|/|fNN| K0
K"
LN,0.967741935483871,(d) Predictor Comparison
LN,0.9691444600280504,"Figure J.2: The silent alignment effect is preserved across a large range of depths in WideResNet
trained on whitened CIFAR-10 images. The number of blocks per group b alters the total number
of conv layers (6b + 1 total conv layers). (a) The deeper models train faster with Adam. (b) The
ﬁnal NTK norm increases with depth. (c) The alignment achieves close to its ﬁnal value by the time
the kernel norm reaches 10% of its ﬁnal value (dashed line), indicating successful silent alignment.
(d) The neural network predictions are very close to the predictions of the ﬁnal NTK but is not
accurately predicted by the initial NTK."
LN,0.97054698457223,"where ηj(t) are time-varying functions which are computed in terms of the history of gradient mo-
ments for parameter θj or in terms of its instantaneous gradient. The relevant kernel at time t which
governs instantaneous evolution of network predictions is"
LN,0.9719495091164095,"K(x, x′, t) =
X"
LN,0.9733520336605891,"j
ηj(t)∂f(x, t) ∂θj"
LN,0.9747545582047685,"∂f(x′, t)"
LN,0.9761570827489481,"∂θj
(91)"
LN,0.9775596072931276,since ˙f(x) = P
LN,0.9789621318373072,"µ K(x, xµ, t)(yµ −f(xµ, t)). Though we do not calculate this kernel which is
relevant to the adaptive learning rate scheme since it is not supported in Neural Tangents API, this
could be a worthy future investigation."
LN,0.9803646563814866,Published as a conference paper at ICLR 2022
LN,0.9817671809256662,"0
1000
2000
3000
4000
5000
6000
7000
t 0.0 0.2 0.4 0.6 0.8 1.0 Loss"
LN,0.9831697054698457,"k = 1
k = 2
k = 3
k = 4"
LN,0.9845722300140253,(a) Train Loss Dynamics
LN,0.9859747545582047,"0
500
1000
1500
2000
2500
3000
3500
t 0 1 2 3 4 5 6 7"
LN,0.9873772791023843,Kernel Norm
LN,0.9887798036465638,(b) Kernel Norm
LN,0.9901823281907434,"0
500
1000
1500
2000
2500
3000
3500
t 0.0 0.1 0.2 0.3 0.4 0.5"
LN,0.9915848527349228,Alignment
LN,0.9929873772791024,(c) Alignment
LN,0.9943899018232819,"0.5
1.0
1.5
2.0
2.5
3.0
3.5
4.0
4.5
Wide Res-Net Width 0.0 0.2 0.4 0.6 0.8 1.0"
LN,0.9957924263674615,"|fNTK
fNN|/|fNN| K0
K"
LN,0.9971949509116409,(d) Predictor Comparison
LN,0.9985974754558204,"Figure J.3: Varying the ResNet widening parameter k also alters the kernel and loss dynamics. (a)
The loss curve for b = 2 WRNs with widening factor k. Wider networks train more quickly. (b)
The kernel norm increases more rapidly for wider networks but changes by a smaller amount. (c)
Alignment reaches close to its asymptote by the time the kernel norm grows to 10% its ﬁnal value
(dashed). (d) The ﬁnal kernel is a much better predictor of the NN function than the initial kernel."
