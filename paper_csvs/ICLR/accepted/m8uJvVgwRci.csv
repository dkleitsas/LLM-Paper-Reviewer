Section,Section Appearance Order,Paragraph
MICROSOFT RESEARCH ASIA,0.0,"1Microsoft Research Asia
2University of Washington
3University of Science and Technology of China
4Carnegie Mellon University
5Snorkel AI, Inc.
{jieyuz2, ajratner}@cs.washington.edu
{yujwang, yayaming, jbai}@microsoft.com
wbhfy@mail.ustc.edu.cn
xiangchensong@cmu.edu"
ABSTRACT,0.001002004008016032,ABSTRACT
ABSTRACT,0.002004008016032064,"Creating labeled training sets has become one of the major roadblocks in machine
learning. To address this, recent Weak Supervision (WS) frameworks synthesize
training labels from multiple potentially noisy supervision sources. However,
existing frameworks are restricted to supervision sources that share the same output
space as the target task. To extend the scope of usable sources, we formulate Weak
Indirect Supervision (WIS), a new research problem for automatically synthesizing
training labels based on indirect supervision sources that have different output label
spaces. To overcome the challenge of mismatched output spaces, we develop a
probabilistic modeling approach, PLRM, which uses user-provided label relations
to model and leverage indirect supervision sources. Moreover, we provide a
theoretically-principled test of the distinguishability of PLRM for unseen labels,
along with a generalization bound. On both image and text classification tasks as
well as an industrial advertising application, we demonstrate the advantages of
PLRM by outperforming baselines by a margin of 2%-9%."
INTRODUCTION,0.003006012024048096,"1
INTRODUCTION"
INTRODUCTION,0.004008016032064128,"One of the greatest bottlenecks of using modern machine learning models is the need for substantial
amounts of manually-labeled training data. In real-world applications, such manual annotations are
typically time-consuming, labor-intensive and static. To reduce the efforts of annotation, researchers
have proposed Weak Supervision (WS) frameworks (Ratner et al., 2016; 2018; 2019; Fu et al., 2020)
for synthesizing labels from multiple weak supervision sources, e.g., heuristics, knowledge bases,
or pre-trained classifiers. These frameworks have been widely applied on various machine learning
tasks (Dunnmon et al., 2020; Fries et al., 2021; Safranchik et al., 2020; Lison et al., 2020; Zhou
et al., 2020; Hooper et al., 2021; Zhan et al., 2019; Varma et al., 2019) and industrial data (Bach
et al., 2019). Among them, data programming (Ratner et al., 2016), one representative example
that generalizes many approaches in the literature, represents weak supervision sources as labeling
functions (LFs) and synthesizes training labels using Probabilistic Graphical Model (PGM)."
INTRODUCTION,0.00501002004008016,"Given both the increasing popularity of WS and the general increase in open-source availability of
machine learning models and tools, there is a rising tide of available supervision sources that WS
frameworks and practitioners could potentially leverage, including pre-trained machine learning
models or prediction APIs (Chen et al., 2020; d’Andrea & Mintz, 2019; Yao et al., 2017). However,
existing WS frameworks only utilize weak supervision sources with the same label space as the
target task. This incompatibility largely limits the scope of usable sources, necessitating manual
effort from domain experts to provide supervision for unseen labels. For example, consider target
task of classifying {“dog”, “wolf”, “cat”, “lion”} and a set of three weak supervision sources
(e.g. trained classifiers or expert heuristics) with disjoint output spaces {“caninae”, “felidae”},
{“domestic animals”, “wild animals”} and {“husky”, “bengal cat”} respectively. We call these types
of sources indirect supervision sources. For concreteness, we follow the general convention of data
programming (Ratner et al., 2016) and refer to these sources as indirect labeling functions (ILFs)."
INTRODUCTION,0.006012024048096192,Published as a conference paper at ICLR 2022
INTRODUCTION,0.0070140280561122245,"Despite their apparent utility, existing weak supervision methods could not directly leverage such
ILFs, as their output spaces have no overlap with the target one."
INTRODUCTION,0.008016032064128256,"In this paper, we formulate a novel research problem that aims to leverage such ILFs automatically,
minimizing the manual efforts to develop and deploy new models. We refer to this as the Weak
Indirect Supervision (WIS) setting, a new Weak Supervision paradigm which leverages ILFs, along
with the relational structures between individual labels, to automatically create training labels."
INTRODUCTION,0.009018036072144289,"The key difficulty of leveraging ILFs is due to the mismatched label spaces. To overcome this, we
introduce pairwise relations between individual labels to the WIS setup, which are often available
in structured sources (e.g. off-the-shelf Knowledge Bases (Miller, 1995; Sinha et al., 2015; Dong
et al., 2020) or large scale label hierarchies (Murty et al., 2017; The Gene Ontology Consortium,
2018; Partalas et al., 2015) for various domains), or can be provided by subject matter experts in
far less time than generating entirely new sets of weak supervision sources. For example, in the
aforementioned example, we could rely on a biological species ontology to see that the unseen labels
“dog” and “cat” are both subsumed by the seen label “domestic animals”. Based on the label relations,
we can automatically leverage the supervision sources as ILFs. Notably, previous work (Qu et al.,
2020) also leveraged a label relation graph but was focused on relation extraction task in a few-shot
learning setting, while You et al. (2020) proposed to learn label relations given data for each label in
a transfer learning scenario. In contrast, we aim to solve the target task directly and without clean
labeled data."
INTRODUCTION,0.01002004008016032,"The remaining questions are (1) how to synthesize labels based on pair-wise label relations and ILFs?
and (2) How can we know whether, given a set of ILFs and label relations, the unseen labels are
distinguishable or not? To address the first question, we develop a probabilistic label relation model
(PLRM), the first PGM for WIS which aggregates the output of ILFs and models the label relations as
dependencies between random variables. In turn, we use the learned PLRM to produce labels for
training an end model. Furthermore, we derive the generalization error bound of PLRM based on
assumptions similar to previous work (Ratner et al., 2016)."
INTRODUCTION,0.011022044088176353,"The second question presents an important stumbling block when dealing with unseen labels, as we
may not be able to distinguish the unseen labels given existing label relations and ILFs, resulting in
an unsatisfactory synthesized training set. To address this issue, we formally introduce the notion
of distinguishability in WIS setting and theoretically establish an equivalence between: (1) the
distinguishability of the label relation structure as well as the ILFs, and (2) the capability of PLRM
to distinguish unseen labels. This result then leads to a simple sanity test for preventing the model
from failing to distinguish unseen labels. In preliminary experiments, we observe a significant drop
in model performance when the condition is violated."
INTRODUCTION,0.012024048096192385,"In experiments, we make non-trivial adaptations for baselines from related settings to the new WIS
problem. On both text and image classification tasks, we demonstrate the advantages of PLRM over
adapted baselines. Finally, in a commercial advertising system where developers need to collect
annotations for new ads tags, we illustrate how to formulate the training label collection as a WIS
problem and apply PLRM to achieve an effective performance."
INTRODUCTION,0.013026052104208416,Summary of Contributions. Our contributions are summarized as follows:
INTRODUCTION,0.014028056112224449,"• We formulate Weak Indirect Supervision (WIS), a new research problem which synthesizes
training labels based on indirect supervision sources and label relations, minimizing human efforts
of both data annotation and weak supervision sources construction;"
INTRODUCTION,0.01503006012024048,"• We develop the first model for WIS, the Probabilistic Label Relation Model (PLRM) with
comparable statistical efficiency to previous WS frameworks and standard supervised learning;"
INTRODUCTION,0.01603206412825651,"• We introduce a new notion of distinguishability in WIS setting, and provide a simple test of the
distinguishability of PLRM for unseen labels by theoretically establishing the connection between
the label relation structures and distinguishability;"
INTRODUCTION,0.017034068136272545,"• We showcase the potential of the WIS formulation and the effectiveness of PLRM in a commercial
advertising system for synthesizing training labels of new ads tags. On academic image and
text classification tasks, we demonstrate the advantages of PLRM over baselines by quantitative
experiments. Overall, PLRM outperforms baselines by a margin of 2%-9%."
INTRODUCTION,0.018036072144288578,Published as a conference paper at ICLR 2022
RELATED WORK,0.01903807615230461,"2
RELATED WORK"
RELATED WORK,0.02004008016032064,"Table 1: Comparisons between the proposed weak indirect supervision (WIS) and related machine
learning tasks. Compared to normal and weakly supervised learning, WIS handles mismatched train
and test label spaces. WIS is similar in spirit to indirect supervision (IS) and zero-shot learning
(ZSL), but distinct in that WIS only takes as input weak or noisy labels and a simple set of logical
label relations, and aims to output a training data set rather than a trained model, affording complete
modularity in which final model class is used."
RELATED WORK,0.021042084168336674,"Task
Label Type
Ytrain = Ytest
Label Information
When Label Info. is Required"
RELATED WORK,0.022044088176352707,"Supervised Learning (SL)
Clean Labels
✓
–
–
Weak Supervision (WS)
Noisy Sources
✓
–
–
Indirect Supervision (IS)
Clean Labels
Label Trans. Matrix
Training
Zero-Shot Learning (ZSL)
Clean Labels
Label Embed. / Attribute
Training & Test"
RELATED WORK,0.023046092184368736,"Weak Indirect Supervision (WIS)
Noisy Sources
Label Relation
Training"
RELATED WORK,0.02404809619238477,We briefly review related settings. The comparison between WIS and related tasks is in Table 1.
RELATED WORK,0.025050100200400802,"Weak Supervision: We draw motivation from recent work which model and integrate weak supervi-
sion sources using PGMs (Ratner et al., 2016; 2018; 2019; Fu et al., 2020) and other methods (Guan
et al., 2018; Khetan et al., 2018) to create training sets. While they assume supervision sources
share the same label space as the new tasks, we aim to leverage indirect supervision sources with
mismatched label spaces in a labor-free way."
RELATED WORK,0.026052104208416832,"Indirect Supervision: Indirect supervision arises more generally in latent-variable models for various
domains (Brown et al., 1993; Liang et al., 2013; Quattoni et al., 2004; Chang et al., 2010; Zhang
et al., 2019). Very recently, Raghunathan et al. (2016) proposed to use the linear moment method for
indirect supervision, wherein the transition between desired label space Y and indirect supervision
space O is known, as well as the ground truth of indirect supervisions for training. In contrast,
both are unavailable in WIS. Theoretically, Wang et al. (2020) developed a unified framework for
analyzing the learnability of indirect supervision with shared or superset label spaces, while we focus
on disjoint label spaces and the consequent unique challenge of distinguishability of unseen classes."
RELATED WORK,0.027054108216432865,"Zero-Shot Learning: Zero-Shot Learning (ZSL) (Lampert et al., 2009; Wang et al., 2019) aims to
learn a classifier that is able to generalize to unseen classes. The WIS problem differentiates from
ZSL by (1) in ZSL setting, the training and test data belong to seen and unseen classes, respectively,
and training data is labeled, while for WIS, both training and test data belong to unseen classes
and unlabeled; (2) ZSL tends to render a classifier that could predict unseen classes given certain
label information, e.g., label attributes (Romera-Paredes & Torr, 2015), label descriptions (Srivastava
et al., 2018) or label similarities (Frome et al., 2013), while WIS aims to provide training labels for
unlabeled training data, allowing users to train any machine learning models, and the label relations
are used only in synthesizing training labels."
RELATED WORK,0.028056112224448898,"3
PRELIMINARY: WEAK SUPERVISION"
RELATED WORK,0.02905811623246493,We first describe the Weak Supervision (WS) setting. A glossary of notations used is in App. A.
RELATED WORK,0.03006012024048096,"Definitions and notations. We assume a k-way classification task, and have an unlabeled dataset D
consisting of m data points. Denote by Xi ∈X the individual data point and Yi ∈Y = {y1, . . . , yk}
the unobserved interested label of Xi. We also have n sources, each represented by a labeling
function (LF) and denoted by λj. Each λj outputs a label ˆY j
i ∈Yλj = {ˆyj
1, . . . , ˆyj
kλj } on Xi, where"
RELATED WORK,0.031062124248496994,"Yλj is the label space associated with λj and |Yλj| = kλj. We denote the concatenation of LFs’
output as ˆYi = [ ˆY 1
i , ˆY 2
i , . . . , ˆY n
i ], and the union set of LFs’ label spaces as ˆY with | ˆY| = ˆk. Note
that ˆk is not necessarily equal to the sum over kλj, since LFs may have overlapping label spaces. We
call ˆy ∈ˆY seen label and y ∈Y desired labels. In WS settings, we have Y ⊂ˆY. Notably, we assume
all the involved labels come from the same semantic space."
RELATED WORK,0.03206412825651302,"The goal of WS. The goal is to infer the training labels for the dataset D based on LFs, and to use
them to train an end discriminative classifier fW : X →Y, all without ground truth training labels."
RELATED WORK,0.033066132264529056,Published as a conference paper at ICLR 2022
RELATED WORK,0.03406813627254509,Indirect Labeling Functions
RELATED WORK,0.03507014028056112,Unlabeled Data
RELATED WORK,0.036072144288577156,Label Graph Lion Wolf
RELATED WORK,0.03707414829659319,Domestic Animal Dog Cat Husky
RELATED WORK,0.03807615230460922,Bengal Cat
RELATED WORK,0.03907815631262525,Wild Animal
RELATED WORK,0.04008016032064128,Felidae
RELATED WORK,0.041082164328657314,Canine
RELATED WORK,0.04208416833667335,"Probabilistic Labels
End Model
Label Model Lion Wolf Dog Cat"
RELATED WORK,0.04308617234468938,"Canine
Felidae
Wild Animals
Husky
Bengal Cat
Domestic Animals …"
RELATED WORK,0.04408817635270541,def labeling rule:
RELATED WORK,0.045090180360721446,return label
RELATED WORK,0.04609218436873747,"λ1
λ2
λn"
RELATED WORK,0.047094188376753505,def labeling rule:
RELATED WORK,0.04809619238476954,return label
RELATED WORK,0.04909819639278557,def labeling rule:
RELATED WORK,0.050100200400801605,return label Input
RELATED WORK,0.05110220440881764,3Ur1q/qh69LBbBU0ikqMeCF48t2FZpQ9lsJ+3azSbsboRS+gu8eFDEqz/Jm/GbZuDtj4YeLw3w8y8MBVcG8/7dgpr6xubW8Xt0s7u3v5B+fCopZNMWyRCTqPqQaBZfYNwIvE8V0jgU2A5HNzO/YRK80TemXGKQUwHkecUWOlxkOvXPFcbw6ySvycVCBHvVf+6vYTlsUoDRNU647vpSaYUGU4EzgtdTONKWUjOsCOpZLGqIPJ/NApObNKn0SJsiUNmau/JyY01noch7Yzpmaol72Z+J/XyUx0HUy4TDODki0WRZkgJiGzr0mfK2RGjC2hTHF7K2FDqigzNpuSDcFfnmVtC5c/9KtNqVmpvHUYQTOIVz8OEKanALdWgCA4RneIU359F5cd6dj0VrwclnjuEPnM8ftCeM0g=</latexit>Y
RELATED WORK,0.052104208416833664,"ˆY 1
ˆY 2
ˆY 3"
RELATED WORK,0.0531062124248497,gtB1MbjO/USVZpF8MNOY+gKPJAsZwcZK3X6AVdqdPXqDcsWtunOgVeLlpAI5GoPyV38YkURQaQjHWvc8NzZ+ipVhNZqZ9oGmMywSPas1RiQbWfzg+eoTOrDFEYKVvSoLn6eyLFQupCGynwGasl71M/M/rJSa89lMm48RQSRaLwoQjE6HsezRkihLDp5Zgopi9FZExVpgYm1HJhuAtv7xKWhdV7Jau69V6jd5HEU4gVM4Bw+uoA530IAmEBDwDK/w5ijnxXl3PhatBSefOY/cD5/AKCakE4=</latexit>¯Y 1
RELATED WORK,0.05410821643286573,AaTuY3M79hNVmkXywUxj6gs8kixkBsrdfsBVml39lgZFEtu2V0ArRMvIyXI0BgUv/rDiCSCSkM41rnubHxU6wMI5zOCv1E0xiTCR7RnqUSC6r9dHwDF1YZYjCSNmSBi3U3xMpFlpPRWA7BTZjverNxf+8XmLCaz9lMk4MlWS5KEw4MhGaf4+GTFi+NQSTBSztyIyxgoTYzMq2BC81ZfXSatS9mrl6n21VL/J4sjDGZzDJXhwBXW4gwY0gYCAZ3iFN0c5L86787FszTnZzCn8gfP5A6IekE8=</latexit>¯Y 2
RELATED WORK,0.05511022044088176,"Figure 1: An example of WIS problem: the input consists of an unlabeled dataset, a label graph, and
n indirect labeling functions (ILFs). The ILFs represent weak supervision sources such as pretrained
classifiers, knowledge bases, heuristic rules, etc. We can see that the ILFs cannot predict desired
labels i.e., {“dog”, “wolf”, “cat”, “lion”}. To address this, a label graph is given; here we only
visualize the subsuming relation. Finally, a label model, instantiated as a PGM, takes the ILF’s
outputs and produces probabilistic labels in the target output space, which are in turn used to train an
end machine learning model that can generalize beyond them."
WEAK INDIRECT SUPERVISION,0.056112224448897796,"4
WEAK INDIRECT SUPERVISION"
WEAK INDIRECT SUPERVISION,0.05711422845691383,"Now, we introduce the new Weak Indirect Supervision (WIS) problem. Unlike the standard WS
setting, we only have indirect labeling functions (ILFs) instead of LFs, and an additional label graph
is given. The goal of WIS remains the same as WS. An example of WIS problem is in Fig. 1."
WEAK INDIRECT SUPERVISION,0.05811623246492986,"Indirect Labeling Function. In WIS, we only have indirect labeling functions (ILFs), which cannot
directly predict any desired labels, i.e., ˆY ∩Y = ∅. Therefore, we refer to the desired labels as unseen
labels. To make it possible to leverage the ILFs, a label graph is given, which encodes pair-wise label
relations between different seen and unseen labels."
WEAK INDIRECT SUPERVISION,0.05911823647294589,"Label Graph. Concretely, a label graph G = (V, E) consists of (1) a set of all the labels as nodes, i.e.,
V = ˆY ∪Y, and (2) a set of pair-wise label relations as typed edges, i.e., E = {(yi, yj, tyiyj)|tyiyj ∈
T , i < j, ∀yi, yj ∈V}. Here, T is the set of label relation types and, similar to Deng et al. (2014),
there are four types of label relations: exclusive, overlapping, subsuming, subsumed, notated by
to, te, tsg, tsd, respectively. Notably, for any ordered pair of labels (yi, yj), their label relation should
fall into one of the four types. The rationale behind these label relations is that when treating each
label as a set, there are four unique set relations and each corresponds to one defined label relation
respectively as shown in Fig. 2. For convenience, we denote the set of non-exclusive neighbors of a
given label y in ˆY as N(y, ˆY), i.e., N(y, ˆY) = {ˆy ∈ˆY|tyˆy ̸= te}. A
B"
WEAK INDIRECT SUPERVISION,0.06012024048096192,"Exclusive
Overlap A
B"
WEAK INDIRECT SUPERVISION,0.061122244488977955,Subsuming
WEAK INDIRECT SUPERVISION,0.06212424849699399,"A
B 
 
B
A"
WEAK INDIRECT SUPERVISION,0.06312625250501001,"Subsumed
Set relation
A \ B = ;
A \ B 6= ;, A 6⇢B, B 6⇢A
Label relation:"
WEAK INDIRECT SUPERVISION,0.06412825651302605,"A $ B
A % B"
WEAK INDIRECT SUPERVISION,0.06513026052104208,Figure 2: The one-to-one mapping between label relations and set relations.
PROBABILISTIC LABEL RELATION MODEL,0.06613226452905811,"5
PROBABILISTIC LABEL RELATION MODEL"
PROBABILISTIC LABEL RELATION MODEL,0.06713426853707415,"One of the key difficulties in both WS and WIS is that we do not observe the true label Yi. Following
prior work (Ratner et al., 2016; 2019; Fu et al., 2020), we use a latent variable Probabilistic Graphical
Model (PGM) for estimating Yi based on the ˆYi output by ILFs. Specifically, the PGM is instantiated"
PROBABILISTIC LABEL RELATION MODEL,0.06813627254509018,Published as a conference paper at ICLR 2022
PROBABILISTIC LABEL RELATION MODEL,0.06913827655310621,"as a factor graph model. This standard technique lets us describe the family of generative distributions
in terms of M known dependencies/factor functions {ϕ}, and an unknown parameter Θ ∈RM as
PΘ(·) ∝exp(Θ⊤Φ(·)), where Φ is the concatenation of {ϕ}. However, the unique challenge for
WIS is that the dependencies {ϕ} between Yi and ˆYi are unknown due to the mismatches of label
spaces. We overcome these by leveraging the label graph G to build the dependencies for the PGM."
A BASELINE PGM FOR WIS,0.07014028056112225,"5.1
A BASELINE PGM FOR WIS"
A BASELINE PGM FOR WIS,0.07114228456913828,"In prior work (Ratner et al., 2016; Bach et al., 2017), the PGM for WS is governed by accuracy
dependencies:
ϕAcc
y,j(Y, ˆY j) := 1{Y = ˆY j = y}
which is defined for each λj and y ∈Yλj ∩Y. However, in WIS, the ILFs cannot predict desired label
y ∈Y. As a simple baseline approach to start, we leverage the coarse-grained exclusive/non-exclusive
label relation to build a corresponding ""accuracy"" factor. Specifically, for an ILF λj and one label
ˆy ∈Yλj, given a desired label y ∈Y, if ˆy and y have non-exclusive label relation, i.e., ˆy ∈N(y, Yλj)
we expect a certain portion of data assigned ˆy should be labeled as y. Thus, we treat ˆY j = ˆy as a
pseudo indicator of Y = y and add a pseudo accuracy dependency between them:"
A BASELINE PGM FOR WIS,0.07214428857715431,"ϕAcc
y,ˆy,j(Y, ˆY j) := 1{Y = y ∧ˆY j = ˆy}"
A BASELINE PGM FOR WIS,0.07314629258517034,"We call the PGM governed by pseudo accuracy dependencies Weak Supervision with Label Graph
(WS-LG). Notably, it can be treated as a simple adaptation of PGM for WS (Ratner et al., 2016; 2019;
Fu et al., 2020) to the WIS problem. However, such a naïve adaptation might have two drawbacks:"
A BASELINE PGM FOR WIS,0.07414829659318638,"1. It does not model specific dependencies ILFs with different undesired labels. For example, two
ILFs outputting “Husky” and “bulldog” respectively would be naively modeled the same as if they
both output “Dog”.
2. It can only directly model exclusive/non-exclusive label relations, ignoring the prior knowledge
encoded in other relation types, i.e., subsuming, subsumed, or overlapping. For example, given
an unseen label “Dog” and some ILFs outputting “Husky” or “Domestic Animals”, WS-LG
would treat all ILFs as indicators of “Dog”. However, we know a “Husky” is of course a “Dog”
(subsumed relation) while a “Domestic Animals” is not necessarily a “Dog” (subsuming relation)."
PROBABILISTIC LABEL RELATION MODEL,0.07515030060120241,"5.2
PROBABILISTIC LABEL RELATION MODEL"
PROBABILISTIC LABEL RELATION MODEL,0.07615230460921844,"To more directly model the full range and nuance of label relations, we propose a new probabilistic
label relation model (PLRM). In PLRM, we explicitly model both (1) the dependency between ILF
outputs and the true labels in their output spaces, i.e. their direct accuracy, and (2) the dependencies
between these labels and the target unseen labels, as separate dependency types, thus explicitly
incorporating the full label relation graph into our model and learning its corresponding weights."
PROBABILISTIC LABEL RELATION MODEL,0.07715430861723446,"Concretely, we augment the WS-LG model with (1) latent variables representing the assignment
of the data to each seen label, and (2) label relation dependencies which capture fine-grained label
relations between these output labels and desired labels. To model seen label in ˆY, we introduce
a binary latent random vector ¯Y = [ ¯Y 1, . . . , ¯Y ˆk], where ¯Y i indicating whether the data should be
assigned ˆyi. Then, for ILF λj that could predict ˆyi, we have accuracy dependency:"
PROBABILISTIC LABEL RELATION MODEL,0.0781563126252505,"ϕAcc
ˆyi,j( ¯Y i, ˆY j) := 1{ ¯Y i = 1 ∧ˆY j = ˆyi}"
PROBABILISTIC LABEL RELATION MODEL,0.07915831663326653,"To model fine-grained label relations, for a desired label y ∈Y and seen label ˆyi ∈ˆY, we add label
relation dependencies. We enumerate the label relation dependencies corresponding to the four label
relation types, i.e., exclusive, overlapping, subsuming, subsumed, as follows:"
PROBABILISTIC LABEL RELATION MODEL,0.08016032064128256,"ϕe
y,ˆyi(Y, ¯Y i) := −1{Y = y ∧¯Y i = 1}"
PROBABILISTIC LABEL RELATION MODEL,0.0811623246492986,"ϕo
y,ˆyi(Y, ¯Y i) := 1{Y = y ∧¯Y i = 1}"
PROBABILISTIC LABEL RELATION MODEL,0.08216432865731463,"ϕsg
y,ˆyi(Y, ¯Y i) := −1{Y ̸= y ∧¯Y i = 1}"
PROBABILISTIC LABEL RELATION MODEL,0.08316633266533066,"ϕsd
y,ˆyi(Y, ¯Y i) := −1{Y = y ∧¯Y i = 0}"
PROBABILISTIC LABEL RELATION MODEL,0.0841683366733467,Published as a conference paper at ICLR 2022
PROBABILISTIC LABEL RELATION MODEL,0.08517034068136273,"The above dependencies encode the prior knowledge of the label relations, but also allow the model
to learn corresponding parameters. For example, an exclusive label relation dependency ϕe outputs
-1 when two exclusive labels are activated at the same time for the same data, otherwise 0, which
reflects our prior knowledge of the exclusive label relation; and the corresponding parameter can be
treated as the strength of the label relation. Likewise, for any pair of seen labels, we add label relation
dependency following the same convention. Finally, we specify the model as:"
PROBABILISTIC LABEL RELATION MODEL,0.08617234468937876,"PΘ(Y, ¯Y , ˆY ) ∝exp

Θ⊤Φ(Y, ¯Y , ˆY )

.
(1)"
PROBABILISTIC LABEL RELATION MODEL,0.0871743486973948,"Recall that Y is the unobserved true label, ¯Y is the binary random vector, each of whose binary value
¯Y i reflects whether the data should be assigned seen label ˆyi ∈ˆY, and ˆY is the concatenated outputs
of ILFs."
PROBABILISTIC LABEL RELATION MODEL,0.08817635270541083,"Learning Objective. We estimate the parameters ˆΘ by minimizing the negative log marginal
likelihood PΘ( ˆY ) for observed ILF outputs ˆY1:m:"
PROBABILISTIC LABEL RELATION MODEL,0.08917835671342686,"ˆΘ = arg min
Θ
− m
X"
PROBABILISTIC LABEL RELATION MODEL,0.09018036072144289,"i=1
log
X"
PROBABILISTIC LABEL RELATION MODEL,0.09118236472945891,"Y, ¯Y
PΘ(Y, ¯Y , ˆYi) .
(2)"
PROBABILISTIC LABEL RELATION MODEL,0.09218436873747494,We follow Ratner et al. (2016) to optimize the objective using stochastic gradient descent.
PROBABILISTIC LABEL RELATION MODEL,0.09318637274549098,"Training an End Model. Let p ˆΘ(Y | ˆY ) be the probabilistic label (i.e. distribution) predicted by
learned PLRM. We then train an end model fW : X →Y parameterized by W, by minimizing the
empirical noise-aware loss (Ratner et al., 2019) with respect to ˆΘ over m unlabeled data points:"
PROBABILISTIC LABEL RELATION MODEL,0.09418837675350701,"ˆ
W = arg min
W
1
m m
X"
PROBABILISTIC LABEL RELATION MODEL,0.09519038076152304,"i=1
EY ∼p ˆ
Θ(Y | ˆYi)ℓ(Y, fW (Xi)),
(3)"
PROBABILISTIC LABEL RELATION MODEL,0.09619238476953908,"where ℓ(Y, fW (Xi)) is a standard cross entropy loss."
PROBABILISTIC LABEL RELATION MODEL,0.09719438877755511,"Generalization Error Bound. We extend previous results from (Ratner et al., 2016) to bound both
the expected error of learned parameter ˆΘ and the expected risk for ˆW. All the proof details and
description of assumptions can be found in Appendix."
PROBABILISTIC LABEL RELATION MODEL,0.09819639278557114,"Theorem 1. Suppose that we run stochastic gradient descent to produce ˆΘ and ˆW based on Eqs. (2)
and (3), respectively, and that our setup satisfies certain assumptions (App D.2). Let |D| be the size
of the unlabeled dataset. Then we have"
PROBABILISTIC LABEL RELATION MODEL,0.09919839679358718,"E
ˆΘ −Θ∗
2
≤O

M log |D| |D|"
PROBABILISTIC LABEL RELATION MODEL,0.10020040080160321,"
,
E
h
ℓ( ˆ
W) −ℓ(W ∗)
i
≤χ + O  H s"
PROBABILISTIC LABEL RELATION MODEL,0.10120240480961924,log |D| |D| ! .
PROBABILISTIC LABEL RELATION MODEL,0.10220440881763528,"Interpreting the Bound.
By Theorem 1, the two errors decrease by the rate ˜O(1/|D|) and
˜O(1/|D|1/2) respectively as |D| increases. This shows that although we trade computational effi-
ciency for the reduction of human efforts by using complex dependencies and more latent variables,
we maintain comparable statistical efficiency as previous WS frameworks and supervised learning
theoretically."
DISTINGUISHABILITY OF UNSEEN LABELS,0.10320641282565131,"6
DISTINGUISHABILITY OF UNSEEN LABELS Dog"
DISTINGUISHABILITY OF UNSEEN LABELS,0.10420841683366733,"Husky
Bulldog"
DISTINGUISHABILITY OF UNSEEN LABELS,0.10521042084168336,Exclusive
DISTINGUISHABILITY OF UNSEEN LABELS,0.1062124248496994,Subsuming
DISTINGUISHABILITY OF UNSEEN LABELS,0.10721442885771543,"Figure 3:
Example of in-
distinguishable unseen labels
“Husky” and “Bulldog”."
DISTINGUISHABILITY OF UNSEEN LABELS,0.10821643286573146,"One unique challenge of WIS is that there may exist pairs of unseen
labels which cannot be distinguished by the learned model. For
example, as shown in Fig. 3, where “Dog” is a seen label for which
LFs could predict for and “Husky” and “Bulldog” are unseen labels
for which we want to generate training labels; however, we could
not distinguish between “Husky” and “Bulldog” even though the LFs
make correct predictions of seen label “Dog”, because both “Husky”
and “Bulldog” share the same label relation to “Dog”."
DISTINGUISHABILITY OF UNSEEN LABELS,0.1092184368737475,"To tackle this issue, we theoretically connect the distinguishability of
unseen labels to the label relation structures and provide a testable"
DISTINGUISHABILITY OF UNSEEN LABELS,0.11022044088176353,Published as a conference paper at ICLR 2022
DISTINGUISHABILITY OF UNSEEN LABELS,0.11122244488977956,"condition for the distinguishability. Intuitively, same label relation
structures could lead to indistinguishable unseen labels as shown in Fig. 3; however, it turns out to be
challenging to prove that different label relation structures could guarantee the distinguishability
with respect to the model. To illustrate, we formally define the distinguishability as below."
DISTINGUISHABILITY OF UNSEEN LABELS,0.11222444889779559,"Definition 1 (Distinguishability). For any model PΘ(Y, ¯Y , ˆY ) with parameters Θ, any pair of unseen
labels yi, yj ∈Y are distinguishable w.r.t. the model, if for a.e. Θ > 0 (element-wisely), there does
NOT exist such a ˜Θ > 0 that, for ∀¯Y , ˆY , the following equations hold"
DISTINGUISHABILITY OF UNSEEN LABELS,0.11322645290581163,"PΘ(Y = yi| ¯Y , ˆY ) = P ˜Θ(Y = yj| ¯Y , ˆY ), PΘ(Y = yj| ¯Y , ˆY ) = P ˜Θ(Y = yi| ¯Y , ˆY ),
(4)"
DISTINGUISHABILITY OF UNSEEN LABELS,0.11422845691382766,"PΘ(Y = y| ¯Y , ˆY ) = P ˜Θ(Y = y| ¯Y , ˆY ), ∀y ∈Y/{yi, yj},
(5)"
DISTINGUISHABILITY OF UNSEEN LABELS,0.11523046092184369,"PΘ( ˆY ) = P ˜Θ( ˆY ).
(6)"
DISTINGUISHABILITY OF UNSEEN LABELS,0.11623246492985972,"From the definition, we can see that the opposite of distinguishability, i.e., indistinguishability,
describes an undesired model: for any learned parameter Θ > 0, we can always find another ˜Θ
which optimizes the loss equally well (Eq. (6)), but Eqs. (4-5) implies whenever PΘ predict yi,
P ˜Θ will predict yj instead, which reflects that the model cannot distinguish the two unseen labels.
Note that the notion of distinguishability is different from the identifiability in PGMs: the generic
identifiability (Allman et al., 2015), the strongest notion of identifiability, requires the model to be
identifiable up to label swapping, while the distinguishability aims to avoid the label swapping."
DISTINGUISHABILITY OF UNSEEN LABELS,0.11723446893787576,"However, distinguishability is hard to verify since Eqs. (4-5) and (6) need to hold for any possible
configuration of ¯Y , ˆY , and any pair of unseen labels. Fortunately, for the proposed PLRM, we
prove that distinguishability is equivalent to the asymmetry of the label relation structures when two
conditions hold. To state the required conditions, we first introduce the notations of consistency and
informativeness to characterize the label graph and ILFs."
DISTINGUISHABILITY OF UNSEEN LABELS,0.11823647294589178,"Consistency. We discuss the consistency of a label graph to avoid an ambiguous or unrealistic label
graph. We interpret semantic labels ya, yb as sets A, B, and then connect the label relations to the set
relations (Fig. 2). Given the set interpretations, we define the consistency of label graph as:"
DISTINGUISHABILITY OF UNSEEN LABELS,0.11923847695390781,"Definition 2 (Consistent Label Graph). A label graph G = (Y, E) is consistent if the induced set
relations are consistent."
DISTINGUISHABILITY OF UNSEEN LABELS,0.12024048096192384,"For example, assume Y = {ya, yb, yc}, and tab = tbc = tca = tsg. From tab, tbc, we can observe
that A ⫌B ⫌C, which contradicts to C ⫌A implied by tca = tsg. Thus, G is inconsistent."
DISTINGUISHABILITY OF UNSEEN LABELS,0.12124248496993988,"Informativeness. In addition, we try to describe what kind of ILF is desired. Intuitively, an ILF is
uninformative if it always ""votes"" for one of the desired labels. For example, if the desired label
space Y is {“Dog”, “Bird”}, then for an ILF λ1 outputting {“Husky”, “Bulldog”}, we know “Dog” is
non-exclusive to “Husky” and “Bulldog”, while “Bird” exclusive to both. In such case, λ1 can hardly
provide information to help distinguish “Dog” from “Bird”, because it always votes for “Dog”. On
the other hand, a binary classifier of “Husky”, i.e., λ2, is favorable since it could output “Not a Husky”
to avoid consistently voting for “Dog”. We can see an undesired ILF always votes for a single desired
label. To formally describe this, we define an informative ILF as:"
DISTINGUISHABILITY OF UNSEEN LABELS,0.12224448897795591,"Definition 3 (Informative ILF). An ILF λj is informative if, for ∀y ∈Y, there exists Xi ∈D s.t. the
output of λj on Xi is not in N(y, Yλj), i.e., ˆY j
i ̸∈N(y, Yλj)."
DISTINGUISHABILITY OF UNSEEN LABELS,0.12324649298597194,"Testable Conditions for Distinguishability. Based on the introduced notations, we prove the
necessary and sufficient condition for learned PLRM being able to distinguish unseen labels:"
DISTINGUISHABILITY OF UNSEEN LABELS,0.12424849699398798,"Theorem 2. For PLRM induced from a consistent label graph, as well as informative ILFs, for any
pair of yi, yj ∈Y, they are indistinguishable, if and only if tik = tjk for ∀yk ∈ˆY."
DISTINGUISHABILITY OF UNSEEN LABELS,0.125250501002004,"Theorem 2 provides users with a testable condition: for any pair of unseen labels yi, yj, there should
exist at least one seen label yk such that yk has different label relations to yi and yj, i.e., tik ̸= tjk,
so that PLRM is able to distinguish yi and yj. In preliminary experiments, we observe the violation
of this condition causes a dramatic drop in overall performance (about 10 points). Notably, based on
Theorem 2, users could theoretically guarantee the distinguishability of a pair of unseen labels by
adding only one seen label and corresponding ILFs to break the symmetry."
DISTINGUISHABILITY OF UNSEEN LABELS,0.12625250501002003,Published as a conference paper at ICLR 2022
EXPERIMENTS,0.12725450901803606,"7
EXPERIMENTS"
EXPERIMENTS,0.1282565130260521,"We demonstrate the applicability and performance of our method on image classification tasks
derived from ILSVRC2012 (Russakovsky et al., 2015) and text classification tasks derived from
LSHTC-3 (Partalas et al., 2015). Both datasets have off-the-shelf label relation structure (Deng et al.,
2014; Partalas et al., 2015), which are directed acyclic graphs (DAGS) and from which we could
query pairwise label relations. Indeed, there is a one-to-one mapping between a DAG structure of
labels and a consistent label graph (See App. E.1 for an example). The ILSVRC2012 dataset consists
of 1.2M training images from 1,000 leave classes; for non-leave classes, we follow Deng et al. (2014)
to aggregate images belonging to its descendent classes as its data points. The LSHTC-3 dataset
consists of 456,886 documents and 36,504 labels organized in a DAG."
SETUP,0.12925851703406813,"7.1
SETUP"
SETUP,0.13026052104208416,"For each dataset, we randomly sample 100 different label graphs, each of which consists of 8 classes,
and use each label graph to construct a WIS task. For each label graph, we treat 3 of the sampled
classes as unseen classes and the other 5 as seen classes. The distinguishable condition in Sec. 6
is ensured for all the WIS tasks, and the performance drop when it is violated can be found in
App. G.1. We sample data belonging to unseen classes for our experiments and split them into
train and test set. For image classification tasks, we follow Mazzetto et al. (2021b;a) to train a
branch of image classifiers as supervision sources of seen classes. For text classification tasks, we
made keyword-based labeling functions as supervision sources of seen classes following Zhang et al.
(2021); each of the labeling functions returns its associated label when a certain keyword exists in
the text, otherwise abstains. Notably, all the involved supervision sources are ""weak"" because they
cannot predict the desired unseen classes. Experimental details and additional results are in App. F."
COMPARED METHODS AND RESULTS,0.1312625250501002,"7.2
COMPARED METHODS AND RESULTS"
COMPARED METHODS AND RESULTS,0.13226452905811623,"In addition to the WS-LG baseline, which is an adaptation of Data Programming (Ratner et al., 2019)
to WIS task, and PLRM, we also include the following baselines. Note that all compared methods
input the same data, ILFs, and label relations throughout our experiments for fair comparisons."
COMPARED METHODS AND RESULTS,0.13326653306613226,"Label Relation Majority Voting (LR-MV).
We modify the majority voting method based on the
label’s non-exclusive neighbors: we replace ˆy predicted by any ILF with the set of desired labels
N(ˆy, Y), i.e., the desired labels with non-exclusive relation to ˆy, then aggregate the modified votes."
COMPARED METHODS AND RESULTS,0.1342685370741483,"Weighted Label Relation Majority Voting (W-LR-MV).
LR-MV only leverages exclusive/non-
exclusive label relations. To leverage fine-grained label relations, W-LR-MV attaches a weight to
each replaced label. Specifically, if the ILF’s output ˆy is replaced with its ancestor label y (subsumed
relation), then the weight of y equals 1, while for the other relations, the weight is
1
|Y∗(ˆy)|, where
Y∗(ˆy) = {y ∈Y(ˆy)|tyˆy ̸= tsd}."
COMPARED METHODS AND RESULTS,0.13527054108216433,"For the above methods, we compare the performance of (1) directly applying included models on the
test set and (2) the end models (classifiers) trained with inferred training labels."
COMPARED METHODS AND RESULTS,0.13627254509018036,"Zero-Shot Learning (ZSL).
It is non-trivial to apply ZSL methods, because ZSL assumes label
attributes for all classes and a labeled training set of seen classes, while WIS input an unlabeled
dataset of unseen classes, label relations and ILFs. Fortunately, the Direct Attribute Prediction
(DAP) (Lampert et al., 2013) method is able to make predictions solely based on attributes without
labeled data, by training attribute classifier p(ai|x) for each attribute ai. Therefore we include it in
our experiments. The details of applying DAP can be found in App. F.2."
COMPARED METHODS AND RESULTS,0.1372745490981964,"Evaluation Results.
For a fair comparison, we fix the network architecture of the classifiers for all
the methods. For image classification, we use ResNet-32 (He et al., 2016) and for text classification,
we use logistic regression with pre-trained text embedding (Reimers & Gurevych, 2019). The overall
results for both datasets can be found in Table 2. From the results, we can see that PLRM consistently
outperforms baselines. The advantages of PLRM show the effect of not just leveraging the label
graph, as the baselines do, but modeling the accuracy of ILFs and the strengths of label relations"
COMPARED METHODS AND RESULTS,0.13827655310621242,Published as a conference paper at ICLR 2022
COMPARED METHODS AND RESULTS,0.13927855711422846,Table 2: Averaged evaluation results over 100 WIS tasks derived from LSHTC-3 and ILSVRC2012.
COMPARED METHODS AND RESULTS,0.1402805611222445,"Method
LSHTC-3
ILSVRC2012"
COMPARED METHODS AND RESULTS,0.14128256513026052,"Accuracy
F1-score
Accuracy
F1-score"
COMPARED METHODS AND RESULTS,0.14228456913827656,"DAP
42.90 ± 13.53
35.98 ± 15.73
33.25 ± 3.68
29.13 ± 4.63"
COMPARED METHODS AND RESULTS,0.1432865731462926,Label Model
COMPARED METHODS AND RESULTS,0.14428857715430862,"LR-MV
58.86 ± 10.50
54.33 ± 11.10
46.88 ± 10.66
40.11 ± 16.44
W-LR-MV
59.28 ± 10.47
54.55 ± 11.36
41.39 ± 10.80
30.19 ± 16.94
WS-LG
62.60 ± 10.12
57.50 ± 11.19
53.68 ± 7.62
52.15 ± 7.94"
COMPARED METHODS AND RESULTS,0.14529058116232466,"PLRM
64.65 ± 11.30
60.01 ± 13.39
56.18 ± 7.35
54.94 ± 7.44"
COMPARED METHODS AND RESULTS,0.1462925851703407,End Model
COMPARED METHODS AND RESULTS,0.14729458917835672,"LR-MV
67.17 ± 12.25
62.49 ± 13.95
49.60 ± 12.80
42.83 ± 18.17
W-LR-MV
66.57 ± 11.73
61.80 ± 13.24
42.61 ± 12.46
31.34 ± 18.20
WS-LG
70.69 ± 13.05
67.36 ± 14.24
56.56 ± 9.68
54.57 ± 11.17"
COMPARED METHODS AND RESULTS,0.14829659318637275,"PLRM
72.32 ± 13.18
69.37 ± 14.41
58.38 ± 8.27
56.83 ± 8.49"
COMPARED METHODS AND RESULTS,0.1492985971943888,"as PLRM does. The reported results have high variance, which actually indicates the 100 different
WIS tasks are diverse and have varying difficulty. Also, we can see the end models are much better
than directly applying the label models on the test set; this shows that the end models are able to
generalize beyond the training labels produced by label models."
REAL-WORLD APPLICATION,0.15030060120240482,"7.3
REAL-WORLD APPLICATION"
REAL-WORLD APPLICATION,0.15130260521042085,"In this section, on a commercial advertising system (CAS), we showcase how to reduce human
annotation efforts of new labeling tasks by formulating them as WIS problems. In a CAS, ads tagging
(classification) is a critical application for understanding the semantics of ads copy. When new ads
and tags are added to the system, manual annotations need to be collected for training a new classifier.
As tags are commonly organized as taxonomies, the label relations between existing and new tags are
readily available or can be trivially figured out by humans; Existing classifiers and the heuristic rules
previously used for annotating existing tags could serve as ILFs. Therefore, given (1) an unlabeled
dataset of new tags, (2) the label relations, and (3) ILFs, we formulate it as a WIS problem."
REAL-WORLD APPLICATION,0.1523046092184369,"On such WIS formulation, we apply our method and baselines, to synthesize training labels of new
tags. Specifically, we have two WIS tasks where the tags are under the “Car Accessories” and
“Furniture” categories respectively. For both tasks, we have 3 new tags and leverage 5 existing
tags related to the new ones with given relations. On a test set, we evaluate the performance of
DAP and the quality of labels produced by label models, as shown in Table 3. Note that since we
re-use the existing labeling sources tailored for existing tags as ILFs and obtain label relations from
an existing taxonomy, we achieve these results without any manual annotation or creation of new
labeling functions. This demonstrates the potential of the proposed WIS task in real-world scenarios."
REAL-WORLD APPLICATION,0.1533066132264529,Table 3: Evaluation on product tagging with new tags.
REAL-WORLD APPLICATION,0.15430861723446893,"Category
Metric
DAP
LR-MV
W-LR-MV
WS-LG
PLRM"
REAL-WORLD APPLICATION,0.15531062124248496,"Car Accessories
F1
50.62
68.68
68.06
66.85
76.37
Accuracy
52.83
68.17
67.67
66.33
75.83"
REAL-WORLD APPLICATION,0.156312625250501,"Furniture
F1
30.81
64.70
61.45
70.59
80.57
Accuracy
33.60
72.53
72.13
74.51
82.02"
CONCLUSION,0.15731462925851702,"8
CONCLUSION"
CONCLUSION,0.15831663326653306,"We propose Weak Indirect Supervision (WIS), a new research problem which leverages indirect
supervision sources and label relations to synthesize training labels for training machine learning
models. We develop the first method for WIS called Probabilistic Label Relation Model (PLRM) with
the generalization error bound of both PLRM and end model. We provide a theoretically-principled
sanity test to ensure the distinguishability of unseen labels. Finally, we provide experiments to
demonstrate the effectiveness of PLRM and its advantages over baselines on both academic datasets
and industrial scenario."
CONCLUSION,0.1593186372745491,Published as a conference paper at ICLR 2022
REPRODUCIBILITY STATEMENT,0.16032064128256512,"Reproducibility Statement.
All the assumptions and proofs of our theory can be found in App. C
& D. Examples and illustrations of label graph are in App. E. Experimental details can be found in
App. F. Additional experiments are in App. G."
REFERENCES,0.16132264529058116,REFERENCES
REFERENCES,0.1623246492985972,"Elizabeth S Allman, John A Rhodes, Elena Stanghellini, and Marco Valtorta. Parameter identifiability
of discrete bayesian networks with hidden variables. Journal of Causal Inference, 3(2):189–205,
2015."
REFERENCES,0.16332665330661322,"Stephen H. Bach, Bryan He, Alexander J. Ratner, and Christopher Ré. Learning the structure of
generative models without labeled data. In Proceedings of the 34th International Conference on
Machine Learning (ICML 2017), Sydney, Australia, 2017."
REFERENCES,0.16432865731462926,"Stephen H. Bach, Daniel Rodriguez, Yintao Liu, Chong Luo, Haidong Shao, Cassandra Xia, Souvik
Sen, Alex Ratner, Braden Hancock, Houman Alborzi, Rahul Kuchhal, Chris Ré, and Rob Malkin.
Snorkel drybell: A case study in deploying weak supervision at industrial scale. In Proceedings
of the 2019 International Conference on Management of Data, SIGMOD ’19, pp. 362–375, New
York, NY, USA, 2019. Association for Computing Machinery. ISBN 9781450356435. doi:
10.1145/3299869.3314036. URL https://doi.org/10.1145/3299869.3314036."
REFERENCES,0.1653306613226453,"Peter F Brown, Stephen A Della Pietra, Vincent J Della Pietra, and Robert L Mercer. The mathematics
of statistical machine translation: Parameter estimation. Computational linguistics, 19(2):263–311,
1993."
REFERENCES,0.16633266533066132,"Ming-Wei Chang, Vivek Srikumar, Dan Goldwasser, and Dan Roth. Structured output learning with
indirect supervision. In ICML, pp. 199–206, 2010."
REFERENCES,0.16733466933867736,"Lingjiao Chen, Matei Zaharia, and James Zou. Frugalml: How to use ml prediction apis more
accurately and cheaply. In Advances in Neural Information Processing Systems (NeurIPS), 2020."
REFERENCES,0.1683366733466934,"Carlos d’Andrea and André Mintz. Studying the live cross-platform circulation of images with
computer vision api: An experiment based on a sports media event. International Journal of
Communication, 13(0), 2019. ISSN 1932-8036."
REFERENCES,0.16933867735470942,"Jia Deng, Nan Ding, Yangqing Jia, Andrea Frome, Kevin Murphy, Samy Bengio, Yuan Li, Hartmut
Neven, and Hartwig Adam. Large-scale object classification using label relation graphs. In
European conference on computer vision, pp. 48–64. Springer, 2014."
REFERENCES,0.17034068136272545,"Xin Luna Dong, Xiang He, Andrey Kan, Xian Li, Yan Liang, Jun Ma, Yifan Ethan Xu, Chenwei
Zhang, Tong Zhao, Gabriel Blanco Saldana, et al. Autoknow: Self-driving knowledge collection
for products of thousands of types. In Proceedings of the 26th ACM SIGKDD International
Conference on Knowledge Discovery & Data Mining, pp. 2724–2734, 2020."
REFERENCES,0.1713426853707415,"Jared A. Dunnmon, Alexander J. Ratner, Khaled Saab, Nishith Khandwala, Matthew Markert,
Hersh Sagreiya, Roger Goldman, Christopher Lee-Messer, Matthew P. Lungren, Daniel L.
Rubin, and Christopher Ré. Cross-modal data programming enables rapid medical machine
learning. Patterns, 1(2):100019, 2020. ISSN 2666-3899. doi: https://doi.org/10.1016/j.patter.
2020.100019.
URL https://www.sciencedirect.com/science/article/pii/
S2666389920300192."
REFERENCES,0.17234468937875752,"Jason A Fries, Ethan Steinberg, Saelig Khattar, Scott L Fleming, Jose Posada, Alison Callahan, and
Nigam H Shah. Ontology-driven weak supervision for clinical entity classification in electronic
health records. Nature Communications, 12(1), 2021."
REFERENCES,0.17334669338677355,"Andrea Frome, Greg S Corrado, Jon Shlens, Samy Bengio, Jeff Dean, Marc' Aurelio Ran-
zato, and Tomas Mikolov.
Devise:
A deep visual-semantic embedding model.
In
C. J. C. Burges, L. Bottou, M. Welling, Z. Ghahramani, and K. Q. Weinberger (eds.), Ad-
vances in Neural Information Processing Systems, volume 26, pp. 2121–2129. Curran Asso-
ciates, Inc., 2013. URL https://proceedings.neurips.cc/paper/2013/file/
7cce53cf90577442771720a370c3c723-Paper.pdf."
REFERENCES,0.1743486973947896,Published as a conference paper at ICLR 2022
REFERENCES,0.17535070140280562,"Daniel Y. Fu, Mayee F. Chen, Frederic Sala, Sarah M. Hooper, Kayvon Fatahalian, and Christopher
Ré. Fast and three-rious: Speeding up weak supervision with triplet methods. In Proceedings of
the 37th International Conference on Machine Learning (ICML 2020), 2020."
REFERENCES,0.17635270541082165,"Melody Y. Guan, Varun Gulshan, Andrew M. Dai, and Geoffrey E. Hinton. Who said what: Modeling
individual labelers improves classification. In AAAI, 2018."
REFERENCES,0.17735470941883769,"K. He, X. Zhang, S. Ren, and J. Sun. Deep residual learning for image recognition. In 2016
IEEE Conference on Computer Vision and Pattern Recognition (CVPR), pp. 770–778, 2016. doi:
10.1109/CVPR.2016.90."
REFERENCES,0.17835671342685372,"Sarah Hooper, Michael Wornow, Ying Hang Seah, Peter Kellman, Hui Xue, Frederic Sala, Curtis
Langlotz, and Christopher Re. Cut out the annotator, keep the cutout: better segmentation
with weak supervision. In International Conference on Learning Representations, 2021. URL
https://openreview.net/forum?id=bjkX6Kzb5H."
REFERENCES,0.17935871743486975,"Ashish Khetan, Zachary C. Lipton, and Anima Anandkumar. Learning from noisy singly-labeled data.
In International Conference on Learning Representations, 2018. URL https://openreview.
net/forum?id=H1sUHgb0Z."
REFERENCES,0.18036072144288579,"Christoph H Lampert, Hannes Nickisch, and Stefan Harmeling. Learning to detect unseen object
classes by between-class attribute transfer. In 2009 IEEE Conference on Computer Vision and
Pattern Recognition, pp. 951–958. IEEE, 2009."
REFERENCES,0.1813627254509018,"Christoph H Lampert, Hannes Nickisch, and Stefan Harmeling. Attribute-based classification for zero-
shot visual object categorization. IEEE transactions on pattern analysis and machine intelligence,
36(3):453–465, 2013."
REFERENCES,0.18236472945891782,"Percy Liang, Michael I Jordan, and Dan Klein. Learning dependency-based compositional semantics.
Computational Linguistics, 39(2):389–446, 2013."
REFERENCES,0.18336673346693386,"Pierre Lison, Jeremy Barnes, Aliaksandr Hubin, and Samia Touileb. Named entity recognition
without labelled data: A weak supervision approach. In Proceedings of the 58th Annual Meeting
of the Association for Computational Linguistics, pp. 1518–1533, Online, July 2020. Association
for Computational Linguistics. doi: 10.18653/v1/2020.acl-main.139. URL https://www.
aclweb.org/anthology/2020.acl-main.139."
REFERENCES,0.1843687374749499,"Alessio Mazzetto, Cyrus Cousins, Dylan Sam, Stephen H Bach, and Eli Upfal. Adversarial multi
class learning under weak supervision with performance guarantees. In Marina Meila and Tong
Zhang (eds.), Proceedings of the 38th International Conference on Machine Learning, volume 139
of Proceedings of Machine Learning Research, pp. 7534–7543. PMLR, 18–24 Jul 2021a. URL
https://proceedings.mlr.press/v139/mazzetto21a.html."
REFERENCES,0.18537074148296592,"Alessio Mazzetto, Dylan Sam, Andrew Park, Eli Upfal, and Stephen Bach. Semi-supervised ag-
gregation of dependent weak supervision sources with performance guarantees. In Arindam
Banerjee and Kenji Fukumizu (eds.), Proceedings of The 24th International Conference on Artifi-
cial Intelligence and Statistics, volume 130 of Proceedings of Machine Learning Research, pp.
3196–3204. PMLR, 13–15 Apr 2021b. URL https://proceedings.mlr.press/v130/
mazzetto21a.html."
REFERENCES,0.18637274549098196,"George A Miller. Wordnet: a lexical database for english. Communications of the ACM, 38(11):
39–41, 1995."
REFERENCES,0.187374749498998,"Shikhar Murty, Pat Verga, L. Vilnis, and A. McCallum. Finer grained entity typing with typenet.
AKBC Workshop, 2017."
REFERENCES,0.18837675350701402,"Ioannis Partalas, Aris Kosmopoulos, Nicolas Baskiotis, Thierry Artières, George Paliouras, Éric
Gaussier, Ion Androutsopoulos, Massih-Reza Amini, and Patrick Gallinari. LSHTC: A benchmark
for large-scale text classification. CoRR, abs/1503.08581, 2015."
REFERENCES,0.18937875751503006,"Meng Qu, Tianyu Gao, Louis-Pascal Xhonneux, and Jian Tang. Few-shot relation extraction via
bayesian meta-learning on relation graphs. In International Conference on Machine Learning, pp.
7867–7876. PMLR, 2020."
REFERENCES,0.1903807615230461,Published as a conference paper at ICLR 2022
REFERENCES,0.19138276553106212,"Ariadna Quattoni, Michael Collins, and Trevor Darrell. Conditional random fields for object recogni-
tion. Advances in neural information processing systems, 17:1097–1104, 2004."
REFERENCES,0.19238476953907815,"Aditi Raghunathan, Roy Frostig, John Duchi, and Percy Liang. Estimation from indirect supervision
with linear moments. In International Conference on Machine Learning (ICML), 2016."
REFERENCES,0.1933867735470942,"A. J. Ratner, Christopher M. De Sa, Sen Wu, Daniel Selsam, and C. Ré. Data programming:
Creating large training sets, quickly. In Proceedings of the 29th Conference on Neural Information
Processing Systems (NIPS 2016), Barcelona, Spain, 2016."
REFERENCES,0.19438877755511022,"A. J. Ratner, B. Hancock, J. Dunnmon, F. Sala, S. Pandey, and C. Ré. Training complex models with
multi-task weak supervision. In Proceedings of the AAAI Conference on Artificial Intelligence,
Honolulu, Hawaii, 2019."
REFERENCES,0.19539078156312625,"Alexander Ratner, Stephen H. Bach, Henry Ehrenberg, Jason Fries, Sen Wu, and Christopher
Ré. Snorkel: Rapid training data creation with weak supervision. In Proceedings of the 44th
International Conference on Very Large Data Bases (VLDB), Rio de Janeiro, Brazil, 2018."
REFERENCES,0.1963927855711423,"Nils Reimers and Iryna Gurevych. Sentence-bert: Sentence embeddings using siamese bert-networks.
In Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing.
Association for Computational Linguistics, 11 2019. URL https://arxiv.org/abs/1908.
10084."
REFERENCES,0.19739478957915832,"Bernardino Romera-Paredes and Philip Torr. An embarrassingly simple approach to zero-shot
learning. In International conference on machine learning, pp. 2152–2161. PMLR, 2015."
REFERENCES,0.19839679358717435,"Olga Russakovsky, Jia Deng, Hao Su, Jonathan Krause, Sanjeev Satheesh, Sean Ma, Zhiheng Huang,
Andrej Karpathy, Aditya Khosla, Michael Bernstein, Alexander C. Berg, and Li Fei-Fei. Imagenet
large scale visual recognition challenge. Int. J. Comput. Vision, 115(3):211–252, December 2015.
ISSN 0920-5691. doi: 10.1007/s11263-015-0816-y. URL https://doi.org/10.1007/
s11263-015-0816-y."
REFERENCES,0.19939879759519039,"Esteban Safranchik, Shiying Luo, and Stephen Bach. Weakly supervised sequence tagging from
noisy rules. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 34, pp.
5570–5578, 2020."
REFERENCES,0.20040080160320642,"Arnab Sinha, Zhihong Shen, Yang Song, Hao Ma, Darrin Eide, Bo-June Paul Hsu, and Kuansan
Wang. An overview of microsoft academic service (mas) and applications. In WWW, 2015."
REFERENCES,0.20140280561122245,"Shashank Srivastava, Igor Labutov, and Tom Mitchell. Zero-shot learning of classifiers from natural
language quantification.
In Proceedings of the 56th Annual Meeting of the Association for
Computational Linguistics (Volume 1: Long Papers), pp. 306–316, Melbourne, Australia, July
2018. Association for Computational Linguistics. doi: 10.18653/v1/P18-1029. URL https:
//www.aclweb.org/anthology/P18-1029."
REFERENCES,0.20240480961923848,"The Gene Ontology Consortium. The Gene Ontology Resource: 20 years and still GOing strong.
Nucleic Acids Research, 47(D1):D330–D338, 11 2018. ISSN 0305-1048. doi: 10.1093/nar/
gky1055. URL https://doi.org/10.1093/nar/gky1055."
REFERENCES,0.20340681362725452,"Paroma Varma, Frederic Sala, Shiori Sagawa, Jason Alan Fries, Daniel Y. Fu, Saelig Khattar, Ash-
wini Ramamoorthy, Ke Xiao, Kayvon Fatahalian, James Priest, and Christopher Ré. Multi-
resolution weak supervision for sequential data.
In Hanna M. Wallach, Hugo Larochelle,
Alina Beygelzimer, Florence d’Alché-Buc, Emily B. Fox, and Roman Garnett (eds.), Ad-
vances in Neural Information Processing Systems 32: Annual Conference on Neural Informa-
tion Processing Systems 2019, NeurIPS 2019, December 8-14, 2019, Vancouver, BC, Canada,
pp. 192–203, 2019. URL https://proceedings.neurips.cc/paper/2019/hash/
93db85ed909c13838ff95ccfa94cebd9-Abstract.html."
REFERENCES,0.20440881763527055,"Kaifu Wang, Qiang Ning, and Dan Roth. Learnability with indirect supervision signals. Advances in
Neural Information Processing Systems 32, 2020."
REFERENCES,0.20541082164328658,"Wei Wang, Vincent W Zheng, Han Yu, and Chunyan Miao. A survey of zero-shot learning: Settings,
methods, and applications. ACM Transactions on Intelligent Systems and Technology (TIST), 10
(2):1–37, 2019."
REFERENCES,0.20641282565130262,Published as a conference paper at ICLR 2022
REFERENCES,0.20741482965931865,"Yuanshun Yao, Zhujun Xiao, Bolun Wang, Bimal Viswanath, Haitao Zheng, and Ben Y. Zhao.
Complexity vs. performance: Empirical analysis of machine learning as a service. In Proceedings
of the 2017 Internet Measurement Conference, IMC ’17, pp. 384–397, New York, NY, USA, 2017.
Association for Computing Machinery. ISBN 9781450351188. doi: 10.1145/3131365.3131372.
URL https://doi.org/10.1145/3131365.3131372."
REFERENCES,0.20841683366733466,"Kaichao You, Zhi Kou, Mingsheng Long, and Jianmin Wang. Co-tuning for transfer learning.
Advances in Neural Information Processing Systems, 33, 2020."
REFERENCES,0.2094188376753507,"Eric Zhan, Stephan Zheng, Yisong Yue, Long Sha, and Patrick Lucey. Generating multi-agent
trajectories using programmatic weak supervision. In International Conference on Learning
Representations, 2019. URL https://openreview.net/forum?id=rkxw-hAcFQ."
REFERENCES,0.21042084168336672,"Jieyu Zhang, Yue Yu, Yinghao Li, Yujing Wang, Yaming Yang, Mao Yang, and Alexander Ratner.
Wrench: A comprehensive benchmark for weak supervision. In Thirty-fifth Conference on Neural
Information Processing Systems Datasets and Benchmarks Track (Round 2), 2021."
REFERENCES,0.21142284569138275,"Yivan Zhang, Nontawat Charoenphakdee, and Masashi Sugiyama. Learning from indirect observa-
tions, 2019."
REFERENCES,0.2124248496993988,"Wenxuan Zhou, Hongtao Lin, Bill Yuchen Lin, Ziqi Wang, Junyi Du, Leonardo Neves, and Xiang
Ren. Nero: A neural rule grounding framework for label-efficient relation extraction. The Web
Conference, 2020."
REFERENCES,0.21342685370741482,Published as a conference paper at ICLR 2022
REFERENCES,0.21442885771543085,"SUPPLEMENTARY MATERIALS FOR
“CREATING TRAINING SETS VIA WEAK INDIRECT SUPERVISION”"
REFERENCES,0.2154308617234469,"The supplementary materials are organized as follows. In Appendix A, we provide a glossary of
variables and symbols used in this paper. In Appendix B, we provide the details of PLRM model.
In Appendix C and D, we provide the detailed proofs of Theorem 2 and Theorem 1 respectively. In
Appendix E, we provide the detailed examples and illustrations of label graph in WIS. In Appendix F
and G, we provide experimental details and additional experiment resulst respectively."
REFERENCES,0.21643286573146292,"A
GLOSSARY OF SYMBOLS"
REFERENCES,0.21743486973947895,Table 4: Glossary of variables and symbols used in this paper.
REFERENCES,0.218436873747495,"Symbol
Simplified
Used for"
REFERENCES,0.21943887775551102,"Xi
The i-th data point, Xi ∈X
m
Number of data points
Yi
The true desired label of the i-th data point, Yi ∈Y
y
A semantic label, e.g., ""dog""
Y
The set of desired labels, Y = {y1, y2, . . . , yk}
k
Cardinality of Y, i.e., k = |Y|"
REFERENCES,0.22044088176352705,"λj
The j-th Indirect labeling function (ILF)
n
Number of ILF
ˆY j
i
The output label of j-th ILF on i-th data point, ˆY j
i ∈Yλj
ˆYi
The concatenation of ILFs’ output, ˆYi = [ ˆY 1
i , ˆY 2
i , . . . , ˆY n
i ]
ˆyj
A semantic label in the label space of λj
Yλj
Yj
Label label space of ILF λj, Yλj = {ˆyj
1, ˆyj
2, . . . , ˆyj
kλj }
kλj
kj
Cardinality of the output space of ILF λ, i.e., kλj = |Yλj|
ˆY
Union set of all the Yλj, ˆY = {ˆy1, ˆy2, . . . , ˆyˆk}
ˆk
Cardinality of the ˆY, i.e., ˆk = | ˆY|
K
Total number of labels, i.e., K = ˆk + k"
REFERENCES,0.22144288577154309,"¯Y i
Latent binary variable indicating whether the data should be assigned ˆyi ∈ˆY.
¯Y
Concatenation of all latent binary variable, ¯Y = [ ¯Y 1, . . . , ¯Y ˆk]"
REFERENCES,0.22244488977955912,"G
Label graph, G = ( ˆY ∪Y, E)
E
The set of label relations, E = {(yi, yj, tyiyj)|tyiyj ∈T , i < j, ∀yi, yj ∈V}
T
The set of label relation types, T = {te, to, tsd, tsg}
te
Exclusive label relation
to
Overlap label relation
tsg
Subsuming label relation
tsd
Subsumed label relation
N(y, ˆY)
the set of non-exclusive neighbors of a given label y in ˆY"
REFERENCES,0.22344689378757515,"ϕ
A single dependency, or, factor function
Φ
Concatenation of all individual dependency
M
Number of total dependencies
θ
A single parameter of the PGM
Θ
Concatenation of all parameters of the PGM, Θ ∈RM
ˆΘ
The learned parameters
Θ∗
The golden parameters
W
The parameter of an end model
ˆW
The learned parameters
W ∗
The golden parameters"
REFERENCES,0.22444889779559118,Published as a conference paper at ICLR 2022
REFERENCES,0.22545090180360722,"B
DETAILS OF THE PLRM"
REFERENCES,0.22645290581162325,"We use Y, ¯Y , and ˆY to represent random vector. Then, we give the formal form of the PLRM as:"
REFERENCES,0.22745490981963928,"PΘ(Y, ¯Y , ˆY ) ∝exp

Θ⊤Φ(Y, ¯Y , ˆY )

.
(7)"
REFERENCES,0.22845691382765532,"Recall that Y is the unobserved true label, ¯Y is the binary random vector, each of whose binary value
¯Y i reflects whether the data should be assigned seen label ˆyi ∈ˆY, and ˆY is the concatenated outputs
of ILFs. Specifically, we enumerate Φ as below:"
REFERENCES,0.22945891783567135,"1. (Pseudo accuracy dependency): ∀j ∈[n], y ∈Y/{unknown}, ˆy ∈Yλj, we have"
REFERENCES,0.23046092184368738,"ϕAcc
y,ˆy,j(Y, ˆY j) := 1{Y = y ∧ˆY j = ˆy ∧ˆy ∈N(y, Yλj)}1"
REFERENCES,0.23146292585170342,"2. (Accuracy dependency): ∀j ∈[n], ˆyi ∈ˆY ∩Yj we have"
REFERENCES,0.23246492985971945,"ϕAcc
ˆyi,j( ¯Y i, ˆY j) := 1{ ¯Y i = 1 ∧ˆY j = ˆyi}"
REFERENCES,0.23346693386773548,"3. (Label relation dependency between seen labels): ∀ˆyi, ˆyj ∈ˆY, i < j"
REFERENCES,0.23446893787575152,"(a) if tˆyi ˆyj = te, we have"
REFERENCES,0.23547094188376755,"ϕe
ˆyi,ˆyj( ¯Y i, ¯Y j) := −1{ ¯Y i = 1 ∧¯Y j = 1}"
REFERENCES,0.23647294589178355,"(b) if tˆyi ˆyj = to, we have"
REFERENCES,0.2374749498997996,"ϕo
ˆyi,ˆyj( ¯Y i, ¯Y j) := 1{ ¯Y i = 1 ∧¯Y j = 1}"
REFERENCES,0.23847695390781562,"(c) if tˆyi ˆyj = tsg, we have"
REFERENCES,0.23947895791583165,"ϕsg
ˆyi,ˆyj( ¯Y i, ¯Y j) := −1{ ¯Y i = 0 ∧¯Y j = 1}"
REFERENCES,0.24048096192384769,"(d) if tˆyi ˆyj = tsd, we have"
REFERENCES,0.24148296593186372,"ϕsd
ˆyi,ˆyj( ¯Y i, ¯Y j) := −1{ ¯Y i = 1 ∧¯Y j = 0}"
REFERENCES,0.24248496993987975,"4. (Label relation dependency between desired and seen labels): ∀y ∈Y/{unknown}, ˆyi ∈ˆY"
REFERENCES,0.24348697394789579,"(a) if tyˆyi = te, we have"
REFERENCES,0.24448897795591182,"ϕe
y,ˆyi(Y, ¯Y i) := −1{Y = y ∧¯Y i = 1}
(b) if tyˆyi = to, we have"
REFERENCES,0.24549098196392785,"ϕo
y,ˆyi(Y, ¯Y i) := 1{Y = y ∧¯Y i = 1}
(c) if tyˆyi = tsg, we have"
REFERENCES,0.24649298597194388,"ϕsg
y,ˆyi(Y, ¯Y i) := −1{Y ̸= y ∧¯Y i = 1}"
REFERENCES,0.24749498997995992,"(d) if tyˆyi = tsd, we have"
REFERENCES,0.24849699398797595,"ϕsd
y,ˆyi(Y, ¯Y i) := −1{Y = y ∧¯Y i = 0}"
REFERENCES,0.24949899799599198,"And example of our PLRM is shown in Fig. 4, where square with difference colors corresond to
different dependency/factor functions in PLRM."
REFERENCES,0.250501002004008,"zOTRes8yCuw="">AB6HicbVBNS8NAEJ3Ur1q/qh69LBbBU0ikqMeCF48t2FZpQ9lsJ+3azSbsboRS+gu8eFDEqz/Jm/GbZuDtj4YeLw3w8y8MBVcG8/7dgpr6xubW8Xt0s7u3v5B+fCopZNMWyRCTqPqQaBZfYNwIvE8V0jgU2A5HNzO/YRK80TemXGKQUwHkecUWOlxkOvXPFcbw6ySvycVCBHvVf+6vYTlsUoDRNU647vpSaYUGU4EzgtdTONKWUjOsCOpZLGqIPJ/NApObNKn0SJsiUNmau/JyY01noch7Yzpmaol72Z+J/XyUx0HUy4TDODki0WRZkgJiGzr0mfK2RGjC2hTHF7K2FDqigzNpuSDcFfnmVtC5c/9KtNqVmpvHUYQTOIVz8OEKanALdWgCA4RneIU359F5cd6dj0VrwclnjuEPnM8ftCeM0g=</latexit>Y"
REFERENCES,0.251503006012024,"Label Relation Dependency
True Accuracy Dependency
Pseudo Accuracy Dependency"
REFERENCES,0.25250501002004005,"¯Y 1
¯Y 2"
REFERENCES,0.2535070140280561,"ˆY 1
ˆY 2
ˆY 3"
REFERENCES,0.2545090180360721,Figure 4: PLRM.
REFERENCES,0.25551102204408815,"1When ˆy /∈N(y, Yλj), ϕAcc
y,ˆy,j is always zero and will not occur in the model. Here we use this form for the
sack of rigorous representation."
REFERENCES,0.2565130260521042,Published as a conference paper at ICLR 2022
REFERENCES,0.2575150300601202,"C
PROOF OF THEOREM 2"
REFERENCES,0.25851703406813625,"C.1
SIMPLIFYING THE NOTATION"
REFERENCES,0.2595190380761523,"To simplify the indexing of dependencies, we use Φ1 to represent the concatenation of ϕ which
involves both Y and ¯Y , Φ2 to represent the concatenation of ϕ which involve both Y and ˆΛ, and Φ3
to represent the concatenation of remaining ϕ which do not involve Y."
REFERENCES,0.2605210420841683,"Specifically, Φ1 consists of k ×ˆk components corresponding to the dependency between the k desired
labels and the ˆk seen labels. We use the subscript i, j to denote the dependency function between the
desired label yi and seen label ˆyj, i.e.,"
REFERENCES,0.26152304609218435,"Φ1
i,j = ϕ?
yi,ˆyj,"
REFERENCES,0.2625250501002004,where ? is the corresponding relation.
REFERENCES,0.2635270541082164,"Similarly, Φ2 consists of k × (Pn
j=1 kj) components corresponding to the dependency between the
k desired labels and the kj seen labels output by the ILF λj (j ∈[n]), and we use Φ2
i,j,l to denote the"
REFERENCES,0.26452905811623245,"dependency of yi and ˆyj
l , and Φ2
i,j = (Φ2
i,j,l)kj
l=1to denote the dependency of yi and ˆyj."
REFERENCES,0.2655310621242485,"According to Φ1, Φ2, and Φ3, we also divide the parameter Θ into Θ1 (with elements being Θ1
i,j
correspondingly), Θ2 (with elements being Θ2
i,j = (Θ2
i,j,l)kj
l=1 correspondingly), and Θ3, and the
joint probability is then given as:"
REFERENCES,0.2665330661322645,"PΘ(Y, ¯Y , ˆY ) =
exp

(Θ1)TΦ1(Y, ¯Y ) + (Θ2)⊤Φ2(Y, ˆY ) + (Θ3)TΦ3( ¯Y , ˆY )
 P"
REFERENCES,0.26753507014028055,"Y ′, ¯Y ′, ˆY ′ exp

(Θ1)⊤Φ1(Y ′, ¯Y ′) + (Θ2)⊤Φ2(Y ′, ˆY ′) + (Θ3)TΦ3( ¯Y ′, ˆY ′)

(8)"
REFERENCES,0.2685370741482966,"Also, for notation convenience, we adopt following simplifications:"
REFERENCES,0.2695390781563126,"1. ∀yi ∈Y →∀i ∈[k] since |Y| = k, similarly, ∀ˆyi ∈Yj →∀i ∈[kj] and ∀ˆyi ∈ˆY →∀i ∈
[ˆk];"
REFERENCES,0.27054108216432865,2. ∀λj →∀j ∈[n] since we have n ILFs in total;
REFERENCES,0.2715430861723447,"3. ϕ
tyiyj
yi,yj →ϕt
yi,yj where t = tyiyj and can be seen from the subscript of the dependency."
REFERENCES,0.2725450901803607,"C.2
PROPOSITIONS AND LEMMAS"
REFERENCES,0.27354709418837675,"First, we state some propositions and lemmas that will be useful in the proof to come."
REFERENCES,0.2745490981963928,"Proposition 1 (Multi-class classification). For a multi-class classification task, ∀yi, yj ∈Y, we have
tyiyj = te. Similarly, ∀ˆya, ˆyb ∈ˆY, we have tˆya ˆyb = te."
REFERENCES,0.2755511022044088,"Lemma 1. For a consistent label graph G and ∀ˆyl ∈ˆY, ∀yi, yj ∈Y, if tyi ˆyl = to, we have
tyj ˆyl ̸= tsg ."
REFERENCES,0.27655310621242485,"Proof. For ∀yi, yj ∈Y, based on Proposition 1, we know tyiyj = te, which implies (1) the
intersection of the sets labeled by yi and yj is empty. For ∀ˆyl ∈ˆY, if tyi ˆyl = to, we have (2)
the intersection of the sets labeled by yi and ˆyl is not empty. If tyj ˆyl = tsg, which implies (3)
yj ⫌ˆyl. Based on (2)(3), we have yi ∩yj ̸= ∅, which is contradictory to (1). Thus, we prove when
tyi ˆyl = to, tyj ˆyl ̸= tsg."
REFERENCES,0.2775551102204409,"Lemma 2. For an informative ILF λj and given any yd ∈Y, there exists some ˆyl ∈Yj, such that,
Φ2
d,j,l(yd, ˆy) = 0, ∀l ∈[kj]."
REFERENCES,0.2785571142284569,"Proof. Because ILF λj is informative, we know there exists one ˆya ∈Yj such that ˆya is exclusive to
yd, i.e., ˆya /∈N(yd, Yj). Therefore, for any ˆyl ∈ˆY, either ˆya ̸= ˆyl, or ˆyl = ˆya /∈Yj, which leads to
the conclusion by the definition of Φ2
d,j,l = ϕAcc
yd,ˆyl,j."
REFERENCES,0.27955911823647295,Published as a conference paper at ICLR 2022
REFERENCES,0.280561122244489,"C.3
DEFINITIONS"
REFERENCES,0.281563126252505,"Before the main proof, we connect the indistinguishablity of label relation structure with the depen-
dency structure of PLRM by introducing the concept of symmetry as follows:"
REFERENCES,0.28256513026052105,"Definition 4 (Symmetry). For yi, yj ∈Y, we say yi and yj have symmetric dependency structure if
the following equation holds:"
REFERENCES,0.2835671342685371,"Φ1
i,l = Φ1
j,l, ∀l ∈ˆk;"
REFERENCES,0.2845691382765531,"Φ2
i,a,b = Φ2
j,a,b, ∀a ∈[n], b ∈[ka].
(9)"
REFERENCES,0.28557114228456915,"Based on the construction of PLRM, we know that for ∀yi, yj ∈Y, ∀ˆyb ∈ˆY, tyi ˆyb = tyj ˆyb (the
statement in Theorem 2) is equivalent to yi and yj have symmetric dependency structure."
REFERENCES,0.2865731462925852,"C.4
EQUIVALENT STATEMENT OF THEOREM 2"
REFERENCES,0.2875751503006012,"Our main result states that asymmetric is equivalent to distinguishable as in the following theorem,
which can readily be seen to be identical to Theorem 2 in the main body of the paper:"
REFERENCES,0.28857715430861725,"Theorem 3. For a probability model defined as Eq. (8) induced from a consistent label graph and
informative ILFs, for any pair of yi, yj ∈Y, yi and yj are distinguishable if and only if they have
asymmetric dependency structure."
REFERENCES,0.2895791583166333,"C.5
PROOF OF THE NECESSITY IN THEOREM 3: NECESSARY CONDITION"
REFERENCES,0.2905811623246493,"We first prove that for any yi, yj ∈Y, yi and yj have asymmetric dependency structure is the
necessary condition of that they are distinguishable."
REFERENCES,0.29158316633266534,"Proof of Theorem 3. We prove this theorem by reduction to absurdity. Suppose yi and yj are sym-
metric. Then, by Eq. (8), the distribution of Y condition on any ¯Y and ˆY can be calculated as
follows:"
REFERENCES,0.2925851703406814,"PΘ(Y = yi| ¯Y , ˆY ) = PΘ(yi, ¯Y , ˆY )"
REFERENCES,0.2935871743486974,"PΘ( ¯Y , ˆY )
."
REFERENCES,0.29458917835671344,"On the other hand, applying Y = yi in the definition of Φ2 leads to"
REFERENCES,0.2955911823647295,"Φ2
r,a,l(yi, ·) = 0, ∀r ∈[k], r ̸= i, ∀a ∈[n], ∀l ∈[ka]."
REFERENCES,0.2965931863727455,"We further separate Φ1 into (Φ1
i )k
i=1, where Φ1
i collects all the dependency in Φ1 with yi involved,
i.e.,"
REFERENCES,0.29759519038076154,"Φ1
i = (Φ1
i,j)
ˆk
j=1,"
REFERENCES,0.2985971943887776,"with the corresponding parameters respectively denoted as Θ1
i with Θ1 = (Θ1
i )k
i=1. Similarly, Φ2 is
also divided into (Φ2
i )k
i=1 following the same routine and Θ2 is respectively divided into (Θ2
i )k
i=1.
Specifically, if yi and yj are symmetric, we further have"
REFERENCES,0.2995991983967936,"Φ1
i = Φ1
j, Φ2
i = Φ2
j."
REFERENCES,0.30060120240480964,"Based on the notation, PΘ(Y = yi| ¯Y , ˆY ) can then be represented as"
REFERENCES,0.3016032064128257,"PΘ(Y = yi| ¯Y , ˆY ) X"
REFERENCES,0.3026052104208417,"Y ′
exp

(Θ1)⊤Φ1(Y ′, ¯Y ) + (Θ2)⊤Φ2(Y ′, ˆY ) + (Θ3)TΦ3( ¯Y , ˆY )
! = exp k
X"
REFERENCES,0.30360721442885774,"l=1
(Θ1
l )TΦ1
l (yi, ¯Y ) + k
X"
REFERENCES,0.3046092184368738,"l=1
(Θ2
l )TΦ2
l (yi, ˆY ) + (Θ3)TΦ3( ¯Y , ˆY ) !"
REFERENCES,0.30561122244488975,Published as a conference paper at ICLR 2022
REFERENCES,0.3066132264529058,which further leads to
REFERENCES,0.3076152304609218,"PΘ(Y = yi| ¯Y , ˆY ) X"
REFERENCES,0.30861723446893785,"Y ′
exp

(Θ1)⊤Φ1(Y ′, ¯Y ) + (Θ2)⊤Φ2(Y ′, ˆY )
! = exp k
X"
REFERENCES,0.3096192384769539,"l=1
(Θ1
l )TΦ1
l (yi, ¯Y ) + (Θ2
i )TΦ2
i (yi, ˆY ) ! (10)"
REFERENCES,0.3106212424849699,"which is independent of Θ3. Similarly,"
REFERENCES,0.31162324649298595,"PΘ(Y = yj| ¯Y , ˆY ) X"
REFERENCES,0.312625250501002,"Y ′
exp

(Θ1)⊤Φ1(Y ′, ¯Y ) + (Θ2)⊤Φ2(Y ′, ˆY )
! = exp k
X"
REFERENCES,0.313627254509018,"l=1
(Θ1
l )TΦ1
l (yi, ¯Y ) + (Θ2
j)TΦ2
j(yj, ˆY ) ! (11)"
REFERENCES,0.31462925851703405,"and ∀l ∈[k]/{i, j},"
REFERENCES,0.3156312625250501,"PΘ(Y = yl| ¯Y , ˆY ) X"
REFERENCES,0.3166332665330661,"Y ′
exp

(Θ1)⊤Φ1(Y ′, ¯Y ) + (Θ2)⊤Φ2(Y ′, ˆY )
! = exp k
X"
REFERENCES,0.31763527054108215,"l=1
(Θ1
l )TΦ1
l (yi, ¯Y ) + (Θ2
l )TΦ2
l (yl, ˆY ) ! (12)"
REFERENCES,0.3186372745490982,"Let ˜Θ be defined as follows:
˜Θ1
i = Θ1
j, ˜Θ1
j = Θ1
i , ˜Θ1
l = Θ1
l , ∀l /∈{i, j},"
REFERENCES,0.3196392785571142,"˜Θ2
i = Θ2
j, ˜Θ2
j = Θ2
i , ˜Θ2
l = Θ2
l , ∀l /∈{i, j},
and
˜Θ3 = Θ3.
We then have"
REFERENCES,0.32064128256513025,"PΘ(Y = yi| ¯Y , ˆY )"
REFERENCES,0.3216432865731463,"P ˜Θ(Y = yj| ¯Y , ˆY ) = P"
REFERENCES,0.3226452905811623,"Y ′ exp

(˜Θ1)⊤Φ1(Y ′, ¯Y ) + (˜Θ2)⊤Φ2(Y ′, ˆY )
 P"
REFERENCES,0.32364729458917835,"Y ′ exp

(Θ1)⊤Φ1(Y ′, ¯Y ) + (Θ2)⊤Φ2(Y ′, ˆY )
"
REFERENCES,0.3246492985971944,"· exp ((Θ1
i )T(Φ1
i (yi, ¯Y ) −Φ1
j(yj, ¯Y )) + (Θ1
j)T(Φ1
j(yi, ¯Y ) −Φ1
i (yj, ¯Y )) + (Θ2
i )T(Φ2
i (yi, ˆY ) −Φ2
j(yj, ˆY ))) = P"
REFERENCES,0.3256513026052104,"Y ′ exp

(˜Θ1)⊤Φ1(Y ′, ¯Y ) + (˜Θ2)⊤Φ2(Y ′, ˆY )
 P"
REFERENCES,0.32665330661322645,"Y ′ exp

(Θ1)⊤Φ1(Y ′, ¯Y ) + (Θ2)⊤Φ2(Y ′, ˆY )
."
REFERENCES,0.3276553106212425,"Similarly,"
REFERENCES,0.3286573146292585,"PΘ(Y = yj| ¯Y , ˆY )"
REFERENCES,0.32965931863727455,"P ˜Θ(Y = yi| ¯Y , ˆY ) = P"
REFERENCES,0.3306613226452906,"Y ′ exp

(˜Θ1)⊤Φ1(Y ′, ¯Y ) + (˜Θ2)⊤Φ2(Y ′, ˆY )
 P"
REFERENCES,0.3316633266533066,"Y ′ exp

(Θ1)⊤Φ1(Y ′, ¯Y ) + (Θ2)⊤Φ2(Y ′, ˆY )
"
REFERENCES,0.33266533066132264,"· exp ((Θ1
j)T(Φ1
j(yj, ¯Y ) −Φ1
i (yi, ¯Y )) + (Θ1
i )T(Φ1
i (yj, ¯Y ) −Φ1
j(yi, ¯Y )) + (Θ2
j)T(Φ2
j(yj, ˆY ) −Φ2
i (yi, ˆY ))) = P"
REFERENCES,0.3336673346693387,"Y ′ exp

(˜Θ1)⊤Φ1(Y ′, ¯Y ) + (˜Θ2)⊤Φ2(Y ′, ˆY )
"
REFERENCES,0.3346693386773547,"P
Y ′ exp

(Θ1)⊤Φ1(Y ′, ¯Y ) + (Θ2)⊤Φ2(Y ′, ˆY )
."
REFERENCES,0.33567134268537074,Published as a conference paper at ICLR 2022
REFERENCES,0.3366733466933868,"and ∀l ∈[k]/{i, j},"
REFERENCES,0.3376753507014028,"PΘ(Y = yl| ¯Y , ˆY )"
REFERENCES,0.33867735470941884,"P ˜Θ(Y = yl| ¯Y , ˆY )
= P"
REFERENCES,0.3396793587174349,"Y ′ exp

(˜Θ1)⊤Φ1(Y ′, ¯Y ) + (˜Θ2)⊤Φ2(Y ′, ˆY )
 P"
REFERENCES,0.3406813627254509,"Y ′ exp

(Θ1)⊤Φ1(Y ′, ¯Y ) + (Θ2)⊤Φ2(Y ′, ˆY )
."
REFERENCES,0.34168336673346694,"Similarly, we have"
REFERENCES,0.342685370741483,"PΘ(Y = unknown| ¯Y , ˆY )"
REFERENCES,0.343687374749499,"P ˜Θ(Y = unknown| ¯Y , ˆY )
= P"
REFERENCES,0.34468937875751504,"Y ′ exp

(˜Θ1)⊤Φ1(Y ′, ¯Y ) + (˜Θ2)⊤Φ2(Y ′, ˆY )
 P"
REFERENCES,0.3456913827655311,"Y ′ exp

(Θ1)⊤Φ1(Y ′, ¯Y ) + (Θ2)⊤Φ2(Y ′, ˆY )
."
REFERENCES,0.3466933867735471,"Therefore, we have"
REFERENCES,0.34769539078156314,"PΘ(Y = yi| ¯Y , ˆY )"
REFERENCES,0.3486973947895792,"P ˜Θ(Y = yj| ¯Y , ˆY )
= PΘ(Y = yj| ¯Y , ˆY )"
REFERENCES,0.3496993987975952,"P ˜Θ(Y = yi| ¯Y , ˆY )
= PΘ(Y = y| ¯Y , ˆY )"
REFERENCES,0.35070140280561124,"P ˜Θ(Y = y| ¯Y , ˆY )
, ∀y ∈Y/{yi, yj}."
REFERENCES,0.3517034068136273,"Since
PΘ(Y = yi| ¯Y , ˆY ) + PΘ(Y = yj| ¯Y , ˆY ) +
X"
REFERENCES,0.3527054108216433,"l̸=i,j
PΘ(Y = yl| ¯Y , ˆY ) = 1,"
REFERENCES,0.35370741482965934,"and
P ˜Θ(Y = yj| ¯Y , ˆY ) + P ˜Θ(Y = yi| ¯Y , ˆY ) +
X"
REFERENCES,0.35470941883767537,"l̸=i,j
P ˜Θ(Y = yl| ¯Y , ˆY ) = 1,"
REFERENCES,0.3557114228456914,"we obtain that
PΘ(Y = yi| ¯Y , ˆY ) = P ˜Θ(Y = yj| ¯Y , ˆY )"
REFERENCES,0.35671342685370744,"PΘ(Y = yj| ¯Y , ˆY ) = P ˜Θ(Y = yi| ¯Y , ˆY )"
REFERENCES,0.35771543086172347,"PΘ(Y = yl| ¯Y , ˆY ) = P ˜Θ(Y = yl| ¯Y , ˆY ),
which indicates yi and yj indistinguishable, and leads to a contradictory."
REFERENCES,0.3587174348697395,The proof is completed.
REFERENCES,0.35971943887775554,"C.6
PROOF OF THEOREM 3: SUFFICIENT CONDITION"
REFERENCES,0.36072144288577157,"We then prove that for any yi, yj ∈Y, yi and yj have asymmetric dependency structure is the
sufficient condition of that they are distinguishable."
REFERENCES,0.36172344689378755,"Proof. We use the same notations (Θ1
i )k
i=1, (Θ2
i )k
i=1, and Θ3 in Appendix C.5 to denote the separation
of the parameter Θ. Let Θ be any parameter satisfying that there exists a parameter ˜Θ, such that Eq.
(4-5) holds. By Eqs. (10), (11), and Eq. (12) together with Eqs. (4-5), we have ∀r ∈[k], r ̸= i, j,"
REFERENCES,0.3627254509018036,"exp ((Θ1
i )TΦ1
i (yi, ¯Y ) + (Θ1
j)TΦ1
j(yi, ¯Y ) + (Θ2
i )TΦ2
i (yi, ˆY ))"
REFERENCES,0.3637274549098196,"exp ((˜Θ1
i )TΦ1
i (yj, ¯Y ) + (˜Θ1
j)TΦ1
j(yj, ¯Y ) + (˜Θ2
j)TΦ2
j(yj, ˆY ))"
REFERENCES,0.36472945891783565,"=exp ((Θ1
i )TΦ1
i (yj, ¯Y ) + (Θ1
j)TΦ1
j(yj, ¯Y ) + (Θ2
j)TΦ2
j(yj, ˆY ))"
REFERENCES,0.3657314629258517,"exp ((˜Θ1
i )TΦ1
i (yi, ¯Y ) + (˜Θ1
j)TΦ1
j(yi, ¯Y ) + (˜Θ2
i )TΦ2
i (yi, ˆY ))"
REFERENCES,0.3667334669338677,"=exp ((Θ1
i )TΦ1
i (yr, ¯Y ) + (Θ1
j)TΦ1
j(yr, ¯Y ))"
REFERENCES,0.36773547094188375,"exp ((˜Θ1
i )TΦ1
i (yr, ¯Y ) + (˜Θ1
j)TΦ1
j(yr, ¯Y ))
= exp ((Θ1
i )TΦ1
i (yj, ¯Y ) + (Θ1
j)TΦ1
j(yi, ¯Y ))"
REFERENCES,0.3687374749498998,"exp ((˜Θ1
i )TΦ1
i (yj, ¯Y ) + (˜Θ1
j)TΦ1
j(yi, ¯Y ))
."
REFERENCES,0.3697394789579158,"By simple rearranging, we have"
REFERENCES,0.37074148296593185,"((Θ1
i )TΦ1
i (yi, ¯Y ) + (Θ1
j)TΦ1
j(yi, ¯Y ) + (Θ2
i )TΦ2
i (yi, ˆY ) + (Θ2
j)TΦ2
j(yi, ˆY ))"
REFERENCES,0.3717434869739479,"−((˜Θ1
i )TΦ1
i (yj, ¯Y ) + (˜Θ1
j)TΦ1
j(yj, ¯Y ) + (˜Θ2
i )TΦ2
i (yj, ˆY ) + (˜Θ2
j)TΦ2
j(yj, ˆY ))"
REFERENCES,0.3727454909819639,"=((Θ1
i )TΦ1
i (yj, ¯Y ) + (Θ1
j)TΦ1
j(yj, ¯Y ) + (Θ2
i )TΦ2
i (yj, ˆY ) + (Θ2
j)TΦ2
j(yj, ˆY ))"
REFERENCES,0.37374749498997994,"−((˜Θ1
i )TΦ1
i (yi, ¯Y ) + (˜Θ1
j)TΦ1
j(yi, ¯Y ) + (˜Θ2
i )TΦ2
i (yi, ˆY ) + (˜Θ2
j)TΦ2
j(yi, ˆY ))"
REFERENCES,0.374749498997996,"=((Θ1
i )TΦ1
i (yj, ¯Y ) + (Θ1
j)TΦ1
j(yi, ¯Y )) −((˜Θ1
i )TΦ1
i (yj, ¯Y ) + (˜Θ1
j)TΦ1
j(yi, ¯Y )).
(13)"
REFERENCES,0.375751503006012,Published as a conference paper at ICLR 2022
REFERENCES,0.37675350701402804,"By the equality between the second term and the third term in Eq. (13), we obtain that"
REFERENCES,0.3777555110220441,"(Θ1
j)TΦ1
j(yi, ¯Y ) −(˜Θ1
i )TΦ1
i (yj, ¯Y )"
REFERENCES,0.3787575150300601,"=((Θ1
j)TΦ1
j(yj, ¯Y ) + (Θ2
j)TΦ2
j(yj, ˆY )) −((˜Θ1
i )TΦ1
i (yi, ¯Y ) + (˜Θ2
i )TΦ2
i (yi, ˆY )).
(14)"
REFERENCES,0.37975951903807614,"We further set ¯Y in Eq. (14) respectively to el (the one hot vector with its l-th position being 1) and
0 for any fixed l ∈[ˆk], i.e.,"
REFERENCES,0.3807615230460922,"((Θ1
j)TΦ1
j(yi, el) −(Θ1
j)TΦ1
j(yi, 0)) −((˜Θ1
i )TΦ1
i (yj, el) −(˜Θ1
i )TΦ1
i (yj, 0))"
REFERENCES,0.3817635270541082,"=((Θ1
j)TΦ1
j(yj, el) −(Θ1
j)TΦ1
j(yj, 0)) −((˜Θ1
i )TΦ1
i (yi, el) −(˜Θ1
i )TΦ1
i (yi, 0)),"
REFERENCES,0.38276553106212424,which by simple rearranging further leads to
REFERENCES,0.3837675350701403,"Θ1
j,l(Φ1
j,l(yj, 1) −Φ1
j,l(yj, 0) −Φ1
j,l(yi, 1)) = ˜Θ1
i,l(Φ1
i,l(yi, 1) −Φ1
i,l(yi, 0) −Φ1
i,l(yj, 1))."
REFERENCES,0.3847695390781563,"Since Θ1
j,l, ˜Θ1
i,l > 0, and by definition we have"
REFERENCES,0.38577154308617234,"|Φ1
j,l(yj, 1) −Φ1
j,l(yj, 0) −Φ1
j,l(yi, 1)| = 1,"
REFERENCES,0.3867735470941884,"and
|Φ1
i,l(yi, 1) −Φ1
i,l(yi, 0) −Φ1
i,l(yj, 1)| = 1,"
REFERENCES,0.3877755511022044,"we obtain Θ1
j,l = ˜Θ1
i,l, and"
REFERENCES,0.38877755511022044,"Φ1
j,l(yj, 1) −Φ1
j,l(yj, 0) −Φ1
j,l(yi, 1) = Φ1
i,l(yi, 1) −Φ1
i,l(yi, 0) −Φ1
i,l(yj, 1).
(15)"
REFERENCES,0.3897795591182365,"Therefore, either tyj ˆyl ∈{to, tsd, tsg} and tyi ˆyl ∈{to, tsd, tsg}, or tyj ˆyl = te and tyi ˆyl = te, which
by definition further indicates that Φ2
i = Φ2
j (recall the way we build dependency between Y and ˆY )."
REFERENCES,0.3907815631262525,"As l is arbitrarily picked, we then have Θ1
j is equal to ˜Θ1
i component-wisely."
REFERENCES,0.39178356713426854,"By the equality between the first term and the third term in Eq. (13) and following exact the same
routine, we also have ˜Θ1
j = Θ1
i ."
REFERENCES,0.3927855711422846,"On the other hand, for any r ∈[ˆk], fixing ¯Y and ˆY s (∀s ̸= r), and setting ˆYr = ˆyr
l (l ∈kr,
ˆyr
l ∈N(yj, Yl)) in Eq. (14), we have"
REFERENCES,0.3937875751503006,"(Θ1
j)TΦ1
j(yj, ¯Y ) + (˜Θ1
i )TΦ1
i (yj, ¯Y ) + Θ2
j,r,lΦ2
j,r,l(yj, ˆyr
l ) +
X"
REFERENCES,0.39478957915831664,"s̸=r
Θ2
j,sΦ2
j,s(yj, Y s)"
REFERENCES,0.39579158316633267,"=(Θ1
j)TΦ1
j(yi, ¯Y ) + (˜Θ1
i )TΦ1
i (yi, ¯Y ) + ˜Θ2
i,r,lΦ2
i,r,l(yi, ˆyr
l ) +
X"
REFERENCES,0.3967935871743487,"s̸=r
˜Θ2
i,sΦ2
i,s(yi, ˆY s)."
REFERENCES,0.39779559118236474,"On the other hand, by Lemma 2, there exists some p, s.t., ˆyr
p /∈N(yj, Yr) (which by Φ2
i = Φ2
j further
leads to ˆyr
p /∈N(yi, Yr)). Setting ˆYr = ˆyr
l leads to"
REFERENCES,0.39879759519038077,"(Θ1
j)TΦ1
j(yj, ¯Y ) + (˜Θ1
i )TΦ1
i (yj, ¯Y ) +
X"
REFERENCES,0.3997995991983968,"s̸=r
Θ2
j,sΦ2
j,s(yj, Y s)"
REFERENCES,0.40080160320641284,"=(Θ1
j)TΦ1
j(yi, ¯Y ) + (˜Θ1
i )TΦ1
i (yi, ¯Y ) +
X"
REFERENCES,0.40180360721442887,"s̸=r
˜Θ2
i,sΦ2
i,s(yi, ˆY s)."
REFERENCES,0.4028056112224449,"Subtracting the above two equations leads to Θ2
j,a,l = ˜Θ2
i,a,l. Since a and l are arbitrarily picked, we
conclude that Θ2
j = ˜Θ2
i . Following the same routine, we also have Θ2
i = ˜Θ2
j."
REFERENCES,0.40380761523046094,"Therefore, by applying Θ1
j = ˜Θ1
i , Θ1
i = ˜Θ1
j, Θ2
j = ˜Θ2
i , and Θ2
i = ˜Θ2
j in Eq. (13), we have"
REFERENCES,0.40480961923847697,"(Θ1
i )TΦ1
i (yi, ¯Y ) −(Θ1
i )TΦ1
j(yj, ¯Y ) = (Θ1
i )TΦ1
i (yj, ¯Y ) −(Θ1
i )TΦ1
j(yi, ¯Y ),"
REFERENCES,0.405811623246493,"(Θ1
j)TΦ1
j(yj, ¯Y ) −(Θ1
j)TΦ1
i (yi, ¯Y ) = (Θ1
j)TΦ1
j(yi, ¯Y ) −(Θ1
j)TΦ1
i (yj, ¯Y )."
REFERENCES,0.40681362725450904,Published as a conference paper at ICLR 2022
REFERENCES,0.40781563126252507,"Let ¯Y = 1ˆk (i.e., the ˆk-dimension all 1 vector), we have"
REFERENCES,0.4088176352705411,"(Θ1
i )T((Φ1
i (yi, 1ˆk) −Φ1
i (yj, 1ˆk)) −((Φ1
j(yj, 1ˆk) −Φ1
j(yi, 1ˆk)))) = 0,
(16)"
REFERENCES,0.40981963927855714,"(Θ1
j)T((Φ1
i (yi, 1ˆk) −Φ1
i (yj, 1ˆk)) −((Φ1
j(yj, 1ˆk) −Φ1
j(yi, 1ˆk)))) = 0.
(17)"
REFERENCES,0.41082164328657317,"Since yi and yj are asymmetric, we have that there exists l, such that tyi ˆyl ̸= tyj ˆyl. Concretely, by
Eq. (15), we have tyi ˆyl ∈{to, tsd, tsg}, tyj ˆyl = {to, tsd, tsg}, and tyi ˆyl ̸= tyj ˆyl. On the other hand,"
REFERENCES,0.4118236472945892,"Φ1
i,l(yi, 1) −Φ1
i,l(yj, 1)) = Φ1
j,l(yj, 1) −Φ1
j,l(yi, 1),"
REFERENCES,0.41282565130260523,"if and only if tyi ˆyl = to, tyj ˆyl = tsg, or tyj ˆyl = to, tyi ˆyl = tsg, which contradicts Lemma 1."
REFERENCES,0.41382765531062127,"Therefore,
Φ1
i,l(yi, 1) −Φ1
i,l(yj, 1)) ̸= Φ1
j,l(yj, 1) −Φ1
j,l(yi, 1)."
REFERENCES,0.4148296593186373,"In this case, solutions of Θ1
i , Θ1
j subject to respectively Eqs. (16) and (17) lie along a zero-measure
set."
REFERENCES,0.41583166332665333,The proof is completed.
REFERENCES,0.4168336673346693,"D
PROOF OF THEOREM 1"
REFERENCES,0.41783567134268534,"D.1
LEARNING ALGORITHM"
REFERENCES,0.4188376753507014,We first present the algorithm for producing ˆΘ and ˆW in Algorithm 1.
REFERENCES,0.4198396793587174,Algorithm 1 WIS
REFERENCES,0.42084168336673344,"Require: Step size η, dataset D ⊂X, and initial parameter Θ0."
REFERENCES,0.4218436873747495,"ˆΘ →Θ0.
for all X ∈D do"
REFERENCES,0.4228456913827655,"Independently sample (Y, ¯Y , ˆY ) from π ˆΘ, and (Y ′, ¯Y ′, ˆY ′) from π ˆΘ conditionally given ˆY ′ =
ˆY (X).
ˆΘ ←ˆΘ + η(Φ(Y, ¯Y , ˆY ) −Φ(Y ′, ¯Y ′, ˆY ′)).
Compute ˆW as described in (3) using ˆΘ.
output (ˆΘ, ˆW)"
REFERENCES,0.42384769539078154,"D.2
ASSUMPTIONS"
REFERENCES,0.4248496993987976,"First, the problem distribution π∗needs to be accurately modeled by some distribution Θ∗in the
family that we are trying to learn:"
REFERENCES,0.4258517034068136,"∃Θ∗s.t. ∀(Y, ˆY ), p(X,Y )∼π∗(Y, ˆY ) = pθ∗(Y, ˆY ).
(18)"
REFERENCES,0.42685370741482964,"Secondly, given an example (X, Y ) ∼π∗, we assume Y is independent of X given ˆY (X):"
REFERENCES,0.4278557114228457,"(X, Y ) ∼π∗⇒Y ⊥X | ˆY (X).
(19)
This assumption encodes the idea that while the ILFs can be arbitrarily dependent on the features,
they provide sufficient information to accurately identify the true label vector. Then, for any Θ,
accurately learning Θ from data distribution is possible. That is, there exists an unbiased estimator
ˆΘ(D) which is a function of the dataset D of i.i.d from πΘ, such that, for any Θ and some c > 0,"
REFERENCES,0.4288577154308617,"Cov(ˆΘ(D)) ⪯
I
2c|D|.
(20)"
REFERENCES,0.42985971943887774,"And we are reasonably certain in our guess of latent variables, i.e., Y and ¯Y . That is, for any Θ, Θ∗,"
REFERENCES,0.4308617234468938,"E ˆY ∗∼Θ∗ ""
k
X"
REFERENCES,0.4318637274549098,"i=1
(ni + ˆk)Var(Y, ¯Y , ˆY )∼πΘ(1Y =yi| ˆY = ˆY ∗)2 + ˆk
X"
REFERENCES,0.43286573146292584,"i=1
(mi + K −1)Var(Y, ¯Y , ˆY )∼πΘ( ¯Y i| ˆY = ˆY ∗)2
# 1 2 ≤
c
√"
M,0.4338677354709419,"2M
.
(21)"
M,0.4348697394789579,Published as a conference paper at ICLR 2022
M,0.43587174348697394,"We also assume that the output of the last layer of end model hW has bounded ℓ∞norm, that is, for
any possible parameter W,
∥hW ∥∞≤H.
(22)"
M,0.43687374749499,"Finally, we assume that solving Eq. (3) has bounded generalization risk such that for some χ > 0,
solution ˆW satisfies
E ˆ
W
h
ℓˆΘ( ˆ
W) −min
W ℓˆΘ(W)
i
≤χ.
(23)"
M,0.437875751503006,"D.3
PROOF OF THEOREM 1"
M,0.43887775551102204,"To begin with, we state two basic lemmas needed for proofs throughout this section:
Lemma D.1. Let x1, x2 be two binary random variable. Then we have variance of product of x1
and x2 can be bounded as"
M,0.43987975951903807,Var [x1x2] ≤Var [x1] + Var [x2] .
M,0.4408817635270541,Lemma D.2. Let Y be a random vector and ∥·∥s be the spectral norm. Then we have
M,0.44188376753507014,"∥Cov(Y, Y )∥s ≤
X"
M,0.44288577154308617,"i
Var(Yi)."
M,0.4438877755511022,"Then, we borrow two lemmas from (Ratner et al., 2016), which are slightly different from the original
ones but can be easily proved following the same derivations:
Lemma D.3. [Lemma D.1 in (Ratner et al., 2016)] Given a family of maximum-entropy distributions"
M,0.44488977955911824,"πΘ(Y, ¯Y , ˆY ) =
1
ZΘ
exp (ΘTΦ(Y, ¯Y , ˆY ))."
M,0.44589178356713427,"If we let J be the maximum expected log-likelihood objective, under another distribution π∗, for the
event associated with the observed labeling function values ˆY ,"
M,0.4468937875751503,"J(Θ) = E(Y ∗, ¯Y ∗, ˆY ∗)∼π∗
h
log P(Y, ¯Y , ˆY )∼πΘ"
M,0.44789579158316634,"
ˆY = ˆY ∗i
,"
M,0.44889779559118237,then its Hessian can be calculated as
M,0.4498997995991984,"∇2J(Θ) = E(Y ∗, ¯Y ∗, ˆY ∗)∼π∗
h
Cov(Y, ¯Y , ˆY )∼πΘ"
M,0.45090180360721444,"
ϕ(Y, ¯Y , ˆY ) | ˆY = ˆY ∗i
−Cov(Y, ¯Y , ˆY )∼πΘ(ϕ(Y, ¯Y , ˆY ))."
M,0.45190380761523047,"Lemma D.4. [Lemma D.4 in (Ratner et al., 2016)] Suppose that we are looking at a WIS maximum
likelihood estimation problem and the objective function J(Θ) is strongly concave with concavity
parameter c > 0. If we run stochastic gradient descent using unbiased samples from a true
distribution πΘ∗, then if we set step size as"
M,0.4529058116232465,"η = cϵ2 4 ,"
M,0.45390781563126253,"and run (using a fresh sample at each iteration) for T steps, where"
M,0.45490981963927857,"T =
2
c2ϵ2 log"
M,0.4559118236472946,2 ∥Θ0 −Θ∗∥2 ϵ ! .
M,0.45691382765531063,We can bound the expected parameter estimation error with
M,0.45791583166332667,"E
ˆΘ −Θ∗
2
≤Mϵ2,
(24)"
M,0.4589178356713427,where M is the dimension of Θ.
M,0.45991983967935873,"Based on Lemma D.4, in order to obtain the optimization error with respect to the estimated ˆΘ
produced by Algorithm 1, we only need to show that the WIS object function J(Θ)2 is strongly
concave. We prove this through the following lemma, which is a non-trivial extension of Lemma D.3
in (Ratner et al., 2016) given the fact that we have multiple latent variables and relatively complex
dependency structures with comparison to (Ratner et al., 2016):"
M,0.46092184368737477,"2Note that, in the Eq. (2) of the main body of the paper, we are minimizing −J(Θ), which is equivalent to
maximizing J(Θ) as discussed here."
M,0.4619238476953908,Published as a conference paper at ICLR 2022
M,0.46292585170340683,"Lemma D.5. [Extension of Lemma D.3 in (Ratner et al., 2016)] With conditions (20) and (21), the
WIS objective function J(Θ) is strongly concave with strong convexity c."
M,0.46392785571142287,"We then come to bound the generalization error of ˆW produced by Algorithm 1, using the following
non-trivial extension of Lemma D.5 in (Ratner et al., 2016):"
M,0.4649298597194389,"Lemma D.6. [Extension of Lemma D.5 in (Ratner et al., 2016)] Suppose that conditions (18)-(23)
hold. Let ˆW be the learned parameters of the end model produced by Algorithm 1, and ℓ(W ∗) be the
minimum of cross entropy loss function ℓ. Then, we can bound the expected risk with"
M,0.46593186372745493,"E
h
ℓ( ˆW) −ℓ(W ∗)
i
≤χ + 4cHϵ."
M,0.46693386773547096,"Finally, we conclude Lemmas (D.4), (D.5) and (D.6) as the following theorem, which is identical to
the Theorem 1 in the main body of the paper:"
M,0.467935871743487,"Theorem 4 (Extension of Theorem 2 in (Ratner et al., 2016)). Suppose that we run Algoirthm 1 on a
WIS specification to produce ˆΘ and ˆW, and all conditions of Lemmas (D.5) and (D.6) are satisfied.
Then, for any ϵ > 0, if we set the step size to be"
M,0.46893787575150303,η = cϵ2 4
M,0.46993987975951906,and the input dataset D is large enough such that
M,0.4709418837675351,"|D| >
2
c2ϵ2 log"
M,0.47194388777555113,"2 ∥Θ0 −Θ∗∥2 ϵ ! ,"
M,0.4729458917835671,then we can bound the expected parameter error and the expected risk as:
M,0.47394789579158314,"E
ˆΘ −Θ∗
2
≤Mϵ2,
E
h
ℓ( ˆW) −ℓ(W ∗)
i
≤χ + 4cHϵ."
M,0.4749498997995992,"D.4
PROOFS OF LEMMAS"
M,0.4759519038076152,"Lemma D.1. Let x1, x2 be two binary random variable. Then we have variance of product of x1
and x2 can be bounded as"
M,0.47695390781563124,Var [x1x2] ≤Var [x1] + Var [x2] .
M,0.4779559118236473,"Proof. Joint distribution of x1 and x2 can be listed as the following table: (where p1+p2+p3+p4 =
1)"
M,0.4789579158316633,"x1/x2
0
1
0
p1
p2
1
p3
p4"
M,0.47995991983967934,"Then we have
Var [x1x2] = p4 −p2
4 = p4(p1 + p2 + p3), while"
M,0.48096192384769537,Var [X1] + Var [X2] = (p2 + p4)(p1 + p3) + (p3 + p4)(p1 + p2) ≥p4(p1 + p2 + p3).
M,0.4819639278557114,The proof is completed.
M,0.48296593186372744,Lemma D.2. Let Y be a random vector and ∥·∥s be the spectral norm. Then we have
M,0.48396793587174347,"∥Cov(Y, Y )∥s ≤
X"
M,0.4849699398797595,"i
Var(Yi)."
M,0.48597194388777554,Published as a conference paper at ICLR 2022
M,0.48697394789579157,"Proof. By definition of spectral norm, we have"
M,0.4879759519038076,"∥Cov(Y, Y )∥s = max
∥x∥2≤1 xTCov(Y, Y )x"
M,0.48897795591182364,"Where x is a constant vector. And by Cauchy-Schwarz inequality,"
M,0.48997995991983967,"xTCov(Y, Y )x = E

xT(Y −E [Y ])(Y −E [Y ])Tx

≤E
h
∥x∥2 ∥Y −E [Y ]∥2i
."
M,0.4909819639278557,"Because x is a constant vector and ∥x∥≤1,"
M,0.49198396793587174,"max
∥x∥2≤1 E
h
∥x∥2 ∥Y −E [Y ]∥2i"
M,0.49298597194388777,"= max
∥x∥2≤1 ∥x∥2 E
h
∥Y −E [Y ]∥2i"
M,0.4939879759519038,"= max
∥x∥2≤1 ∥x∥2
""X"
M,0.49498997995991983,"i
Var(Yi) # =
X"
M,0.49599198396793587,"i
Var(Yi)."
M,0.4969939879759519,The proof is completed.
M,0.49799599198396793,"Lemma D.5. [Extension of Lemma D.3 in (Ratner et al., 2016)] With conditions (20) and (21), the
WIS objective function J(Θ) is strongly concave with strong convexity c."
M,0.49899799599198397,"Proof. By Lemma D.3, hessian matrix of J can be decomposed as follows:"
M,0.5,"∇2J(Θ) = E ˆY ∗∼πΘ∗
h
Cov(Y, ¯Y , ˆY )∼πΘ"
M,0.501002004008016,"
Φ(Y, ¯Y , ˆY ) | ˆY = ˆY ∗i
−Cov(Y, ¯Y , ˆY )∼πΘ(Φ(Y, ¯Y , ˆY ))."
M,0.5020040080160321,"Basically, to prove that J(Θ) is strongly concave with strong convexity c, we need to show for a real
number c > 0,"
M,0.503006012024048,∇2J(Θ) ⪯cI.
M,0.5040080160320641,We calculate each term separately: for the first term
M,0.5050100200400801,"A = E ˆY ∗∼πΘ∗
h
Cov(Y, ¯Y , ˆY )∼πΘ"
M,0.5060120240480962,"
Φ(Y, ¯Y , ˆY ) | ˆY = ˆY ∗i
,"
M,0.5070140280561122,"since A is symmetric, for any real number c, A ⪯cI, if and only if its spectral norm ∥A∥s ≤c,
where ∥A∥s equals to the eigenvalue of A with largest absolute value."
M,0.5080160320641283,"Since by definition, vector function Φ(Y, ¯Y , ˆY ) can be represented as:"
M,0.5090180360721442,"Φ(Y, ¯Y , ˆY ) = "
M,0.5100200400801603,"






"
M,0.5110220440881763,"
ϕAcc
yi,ˆyj
l ,j(Y, ˆY j)
"
M,0.5120240480961924,"i∈[k],j∈[n],ˆyj
l ∈N(yi,Yj)

ϕAcc
ˆyi,j( ¯Y i, ˆY j)
"
M,0.5130260521042084,"j∈[n],ˆyi∈Yj

ϕt
ˆyi,ˆyj( ¯Y i, ¯Y j)
"
M,0.5140280561122245,"i,j∈[ˆk]

ϕt
yi,ˆyj(Y, ¯Y j)
"
M,0.5150300601202404,"i∈[k],j∈[ˆk] "
M,0.5160320641282565,"






 ,"
M,0.5170340681362725,Published as a conference paper at ICLR 2022
M,0.5180360721442886,"by Lemma D.2, we have A can be further bounded by A ≤ "
M,0.5190380761523046,"E ˆY ∗∼πΘ∗    
k
X i=1 n
X j=1 X"
M,0.5200400801603207,"ˆyj
l ∈N(yi,Yj)
Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5210420841683366,"
ϕAcc
yi,ˆyj
l ,j(Y, ˆY j) | ˆY = ˆY ∗
   "
M,0.5220440881763527,"+ E ˆY ∗∼πΘ∗    
n
X j=1 X"
M,0.5230460921843687,"ˆyi∈Yj
Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5240480961923848,"
ϕAcc
ˆyi,j( ¯Y i, ˆY j) | ˆY = ˆY ∗
   "
M,0.5250501002004008,+ E ˆY ∗∼πΘ∗    X
M,0.5260521042084169,"1≤i,j≤ˆk
Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5270541082164328,"
ϕt
ˆyi,ˆyj( ¯Y i, ¯Y j) | ˆY = ˆY ∗
   "
M,0.5280561122244489,"+ E ˆY ∗∼πΘ∗    
k
X i=1 ˆk
X"
M,0.5290581162324649,"j=1
Var(Y, ¯Y , ˆY )∼πΘ"
M,0.530060120240481,"
ϕt
yi,ˆyj(Y, ¯Y j) | ˆY = ˆY ∗
     "
M,0.531062124248497,"=A1 + A2 + A3 + A4, where"
M,0.5320641282565131,"A1 =E ˆY ∗∼πΘ∗    
k
X i=1 n
X j=1 X"
M,0.533066132264529,"ˆyj
l ∈N(yi,Yj)
Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5340681362725451,"
ϕAcc
yi,ˆyj
l ,j(Y, ˆY j) | ˆY = ˆY ∗
   ;"
M,0.5350701402805611,"A2 =E ˆY ∗∼πΘ∗    
n
X j=1 X"
M,0.5360721442885772,"ˆyl∈Yj
Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5370741482965932,"
ϕAcc
ˆyl,j(Y, ˆY j) | ˆY = ˆY ∗
   ;"
M,0.5380761523046093,A3 =E ˆY ∗∼πΘ∗    X
M,0.5390781563126252,"1≤i,j≤ˆk
Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5400801603206413,"
ϕt
ˆyi,ˆyj( ¯Y i, ¯Y j) | ˆY = ˆY ∗
   ;"
M,0.5410821643286573,"A4 =E ˆY ∗∼πΘ∗    
k
X i=1 ˆk
X"
M,0.5420841683366734,"j=1
Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5430861723446894,"
ϕt
yi,ˆyj(Y, ¯Y j) | ˆY = ˆY ∗
   ."
M,0.5440881763527055,"We then bound the four terms respectively. As for A1, for fixed ˆY ∗, we have k
X i=1 n
X j=1 X"
M,0.5450901803607214,"ˆyj
l ∈N(yi,Yj)
Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5460921843687375,"
ϕAcc
yi,ˆyj
l ,j(Y, ˆY j) | ˆY = ˆY ∗ = k
X i=1 n
X j=1 X"
M,0.5470941883767535,"ˆyj
l ∈N(yi,Yj)
Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5480961923847696,"
1Y =yi∧ˆY j=ˆyj
l | ˆY = ˆY ∗ = k
X i=1  
X"
M,0.5490981963927856,"j∈[n],ˆyj
l ∈N(yi,Yj),( ˆY ∗)j=ˆyj
l"
M,0.5501002004008017,"Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5511022044088176,"
1Y =yi | ˆY = ˆY ∗
  = k
X i=1  
X"
M,0.5521042084168337,"j∈[n],ˆyj
l ∈N(yi,Yj),( ˆY ∗)j=ˆyj
l"
M,0.5531062124248497,"Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5541082164328658,"
1Y =yi | ˆY = ˆY ∗
  ≤ k
X"
M,0.5551102204408818,"i=1
niVar(Y, ¯Y , ˆY )∼πΘ"
M,0.5561122244488977,"
1Y =yi | ˆY = ˆY ∗
,"
M,0.5571142284569138,"where ni is the number of ILFs whose label space contains label that is non-exclusive to label yi, i.e.,
ni = |{j ∈[n]|N(yi, Yj) ̸= ∅}|."
M,0.5581162324649298,"Therefore, we have A1 ≤ k
X"
M,0.5591182364729459,"i=1
niE ˆY ∗∼πΘ∗Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5601202404809619,"
1Y =yi | ˆY = ˆY ∗
."
M,0.561122244488978,Published as a conference paper at ICLR 2022
M,0.5621242484969939,"Similarly, for A2, we have A2 ≤ ˆk
X"
M,0.56312625250501,"i=1
miE ˆY ∗∼πΘ∗Var(Y, ¯Y , ˆY )∼πΘ"
M,0.564128256513026,"
¯Y i | ˆY = ˆY ∗
,"
M,0.5651302605210421,where mi is the number of ILFs whose label space contains the label ˆyi.
M,0.5661322645290581,"As for A3, for fixed ˆY ∗and any ˆyi, ˆyj ∈ˆY, we further separate the proof into subcases by tˆyi ˆyj
which is simplified as t:"
M,0.5671342685370742,"(1). t = to. In this case,"
M,0.5681362725450901,"Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5691382765531062,"
ϕt
ˆyi,ˆyj( ¯Y i, ¯Y j) | ˆY = ˆY ∗"
M,0.5701402805611222,"=Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5711422845691383,"
1 ¯Y i= ¯Y j | ˆY = ˆY ∗"
M,0.5721442885771543,"=Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5731462925851704,"
¯Y i ¯Y j | ˆY = ˆY ∗"
M,0.5741482965931863,"(∗)
≤Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5751503006012024,"
¯Y i | ˆY = ˆY ∗
+ Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5761523046092184,"
¯Y j | ˆY = ˆY ∗
,"
M,0.5771543086172345,where Eq. (∗) is due to Lemma D.1.
M,0.5781563126252505,"(2). t = te. Similarly,"
M,0.5791583166332666,"Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5801603206412825,"
ϕt
ˆyi,ˆyj( ¯Y i, ¯Y j) | ˆY = ˆY ∗"
M,0.5811623246492986,"=Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5821643286573146,"
−1 ¯Y i= ¯Y j=1 | ˆY = ˆY ∗"
M,0.5831663326653307,"=Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5841683366733467,"
1 ¯Y i= ¯Y j=1 | ˆY = ˆY ∗"
M,0.5851703406813628,"=Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5861723446893787,"
¯Y i ¯Y j | ˆY = ˆY ∗"
M,0.5871743486973948,"≤Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5881763527054108,"
¯Y i | ˆY = ˆY ∗
+ Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5891783567134269,"
¯Y j | ˆY = ˆY ∗
,"
M,0.5901803607214429,"(3). t = tsg. In this case,"
M,0.591182364729459,"Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5921843687374749,"
ϕt
ˆyi,ˆyj( ¯Y i, ¯Y j) | ˆY = ˆY ∗"
M,0.593186372745491,"=Var(Y, ¯Y , ˆY )∼πΘ"
M,0.594188376753507,"
−1 ¯Y i=1, ¯Y j=0 | ˆY = ˆY ∗"
M,0.5951903807615231,"=Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5961923847695391,"
(1 −¯Y i) ¯Y j | ˆY = ˆY ∗"
M,0.5971943887775552,"≤Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5981963927855711,"
1 −¯Y i | ˆY = ˆY ∗
+ Var(Y, ¯Y , ˆY )∼πΘ"
M,0.5991983967935872,"
¯Y j | ˆY = ˆY ∗"
M,0.6002004008016032,"=Var(Y, ¯Y , ˆY )∼πΘ"
M,0.6012024048096193,"
¯Y i | ˆY = ˆY ∗
+ Var(Y, ¯Y , ˆY )∼πΘ"
M,0.6022044088176353,"
¯Y j | ˆY = ˆY ∗
,"
M,0.6032064128256514,"(4). t = tsd. Similar to (3).,"
M,0.6042084168336673,"Var(Y, ¯Y , ˆY )∼πΘ"
M,0.6052104208416834,"
ϕt
ˆyi,ˆyj( ¯Y i, ¯Y j) | ˆY = ˆY ∗"
M,0.6062124248496994,"=Var(Y, ¯Y , ˆY )∼πΘ"
M,0.6072144288577155,"
−1 ¯Y i=0, ¯Y j=1 | ˆY = ˆY ∗"
M,0.6082164328657315,"=Var(Y, ¯Y , ˆY )∼πΘ"
M,0.6092184368737475,"
(1 −¯Y j) ¯Y i | ˆY = ˆY ∗"
M,0.6102204408817635,"≤Var(Y, ¯Y , ˆY )∼πΘ"
M,0.6112224448897795,"
1 −¯Y j | ˆY = ˆY ∗
+ Var(Y, ¯Y , ˆY )∼πΘ"
M,0.6122244488977956,"
¯Y i | ˆY = ˆY ∗"
M,0.6132264529058116,"=Var(Y, ¯Y , ˆY )∼πΘ"
M,0.6142284569138277,"
¯Y i | ˆY = ˆY ∗
+ Var(Y, ¯Y , ˆY )∼πΘ"
M,0.6152304609218436,"
¯Y j | ˆY = ˆY ∗
,"
M,0.6162324649298597,Published as a conference paper at ICLR 2022
M,0.6172344689378757,"Combining (1), (2), (3), and (4), we have A3 ≤ ˆk
X"
M,0.6182364729458918,"i=1
(ˆk −1)E ˆY ∗∼πΘ∗Var(Y, ¯Y , ˆY )∼πΘ"
M,0.6192384769539078,"
¯Y i | ˆY = ˆY ∗
,"
M,0.6202404809619239,"As for A4, by similar discussion of A3, A4 ≤ ˆk
X"
M,0.6212424849699398,"i=1
kE ˆY ∗∼πΘ∗Var(Y, ¯Y , ˆY )∼πΘ"
M,0.6222444889779559,"
¯Y i | ˆY = ˆY ∗
+ k
X"
M,0.6232464929859719,"i=1
ˆkE ˆY ∗∼πΘ∗Var(Y, ¯Y , ˆY )∼πΘ"
M,0.624248496993988,"
1Y =yi | ˆY = ˆY ∗
."
M,0.625250501002004,"Combining estimation of A1, A2, A3, A4, and by condition (21) we have"
M,0.62625250501002,"∥A∥s
≤A1 + A2 + A3 + A4"
M,0.627254509018036,"≤E ˆY ∗∼πΘ∗  
k
X"
M,0.6282565130260521,"i=1
(ni + ˆk)VarY, ˆY (1Y =yi| ˆY = ˆY ∗) + ˆk
X"
M,0.6292585170340681,"i=1
(mi + K −1)VarY, ˆY ( ¯Y i| ˆY = ˆY ∗)  "
M,0.6302605210420842,"≤E ˆY ∗∼πΘ∗  
k
X"
M,0.6312625250501002,"i=1
(ni + ˆk)Var2
Y, ˆY (Y | ˆY = ˆY ∗) + ˆk
X"
M,0.6322645290581163,"i=1
(mi + K −1)Var2
Y, ˆY ( ¯Y i| ˆY = ˆY ∗)   1
2 · k
X"
M,0.6332665330661322,"i=1
(ni + ˆk) + K
X"
M,0.6342685370741483,"i=1
(mi + K −1) ! 1 2 ≤
c
√"
M,0.6352705410821643,"2M
·
√"
M,0.6362725450901804,"2M ≤c,"
M,0.6372745490981964,"which further leads to
A ⪯cI."
M,0.6382765531062125,"For the second term B = Cov(Y, ¯Y , ˆY )∼πΘ(Φ(Y, ¯Y , ˆY )),"
M,0.6392785571142284,"B = E(Y, ¯Y , ˆY )∼πΘ"
M,0.6402805611222445,"h
(Φ(Y, ¯Y , ˆY ) −E(Y, ¯Y , ˆY )∼πΘ[Φ(Y, ¯Y , ˆY )])2i"
M,0.6412825651302605,"= EY, ¯Y , ˆY ∼πΘ   "
M,0.6422845691382766,"Φ(Y, ¯Y , ˆY ) − P"
M,0.6432865731462926,"Y ′, ¯Y ′, ˆY ′ Φ(Y ′, ¯Y ′, ˆY ′) exp

ΘT Φ(Y ′, ¯Y ′, ˆY ′)
 P"
M,0.6442885771543087,"Y ′, ¯Y ′, ˆY ′ exp

ΘT Φ(Y ′, ¯Y ′, ˆY ′)
   2 "
M,0.6452905811623246,"= EY, ¯Y , ˆY ∼πΘ   "
M,0.6462925851703407,"∇Θ log

exp

ΘT Φ(Y, ¯Y , ˆY )

−∇Θ log  
X"
M,0.6472945891783567,"Y ′, ¯Y ′, ˆY ′
exp

ΘT Φ(Y ′, ¯Y ′, ˆY ′)

    2 "
M,0.6482965931863728,"= E(Y, ¯Y , ˆY )∼πΘ"
M,0.6492985971943888,"
∇Θ log πΘ(Y, ¯Y , ˆY )
2
,"
M,0.6503006012024048,"where E(Y, ¯Y , ˆY )∼πΘ"
M,0.6513026052104208,"
∇Θ log πΘ(Y, ¯Y , ˆY )
2
is the Fisher Information of Θ. By the Cramér-Rao"
M,0.6523046092184369,"bound and the condition (20),"
M,0.6533066132264529,"I
2c|D| ⪰Cov(ˆΘ) ⪰

DE(Y, ˆY )∼πΘ"
M,0.654308617234469,"
∇Θ log πΘ(Y, ˆY )
2−1
,"
M,0.655310621242485,which further leads to
M,0.656312625250501,"B = E(Y, ¯Y , ˆY )∼πΘ"
M,0.657314629258517,"
∇Θ log πΘ(Y, ¯Y , ˆY )
2
⪰2cI."
M,0.6583166332665331,The proof is completed by putting estimation of terms A and B together.
M,0.6593186372745491,Published as a conference paper at ICLR 2022
M,0.6603206412825652,"Lemma D.6. [Extension of Lemma D.5 in (Ratner et al., 2016)] Suppose that conditions (18)-(23)
hold. Let ˆW be the learned parameters of the end model produced by Algorithm 1, and ℓ(W ∗) be the
minimum of cross entropy loss function ℓ. Then, we can bound the expected risk with"
M,0.6613226452905812,"E
h
ℓ( ˆW) −ℓ(W ∗)
i
≤χ + 4cHϵ."
M,0.6623246492985972,"Proof. We begin by rewriting objective of expected loss minimization problem using law of total
expectation as follows:"
M,0.6633266533066132,"ℓ(W) =E(X,Y )∼π∗
E(X,Y )∼π∗[H(Y, σ(h(X, W)))|X]
"
M,0.6643286573146293,"=E(X′,Y ′)∼π∗
E(X,Y )∼π∗[H(Y, σ(h(X, W)))|X = X′]
"
M,0.6653306613226453,"=E(X′,Y ′)∼π∗
E(X,Y )∼π∗[H(Y, σ(h(X′, W)))|X = X′]
"
M,0.6663326653306614,"and by our conditional independence assumption (condition (19)), we have"
M,0.6673346693386774,"P(Y |X = X′) = P(Y | ˆY (X) = ˆY (X′)),"
M,0.6683366733466933,which further leads to
M,0.6693386773547094,"ℓ(W) =E(X′,Y ′)∼π∗
h
E(X,Y )∼π∗
h
H(Y, σ(h(X′, W)))
 ˆY (X) = ˆY (X′)
ii"
M,0.6703406813627254,"=E(X′,Y ′)∼π∗
h
E(Y, ˆY )∼πΘ∗
h
H(Y, σ(h(X′, W)))
 ˆY = ˆY (X′)
ii"
M,0.6713426853707415,"On the other hand, if we are minimizing the model with learned parameter ˆΘ, we will be actually
minimizing"
M,0.6723446893787575,"ℓˆΘ(W) = E(X′,Y ′)∼π∗
h
E(Y, ˆY )∼π ˆ
Θ"
M,0.6733466933867736,"h
H(Y, σ(h(X′, W)))
 ˆY = ˆY (X′)
ii
,"
M,0.6743486973947895,"where for any X′, E(Y, ˆY )∼π ˆ
Θ"
M,0.6753507014028056,"h
H(Y, σ(h(X′, W)))
 ˆY = ˆY (X′)
i
can be further calculated as"
M,0.6763527054108216,"E(Y, ˆY )∼π ˆ
Θ"
M,0.6773547094188377,"h
H(Y, σ(h(X′, W)))
 ˆY = ˆY (X′)
i = k
X"
M,0.6783567134268537,"l=1
log (σ(h(X′, W))l) P(Y, ˆY )∼π ˆ
Θ(Y = yl| ˆY = ˆY (X′))."
M,0.6793587174348698,"For simplification, we rewrite P(Y, ˆY )∼π ˆ
Θ(Y = yl| ˆY = ˆY (X′)) as follows with slight abuse of
notations:"
M,0.6803607214428857,"P(Y, ˆY )∼π ˆ
Θ(Y = yl| ˆY = ˆY (X′)) = Pπ ˆ
Θ(yl| ˆY (X′)),"
M,0.6813627254509018,and similarly
M,0.6823647294589178,"E(X′,Y ′)∼π∗= Eπ∗,"
M,0.6833667334669339,"Let lX′
△= arg minl log (σ(h(X′, W))l). The difference between the loss functions will be"
M,0.6843687374749499,"|ℓˆΘ(W) −ℓ(W)| = Eπ∗ "" k
X"
M,0.685370741482966,"l=1
log
 
σ(h(X′, W))l
 
PπΘ∗(yl| ˆY (X′)) −Pπ ˆ
Θ(yl| ˆY (X′))
#"
M,0.6863727454909819,"=
Eπ∗
h
log
 
σ(h(X′, W))lX′
 
PπΘ∗(ylX′ | ˆY (X′)) −Pπ ˆ
Θ(ylX′ | ˆY (X′))
i + Eπ∗  X"
M,0.687374749498998,"l̸=lX′
log
 
σ(h(X′, W))l
 
PπΘ∗(yl| ˆY (X′)) −Pπ ˆ
Θ(yl| ˆY (X′))

  ."
M,0.688376753507014,Published as a conference paper at ICLR 2022
M,0.6893787575150301,"Furthermore,
Eπ∗
h
log
 
σ(h(X′, W))lX′
 
PπΘ∗(ylX′| ˆY (X′)) −Pπ ˆ
Θ(ylX′| ˆY (X′))
i + Eπ∗  X"
M,0.6903807615230461,"l̸=lX′
log (σ(h(X′, W))l)

PπΘ∗(yl| ˆY (X′)) −Pπ ˆ
Θ(yl| ˆY (X′))

   = Eπ∗ "
M,0.6913827655310621,"log
 
σ(h(X′, W))lX′

 −
X"
M,0.6923847695390781,"l̸=lX′
PπΘ∗(yl| ˆY (X′)) +
X"
M,0.6933867735470942,"j̸=lX′
Pπ ˆ
Θ(yl| ˆY (X′))     + Eπ∗  X"
M,0.6943887775551102,"l̸=lX′
log (σ(h(X′, W))l)

PπΘ∗(yl| ˆY (X′)) −Pπ ˆ
Θ(yl| ˆY (X′))

   = Eπ∗  X"
M,0.6953907815631263,l̸=lX′
M,0.6963927855711423," 
log (σ(h(X′, W))l) −log
 
σ(h(X′, W))lX′
 
PπΘ∗(yl| ˆY (X′)) −Pπ ˆ
Θ(yl| ˆY (X′))

   = Eπ∗  X"
M,0.6973947895791583,l̸=lX′
M,0.6983967935871743," 
h(X′, W)l −h(X′, W)lX′
 
PπΘ∗(yl| ˆY (X′)). −Pπ ˆ
Θ(yl| ˆY (X′))

 "
M,0.6993987975951904,".
(25)"
M,0.7004008016032064,"Let
¯h(l1, l2) = h(X′, W)l1 −h(X′, W)l2."
M,0.7014028056112225,"By Eq. (22), we have for any l ∈[k],"
M,0.7024048096192385,"0 ≤¯h(l, lX′) ≤2H."
M,0.7034068136272545,"For any fixed X′, define gX′(Θ) as follows:"
M,0.7044088176352705,"gX′(Θ) =
X"
M,0.7054108216432866,l̸=lX′
M,0.7064128256513026,"¯h(l, lX′)PπΘ(yl| ˆY (X′)),
(26)"
M,0.7074148296593187,"based on which we have
ℓˆΘ(W) −ℓ(W)
 ≤
Eπ∗

gX′(ˆΘ) −gX′(Θ∗)
"
M,0.7084168336673347,"By First Mean Value Theorem,"
M,0.7094188376753507,"gX′(ˆΘ) −gX(Θ∗) = ⟨∇gX′(ξ), ˆΘ −Θ∗⟩≤∥ˆΘ −Θ∗∥∥∇gX′(ξ)∥."
M,0.7104208416833667,We then bound ∇gX(ξ) element-wisely:
M,0.7114228456913828,"(1). For any i ∈[k], j ∈[n], ˆyj
l ∈N(yi, Yj), if i = lX′, ˆY j(X′) = ˆyj
l ,"
M,0.7124248496993988,"∂gX′(ξ)
∂θAcc
yi,ˆyj
l ,j =  X"
M,0.7134268537074149,l̸=lX′
M,0.7144288577154309,"¯h(l, lX′)∂Pπξ(yl| ˆY (X′))"
M,0.7154308617234469,"∂θAcc
yi,ˆyj
l ,j  = −
X"
M,0.7164328657314629,l̸=lX′
M,0.717434869739479,"¯h(l, lX′)Pπξ(yi| ˆY (X′))Pπξ(yl| ˆY (X′))  =
X"
M,0.718436873747495,l̸=lX′
M,0.7194388777555111,"¯h(l, lX′)Pπξ(yi| ˆY (X′))Pπξ(yl| ˆY (X′))"
M,0.720440881763527,≤2HPπξ(yi| ˆY (X′))(1 −Pπξ(yi| ˆY (X′)))
M,0.7214428857715431,"=2HVar
h
1Y =yi| ˆY (X′)
i
."
M,0.7224448897795591,Published as a conference paper at ICLR 2022
M,0.7234468937875751,"If i ̸= lX′, ˆY j(X′) = ˆyj
l , "
M,0.7244488977955912,"∂gX′(ξ)
∂θAcc
yi,ˆyj
l ,j =  X"
M,0.7254509018036072,l̸=lX′
M,0.7264529058116233,"¯h(l, lX′)∂Pπξ(yl| ˆY (X′))"
M,0.7274549098196392,"∂θAcc
yi,ˆyj
l ,j  = −
X"
M,0.7284569138276553,"l/∈{i,lX′}"
M,0.7294589178356713,"¯h(l, lX′)Pπξ(yi| ˆY (X′))Pπξ(yl| ˆY (X′))"
M,0.7304609218436874,"+ ¯h(i, lX′)

Pπξ(yi| ˆY (X′)) −Pπξ(yi| ˆY (X′))Pπξ(yi| ˆY (X′))
 ≤max 
  X"
M,0.7314629258517034,"l/∈{i,lX′}"
M,0.7324649298597194,"¯h(l, lX′)Pπξ(yi| ˆY (X′))Pπξ(yl| ˆY (X′)),"
M,0.7334669338677354,"¯h(i, lX′)

Pπξ(yi| ˆY (X′)) −Pπξ(yi| ˆY (X′))Pπξ(yi| ˆY (X′))
o"
M,0.7344689378757515,≤2HPπξ(yi| ˆY (X′))(1 −Pπξ(yi| ˆY (X′)))
M,0.7354709418837675,"=2HVar
h
1Y =yi| ˆY (X′)
i
."
M,0.7364729458917836,"If ˆY j(X′) ̸= ˆyj
l , "
M,0.7374749498997996,"∂gX′(ξ)
∂θAcc
yi,ˆyj
l ,j =  X"
M,0.7384769539078156,l̸=lX′
M,0.7394789579158316,"¯h(l, lX′)∂Pπξ(yl| ˆY (X′))"
M,0.7404809619238477,"∂θAcc
yi,ˆyj
l ,j = 0."
M,0.7414829659318637,"(2). For j ∈[n], ˆyr ∈Yj, if ˆY j(X′) = ˆyr,"
M,0.7424849699398798,∂gX′(ξ)
M,0.7434869739478958,"∂θAcc
ˆyr,j =  X"
M,0.7444889779559118,l̸=lX′
M,0.7454909819639278,"¯h(l, lX′)∂Pπξ(yl| ˆY (X′))"
M,0.7464929859719439,"∂θAcc
ˆyr,j  =  X"
M,0.7474949899799599,l̸=lX′
M,0.748496993987976,"¯h(l, lX′)

Pπξ(Y = yl, ¯Y r = 1| ˆY (X′)) −Pπξ(Y = yl| ˆY (X′))Pπξ( ¯Y r = 1| ˆY (X′))


. Let"
M,0.749498997995992,"f1(l) = Pπξ(Y = yl, ¯Y r = 1| ˆY (X′))"
M,0.750501002004008,"f2(l) = Pπξ(Y = yl| ˆY (X′))Pπξ( ¯Y r = 1| ˆY (X′)), and"
M,0.751503006012024,"B1 = {l : f1(l) ≥f2(l), l ̸= lX′},"
M,0.7525050100200401,"B2 = {l : f1(l) < f2(l), l ̸= lX′}."
M,0.7535070140280561,Published as a conference paper at ICLR 2022
M,0.7545090180360722,"Therefore, X"
M,0.7555110220440882,l̸=lX′
M,0.7565130260521042,"¯h(l, lX′)

Pπξ(Y = yl, ¯Y r = 1| ˆY (X′)) −Pπξ(Y = yl| ˆY (X′))Pπξ( ¯Y r = 1| ˆY (X′))
 =  X"
M,0.7575150300601202,l̸=lX′
M,0.7585170340681363,"¯h(l, lX′) (f1(l) −f2(l))  =  X"
M,0.7595190380761523,"l∈B1
¯h(l, lX′) (f1(l) −f2(l)) +
X"
M,0.7605210420841684,"l∈B2
¯h(l, lX′) (f1(l) −f2(l)) "
M,0.7615230460921844,"≤max
t=1,2  X"
M,0.7625250501002004,"l∈BT
¯h(l, lX′) (f1(l) −f2(l))  = max (X"
M,0.7635270541082164,"l∈B1
¯h(l, lX′) (f1(l) −f2(l)) ,
X"
M,0.7645290581162325,"l∈B2
¯h(l, lX′) (f2(l) −f1(l)) ) ."
M,0.7655310621242485,"On the other hand, X"
M,0.7665330661322646,"l∈B1
¯h(l, lX′) (f1(l) −f2(l)) =
X"
M,0.7675350701402806,"l∈B1
¯h(l, lX′)

Pπξ(Y = yl, ¯Y r = 1| ˆY (X′)) −Pπξ(Y = yl| ˆY (X′))Pπξ( ¯Y r = 1| ˆY (X′))
 ≤2H
X l∈B1"
M,0.7685370741482966,"
Pπξ(Y = yl, ¯Y r = 1| ˆY (X′)) −Pπξ(Y = yl| ˆY (X′))Pπξ( ¯Y r = 1| ˆY (X′))
"
M,0.7695390781563126,"=2H

Pπξ(Y = yl, ∃l ∈B1, ¯Y r = 1| ˆY (X′)) −Pπξ(Y = yl, ∃l ∈B1| ˆY (X′))Pπξ( ¯Y r = 1| ˆY (X′))
"
M,0.7705410821643287,"=2H

Pπξ(Y = yl, ∃l ∈B1, ¯Y r = 1| ˆY (X′))Pπξ( ¯Y r = 0| ˆY (X′))"
M,0.7715430861723447,"−Pπξ(Y = yl, ∃l ∈B1, ¯Y r = 0| ˆY (X′))Pπξ( ¯Y r = 1| ˆY (X′))
"
M,0.7725450901803608,"≤2H

Pπξ( ¯Y r = 1| ˆY (X′))Pπξ( ¯Y r = 0| ˆY (X′))
"
M,0.7735470941883767,"=2HVar
h
¯Y r| ˆY (X′)
i
."
M,0.7745490981963928,"Similarly, we have
X"
M,0.7755511022044088,"l∈B1
¯h(l, lX′) (f2(l) −f1(l)) −
X"
M,0.7765531062124249,"l∈B2
¯h(l, lX′)

Pπξ(Y = yl, ¯Y r = 1| ˆY (X′)) + Pπξ(Y = yl| ˆY (X′))Pπξ( ¯Y r = 1| ˆY (X′))
"
M,0.7775551102204409,"≤2HVar
h
¯Y r| ˆY (X′)
i
."
M,0.7785571142284569,"Conclusively, we have

∂gX′(ξ)"
M,0.779559118236473,"∂θAcc
ˆyr,j"
M,0.7805611222444889,"≤2HVar
h
¯Y r| ˆY (X′)
i
."
M,0.781563126252505,"If ˆY j = ˆyr, similar to (1), we have

∂gX′(ξ)"
M,0.782565130260521,"∂θAcc
ˆyr,j = 0."
M,0.7835671342685371,Published as a conference paper at ICLR 2022
M,0.7845691382765531,"(3). For any ˆyi, ˆyj ∈ˆY, by the definition of ϕt
ˆyi,ˆyj, there exists (a, b) ∈{0, 1}2, such that
ϕt
ˆyi,ˆyj(a, b) ̸= 0. Similar to (2), let"
M,0.7855711422845691,"f3(l) = Pπξ(Y = yl, ¯Y i = a, ¯Y j = b| ˆY (X′))"
M,0.7865731462925851,"f4(l) = Pπξ(Y = yl| ˆY (X′))Pπξ( ¯Y i = a, ¯Y j = b| ˆY (X′)) and"
M,0.7875751503006012,"B3 = {l : f3(l) ≥f4(l), l ̸= lX′},"
M,0.7885771543086172,"B4 = {l : f3(l) < f4(l), l ̸= lX′}"
M,0.7895791583166333,"we have

∂gX′(ξ)"
M,0.7905811623246493,"∂θt
ˆyi,ˆyj = max (X"
M,0.7915831663326653,"l∈B3
¯h(l, lX′) (f3(l) −f4(l)) ,
X"
M,0.7925851703406813,"l∈B4
¯h(l, lX′) (f4(l) −f3(l)) )"
M,0.7935871743486974,"≤2HVar
h
ϕt
ˆyi,ˆyj( ¯Y i, ¯Y j)| ˆY (X′)
i"
M,0.7945891783567134,"(∗)
≤2H

Var
h
¯Y i| ˆY (X′)
i
+ Var
h
¯Y j| ˆY (X′)
i
,"
M,0.7955911823647295,where inequality (∗) comes from Lemma D.1.
M,0.7965931863727455,"(4). For any yi ∈Y, ˆyr ∈ˆY, by the definition of ϕt
yi,ˆyr, there exists a ∈{0, 1}, yj ∈Y, s.t.,
ϕt
yi,ˆyr(yj, a) ̸= 0. We further divide the proof into two cases: ϕt
yi,ˆyr(yi, a) = 0, and ϕt
yi,ˆyr(yi, a) ̸=
0."
M,0.7975951903807615,"(4a). If ϕt
yi,ˆyr(yi, a) = 0, we have tyi ˆyr = tsg and consequently a = 1. Similar to (1-3)., we have"
M,0.7985971943887775,∂gX′(ξ)
M,0.7995991983967936,"∂θt
yi,ˆyr =  X"
M,0.8006012024048096,l̸=lX′
M,0.8016032064128257,"¯h(l, lX′)∂Pπξ(yl| ˆY (X′))"
M,0.8026052104208417,"∂θt
yi,ˆyr  (•)
=  k
X"
M,0.8036072144288577,"l=1
¯h(l, lX′)∂Pπξ(yl| ˆY (X′))"
M,0.8046092184368737,"∂θt
yi,ˆyr  =  X"
M,0.8056112224448898,"l̸=i
¯h(l, lX′)

Pπξ(Y = yl, ¯Y r = 1| ˆY (X′)) −Pπξ(Y = yl| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))
"
M,0.8066132264529058,"−¯h(i, lX′)Pπξ(Y = yi| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))
 ,"
M,0.8076152304609219,where Eq. (•) is due to Let
M,0.8086172344689379,"f5(l) = Pπξ(Y = yl, ¯Y r = 1| ˆY (X′))"
M,0.8096192384769539,"f6(l) = Pπξ(Y = yl| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′)) and"
M,0.8106212424849699,"B5 = {l : f5(l) ≥f6(l),
l ̸= i},"
M,0.811623246492986,"B6 = {l : f5(l) < f6(l),
l ̸= i}"
M,0.812625250501002,"Then we have

∂gX′(ξ)"
M,0.8136272545090181,"∂θt
yi,ˆyr ≤max (X"
M,0.814629258517034,"l∈B5
¯h(l, lX′) (f5(l) −f6(l)) ,
X"
M,0.8156312625250501,"l∈B6
¯h(l, lX′) (f6(l) −f5(l)) + ¯h(i, lX′)f6(i) ) ."
M,0.8166332665330661,Published as a conference paper at ICLR 2022
M,0.8176352705410822,"On one hand,
X"
M,0.8186372745490982,"l∈B5
¯h(l, lX′) (f5(l) −f6(l)) =
X"
M,0.8196392785571143,"l∈B5
¯h(l, lX′)

Pπξ(Y = yl, ¯Y r = 1| ˆY (X′)) −Pπξ(Y = yl| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))
 ≤
X"
M,0.8206412825651302,"l∈B5
2H

Pπξ(Y = yl, ¯Y r = 1| ˆY (X′)) −Pπξ(Y = yl| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))
"
M,0.8216432865731463,"=2H

Pπξ(Y = yl, ∃l ∈B5, ¯Y r = 1| ˆY (X′)) −Pπξ(Y = yl, ∃l ∈B5| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))
"
M,0.8226452905811623,"=2H

Pπξ(Y = yl, ∃l ∈B5, ¯Y r = 1| ˆY (X′))(1 −Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′)))"
M,0.8236472945891784,"−Pπξ(Y = yl, ∃l ∈B5, ¯Y r = 0| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))
"
M,0.8246492985971944,"≤2HPπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))(1 −Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′)))"
M,0.8256513026052105,"=2HVarπξ
h
ϕt
yi,ˆyl(Y, ¯Y r)| ˆY (X′)
i"
M,0.8266533066132264,"≤2HVarπξ
h
1Y =yi| ˆY (X′)
i
+ 2HVarπξ
h
¯Y r| ˆY (X′)
i
."
M,0.8276553106212425,"On the other hand,
X"
M,0.8286573146292585,"l∈B6
¯h(l, lX′) (f6(l) −f5(l)) + ¯h(i, lX′)f6(i) = −
X"
M,0.8296593186372746,"l∈B6
¯h(l, lX′)

Pπξ(Y = yl, ¯Y r = 1| ˆY (X′)) + Pπξ(Y = yl| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))
"
M,0.8306613226452906,"+ ¯h(i, lX′)Pπξ(Y = yi| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))"
M,0.8316633266533067,"≤2H

−Pπξ(Y = yl, ∃l ∈B6, ¯Y r = 1| ˆY (X′))(1 −Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′)))"
M,0.8326653306613226,"−Pπξ(Y = yl, ∃l ∈B6, ¯Y r = 0| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))"
M,0.8336673346693386,"+ Pπξ(Y = yi| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))
"
M,0.8346693386773547,"≤2H

Pπξ(Y = yl, ∃l ∈B6, ¯Y r = 0| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))"
M,0.8356713426853707,"+ Pπξ(Y = yi| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))
"
M,0.8366733466933868,"≤2H

Pπξ( ¯Y r = 0| ˆY (X′))Pπξ( ¯Y r = 1| ˆY (X′)) + Pπξ(Y = yi| ˆY (X′))Pπξ(Y ̸= yi, ¯Y r = 1| ˆY (X′))
"
M,0.8376753507014028,"≤2HVarπξ
h
1Y =yi| ˆY (X′)
i
+ 2HVarπξ
h
¯Y r| ˆY (X′)
i
."
M,0.8386773547094188,"Therefore, in this case, we have

∂gX′(ξ)"
M,0.8396793587174348,"∂θt
yi,ˆyr"
M,0.8406813627254509,"≤2HVarπξ
h
1Y =yi| ˆY (X′)
i
+ 2HVarπξ
h
¯Y r| ˆY (X′)
i
."
M,0.8416833667334669,"(4b). If ϕt
yi,ˆyr(yi, a) ̸= 0, similar to (4a)., we have"
M,0.842685370741483,∂gX′(ξ)
M,0.843687374749499,"∂θt
yi,ˆyr = −
X"
M,0.844689378757515,"l̸=i
¯h(l, lX′)Pπξ(Y = yl| ˆY (X′))Pπξ(Y = yi, ¯Y r = 1| ˆY (X′))"
M,0.845691382765531,"+ ¯h(i, lX′)

Pπξ(Y = yi, ¯Y l = 1| ˆY (X′)) −Pπξ(Y = yi| ˆY (X′))Pπξ(Y = yi, ¯Y r = 1| ˆY (X′))
 ."
M,0.8466933867735471,Published as a conference paper at ICLR 2022 Since
M,0.8476953907815631,"¯h(i, lX′)

Pπξ(Y = yi, ¯Y r = 1| ˆY (X′)) −Pπξ(Y = yi| ˆY (X′))Pπξ(Y = yi, ¯Y r = 1| ˆY (X′))
"
M,0.8486973947895792,"=¯h(i, lX′)Pπξ(Y = yi, ¯Y r = 1| ˆY (X′))Pπξ(Y ̸= yi| ˆY (X′)) ≥0,"
M,0.8496993987975952,"we have 
∂gX′(ξ)"
M,0.8507014028056112,"∂θt
yi,ˆyl"
M,0.8517034068136272,"≤max
n
¯h(i, lX′)Pπξ(Y = yi, ¯Y r = 1| ˆY (X′))Pπξ(Y ̸= yi| ˆY (X′)) , X"
M,0.8527054108216433,"l̸=i
¯h(l, lX′)Pπξ(Y = yl| ˆY (X′))Pπξ(Y = yi, ¯Y r = 1| ˆY (X′)) 
 "
M,0.8537074148296593,"≤2HVar
h
1Y =yi| ˆY (X′)
i
."
M,0.8547094188376754,"Combining (4a). and (4b)., we have that

∂gX′(ξ)"
M,0.8557114228456913,"∂θt
yi,ˆyl"
M,0.8567134268537074,"≤2H

Varπξ
h
1Y =yi| ˆY (X′)
i
+ Varπξ
h
¯Y l| ˆY (X′)
i
."
M,0.8577154308617234,"Combining (1-4)., we then have"
M,0.8587174348697395,∥∇gX′(ξ)∥2
M,0.8597194388777555,"≤4H2
k
X i=1 n
X"
M,0.8607214428857716,"j=1
(|N(yi, Yj)| −1) Varπξ
h
1Y =yi| ˆY (X′)
i2
(27)"
M,0.8617234468937875,"+ 4H2
X"
M,0.8627254509018036,"j∈[n],ˆyr∈Yj
Varπξ
h
¯Y r| ˆY (X′)
i2"
M,0.8637274549098196,+ 4H2 X
M,0.8647294589178357,"i,j∈[ˆk]"
M,0.8657314629258517,"
Varπξ
h
¯Y i| ˆY (X′)
i
+ Varπξ
h
¯Y j| ˆY (X′)
i2"
M,0.8667334669338678,"+ 4H2
X"
M,0.8677354709418837,"i∈[k],j∈[ˆk]"
M,0.8687374749498998,"
Varπξ
h
1Y =yi| ˆY (X′)
i
+ Varπξ
h
¯Y l| ˆY (X′)
i2 ≤8H2  
k
X"
M,0.8697394789579158,"i=1
(ni + ˆk)Varπξ(1Y =yi| ˆY = ˆY ∗)2 + ˆk
X"
M,0.8707414829659319,"i=1
(mi + K −1)Varπξ( ¯Y i| ˆY = ˆY ∗)2  . (28)"
M,0.8717434869739479,"Therefore, by Eqs. (25), (26), and (28), and Assumption Eq. (21), we have"
M,0.872745490981964,|ℓ(W) −ℓˆΘ(W)| = Eπ∗  X
M,0.87374749498998,l̸=lX′
M,0.874749498997996,"¯h(l, lX′)

PπΘ∗(Y = yl| ˆY (X′)) −Pπ ˆ
Θ(Y = yl| ˆY (X′))

  "
M,0.875751503006012,"=
Eπ∗
h
gX′(Θ∗) −gX′(ˆΘ)
i"
M,0.8767535070140281,"≤
Eπ∗∥∇gX′(ξ)∥∥Θ∗−ˆΘ∥"
M,0.8777555110220441,"≤2cH
√"
M,0.8787575150300602,"M
∥Θ∗−ˆΘ∥."
M,0.8797595190380761,"Now, we apply the assumption that we are able to solve the empirical problem, producing an estimate
ˆW that satisfies
E
h
ℓˆΘ( ˆW) −ℓˆΘ(W ∗
Θ)
i
≤χ,"
M,0.8807615230460922,Published as a conference paper at ICLR 2022
M,0.8817635270541082,"where W ∗
ˆΘ is the true solution to"
M,0.8827655310621243,"W ∗
ˆΘ = arg min
W ℓΘ(W)."
M,0.8837675350701403,"Therefore,"
M,0.8847695390781564,"E
h
ℓ( ˆW) −ℓ(W ∗)
i
= E
h
ℓˆΘ( ˆW) −ℓˆΘ(W ∗
ˆΘ) + ℓˆΘ(W ∗
ˆΘ) −ℓˆΘ( ˆW) + ℓ( ˆW) −ℓ(W ∗)
i"
M,0.8857715430861723,"(∗)
≤χ + E
h
ℓˆΘ(W ∗
ˆΘ) −ℓˆΘ( ˆW) + ℓ( ˆW) −ℓ(W ∗)
i"
M,0.8867735470941884,"≤χ + 4cH
1
√"
M,0.8877755511022044,"M
E∥ˆΘ −Θ∗∥+ E
h
ℓˆΘ(W ∗
ˆΘ) −ℓˆΘ( ˆW) + ℓˆΘ( ˆW) −ℓˆΘ(W ∗)
i"
M,0.8887775551102205,"≤χ + 4cH
1
√"
M,0.8897795591182365,"M
E∥ˆΘ −Θ∗∥,"
M,0.8907815631262525,where Eq. (∗) comes from condition (23).
M,0.8917835671342685,"With Eqs. (20) and (21), we have Eq. (24) by Lemma D.5, i.e.,

E∥ˆΘ −Θ∗∥
2
≤E∥ˆΘ −Θ∗∥2 ≤ε2M."
M,0.8927855711422845,"We can now bound this using the result of Lemma D.6, which results in"
M,0.8937875751503006,"E
h
ℓ( ˆW) −ℓ(W ∗)
i
≤χ + 4cHϵ."
M,0.8947895791583166,The proof is completed.
M,0.8957915831663327,"E
EXAMPLES AND ILLUSTRATIONS"
M,0.8967935871743486,"E.1
LABEL GRAPH AND LABEL HIERARCHY"
M,0.8977955911823647,"Fig 5 shows the mapping between a label hierarchy and the corresponding label graph. Indeed, given
the order of labels, any label structure represented as a (directed acyclic graph) DAG can be converted
to exact one consistent label graph based on the four types of label relations."
M,0.8987975951903807,"Canidae
Domestic"
M,0.8997995991983968,Animal
M,0.9008016032064128,"Dog
Cat Husky Cat Dog"
M,0.9018036072144289,"Husky
Canidae"
M,0.9028056112224448,Domestic
M,0.9038076152304609,Animal
M,0.9048096192384769,"Exclusive
Overlap
Subsuming
Subsumed"
M,0.905811623246493,Figure 5: The illustration of mapping between a DAG of labels and a label graph.
M,0.906813627254509,"E.2
AN EXAMPLE OF INCONSISTENT LABEL GRAPH"
M,0.9078156312625251,"Fig. 6 shows an example of an inconsistent label graph. We can see that the label graph is unrealistic
and ambiguous because “Husky” subsumes “Canidae”, but (1) “Canidae” subsumes “Dog” and
(2) “Dog” subsuems “Husky” combined imply that “Husky” should be subsumed by “Canidae”.
Also, from the example, we can see that label graph induced from cyclic label hierarchy must be
inconsistent."
M,0.908817635270541,Published as a conference paper at ICLR 2022
M,0.9098196392785571,"Dog
Husky"
M,0.9108216432865731,Exclusive
M,0.9118236472945892,"Overlap
Subsuming"
M,0.9128256513026052,Subsumed
M,0.9138276553106213,Canidae
M,0.9148296593186372,"Dog
Husky"
M,0.9158316633266533,Canidae
M,0.9168336673346693,Figure 6: The illustration of inconsistent label graph.
M,0.9178356713426854,"E.3
ENUMERATION OF INCONSISTENT TRIANGLE LABEL GRAPH"
M,0.9188376753507014,"For a triangle label graph G, we list all inconsistent label relation structures. The consistency of
larger label graph with more labels can be verified by checking the consistency of every triangle
inside. One example proof of {Exclusive, Overlap, Subsuming} can be found in Lemma 1."
M,0.9198396793587175,Table 5: Enumeration of Inconsistent Label Relation Triplets.
M,0.9208416833667334,label relation Triplets
M,0.9218436873747495,"tab
tbc
tac
Overlap
Subsumed
Subsuming
Overlap
Subsumed
Exclusive
Overlap
Subsuming
Subsumed
Overlap
Exclusive
Subsumed
Exclusive
Subsumed
Subsuming
Exclusive
Overlap
Subsuming
Exclusive
Subsuming
Subsuming
Exclusive
Subsuming
Subsumed
Exclusive
Subsuming
Overlap
Subsuming
Exclusive
Subsumed
Subsuming
Subsumed
Exclusive
Subsuming
Overlap
Subsumed
Subsuming
Overlap
Exclusive
Subsuming
Subsuming
Exclusive
Subsuming
Subsuming
Subsumed
Subsuming
Subsuming
Overlap
Subsumed
Overlap
Subsuming
Subsumed
Subsumed
Exclusive
Subsumed
Subsumed
Subsuming
Subsumed
Subsumed
Overlap
Subsumed
Exclusive
Subsuming
Subsumed
Exclusive
Subsumed
Subsumed
Exclusive
Overlap"
M,0.9228456913827655,"E.4
AN EXAMPLE OF INDISTINGUISHABLE LABEL GRAPH"
M,0.9238476953907816,"Fig. 7 shows an example label graph with indistinguishable label relation structure. Again, red
labels represent desired unseen labels, while gray labels are undesired and seen. We can see that
unseen label “Husky” and “Bulldog” have indistinguishable label relation structures because for all
seen labels, their label relations are equal. For example, seen label “Dog” subsumes both “Husky”
and “Bulldog”. In contrast, for “Husky” and “Bengal Cat”, seen label “Cat” subsumes the latter
but exclusive to the former, which indicates that “Husky” and “Bengal Cat” have distinguishable
label relation structure. Note that “Bengal Cat” and “Persian Cat” also have indistinguishable label
relation structure, but the former is unseen desired label while the latter is seen and can be predicted
by some ILF(s). We are only interested in the distinguishablity of a pair of unseen labels."
M,0.9248496993987976,Published as a conference paper at ICLR 2022
M,0.9258517034068137,"In practice, users could ""break the symmetry"" by adding new ILFs with new labels. For example, if
we add an ILF that could predict “Arctic Animals”, then the new seen label “Arctic Animals” will be
added into label graph as shown in Fig. 8. We know that “Arctic Animals” subsumes “Husky” but
not “Bulldog”, so we break the indistinguishable label relation structure of “Husky” and “Bulldog”
successfully."
M,0.9268537074148296,Domestic
M,0.9278557114228457,Animal
M,0.9288577154308617,"Dog
Cat Husky"
M,0.9298597194388778,"Exclusive
Overlap
Subsuming"
M,0.9308617234468938,"Subsumed
Bulldog
Bengal Cat"
M,0.9318637274549099,Persian Cat
M,0.9328657314629258,Domestic
M,0.9338677354709419,Animal Dog Cat Husky
M,0.9348697394789579,Bulldog
M,0.935871743486974,Bengal Cat
M,0.93687374749499,"Persian Cat …
…
…"
M,0.9378757515030061,Figure 7: An example of an indistinguishable label relation structure (“Husky” and “Bulldog”).
M,0.938877755511022,Domestic
M,0.9398797595190381,Animal
M,0.9408817635270541,"Dog
Cat Husky"
M,0.9418837675350702,Exclusive
M,0.9428857715430862,Overlap
M,0.9438877755511023,Subsuming
M,0.9448897795591182,"Subsumed
Bulldog
Bengal Cat"
M,0.9458917835671342,Persian Cat
M,0.9468937875751503,Domestic
M,0.9478957915831663,Animal Dog Cat Husky
M,0.9488977955911824,Bulldog
M,0.9498997995991983,Bengal Cat
M,0.9509018036072144,"Persian Cat …
…
…"
M,0.9519038076152304,"Arctic
Animals"
M,0.9529058116232465,"Arctic
Animals …"
M,0.9539078156312625,"Figure 8: An example of fixing an indistinguishable label relation structure (“Husky” and “Bulldog”)
by adding a new label (“Arctic Animals”)."
M,0.9549098196392786,"F
EXPERIMENTAL DETAILS"
M,0.9559118236472945,"F.1
DATASET"
M,0.9569138276553106,"Large scale Text Classification Dataset3: LSHTC-3 (Partalas et al., 2015), a large scale hierarchical
text classification dataset, which consists of 456,886 documents and 36,504 categories organized
in a label hierarchy. We filter out the documents with multiple labels, and preserve categories with
more than 500 documents. We use a pre-trained sentence transformer (Reimers & Gurevych, 2019)
to obtain document embeddings for classification. We follow Zhang et al. (2021) to generate 5
keyword-based labeling functions for each seen label as ILFs."
M,0.9579158316633266,"Large scale Image Classification Dataset4: ILSVRC2012 (Russakovsky et al., 2015), a large scale
image classification dataset, which consists of 1.2M training images from 1000 object classes based"
M,0.9589178356713427,"3http://lshtc.iit.demokritos.gr/
4http://image-net.org/challenges/LSVRC/2012/index#data"
M,0.9599198396793587,Published as a conference paper at ICLR 2022
M,0.9609218436873748,"on ImageNet. Following Deng et al. (2014) we use WordNet as the label hierarchy, and because all
the images are assigned to leave labels in WordNet, for each non-leave label, we aggregate images
belonging to its descendants as its data points (Deng et al., 2014). For weak supervision sources
creation, we follow Mazzetto et al. (2021b;a) to train 10 image classifiers as ILFs. We randomly
sampling 2 or 3 exclusive seen labels from the label graph as well as 500 images for each label to
train a ResNet-32 classifier."
M,0.9619238476953907,"F.2
DESCRIPTION OF APPLYING DAP"
M,0.9629258517034068,"To apply DAP, we use both label relations and ILFs to construct attributes for both unseen classes
and unlabeled data points. Then, we train the attribute classifiers, which in turn are used to predict
unseen labels on the test set as in Lampert et al. (2013). To construct attributes for unseen labels and
data points, we leverage the outputs of ILFs and label relations."
M,0.9639278557114228,"First, based on the label relations and basic logistic rules, we enumerate all the possible assignments
of seen labels given a data point. For example, if label A is subsumed by label B, then for a data
point, when it belongs to label A, it must also belong to B; And if label A and B are exclusive, then
one data cannot belong to both at the same time. Let s ∈S denote one possible label assignment and
S is the set of all possible s. Then we define the attribute as a vector of |S| dimension where each
dimension corresponds to one s."
M,0.9649298597194389,"Second, we define the attribute of unseen labels. For an unseen label A and a label assignment s, if A
is not exclusive to any label in s then we set the corresponding attribute as = 1 for label A, other
wise 0. The intuition is that, if A is not exclusive to labels in s, it’s likely that when a data belongs
to assignment s, it also belongs to label A. For each data point, we use the labels assigned by ILFs
to build their attributes. If a data belongs to assignment s then its corresponding attribute as = 1,
otherwise 0."
M,0.9659318637274549,"Then, we can train attribute classifier p(a|x) for each attribute based on data point attributes. During
inference, we use unseen label attribute as well as attribute classifier as in Lampert et al. (2013):"
M,0.966933867735471,"f(x) = arg max
c |S|
Y m=1"
M,0.9679358717434869,"p(ac
m|x)
p(acm|x)
(29)"
M,0.968937875751503,"F.3
HYPER-PARAMETERS"
M,0.969939879759519,"For the training of PGMs, we set the learning rate to be 1"
M,0.9709418837675351,"n where n is the number of training data. For
training logistic regression model, we use the default parameters in scikit-learn library. For training
ResNet model, we set batch size as 256 and use Adam optimizer with learning rate being 1e-3 and
weight decay being 5e-5."
M,0.9719438877755511,"F.4
HARDWARE AND IMPLEMENTATION DETAILS"
M,0.9729458917835672,"All experiments ran on a machine with an Intel(R) Xeon(R) CPU E5-2678 v3 with a 512G memory
and a GeForce GTX 1080Ti-11GB GPU."
M,0.9739478957915831,"All the code was implemented in Python. We use the standard implementation of the logistic
regression model from Python scikit-learn library5 and the ResNet model from torchvision library6."
M,0.9749498997995992,Our code will be released upon the acceptance.
M,0.9759519038076152,"F.5
DATASET DETAILS OF REAL-WORLD APPLICATIONS"
M,0.9769539078156313,"We list the tags we used in the real-world application (Sec. 7.3) and examples of label relations we
query from the existing product category taxonomy."
M,0.9779559118236473,"5https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.
LogisticRegression.html"
M,0.9789579158316634,6https://pytorch.org/docs/stable/torchvision/models.html
M,0.9799599198396793,Published as a conference paper at ICLR 2022
M,0.9809619238476954,Table 6: The tags and examples of label relations of “Car Accessories” category.
M,0.9819639278557114,"new unseen tags:
“Performance Modifying Parts”, “Vehicle Tires & Tire Parts”, “Car Engines & Engine Parts”"
M,0.9829659318637275,"existing tags:
“Car Modification Parts”, “Car Parts & Accessories”
“Car & Truck Tires”, “Replacement Car Parts”, “Car & Truck Wheels”"
M,0.9839679358717435,"label relation examples:
“Replacement Car Parts” subsumes “Car Engines & Engine Parts”
“Car & Truck Tires” is subsumed by “Vehicle Tires & Tire Parts”"
M,0.9849699398797596,Table 7: The tags and examples of label relations of “Furniture Accessories” category.
M,0.9859719438877755,"new unseen tags:
“Clothing & Shoe Storage”, “Living Room Furniture”, “Beds & Headboards”"
M,0.9869739478957916,"existing tags:
“Coffee Tables & End Tables”, “Entertainment & Media Centers”
“Bedroom Furniture”, “Sofas & Chairs”, “Mattresses”"
M,0.9879759519038076,"label relation examples:
“Bedroom Furniture” subsumes “Beds & Headboards”
“Sofas & Chairs” is subsumed by “Living Room Furniture”"
M,0.9889779559118237,"G
ADDITIONAL EXPERIMENTS"
M,0.9899799599198397,"G.1
PERFORMANCE DROP WHEN THE DISTINGUISHABLE CONDITION IS VIOLATED"
M,0.9909819639278558,"To validate the effectiveness of the distinguishable condition, we drive another 100 WIS tasks from
LSHTC-3 dataset where each task has at least one pair of unseen labels sharing exactly the same
label relation structure. In Table 8, we report the performance drop on the averaged evaluation results
over the 100 WIS tasks with comparison to the numbers in Table 2. Although the two sets of WIS
tasks are different and therefore are not individually comparable, the averaged performance drop does
indicates that the violation of the distinguishable condition results in undesirable synthesized training
labels, which implicitly demonstrates the effectiveness of the distinguishable condition."
M,0.9919839679358717,"Table 8: Performance drop on averaged evaluation results over 100 WIS tasks derived from LSHTC-3
when the distinguishable condition is violated."
M,0.9929859719438878,"Method
Accuracy
F1-score"
M,0.9939879759519038,Label Model
M,0.9949899799599199,"LR-MV
-11.49
-13.83
W-LR-MV
-11.51
-13.47
WS-LG
-9.28
-8.63"
M,0.9959919839679359,"PLRM
-9.66
-9.63"
M,0.996993987975952,End Model
M,0.9979959919839679,"LR-MV
-16.14
-17.08
W-LR-MV
-15.27
-15.97
WS-LG
-13.13
-13.78"
M,0.998997995991984,"PLRM
-13.39
-14.09"
