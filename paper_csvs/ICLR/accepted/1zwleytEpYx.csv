Section,Section Appearance Order,Paragraph
ABSTRACT,0.0,ABSTRACT
ABSTRACT,0.0026246719160104987,"Imitation learning algorithms learn a policy from demonstrations of expert behavior.
We show that, for deterministic experts, imitation learning can be done by reduction
to reinforcement learning with a stationary reward. Our theoretical analysis both
certifies the recovery of expert reward and bounds the total variation distance
between the expert and the imitation learner, showing a link to adversarial imitation
learning. We conduct experiments which confirm that our reduction works well in
practice for continuous control tasks."
INTRODUCTION,0.005249343832020997,"1
INTRODUCTION"
INTRODUCTION,0.007874015748031496,"Typically, reinforcement learning (RL) assumes access to a pre-specified reward and then learns
a policy maximizing the expected average of this reward along a trajectory. However, specifying
rewards is difficult for many practical tasks (Atkeson & Schaal, 1997; Zhang et al., 2018; Ibarz et al.,
2018). In such cases, it is convenient to instead perform Imitation Learning (IL), learning a policy
from expert demonstrations."
INTRODUCTION,0.010498687664041995,"There are two major categories of Imitation Learning algorithms: behavioral cloning and inverse
reinforcement learning. Behavioral cloning learns the policy by supervised learning on expert data,
but is not robust to training errors, failing in settings where expert data is limited (Ross & Bagnell,
2010). Inverse reinforcement learning (IRL) achieves improved performance on limited data by
constructing reward signals and calling an RL oracle to maximize these rewards (Ng et al., 2000)."
INTRODUCTION,0.013123359580052493,"The most versatile IRL method is adversarial IL (Ho & Ermon, 2016; Li et al., 2017; Ghasemipour
et al., 2020), which minimizes a divergence between the distribution of data produced by the agent
and provided by the expert. Adversarial IL learns a representation and a policy simultaneously by
using a non-stationary reward obtained from a discriminator network. However, training adversarial
IL combines two components which are hard to stabilize: a discriminator network, akin to the one
used in GANs, as well as a policy, typically learned with an RL algorithm with actor and critic
networks. This complexity makes the training process very brittle."
INTRODUCTION,0.015748031496062992,"There is a clear need for imitation learning algorithms that are simpler and easier to deploy. To
address this need, Wang et al. (2019) proposed to reduce imitation learning to a single instance of
reinforcement learning problem, where reward is defined to be one for state-action pairs from the
expert trajectory and zero for other state-action pairs. A closely related, but not identical, algorithm
has been proposed by Reddy et al. (2020) (we describe the differences in Section 5). However, while
empirical performance of these approaches has been good, they enjoy no performance guarantees at
all, even in the asymptotic setting where expert data is infinite."
INTRODUCTION,0.01837270341207349,"Contributions
We fill in this missing justification for this algorithm, providing the needed theoreti-
cal analysis. Specifically, in Sections 3 and 4, we show a total variation bound between the expert
policy and the imitation policy, providing a high-probability performance guarantee for a finite dataset
of expert data and linking the reduction to adversarial imitation learning algorithms. For stochastic
experts, we describe how the reduction fails, completing the analysis. Moreover, in Section 6, we
empirically evaluate the performance of the reduction as the amount of available expert data varies."
INTRODUCTION,0.02099737532808399,Published as a conference paper at ICLR 2022
PRELIMINARIES,0.023622047244094488,"2
PRELIMINARIES"
PRELIMINARIES,0.026246719160104987,"Markov Decision Process
An average-reward Markov Decision Process (Puterman, 2014; Fein-
berg & Shwartz, 2012) is a tuple (S, A, T, R, s1), where S is a state space, A is the action space,
T : S × A →P(S) is the transition model, R : S × A →[0, 1] is a bounded reward function and s1
is the initial state. Here, we write P(X) to denote probability distributions over a set X. A stationary
policy π : S →P(A) maps environment states to distributions over actions. A policy π induces a
Markov chain Pπ over the states. In the theoretical part of the paper, we treat MDPs with finite state
and action spaces. Given the starting state s1 of the MDP, and a policy π, the limiting distribution
over states is defined as"
PRELIMINARIES,0.028871391076115485,"ρπ
S = 1(s1)⊤lim
N→∞
1
N N
X"
PRELIMINARIES,0.031496062992125984,"i=0
P i
π,
(1)"
PRELIMINARIES,0.03412073490813648,"where 1(s1) denotes the indicator vector. We adopt the convention that the subscript S indicates a
distribution over states and no subscript indicates a distribution over state-action pairs. We denote
ρπ(s, a) = ρπ
S(s)π(a|s). While the limit in equation 1 is guaranteed to exist for all finite MDPs
(Puterman, 2014), without requiring ergodicity, in this paper we consider policies that induce ergodic
chains. Correspondingly, our notation for ρπ
S and ρπ does not include the dependence on the initial
state. The expected per-step reward of π is defined as"
PRELIMINARIES,0.03674540682414698,"V π = lim
N→∞Eπ [JN/N | s1] = Eρπ[R(s, a)],
(2)"
PRELIMINARIES,0.03937007874015748,"where JN = PN
t=1 R(st, at) is the total return. In this paper we consider undiscounted MDPs
because they are enough to model the essential properties of the imitation learning problem while
being conceptually simpler than discounted MDPs. However, we believe that similar results could be
obtained for discounted MDPs."
PRELIMINARIES,0.04199475065616798,"Expert Dataset
Assume that the expert follows an ergodic policy πE. Denote the corresponding
distribution over expert state-action pairs as ρE(s, a) = ρπE(s, a), which does not depend on
the initial state by ergodicity. Consider a finite trajectory s1, a1, s2, a2, . . . , sN, aN. Denote by
ˆρ(s, a) =
1
N
PN
t=1 1 {(s, a) = (st, at)} the histogram (empirical distribution) of data seen along
this trajectory and denote by ˆρS(s) =
1
N
PN
t=1 1 {s = st} the corresponding histogram over the
states. Denote by D the support of ˆρ, i.e. the set of state-action pairs visited by the expert."
PRELIMINARIES,0.04461942257217848,"Total Variation
Consider probability distributions defined on a discrete set X. The total variation
distance between distributions is defined as"
PRELIMINARIES,0.047244094488188976,"∥ρ1 −ρ2∥TV = sup
M⊆X
|ρ1(M) −ρ2(M)|.
(3)"
PRELIMINARIES,0.049868766404199474,"In our application, the set X is either the set of MDP states S or the set of state state-action pairs
S × A. Below, we restate in our notation standard results about the total variation distance. See
Appendix D for proofs."
PRELIMINARIES,0.05249343832020997,"Lemma 1. If Eρ1[v] −Eρ2[v] ≤ϵ for any vector v ∈[0, 1]|X|, then ∥ρ1 −ρ2∥TV ≤ϵ."
PRELIMINARIES,0.05511811023622047,"Lemma 2. If ∥ρ1 −ρ2∥TV ≤ϵ, then Eρ1[v] −Eρ2[v] ≤2ϵ for any vector v ∈[0, 1]|X|."
PRELIMINARIES,0.05774278215223097,"Imitation Learning
Learning to imitate means obtaining a policy that mimics expert behavior.
This can be formalized in two ways. First, we can seek an imitation policy πI which obtains a
expected per-step reward that is ϵ-close to the expert on any reward signal bounded in the interval
[0, 1]. Denote the limiting distribution of state-action tuples generated by the imitation learner with
ρI(s, a). Formally, we want to satisfy"
PRELIMINARIES,0.06036745406824147,"∀R : S × A →[0, 1],
EρE[R] −EρI[R] ≤ϵ,
(4)"
PRELIMINARIES,0.06299212598425197,"where ϵ is a small constant. Second, we can seek to ensure that the distributions of state-action pairs
generated by the expert and the imitation learner are similar (Ho & Ermon, 2016; Finn et al., 2016).
In particular, if we measure the divergence between distributions with total variation, we want to
ensure"
PRELIMINARIES,0.06561679790026247,"∥ρE −ρI∥TV ≤ϵ.
(5)"
PRELIMINARIES,0.06824146981627296,Published as a conference paper at ICLR 2022
PRELIMINARIES,0.07086614173228346,Algorithm 1 Imitation Learning by Reinforcement Learning (ILR)
PRELIMINARIES,0.07349081364829396,"Require: expert dataset D, ENVIRONMENT (without access to extrinsic reward)"
PRELIMINARIES,0.07611548556430446,"Rint(s, a) ←1 {(s, a) ∈D}
πI ←RL-SOLVER(ENVIRONMENT, Rint)"
PRELIMINARIES,0.07874015748031496,"Lemmas 1 and 2 show that the equations 4 and 5 are closely related. In other words, attaining expected
per-step reward close to the expert’s is the same (up to a multiplicative constant) as closeness in total
variation between the state-action distribution of the expert and the imitation learner. We provide
further background on adversarial imitation learning and other divergences in Section 5."
PRELIMINARIES,0.08136482939632546,"Markov Chains
When coupled with the dynamics of the MDP, a policy induces a Markov chain,
In this paper, we focus our attention on chains which are irreducible and aperiodic. Crucially, such
chains approach the stationary distribution at an exponential rate. In the following Lemma, we
formalize this insight. The proof is given in Appendix D.
Lemma 3. Denote with PE the Markov chain induced by an irreducible and aperiodic expert policy.
The mixing time of the chain τmix, defined as the smallest t so that maxs′ ∥1(s′)⊤P t
E −ρE
S ∥TV ≤1"
PRELIMINARIES,0.08398950131233596,"4
is bounded. Moreover, for any probability distribution p1, we have P∞
t=0 ∥p⊤
1 P t
E −ρE
S ∥TV ≤2τmix."
IMITATION LEARNING BY REINFORCEMENT LEARNING,0.08661417322834646,"3
IMITATION LEARNING BY REINFORCEMENT LEARNING"
IMITATION LEARNING BY REINFORCEMENT LEARNING,0.08923884514435695,"Algorithm
To perform imitation learning, we first obtain an expert dataset D and construct an
intrinsic reward"
IMITATION LEARNING BY REINFORCEMENT LEARNING,0.09186351706036745,"Rint(s, a) = 1 {(s, a) ∈D} .
(6)"
IMITATION LEARNING BY REINFORCEMENT LEARNING,0.09448818897637795,"We can then use any RL algorithm to solve for this reward. We note that for finite MDPs equation 6
exactly matches the algorithm proposed by Wang et al. (2019) as a heuristic. The reward defined in
equation 6 is intrinsic, meaning we construct it artificially in order to elicit a certain behavior from
the agent. This is in contrast to an extrinsic reward, which is what the agent gathers in the real world
and what we want to recover. We will learn in Proposition 1 that the two are in fact closely related
and solving for the intrinsic reward guarantees recovery of the extrinsic reward."
IMITATION LEARNING BY REINFORCEMENT LEARNING,0.09711286089238845,"Guarantee on Imitation Policy
The main focus of the paper lies on showing theoretical properties
of the imitation policy obtained when solving for the reward signal defined in equation 6. Our formal
guarantees hold under three assumptions.
Assumption 1. The expert policy is deterministic.
Assumption 2. The expert policy induces an irreducible and aperiodic Markov chain.
Assumption 3. The imitation learner policy induces an irreducible and aperiodic Markov chain."
IMITATION LEARNING BY REINFORCEMENT LEARNING,0.09973753280839895,"Assumption 1 is critical for our proof to go through and cannot be relaxed. It is also essential to
rationalize the approach of Wang et al. (2019). In fact, no reduction involving a single call to an RL
solver with stationary reward can exist for stochastic experts since for any MDP there is always an
optimal policy which is deterministic. Assumptions 2 and 3 could in principle be relaxed, to allow
for periodic chains, but it would complicate the reasoning, which we wanted to avoid. We note that
we only interact with the expert policy via a finite dataset of N samples."
IMITATION LEARNING BY REINFORCEMENT LEARNING,0.10236220472440945,"Our main contribution is Proposition 1, in which we quantify the performance of our imitation learner.
We state it below and prove it in Section 4.
Proposition 1. Consider an imitation learner trained on a dataset of size N, which attains the
limiting distribution of state-action pairs ρI. Under Assumptions 1, 2 and 3, given that we have
N ≥max

800|S|, 450 log
  2"
IMITATION LEARNING BY REINFORCEMENT LEARNING,0.10498687664041995,"δ
	
τ 3
mixη−2 expert demonstrations, with probability at least 1 −δ,
the imitation learner attains total variation distance from the expert of at most"
IMITATION LEARNING BY REINFORCEMENT LEARNING,0.10761154855643044,"∥ρE −ρI∥TV ≤η.
(7)"
IMITATION LEARNING BY REINFORCEMENT LEARNING,0.11023622047244094,"The constant τmix is the mixing time of the expert policy and has been defined in Section 2. Moreover,
with the same probability, for any bounded extrinsic reward function R, the imitation learner achieves"
IMITATION LEARNING BY REINFORCEMENT LEARNING,0.11286089238845144,Published as a conference paper at ICLR 2022
IMITATION LEARNING BY REINFORCEMENT LEARNING,0.11548556430446194,"expected per-step extrinsic reward of at least
EρI[R] ≥EρE[R] −η.
(8)"
IMITATION LEARNING BY REINFORCEMENT LEARNING,0.11811023622047244,"Proposition 1 shows that the policy learned by imitation learner satisfies two important desiderata: we
can guarantee both the closeness of the generated state-action distribution to the expert distribution
as well as recovery of expert reward. Moreover, the total variation bound in equation 7 links the
obtained policy to adversarial imitation learning algorithms. We describe this link in more detail in
Section 5."
PROOF,0.12073490813648294,"4
PROOF"
PROOF,0.12335958005249344,"Structure of Results
We begin by showing a result about mixing in Markov chains in Section 4.1.
We then give our proof, which has two main parts. In the first part, in Section 4.2, we show that it
is possible to achieve a high expected per-step intrinsic reward defined in equation 6. In the second
part, in Section 4.3, we show that, achieving a large expected per-step intrinsic reward guarantees a
large expected per-step extrinsic reward for any extrinsic reward bounded in [0, 1]. In Section 4.4, we
combine these results and prove Proposition 1."
MIXING IN MARKOV CHAINS,0.12598425196850394,"4.1
MIXING IN MARKOV CHAINS"
MIXING IN MARKOV CHAINS,0.12860892388451445,"We now show a lemma that quantifies how fast the histogram approaches the stationary distribu-
tion. The proof of the lemma relies on standard results about the Total Variation distance between
probability distributions as well as generic results about mixing in MDPs, developed by Paulin (2015).
Lemma 4. The total variation distance between the expert distribution and the expert histogram ˆρ
based on N samples can be bounded as"
MIXING IN MARKOV CHAINS,0.13123359580052493,∥ρE −ˆρ∥TV ≤ϵ + r
MIXING IN MARKOV CHAINS,0.13385826771653545,"8|S|τmix N
(9)"
MIXING IN MARKOV CHAINS,0.13648293963254593,"with probability at least 1 −2 exp
n
−ϵ2N"
MIXING IN MARKOV CHAINS,0.13910761154855644,4.5τmix
MIXING IN MARKOV CHAINS,0.14173228346456693,"o
(where the probability space is defined by the process
generating the expert histogram)."
MIXING IN MARKOV CHAINS,0.14435695538057744,"Proof. We first prove the statement for histograms over the states. Recall the notation ˆρS =
1
N
PN
t=1 1 {st = s}. Recall that we denote the stationary distribution (over states) of the Markov
chain induced by the expert with ρE
S ."
MIXING IN MARKOV CHAINS,0.14698162729658792,"First, instantiating Proposition 3.16 of Paulin (2015), we obtain"
MIXING IN MARKOV CHAINS,0.14960629921259844,"EˆρS[∥ρE
S −ˆρS∥TV] ≤P"
MIXING IN MARKOV CHAINS,0.15223097112860892,"s min
q"
MIXING IN MARKOV CHAINS,0.15485564304461943,"4ρE
S (s)
Nγps , ρE
S (s)

,"
MIXING IN MARKOV CHAINS,0.15748031496062992,"where γps is pseudo spectral gap of the chain. Re-write the right-hand side as
P"
MIXING IN MARKOV CHAINS,0.16010498687664043,"s min
q"
MIXING IN MARKOV CHAINS,0.16272965879265092,"4ρE
S (s)
Nγps , ρE
S (s)

≤P s
q"
MIXING IN MARKOV CHAINS,0.16535433070866143,"4ρE
S (s)
Nγps
≤
q"
MIXING IN MARKOV CHAINS,0.1679790026246719,"4|S|
Nγps ,"
MIXING IN MARKOV CHAINS,0.17060367454068243,"where the last inequality follows from the Cauchy-Schwartz inequality. Using equation 3.9 of Paulin
(2015), we have γps ≥
1
2τmix . Taken together, this gives"
MIXING IN MARKOV CHAINS,0.1732283464566929,"EˆρS[∥ρE
S −ˆρS∥TV] ≤
q"
MIXING IN MARKOV CHAINS,0.17585301837270342,8|S|τmix
MIXING IN MARKOV CHAINS,0.1784776902887139,"N
.
(10)"
MIXING IN MARKOV CHAINS,0.18110236220472442,"Instantiating Proposition 2.18 of Paulin (2015), we obtain"
MIXING IN MARKOV CHAINS,0.1837270341207349,"P(|∥ρE
S −ˆρS∥TV −EˆρS[∥ρE
S −ˆρS∥TV]| ≥ϵ) ≤2 exp

−ϵ2N"
MIXING IN MARKOV CHAINS,0.18635170603674542,4.5τmix
MIXING IN MARKOV CHAINS,0.1889763779527559,"
.
(11)"
MIXING IN MARKOV CHAINS,0.19160104986876642,"Combining equations 10 and 11, we obtain"
MIXING IN MARKOV CHAINS,0.1942257217847769,"P

|∥ρE
S −ˆρS∥TV ≥ϵ +
q"
MIXING IN MARKOV CHAINS,0.1968503937007874,8|S|τmix N
MIXING IN MARKOV CHAINS,0.1994750656167979,"
≤2 exp

−ϵ2N"
MIXING IN MARKOV CHAINS,0.2020997375328084,"4.5τmix 
."
MIXING IN MARKOV CHAINS,0.2047244094488189,"Since the expert policy is deterministic, the total variation distance between the distributions of
state-action tuples and states is the same, i.e. ∥ρE
S −ˆρS∥TV = ∥ρE −ˆρ∥TV."
MIXING IN MARKOV CHAINS,0.2073490813648294,Published as a conference paper at ICLR 2022
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2099737532808399,"4.2
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2125984251968504,"We now want to show that it is possible for the imitation learner to attain a large intrinsic reward.
Informally, the proof asks what intrinsic reward the expert would have achieved. We then conclude
that a learner specifically optimizing the intrinsic reward will obtain at least as much.
Lemma 5. Generating an expert histogram with N points, with probability at least 1 −
2 exp
n
−ϵ2N"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2152230971128609,4.5τmix
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2178477690288714,"o
, we obtain a dataset such that a policy πI maximizing the intrinsic reward"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2204724409448819,"Rint(s, a) = 1((s, a) ∈D) satisfies EρI[Rint] ≥1 −ϵ −
q"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2230971128608924,8|S|τmix
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.22572178477690288,"N
, where we used the shorthand
notation ρI = ρπI to denote the state-action distribution of πI."
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2283464566929134,"Proof. We invoke Lemma 4 obtaining ∥ρE −ˆρ∥TV ≤ϵ +
q"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.23097112860892388,8|S|τmix
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2335958005249344,"N
with probability as in the
statement of the lemma. First, we prove
P
s,a ρE(s, a)1 {ˆρ(s, a) = 0} ≤ϵ +
q"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.23622047244094488,8|S|τmix
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2388451443569554,"N
,
(12)"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.24146981627296588,"by setting ρ1 = ρE, ρ2 = ˆρ and M = {(s, a) : ˆρ(s, a) = 0} in equation 3."
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2440944881889764,Combining 1 = P
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.24671916010498687,"s,a ρE(s, a) = P"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.24934383202099739,"s,a ρE(s, a)1 {ˆρ(s, a) = 0} + P"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.25196850393700787,"s,a ρE(s, a)1 {ˆρ(s, a) > 0}
(13)"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2545931758530184,"and equation 12, we obtain
P"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2572178477690289,"s,a ρE(s, a)1 {ˆρ(s, a) > 0} ≥1 −ϵ −
q"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.25984251968503935,8|S|τmix
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.26246719160104987,"N
,
(14)"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2650918635170604,"which means that the expert policy achieves expected per-step intrinsic reward of at least 1 −ϵ −
q"
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.2677165354330709,8|S|τmix
HIGH EXPECTED INTRINSIC PER-STEP REWARD IS ACHIEVABLE,0.27034120734908135,"N
. This lower bounds the expected per-step reward obtained by the optimal policy."
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.27296587926509186,"4.3
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD"
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.2755905511811024,"We now aim to prove that the intrinsic and extrinsic rewards are connected, i.e. maximizing the
intrinsic reward leads to a large expected per-step extrinsic reward. The proofs in this section are
based on the insight that, by construction of intrinsic reward in equation 6, attaining intrinsic reward
of one in a given state implies agreement with the expert. In the following Lemma, we quantify the
outcome of achieving such agreement for ℓconsecutive steps.
Lemma 6. Assume an agent traverses a sequence of ℓstate-action pairs, in a way consistent with
the expert policy. Denote the expert’s expected extrinsic per-step reward with EρE[R]. Denote
by ˜ρp1
t (s, a) = (p⊤
1 P t
E)(s)πE(a|s) the expected state-action occupancy at time t, starting in state
distribution p1. The per-step extrinsic reward ˜V ℓ
p1 of the agent in expectation over realizations of the
sequence satisfies"
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.2782152230971129,"˜V ℓ
p1 = P"
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.28083989501312334,"s,a
Pℓ−1
t=0
1
ℓ˜ρp1
t (s, a)

R(s, a)

≥EρE[R] −4τmix"
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.28346456692913385,"ℓ.
(15)"
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.28608923884514437,"Proof. Invoking Lemma 2, we have that EρE[R] −E˜ρp1
t [R] ≤2∥˜ρp1
t
−ρE∥TV for any timestep
t. In other words, the expected per-step reward obtained in step t of the sequence is at least
EρE[R] −2∥˜ρp1
t −ρE∥TV. The per-step reward in the sequence is at least"
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.2887139107611549,"˜V ℓ
p1 ≥1"
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.29133858267716534,"ℓ
Pℓ−1
i=0(EρE[R] −2∥˜ρp1
i −ρE∥TV) = EρE[R] −2"
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.29396325459317585,"ℓ
Pℓ−1
i=0 ∥˜ρp1
i −ρE∥TV
≥EρE[R] −2"
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.29658792650918636,"ℓ
P∞
i=0 ∥˜ρp1
i −ρE∥TV"
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.2992125984251969,"Invoking Lemma 3, we have that P∞
t=0 ∥p⊤
1 P t
E −ρE
S ∥TV ≤2τmix. Since the expert policy is
deterministic, distances between distributions of states and state-action pairs are the same. We thus
get ˜V ℓ
p1 ≥EρE[R] −4τmix ℓ."
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.30183727034120733,Published as a conference paper at ICLR 2022
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.30446194225721784,"In Lemma 6, we have shown that, on average, agreeing with the expert for a number of steps
guarantees a certain level of extrinsic reward. We will now use this result to guarantee extrinsic
reward obtained over a long trajectory."
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.30708661417322836,"Lemma 7. For any extrinsic reward signal R bounded in [0, 1], an imitation learner which attains
expected per-step intrinsic reward of EρI[Rint] = 1 −κ also attains extrinsic per-step reward of at
least
EρI[R] ≥(1 −κ)(EρE[R]) −4τmixκ,"
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.30971128608923887,"with probability one, where EρE[R] is the expected per-step extrinsic reward of the expert."
MAXIMIZING INTRINSIC REWARD LEADS TO HIGH PER-STEP EXTRINSIC REWARD,0.3123359580052493,We provide the proof in Appendix D.
BRINGING THE PIECES TOGETHER,0.31496062992125984,"4.4
BRINGING THE PIECES TOGETHER"
BRINGING THE PIECES TOGETHER,0.31758530183727035,"We now show how Lemma 5 and Lemma 7 can be combined to obtain Proposition 1 (stated in Section
3)."
BRINGING THE PIECES TOGETHER,0.32020997375328086,"Proof of Proposition 1. We use the assumption that N ≥max

800|S|, 450 log
  2"
BRINGING THE PIECES TOGETHER,0.3228346456692913,"δ
	
τ 3
mixη−2.
Since τmix is either zero or τmix ≥1, this implies"
BRINGING THE PIECES TOGETHER,0.32545931758530183,"N ≥max

32|S|τmix (1 + 4τmix)2 η−2, log
2 δ"
BRINGING THE PIECES TOGETHER,0.32808398950131235,"
18τmix (1 + 4τmix)2 η−2

.
(16)"
BRINGING THE PIECES TOGETHER,0.33070866141732286,We will instantiate Lemma 5 with
BRINGING THE PIECES TOGETHER,0.3333333333333333,"ϵ =
η
2 + 8τmix
.
(17)"
BRINGING THE PIECES TOGETHER,0.3359580052493438,"Equations 16 and 17 imply that N ≥log
  2"
BRINGING THE PIECES TOGETHER,0.33858267716535434,"δ

18τmix (1 + 4τmix)2 η−2 = log
  2"
BRINGING THE PIECES TOGETHER,0.34120734908136485,"δ

4.5τmixϵ−2. We can
rewrite this as log
  2"
BRINGING THE PIECES TOGETHER,0.3438320209973753,"δ

≤
Nϵ2
4.5τmix , which implies −ϵ2N"
BRINGING THE PIECES TOGETHER,0.3464566929133858,4.5τmix ≤log δ
THIS IMPLIES THAT,0.34908136482939633,2. This implies that
THIS IMPLIES THAT,0.35170603674540685,"δ ≥2 exp

−ϵ2N"
THIS IMPLIES THAT,0.3543307086614173,4.5τmix
THIS IMPLIES THAT,0.3569553805774278,"
.
(18)"
THIS IMPLIES THAT,0.35958005249343833,"Moreover, using equation 16 again, we have that N ≥32|S|τmix (1 + 4τmix)2 η−2. This is equivalent"
THIS IMPLIES THAT,0.36220472440944884,"to 8|S|τmix N
≤1 4
η2"
THIS IMPLIES THAT,0.3648293963254593,"(1+4τmix)2 , or
q"
THIS IMPLIES THAT,0.3674540682414698,"8|S|τmix N
≤1"
THIS IMPLIES THAT,0.3700787401574803,"2
η
1+4τmix . Using equation 17, we obtain ϵ +
q"
THIS IMPLIES THAT,0.37270341207349084,"8|S|τmix N
≤"
THIS IMPLIES THAT,0.3753280839895013,"η
1+4τmix , equivalent to

ϵ +
q"
THIS IMPLIES THAT,0.3779527559055118,8|S|τmix N
THIS IMPLIES THAT,0.3805774278215223,"
(1 + 4τmix) ≤η. Rewriting this gives"
THIS IMPLIES THAT,0.38320209973753283,"κ (1 + 4τmix) ≤η,
(19)"
THIS IMPLIES THAT,0.3858267716535433,"where we use the notation κ = ϵ +
q"
THIS IMPLIES THAT,0.3884514435695538,"8|S|τmix N
."
THIS IMPLIES THAT,0.3910761154855643,"We first show equation 8, which states that we are able to recover expected per-step expert reward.
Invoking Lemma 5 and using equation 18, we have that it is possible for the imitation learner to
achieve per-step expected intrinsic reward of at least 1 −κ with probability 1 −δ. Invoking Lemma
7, this implies achieving extrinsic reward of at least"
THIS IMPLIES THAT,0.3937007874015748,EρI[R] ≥EρE[R](1 −κ) −4τmixκ.
THIS IMPLIES THAT,0.3963254593175853,This implies
THIS IMPLIES THAT,0.3989501312335958,EρE[R] −EρI[R] ≤EρE[R] −EρE[R](1 −κ) + 4τmixκ
THIS IMPLIES THAT,0.4015748031496063,"= κEρE[R] + 4τmixκ ≤κ + 4τmixκ ≤η,"
THIS IMPLIES THAT,0.4041994750656168,"where the last inequality follows from equation 19. Since this statement holds for any extrinsic reward
signal R, we obtain the total variation bound by invoking Lemma 1, getting ∥ρE −ρI∥TV ≤η."
THIS IMPLIES THAT,0.4068241469816273,Published as a conference paper at ICLR 2022
RELATED WORK,0.4094488188976378,"5
RELATED WORK"
RELATED WORK,0.4120734908136483,"Behavioral Cloning
The simplest way of performing imitation learning is to learn a policy by
fitting a Maximum Likelihood model on the expert dataset. While such ‘behavioral cloning’ is easy
to implement, it does not take into account the sequential nature of the Markov Decision Process,
leading to catastrophic compounding of errors (Ross & Bagnell, 2010). In practice, the performance
of policies obtained with behavioral cloning is highly dependent on the amount of available data.
In contrast, our reduction avoids the problem faced by behavioral cloning and provably works with
limited expert data."
RELATED WORK,0.4146981627296588,"Apprenticeship Learning
Apprenticeship Learning (Abbeel & Ng, 2004) assumes the existence
of a pre-learned linear representation for rewards and then proceeds in multiple iterations. In each
iteration, the algorithm first computes an intrinsic reward signal and then calls an RL solver to obtain
a policy. Our algorithm also uses an RL solver, but unlike Apprenticeship Learning, we only call it
once."
RELATED WORK,0.41732283464566927,"Adversarial IL
Modern adversarial IL algorithms (Ho & Ermon, 2016; Finn et al., 2016; Li et al.,
2017; Sun et al., 2019) remove the requirement to provide a representation by learning it online.
They work by minimizing a divergence between the expert state-action distribution and the one
generated by the RL agent. For example, the GAIL algorithm (Ho & Ermon, 2016) minimizes the
Jensen-Shannon divergence. It can be related to the total variation objective of equation 5 in two ways.
First, the TV and JS divergences obey 2
p"
RELATED WORK,0.4199475065616798,"DJS(ρE, ρI) ≥∥ρE −ρI∥TV, so that DJS(ρE, ρI) ≤ϵ′"
RELATED WORK,0.4225721784776903,"implies ∥ρE −ρI∥TV ≤2
√"
RELATED WORK,0.4251968503937008,"ϵ′. This means that GAIL indirectly minimizes the total variation distance.
Second, we have ∥ρE −ρI∥TV ≥DJS(ρE, ρI). Since our algorithm minimizes Total Variation for
sufficiently large sizes of the expert dataset, this means that it also minimizes the GAIL objective.
Both of these properties imply that our reduction converges to a fixpoint with similar properties
as GAIL’s. This has huge practical significance because our algorithm does not need to train a
discriminator."
RELATED WORK,0.42782152230971127,"Another adversarial algorithm, InfoGAIL (Li et al., 2017) minimizes the 1-Wasserstein divergence,
which obeys EρE[RL] −EρI[RL] ≤DW1(ρE, ρI) for any reward function RL Lipschitz in the L1
norm. This is similar to the property defined by equation 4, implied by our Proposition 1, except
we guarantee closeness of expected per-step reward for any bounded reward function as opposed to
Lipschitz-continuous functions."
RELATED WORK,0.4304461942257218,"Random Expert Distillation
Wang et al. (2019) propose an algorithm which, for finite MDPs,
is the same as ours. However, they do not justify the properties of the imitation policy formally.
Our work can be thought of as complementary. While Wang et al. (2019) conducted an empirical
evaluation using sophisticated support estimators, we fill in the missing theory. Moreover, while our
empirical evaluation is smaller in scope, we attempt to be more complete, demonstrating convergence
in cases where only partial trajectories are given."
RELATED WORK,0.4330708661417323,"The SQIL heuristic
SQIL (Reddy et al., 2020) is close to our work in that it proposes a similar
algorithm. At any given time, SQIL performs off-policy reinforcement learning on a dataset sampled
from the mixture distribution 1"
RELATED WORK,0.4356955380577428,"2(ρE(s, a) + ρRL(s, a)), where ρE(s, a) is the distribution of data
under the expert. Since the rewards are one for the data sampled from ρE and zero for state-
action pairs sampled from ρRL, the expected reward obtained at a state-action pair (s, a) is given by
ρE(s,a)
ρE(s,a)+ρRL(s,a), which is non-stationary and varies between zero and one. The benefit of SQIL is
that it does not require a support estimate. However, while SQIL has demonstrated good empirical
performance, it does not come with a theoretical guarantee of any kind, making it hard to deploy in
settings where we need a theoretical certificate of policy quality."
RELATED WORK,0.43832020997375326,"Expert Feedback Loop
IL algorithms such as SMILe (Ross & Bagnell, 2010) and DAGGER
(Ross et al., 2011) assume the ability to query the expert for more data. While this makes it easier to
reproduce expert behavior, the ability to execute queries is not always available in realistic scenarios.
Our reduction is one-off, and does not need to execute expert queries to obtain more data."
RELATED WORK,0.4409448818897638,Published as a conference paper at ICLR 2022
RELATED WORK,0.4435695538057743,"(
) expert
(
) ILR
(
) BC
(
) GAIL
(
) GMMIL
(
) SQIL"
RELATED WORK,0.4461942257217848,"2
9
2
7
2
5
2
3
2
1
21
23
25
0 500 1000 1500 2000 2500"
RELATED WORK,0.44881889763779526,(a) Hopper
RELATED WORK,0.45144356955380577,"2
9
2
7
2
5
2
3
2
1
21
23
25
0 500 1000 1500 2000 2500"
RELATED WORK,0.4540682414698163,(b) Ant
RELATED WORK,0.4566929133858268,"2
9
2
7
2
5
2
3
2
1
21
23
25
0 500 1000 1500 2000"
RELATED WORK,0.45931758530183725,(c) Walker
RELATED WORK,0.46194225721784776,"2
9
2
7
2
5
2
3
2
1
21
23
25 1000 0 1000 2000"
RELATED WORK,0.4645669291338583,(d) HalfCheetah
RELATED WORK,0.4671916010498688,"Figure 1: Extrinsic return of imitation learners as a function of the number of episodes of demonstra-
tion data. For comparison, we also show expert performance. Confidence bars denote one standard
error."
EXPERIMENTS,0.46981627296587924,"6
EXPERIMENTS"
EXPERIMENTS,0.47244094488188976,"We investigate the performance of our reduction on continuous control tasks. Because Wang et al.
(2019) have already conducted an extensive evaluation of various ways of estimating the support for
the expert distribution, we do not attempt this. Instead, we focus on two aspects: the amount of expert
data needed to achieve good imitation and the relationship between intrinsic and extrinsic return."
EXPERIMENTS,0.47506561679790027,"Continuous Relaxation
In order to adapt the discrete reduction to a continuous state-action space,
we define the reward as R′
I(s, a) = 1 −min(s′,a′)∈D dL2((s, a), (s′, a′))2. To see how this is related
to the reward in equation 6, consider a scaled version of the binary reward used in the theoretical
analysis which ranges from 1 −L to 1 instead of from 0 to 1, where L is the L2-diameter of the
state-action space. Then the relaxed reward is an upper bound on the scaled theoretical reward. Since
optimizing this upper bound is different from optimizing the reward in equation 6 directly, we can no
longer theoretically claim the recovery of expert reward (as in Lemma 7). However, this property
still holds in practice, as verified below. In settings where such reduction is not feasible, the random
expert distillation approach can be used, which Wang et al. (2019) have demonstrated can work quite
well and Burda et al. (2018) have shown can work with pixel observations."
EXPERIMENTS,0.4776902887139108,"Experimental Setup
We use the Hopper, Ant, Walker and HalfCheetah continuous control envi-
ronments from the PyBullet gym suite (Ellenberger, 2018–2019). The expert policy is obtained
by training a SAC agent for 2 million steps. We compare 5 methods. ILR denotes our imitation
learning reduction. BC denotes a behavioral cloning policy, obtained after training on the expert
dataset for 500000 steps. GAIL (Ho & Ermon, 2016) denotes the Generative Adversarial Imitation
Learning algorithm. GMMIL (Kim & Park, 2018) denotes a variant of adversarial IL minimizing the
MMD divergence. SQIL (Reddy et al., 2020) denotes the SQIL heuristic. In order to ensure a fair
comparison among algorithms, we re-implemented all of them using the same basis RL algorithm,
SAC (Haarnoja et al., 2018). All imitation learning agents were run for 500000 environment interac-
tions. We repeated our experiments using 5 different random seeds. The remaining details about the
implementation and hyperparameters are provided in Appendix A."
EXPERIMENTS,0.48031496062992124,"Performance as Function of Quantity of Expert Data
The plot in Figure 1 shows the performance
of various imitation learners as a function of how much expert data is available. The amount of data
is measured in episodes, where fractional numbers mean that state-action tuples are taken from the
beginning of the episode. Confidence bars represent one standard error. All of the methods except BC
work well when given a large quantity of expert data (16 episodes, on the right hand side of the plot).
However, for smaller sizes of the expert dataset, the performance of various methods deteriorates
at different rates. In particular, GMMIL needs more expert data than other methods on Hopper and
Walker, while on Ant ILR achieves top performance with less data than other methods. Across all the
environments, ILR is competitive with the best of the other methods. We claim that our method is
preferable since it is the simplest one to implement, is computationally cheap and does not introduce
new hyperparameters beyond those of the RL solver."
EXPERIMENTS,0.48293963254593175,"Performance as Function of Quantity of Environment Interactions
In Figure 2, we examine the
progress of the various agents as a function of environment interactions for a dataset containing 16
expert episodes. ILR shows improved sample efficiency on Ant, while behaving similarly to other"
EXPERIMENTS,0.48556430446194226,Published as a conference paper at ICLR 2022
EXPERIMENTS,0.4881889763779528,"(
) expert
(
) ILR
(
) GAIL
(
) GMMIL
(
) SQIL"
K,0.49081364829396323,"0.00K
250.00K
500.00K
0 500 1000 1500 2000 2500"
K,0.49343832020997375,(a) Hopper
K,0.49606299212598426,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.49868766404199477,(b) Ant
K,0.5013123359580053,"0.00K
250.00K
500.00K
0 500 1000 1500 2000"
K,0.5039370078740157,(c) Walker
K,0.5065616797900262,"0.00K
250.00K
500.00K 1000 500 0 500 1000 1500 2000"
K,0.5091863517060368,(d) HalfCheetah
K,0.5118110236220472,"Figure 2: Extrinsic return of imitation learner as a function of the number of environment interactions.
Imitation learners were trained on 16 expert trajectories. Shaded area denotes one standard error."
K,0.5144356955380578,"algorithms on Hopper, Walker and HalfCheetah. Again, we are led to conclude that ILR is preferable
to to the other algorithms because of its simplicity. We provide analogous plots for different sizes of
the expert dataset in Appendix B."
K,0.5170603674540682,"0
200
400
600
800
Intrinsic Return 0 500 1000 1500 2000"
K,0.5196850393700787,Extrinsic Return
K,0.5223097112860893,"Figure 3: Intrinsic vs Extrinsic
returns"
K,0.5249343832020997,"Intrinsic and Extrinsic Returns are Related in Practice
Our
reasoning in Section 4.3 shows that achieving a large intrinsic return
serves as a performance certificate, guaranteeing a certain level of
extrinsic return. We conducted an experiment to determine if this
property still holds for our continuous-state relaxation. Figure 3
shows the relationship between the intrinsic return (on the horizontal
axis) and the extrinsic return (on the vertical axis), during the first
50K steps of training using the Hopper environment. Each point on
the plot corresponds to evaluating the policy 100 times and averaging
the results. The plot confirms that there is a clear, close-to-linear,
relationship between the intrinsic and extrinsic return."
CONCLUSIONS,0.5275590551181102,"7
CONCLUSIONS"
CONCLUSIONS,0.5301837270341208,"We have shown that, for deterministic experts, imitation learning can be performed with a single
invocation of an RL solver. We have derived a bound guaranteeing the performance of the obtained
policy and relating the reduction to adversarial imitation learning algorithms. Finally, we have
evaluated the proposed reduction on a family of continuous control tasks, showing that it achieves
competitive performance while being comparatively simple to implement."
ACKNOWLEDGMENTS,0.5328083989501312,"8
ACKNOWLEDGMENTS"
ACKNOWLEDGMENTS,0.5354330708661418,"The author thanks Lucas Maystre and Daniel Russo for proofreading the draft and making helpful
suggestions. Any mistakes are my own."
ETHICS STATEMENT,0.5380577427821522,"9
ETHICS STATEMENT"
ETHICS STATEMENT,0.5406824146981627,"Since our most important contribution is a bound stating that the imitation learner closely mimics the
expert, the ethical implications of actions taken by our algorithm crucially depend on the provided
demonstrations. The most direct avenue for misuse is for malicious actors to intentionally demonstrate
unethical behavior. Second, assuming the demonstrations are provided in good faith, there is a risk
of excessive reliance on the provided bound. Specifically, it is still possible that our algorithm fails
to recover expert behavior in situations where assumptions needed by our proof are not met, for
example if the expert policy is stochastic. In certain settings, the bounds can also turn out to be very
loose, for example when the expert policy takes long to mix. This means that one should not deploy
our reduction in safety-critical environments without validating the assumptions first. However, the
proposed reduction also has positive effects. Specifically, we provide the benefits of adversarial
imitation learning, but without having to train the discriminator. This means that training is cheaper,
making imitation learning more affordable and research on imitation learning more democratic."
ETHICS STATEMENT,0.5433070866141733,Published as a conference paper at ICLR 2022
REPRODUCIBILITY STATEMENT,0.5459317585301837,"10
REPRODUCIBILITY STATEMENT"
REPRODUCIBILITY STATEMENT,0.5485564304461942,"Our main contribution is Proposition 1, for which we provided a complete proof. The external results
we rely on are generic properties of the Total Variation distance and of Markov chain mixing1, for all
of which we have provided references. Our experimental setup is described in detail in Appendix A.
Moreover, we make the source code available."
REFERENCES,0.5511811023622047,REFERENCES
REFERENCES,0.5538057742782152,"Pieter Abbeel and Andrew Y Ng. Apprenticeship learning via inverse reinforcement learning. In
Proceedings of the twenty-first international conference on Machine learning, pp. 1, 2004."
REFERENCES,0.5564304461942258,"Christopher G Atkeson and Stefan Schaal. Robot learning from demonstration. In ICML, volume 97,
pp. 12–20. Citeseer, 1997."
REFERENCES,0.5590551181102362,"Yuri Burda, Harrison Edwards, Amos Storkey, and Oleg Klimov. Exploration by random network
distillation. arXiv preprint arXiv:1810.12894, 2018."
REFERENCES,0.5616797900262467,"Benjamin
Ellenberger.
Pybullet
gymperium.
https://github.com/benelot/
pybullet-gym, 2018–2019."
REFERENCES,0.5643044619422573,"Eugene A Feinberg and Adam Shwartz. Handbook of Markov decision processes: methods and
applications, volume 40. Springer Science & Business Media, 2012."
REFERENCES,0.5669291338582677,"Chelsea Finn, Sergey Levine, and Pieter Abbeel. Guided cost learning: Deep inverse optimal control
via policy optimization. In International Conference on Machine Learning, pp. 49–58, 2016."
REFERENCES,0.5695538057742782,"Seyed Kamyar Seyed Ghasemipour, Richard Zemel, and Shixiang Gu. A divergence minimization
perspective on imitation learning methods. In Conference on Robot Learning, pp. 1259–1277.
PMLR, 2020."
REFERENCES,0.5721784776902887,"Tuomas Haarnoja, Aurick Zhou, Pieter Abbeel, and Sergey Levine. Soft actor-critic: Off-policy
maximum entropy deep reinforcement learning with a stochastic actor. In International conference
on machine learning, pp. 1861–1870. PMLR, 2018."
REFERENCES,0.5748031496062992,"Jonathan Ho and Stefano Ermon. Generative adversarial imitation learning. In Advances in neural
information processing systems, pp. 4565–4573, 2016."
REFERENCES,0.5774278215223098,"Borja Ibarz, Jan Leike, Tobias Pohlen, Geoffrey Irving, Shane Legg, and Dario Amodei. Reward
learning from human preferences and demonstrations in atari. In Advances in neural information
processing systems, pp. 8011–8023, 2018."
REFERENCES,0.5800524934383202,"Kee-Eung Kim and Hyun Soo Park. Imitation learning via kernel mean embedding. In Thirty-Second
AAAI Conference on Artificial Intelligence, 2018."
REFERENCES,0.5826771653543307,"David A Levin, Yuval Peres, and EL Wilmer. Markov chains and mixing times, vol. 107. American
Mathematical Soc, 799, 2017."
REFERENCES,0.5853018372703412,"Yunzhu Li, Jiaming Song, and Stefano Ermon. Infogail: Interpretable imitation learning from visual
demonstrations. In Advances in Neural Information Processing Systems, pp. 3812–3822, 2017."
REFERENCES,0.5879265091863517,"Andrew Y Ng, Stuart J Russell, et al. Algorithms for inverse reinforcement learning. In Icml,
volume 1, pp. 2, 2000."
REFERENCES,0.5905511811023622,"Daniel Paulin. Concentration inequalities for markov chains by marton couplings and spectral
methods. Electronic Journal of Probability, 20, 2015."
REFERENCES,0.5931758530183727,"Martin L Puterman. Markov decision processes: discrete stochastic dynamic programming. John
Wiley & Sons, 2014."
REFERENCES,0.5958005249343832,"1In particular, we use a corollary of McDiarmid’s inequality for Markov chains by Paulin (2015)."
REFERENCES,0.5984251968503937,Published as a conference paper at ICLR 2022
REFERENCES,0.6010498687664042,"Siddharth Reddy, Anca D. Dragan, and Sergey Levine. SQIL: Imitation learning via reinforcement
learning with sparse rewards. In International Conference on Learning Representations, 2020.
URL https://openreview.net/forum?id=S1xKd24twB."
REFERENCES,0.6036745406824147,"Stéphane Ross and Drew Bagnell. Efficient reductions for imitation learning. In Proceedings of the
thirteenth international conference on artificial intelligence and statistics, pp. 661–668, 2010."
REFERENCES,0.6062992125984252,"Stéphane Ross, Geoffrey Gordon, and Drew Bagnell. A reduction of imitation learning and structured
prediction to no-regret online learning. In Proceedings of the fourteenth international conference
on artificial intelligence and statistics, pp. 627–635, 2011."
REFERENCES,0.6089238845144357,"Wen Sun, Anirudh Vemula, Byron Boots, and Drew Bagnell. Provably efficient imitation learning
from observation alone. In International Conference on Machine Learning, pp. 6036–6045, 2019."
REFERENCES,0.6115485564304461,"Ruohan Wang, Carlo Ciliberto, Pierluigi Vito Amadori, and Yiannis Demiris. Random expert
distillation: Imitation learning via expert policy support estimation. In International Conference
on Machine Learning, pp. 6536–6544. PMLR, 2019."
REFERENCES,0.6141732283464567,"Tianhao Zhang, Zoe McCarthy, Owen Jow, Dennis Lee, Xi Chen, Ken Goldberg, and Pieter Abbeel.
Deep imitation learning for complex manipulation tasks from virtual reality teleoperation. In 2018
IEEE International Conference on Robotics and Automation (ICRA), pp. 1–8. IEEE, 2018."
REFERENCES,0.6167979002624672,"A
DETAILS OF EXPERIMENTAL SETUP"
REFERENCES,0.6194225721784777,"To ensure a fair comparison, we implemented all imitation learners (ILR, GAIL, GMMIL and SQIL)
using the same base reinforcement learning solver (SAC). The implementation of SAC we used as a
basis came from the d4rl-pybullet repository2. The hyperparameters of SAC are given in the
table below."
REFERENCES,0.6220472440944882,"hyperparameter
value
actor optimizer
Adam
actor learning rate
3e-4
critic optimizer
Adam
critic learning rate
3e-4
batch size
100
update rate for target network (tau)
0.005
γ
0.99"
REFERENCES,0.6246719160104987,"The policy network and the critic network have two fully connected middle layers with 256 neurons
each followed by ReLU non-linearities. The entropy term was not used when performing the actor
update after we found that including it had no effect on performance. Instead, a fixed Gaussian noise
with standard deviation of 0.01 was used for exploration."
REFERENCES,0.6272965879265092,"For our behavioral cloning baseline, we performed supervised learning for 500K steps, using the
Adam optimizer with learning rate 3e-4. We used the same policy network architecture as the SAC
policy network."
REFERENCES,0.6299212598425197,ILR does not introduce any additional hyperparameters.
REFERENCES,0.6325459317585301,GAIL has the following additional hyperparameters.
REFERENCES,0.6351706036745407,"hyperparameter
value
discriminator optimizer
Adam
discriminator learning rate
3e-4
discriminator batch size
100
discriminator update frequency
32
discriminator training iterations
500"
REFERENCES,0.6377952755905512,2https://github.com/takuseno/d4rl-pybullet
REFERENCES,0.6404199475065617,Published as a conference paper at ICLR 2022
REFERENCES,0.6430446194225722,"The last two hyperparameters mean that the discriminator network in GAIL is updated every 32
simulation steps, using 500 batches of data."
REFERENCES,0.6456692913385826,"A direct implementation of GMMIL requires looping over the whole replay buffer each time a reward
is computed, which makes the algorithm very slow for longer runs. To make it tractable, we we only
computed the kernel for 8 points closest to the given state-action pair in the replay buffer and for 8
points in the expert dataset. The data structure used to find the nearest 8 points was updated every
32 steps. Kernel hyper-parameters were automatically estimated using the median heuristic (Kim &
Park, 2018) each time the algorithm was run."
REFERENCES,0.6482939632545932,"SQIL uses a batch size of 200 (100 for state-action pairs from the expert and 100 for state-action
pairs coming from the replay buffer). It does not have additional hyperparameters."
REFERENCES,0.6509186351706037,"B
PLOTS MEASURING SAMPLE EFFICIENCY"
REFERENCES,0.6535433070866141,"In this section, we include plots showing the efficiency of all algorithms measured in terms of
environment interactions, for different quantities of available expert data. The plots can be thought as
an extension of Figure 1 in the main paper to what is happening during learning, not just at the end."
REFERENCES,0.6561679790026247,"(
) expert
(
) ILR
(
) GAIL
(
) GMMIL
(
) SQIL"
REFERENCES,0.6587926509186351,"Hopper
Ant
Walker
HalfCheetah"
EPISODES,0.6614173228346457,16 episodes
K,0.6640419947506562,"0.00K
250.00K
500.00K
0 500 1000 1500 2000 2500"
K,0.6666666666666666,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.6692913385826772,"0.00K
250.00K
500.00K
0 500 1000 1500 2000"
K,0.6719160104986877,"0.00K
250.00K
500.00K 1000 500 0 500 1000 1500 2000"
EPISODES,0.6745406824146981,8 episodes
K,0.6771653543307087,"0.00K
250.00K
500.00K 500 1000 1500 2000 2500"
K,0.6797900262467191,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.6824146981627297,"0.00K
250.00K
500.00K
0 500 1000 1500 2000"
K,0.6850393700787402,"0.00K
250.00K
500.00K 1000 500 0 500 1000 1500 2000"
EPISODES,0.6876640419947506,4 episodes
K,0.6902887139107612,"0.00K
250.00K
500.00K 500 1000 1500 2000 2500"
K,0.6929133858267716,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.6955380577427821,"0.00K
250.00K
500.00K 0 500 1000 1500 2000"
K,0.6981627296587927,"0.00K
250.00K
500.00K
1500 1000 500 0 500 1000 1500 2000"
EPISODE,0.7007874015748031,1 episode
K,0.7034120734908137,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7060367454068242,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7086614173228346,"0.00K
250.00K
500.00K 0 500 1000 1500 2000"
K,0.7112860892388452,"0.00K
250.00K
500.00K
1500 1000 500 0 500 1000 1500 2000"
K,0.7139107611548556,1/2 episode
K,0.7165354330708661,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7191601049868767,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7217847769028871,"0.00K
250.00K
500.00K 0 500 1000 1500 2000"
K,0.7244094488188977,"0.00K
250.00K
500.00K 1000 500 0 500 1000 1500 2000"
K,0.7270341207349081,1/4 episode
K,0.7296587926509186,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7322834645669292,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7349081364829396,"0.00K
250.00K
500.00K 0 500 1000 1500 2000"
K,0.7375328083989501,"0.00K
250.00K
500.00K 1000 500 0 500 1000 1500 2000"
K,0.7401574803149606,Published as a conference paper at ICLR 2022
K,0.7427821522309711,1/8 episode
K,0.7454068241469817,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7480314960629921,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7506561679790026,"0.00K
250.00K
500.00K 0 500 1000 1500 2000"
K,0.7532808398950132,"0.00K
250.00K
500.00K 1000 500 0 500 1000 1500 2000"
K,0.7559055118110236,1/16 episode
K,0.7585301837270341,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7611548556430446,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7637795275590551,"0.00K
250.00K
500.00K 0 500 1000 1500"
K,0.7664041994750657,"0.00K
250.00K
500.00K 1000 0 1000 2000"
K,0.7690288713910761,1/32 episode
K,0.7716535433070866,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7742782152230971,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7769028871391076,"0.00K
250.00K
500.00K 0 500 1000 1500"
K,0.7795275590551181,"0.00K
250.00K
500.00K 1000 0 1000 2000"
K,0.7821522309711286,1/64 episode
K,0.7847769028871391,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7874015748031497,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.7900262467191601,"0.00K
250.00K
500.00K 0 500 1000 1500"
K,0.7926509186351706,"0.00K
250.00K
500.00K 1000 0 1000 2000"
K,0.7952755905511811,1/128 episode
K,0.7979002624671916,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.800524934383202,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.8031496062992126,"0.00K
250.00K
500.00K 0 500 1000 1500"
K,0.8057742782152231,"0.00K
250.00K
500.00K 1000 0 1000 2000"
K,0.8083989501312336,1/256 episode
K,0.8110236220472441,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.8136482939632546,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.8162729658792651,"0.00K
250.00K
500.00K 0 500 1000 1500"
K,0.8188976377952756,"0.00K
250.00K
500.00K 1000 0 1000 2000"
K,0.821522309711286,1/512 episode
K,0.8241469816272966,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.8267716535433071,"0.00K
250.00K
500.00K 0 500 1000 1500 2000 2500"
K,0.8293963254593176,"0.00K
250.00K
500.00K 0 500 1000 1500"
K,0.8320209973753281,"0.00K
250.00K
500.00K 1000 0 1000 2000"
K,0.8346456692913385,"C
RUNTIME COMPARISON OF DIFFERENT ALGORITHMS"
K,0.8372703412073491,"We ran all algorithms from the paper in a controlled computational setting (no other processes running
on the machine) in the hopper environment for 500K iterations. An expert dataset containing 16
episodes was used. Results are given below."
K,0.8398950131233596,"Algorithm
Runtime
BC
0m 17s
SQIL
94m 39s
ILR
99m 16s
GAIL
213m 56s
GMMIL
448m 42s"
K,0.84251968503937,"Behavioral Cloning (BC) is the fastest, because it does not have to do any interaction with the
environment (it does, however, produce a policy with the worst performance). SQIL and ILR have a"
K,0.8451443569553806,Published as a conference paper at ICLR 2022
K,0.847769028871391,"comparable runtime, dominated by the complexity of simulating the environment. GAIL is slower
because it has to train the discriminator network. GMMIL is the slowest algorithm due to the high
cost of computing the MMD divergences."
K,0.8503937007874016,"Overall, the conclusion from this benchmark is that our algorithm (ILR) is highly competitive in
terms of runtime."
K,0.8530183727034121,"D
ADDITIONAL PROOFS"
K,0.8556430446194225,"Proof of Lemma 1. By setting v′ = 1 −v, it follows that Eρ2[v] −Eρ1[v] ≤ϵ for all v. Therefore
|Eρ1[v] −Eρ2[v]| ≤ϵ for all v. For any M ⊆X on the right-hand side of equation 3, we can
instantiate v(x) = 1 {x ∈M}, completing the proof."
K,0.8582677165354331,Proof of Lemma 2. We have
K,0.8608923884514436,|Eρ1[v] −Eρ2[v]| = |P
K,0.863517060367454,x(ρ1(x) −ρ2(x))v(x)| ≤P
K,0.8661417322834646,x |ρ1(x) −ρ2(x)| = ∥ρ1 −ρ2∥1.
K,0.868766404199475,"Here, the first inequality follows because elements of v are in the interval [0, 1]. The statement of the
lemma follows from the property ∥ρ1 −ρ2∥TV = 1"
K,0.8713910761154856,2∥ρ1 −ρ2∥1.
K,0.8740157480314961,"Proof of Lemma 3. By Theorem 4.9 in the book by Levin et al. (2017), there are constants
C > 0 and α ∈(0, 1) such that max′
s ∥1(s′)⊤P t
E −ρE
S ∥TV ≤Cαt.
Defining ˜ρs′
t (s, a) =
(1(s′)⊤P t
E)(s)πE(a|s), we have maxs′ ∥˜ρs′
t −ρE∥TV ≤Cαt, where we used the fact that the
expert policy is deterministic so that ∥˜ρs′
t −ρE∥TV = ∥1(s′)⊤P t
E −ρE
S ∥TV. The mixing time of
the chain τmix, defined as the smallest t so that maxs′ ∥1(s′)⊤P t
E −ρE
S ∥TV ≤1"
IS THEN BOUNDED AS,0.8766404199475065,"4 is then bounded as
τmix ≤−logα C −logα(4)."
IS THEN BOUNDED AS,0.8792650918635171,"It remains to show that, for any probability distribution p1, we have P∞
t=0 ∥p⊤
1 P t
E −ρE
S ∥≤2τmix."
IS THEN BOUNDED AS,0.8818897637795275,"Define d(t) = supp ∥p⊤P t
E −ρE
S ∥TV. By equation 4.35 in the book by Levin et al. (2017), we have"
IS THEN BOUNDED AS,0.884514435695538,"d(ℓτmix) ≤2−ℓ.
(20)"
IS THEN BOUNDED AS,0.8871391076115486,"We can now write ∞
X"
IS THEN BOUNDED AS,0.889763779527559,"t=0
∥p⊤
1 P t
E −ρE
S ∥≤ ∞
X"
IS THEN BOUNDED AS,0.8923884514435696,"t=0
d(t) ≤ ∞
X"
IS THEN BOUNDED AS,0.89501312335958,"t=0
d(τmix⌊t/τmix⌋) ≤ ∞
X"
IS THEN BOUNDED AS,0.8976377952755905,"t=0
2−⌊t/τmix⌋,"
IS THEN BOUNDED AS,0.9002624671916011,"where the first inequality follows from the definition of d(t), the second one from the fact that
d(t′) ≤d(t) for t′ ≥t and the last one from equation 20. We can rewrite the right-hand side further,
giving ∞
X"
IS THEN BOUNDED AS,0.9028871391076115,"t=0
2−⌊t/τmix⌋= τmix ∞
X"
IS THEN BOUNDED AS,0.905511811023622,"t=0
2−t = 2τmix."
IS THEN BOUNDED AS,0.9081364829396326,"Proof of Lemma 7. Consider the imitation learner’s trajectory of length T. We will now consider
sub-sequences where the agent agrees with the expert. Denote by Mℓthe number of such sequences
of length ℓ. Denote by ˆV i,ℓthe per-step extrinsic reward obtained by the agent in the ith sequence of
length ℓ."
IS THEN BOUNDED AS,0.910761154855643,"Assuming the worst case reward on states which are not in any of the sequences (i.e. where
the agent disagrees with the expert), the total extrinsic return JT along the trajectory is at least
P"
IS THEN BOUNDED AS,0.9133858267716536,"ℓℓPMℓ
i=1 ˆV i,ℓ= P ℓℓMℓ1"
IS THEN BOUNDED AS,0.916010498687664,"Mℓ
PMℓ
i=1 ˆV i,ℓ. Dividing by the sequence length, the per-step extrinsic
reward is at least JT T ≥P ℓ
ℓMℓ"
IS THEN BOUNDED AS,0.9186351706036745,"T
1
Mℓ
PMℓ
i=1 ˆV i,ℓ.
(21)"
IS THEN BOUNDED AS,0.9212598425196851,Published as a conference paper at ICLR 2022
IS THEN BOUNDED AS,0.9238845144356955,"Denote by ∆ℓ=
 1"
IS THEN BOUNDED AS,0.926509186351706,"Mℓ
PMℓ
i=1 ˆV i,ℓ−
1
Mℓ
PMℓ
i=1 ˜V ℓ
p(sℓ
1)"
IS THEN BOUNDED AS,0.9291338582677166,the difference between the average extrinsic
IS THEN BOUNDED AS,0.931758530183727,"reward obtained in sequences of length ℓand its expected value, where we denoted by p(sℓ
1) the
initial state distribution among sequences of length ℓ. We can now re-write equation 21 as: JT T ≥P ℓ
ℓMℓ"
IS THEN BOUNDED AS,0.9343832020997376,"T
1
Mℓ
PMℓ
i=1 ˜V ℓ
p(sℓ
1) −P ℓ
ℓMℓ"
IS THEN BOUNDED AS,0.937007874015748,"T ∆ℓ.
(22)"
IS THEN BOUNDED AS,0.9396325459317585,"Using Lemma 6, we can re-write this further JT T ≥P ℓ
ℓMℓ"
IS THEN BOUNDED AS,0.9422572178477691,"T
 
EρE[R] −1"
IS THEN BOUNDED AS,0.9448818897637795,"ℓ4τmix

−P ℓ
ℓMℓ"
IS THEN BOUNDED AS,0.94750656167979,"T ∆ℓ
(23) = P ℓ
ℓMℓ"
IS THEN BOUNDED AS,0.9501312335958005,"T EρE[R] −P ℓ
Mℓ"
IS THEN BOUNDED AS,0.952755905511811,"T 4τmix −P ℓ
ℓMl"
IS THEN BOUNDED AS,0.9553805774278216,"T ∆ℓ.
(24)"
IS THEN BOUNDED AS,0.958005249343832,"Denote by B the number of timesteps the imitation learner disagrees with the expert. Observe
that we have P
ℓ
Mℓ"
IS THEN BOUNDED AS,0.9606299212598425,T ≤B+1
IS THEN BOUNDED AS,0.963254593175853,"T
since B bad timesteps can partition the trajectory into at most B + 1
sub-sequences and P
ℓMℓis the total number of sub-sequences. This gives JT T ≥P ℓ
ℓMℓ"
IS THEN BOUNDED AS,0.9658792650918635,T EρE[R] −B+1
IS THEN BOUNDED AS,0.968503937007874,"T 4τmix −P l
ℓMℓ"
IS THEN BOUNDED AS,0.9711286089238845,"T ∆ℓ.
(25)"
IS THEN BOUNDED AS,0.973753280839895,"Now, using the fact that the imitation learner policy is ergodic, we can take limits as T →∞. The
left hand side converges to EρI[R] with probability one. On the right-hand side, P ℓ
ℓMℓ"
IS THEN BOUNDED AS,0.9763779527559056,"T
(the fraction
of time the imitation learner agrees with the expert) converges to EρI[Rint] = 1 −κ with probability
one. Using ergodicity again, B+1"
IS THEN BOUNDED AS,0.979002624671916,"T
converges to 1 −EρI[Rint] with probability one."
IS THEN BOUNDED AS,0.9816272965879265,"It remains to prove that the error term P ℓ
ℓMℓ"
IS THEN BOUNDED AS,0.984251968503937,"T ∆ℓconverges to zero with probability one. First,
we will show that, for every ℓ, either Mℓis always zero, i.e. the streak length ℓdoes not occur in
sub-sequences of any length or Mℓ→∞as T →∞. Indeed, the chain is ergodic, which means that,
if we traversed a streak of length ℓ, we have non-zero probability of returning to where the streak
begun and then retracing it. Let us call the of set of all ℓs where Mℓ= 0 by N −L∞. Moreover, let
us call the set of ℓs with Mℓ→∞as T →∞with L∞. We have:
P"
IS THEN BOUNDED AS,0.9868766404199475,"ℓ∈L∞
ℓMℓ"
IS THEN BOUNDED AS,0.989501312335958,T ∆ℓ+ P
IS THEN BOUNDED AS,0.9921259842519685,"ℓ∈N−L∞
ℓMℓ"
IS THEN BOUNDED AS,0.994750656167979,"T ∆ℓ≤supℓ∈L∞∆ℓ.
(26)"
IS THEN BOUNDED AS,0.9973753280839895,"The second term in the sum equals zero with because of the definition of L∞. The term supℓ∈L∞∆ℓ
converges to zero with probability one by the law of large numbers, where we use the fact that
Mℓ→∞as T →∞for Mℓ∈L∞."
